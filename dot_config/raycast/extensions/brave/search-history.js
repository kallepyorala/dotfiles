"use strict";
var __create = Object.create;
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __getProtoOf = Object.getPrototypeOf;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toESM = (mod, isNodeMode, target) => (target = mod != null ? __create(__getProtoOf(mod)) : {}, __copyProps(
  // If the importer is in node compatibility mode or this is not an ESM
  // file that has been converted to a CommonJS file using a Babel-
  // compatible transform (i.e. "__esModule" has not been set), then set
  // "default" to the CommonJS "module.exports" for node compatibility.
  isNodeMode || !mod || !mod.__esModule ? __defProp(target, "default", { value: mod, enumerable: true }) : target,
  mod
));
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/search-history.tsx
var search_history_exports = {};
__export(search_history_exports, {
  default: () => Command
});
module.exports = __toCommonJS(search_history_exports);
var import_api9 = require("@raycast/api");
var import_react5 = require("react");

// src/hooks/useHistorySearch.tsx
var import_fs = require("fs");

// src/util/index.ts
var import_path = __toESM(require("path"));

// src/constants.ts
var defaultBraveProfilePath = ["Application Support", "BraveSoftware", "Brave-Browser"];
var defaultBraveBetaProfilePath = ["Application Support", "BraveSoftware", "Brave-Browser-Beta"];
var defaultBraveNightlyProfilePath = ["Application Support", "BraveSoftware", "Brave-Browser-Nightly"];
var defaultBraveStatePath = ["Application Support", "BraveSoftware", "Brave-Browser", "Local State"];
var DEFAULT_BRAVE_PROFILE_ID = "Default";
var BRAVE_PROFILE_KEY = "BRAVE_PROFILE_KEY";
var BRAVE_PROFILES_KEY = "BRAVE_PROFILES_KEY";
var NOT_INSTALLED_MESSAGE = "Brave not installed";

// src/util/index.ts
var import_api = require("@raycast/api");
var { browserOption } = (0, import_api.getPreferenceValues)();
var prefProfile;
switch (browserOption) {
  case "Brave Browser Beta":
    prefProfile = defaultBraveBetaProfilePath;
    break;
  case "Brave Browser Nightly":
    prefProfile = defaultBraveNightlyProfilePath;
    break;
  default:
    prefProfile = defaultBraveProfilePath;
}
var userLibraryDirectoryPath = () => {
  if (!process.env.HOME) {
    throw new Error("$HOME environment variable is not set.");
  }
  return import_path.default.join(process.env.HOME, "Library");
};
var getHistoryDbPath = (profile) => import_path.default.join(userLibraryDirectoryPath(), ...prefProfile, profile ?? DEFAULT_BRAVE_PROFILE_ID, "History");
var getLocalStatePath = () => import_path.default.join(userLibraryDirectoryPath(), ...defaultBraveStatePath);

// src/hooks/useHistorySearch.tsx
var import_react2 = require("react");

// node_modules/@raycast/utils/dist/module.js
var import_react = __toESM(require("react"));
var import_api2 = require("@raycast/api");

// node_modules/dequal/lite/index.mjs
var has = Object.prototype.hasOwnProperty;
function dequal(foo, bar) {
  var ctor, len;
  if (foo === bar) return true;
  if (foo && bar && (ctor = foo.constructor) === bar.constructor) {
    if (ctor === Date) return foo.getTime() === bar.getTime();
    if (ctor === RegExp) return foo.toString() === bar.toString();
    if (ctor === Array) {
      if ((len = foo.length) === bar.length) {
        while (len-- && dequal(foo[len], bar[len])) ;
      }
      return len === -1;
    }
    if (!ctor || typeof foo === "object") {
      len = 0;
      for (ctor in foo) {
        if (has.call(foo, ctor) && ++len && !has.call(bar, ctor)) return false;
        if (!(ctor in bar) || !dequal(foo[ctor], bar[ctor])) return false;
      }
      return Object.keys(bar).length === len;
    }
  }
  return foo !== foo && bar !== bar;
}

// node_modules/@raycast/utils/dist/module.js
var import_node_fs = __toESM(require("node:fs"));
var import_node_path = __toESM(require("node:path"));
var import_node_crypto = __toESM(require("node:crypto"));
var import_node_child_process = __toESM(require("node:child_process"));
var import_node_buffer = require("node:buffer");
var import_node_stream = __toESM(require("node:stream"));
var import_node_util = require("node:util");
var import_promises = require("node:fs/promises");
var import_jsx_runtime = require("react/jsx-runtime");
var import_node_os = __toESM(require("node:os"));
var import_node_url = require("node:url");
var $parcel$global = globalThis;
function $a57ed8effbd797c7$export$722debc0e56fea39(value) {
  const ref = (0, import_react.useRef)(value);
  const signalRef = (0, import_react.useRef)(0);
  if (!(0, dequal)(value, ref.current)) {
    ref.current = value;
    signalRef.current += 1;
  }
  return (0, import_react.useMemo)(() => ref.current, [
    signalRef.current
  ]);
}
function $bfcf6ee368b3bd9f$export$d4b699e2c1148419(value) {
  const ref = (0, import_react.useRef)(value);
  ref.current = value;
  return ref;
}
function $c718fd03aba6111c$export$80e5033e369189f3(error, options) {
  const message = error instanceof Error ? error.message : String(error);
  return (0, import_api2.showToast)({
    style: (0, import_api2.Toast).Style.Failure,
    title: options?.title ?? "Something went wrong",
    message: options?.message ?? message,
    primaryAction: options?.primaryAction ?? $c718fd03aba6111c$var$handleErrorToastAction(error),
    secondaryAction: options?.primaryAction ? $c718fd03aba6111c$var$handleErrorToastAction(error) : void 0
  });
}
var $c718fd03aba6111c$var$handleErrorToastAction = (error) => {
  let privateExtension = true;
  let title = "[Extension Name]...";
  let extensionURL = "";
  try {
    const packageJSON = JSON.parse((0, import_node_fs.readFileSync)((0, import_node_path.join)((0, import_api2.environment).assetsPath, "..", "package.json"), "utf8"));
    title = `[${packageJSON.title}]...`;
    extensionURL = `https://raycast.com/${packageJSON.owner || packageJSON.author}/${packageJSON.name}`;
    if (!packageJSON.owner || packageJSON.access === "public") privateExtension = false;
  } catch (err) {
  }
  const fallback = (0, import_api2.environment).isDevelopment || privateExtension;
  const stack = error instanceof Error ? error?.stack || error?.message || "" : String(error);
  return {
    title: fallback ? "Copy Logs" : "Report Error",
    onAction(toast) {
      toast.hide();
      if (fallback) (0, import_api2.Clipboard).copy(stack);
      else (0, import_api2.open)(`https://github.com/raycast/extensions/issues/new?&labels=extension%2Cbug&template=extension_bug_report.yml&title=${encodeURIComponent(title)}&extension-url=${encodeURI(extensionURL)}&description=${encodeURIComponent(`#### Error:
\`\`\`
${stack}
\`\`\`
`)}`);
    }
  };
};
function $cefc05764ce5eacd$export$dd6b79aaabe7bc37(fn, args, options) {
  const lastCallId = (0, import_react.useRef)(0);
  const [state, set] = (0, import_react.useState)({
    isLoading: true
  });
  const fnRef = (0, $bfcf6ee368b3bd9f$export$d4b699e2c1148419)(fn);
  const latestAbortable = (0, $bfcf6ee368b3bd9f$export$d4b699e2c1148419)(options?.abortable);
  const latestArgs = (0, $bfcf6ee368b3bd9f$export$d4b699e2c1148419)(args || []);
  const latestOnError = (0, $bfcf6ee368b3bd9f$export$d4b699e2c1148419)(options?.onError);
  const latestOnData = (0, $bfcf6ee368b3bd9f$export$d4b699e2c1148419)(options?.onData);
  const latestOnWillExecute = (0, $bfcf6ee368b3bd9f$export$d4b699e2c1148419)(options?.onWillExecute);
  const latestFailureToast = (0, $bfcf6ee368b3bd9f$export$d4b699e2c1148419)(options?.failureToastOptions);
  const latestValue = (0, $bfcf6ee368b3bd9f$export$d4b699e2c1148419)(state.data);
  const latestCallback = (0, import_react.useRef)(null);
  const paginationArgsRef = (0, import_react.useRef)({
    page: 0
  });
  const usePaginationRef = (0, import_react.useRef)(false);
  const hasMoreRef = (0, import_react.useRef)(true);
  const pageSizeRef = (0, import_react.useRef)(50);
  const abort = (0, import_react.useCallback)(() => {
    if (latestAbortable.current) {
      latestAbortable.current.current?.abort();
      latestAbortable.current.current = new AbortController();
    }
    return ++lastCallId.current;
  }, [
    latestAbortable
  ]);
  const callback = (0, import_react.useCallback)((...args2) => {
    const callId = abort();
    latestOnWillExecute.current?.(args2);
    set((prevState) => ({
      ...prevState,
      isLoading: true
    }));
    const promiseOrPaginatedPromise = $cefc05764ce5eacd$var$bindPromiseIfNeeded(fnRef.current)(...args2);
    function handleError(error) {
      if (error.name == "AbortError") return error;
      if (callId === lastCallId.current) {
        if (latestOnError.current) latestOnError.current(error);
        else if ((0, import_api2.environment).launchType !== (0, import_api2.LaunchType).Background) (0, $c718fd03aba6111c$export$80e5033e369189f3)(error, {
          title: "Failed to fetch latest data",
          primaryAction: {
            title: "Retry",
            onAction(toast) {
              toast.hide();
              latestCallback.current?.(...latestArgs.current || []);
            }
          },
          ...latestFailureToast.current
        });
        set({
          error,
          isLoading: false
        });
      }
      return error;
    }
    if (typeof promiseOrPaginatedPromise === "function") {
      usePaginationRef.current = true;
      return promiseOrPaginatedPromise(paginationArgsRef.current).then(
        // @ts-expect-error too complicated for TS
        ({ data, hasMore, cursor }) => {
          if (callId === lastCallId.current) {
            if (paginationArgsRef.current) {
              paginationArgsRef.current.cursor = cursor;
              paginationArgsRef.current.lastItem = data?.[data.length - 1];
            }
            if (latestOnData.current) latestOnData.current(data, paginationArgsRef.current);
            if (hasMore) pageSizeRef.current = data.length;
            hasMoreRef.current = hasMore;
            set((previousData) => {
              if (paginationArgsRef.current.page === 0) return {
                data,
                isLoading: false
              };
              return {
                data: (previousData.data || [])?.concat(data),
                isLoading: false
              };
            });
          }
          return data;
        },
        (error) => {
          hasMoreRef.current = false;
          return handleError(error);
        }
      );
    }
    usePaginationRef.current = false;
    return promiseOrPaginatedPromise.then((data) => {
      if (callId === lastCallId.current) {
        if (latestOnData.current) latestOnData.current(data);
        set({
          data,
          isLoading: false
        });
      }
      return data;
    }, handleError);
  }, [
    latestOnData,
    latestOnError,
    latestArgs,
    fnRef,
    set,
    latestCallback,
    latestOnWillExecute,
    paginationArgsRef,
    latestFailureToast,
    abort
  ]);
  latestCallback.current = callback;
  const revalidate = (0, import_react.useCallback)(() => {
    paginationArgsRef.current = {
      page: 0
    };
    const args2 = latestArgs.current || [];
    return callback(...args2);
  }, [
    callback,
    latestArgs
  ]);
  const mutate = (0, import_react.useCallback)(async (asyncUpdate, options2) => {
    let dataBeforeOptimisticUpdate;
    try {
      if (options2?.optimisticUpdate) {
        abort();
        if (typeof options2?.rollbackOnError !== "function" && options2?.rollbackOnError !== false)
          dataBeforeOptimisticUpdate = structuredClone(latestValue.current?.value);
        const update = options2.optimisticUpdate;
        set((prevState) => ({
          ...prevState,
          data: update(prevState.data)
        }));
      }
      return await asyncUpdate;
    } catch (err) {
      if (typeof options2?.rollbackOnError === "function") {
        const update = options2.rollbackOnError;
        set((prevState) => ({
          ...prevState,
          data: update(prevState.data)
        }));
      } else if (options2?.optimisticUpdate && options2?.rollbackOnError !== false) set((prevState) => ({
        ...prevState,
        data: dataBeforeOptimisticUpdate
      }));
      throw err;
    } finally {
      if (options2?.shouldRevalidateAfter !== false) {
        if ((0, import_api2.environment).launchType === (0, import_api2.LaunchType).Background || (0, import_api2.environment).commandMode === "menu-bar")
          await revalidate();
        else revalidate();
      }
    }
  }, [
    revalidate,
    latestValue,
    set,
    abort
  ]);
  const onLoadMore = (0, import_react.useCallback)(() => {
    paginationArgsRef.current.page += 1;
    const args2 = latestArgs.current || [];
    callback(...args2);
  }, [
    paginationArgsRef,
    latestArgs,
    callback
  ]);
  (0, import_react.useEffect)(() => {
    paginationArgsRef.current = {
      page: 0
    };
    if (options?.execute !== false) callback(...args || []);
    else
      abort();
  }, [
    (0, $a57ed8effbd797c7$export$722debc0e56fea39)([
      args,
      options?.execute,
      callback
    ]),
    latestAbortable,
    paginationArgsRef
  ]);
  (0, import_react.useEffect)(() => {
    return () => {
      abort();
    };
  }, [
    abort
  ]);
  const isLoading = options?.execute !== false ? state.isLoading : false;
  const stateWithLoadingFixed = {
    ...state,
    isLoading
  };
  const pagination = usePaginationRef.current ? {
    pageSize: pageSizeRef.current,
    hasMore: hasMoreRef.current,
    onLoadMore
  } : void 0;
  return {
    ...stateWithLoadingFixed,
    revalidate,
    mutate,
    pagination
  };
}
function $cefc05764ce5eacd$var$bindPromiseIfNeeded(fn) {
  if (fn === Promise.all)
    return fn.bind(Promise);
  if (fn === Promise.race)
    return fn.bind(Promise);
  if (fn === Promise.resolve)
    return fn.bind(Promise);
  if (fn === Promise.reject)
    return fn.bind(Promise);
  return fn;
}
function $93381684554307cb$var$isNativeFunction(f) {
  if (typeof f !== "function") return false;
  const exp = /^function\s+\w*\s*\(\s*\)\s*{\s+\[native code\]\s+}$/i;
  return exp.exec(Function.prototype.toString.call(f)) !== null;
}
function $93381684554307cb$var$hashReplacer(value) {
  if (value instanceof URLSearchParams) return value.toString();
  return value;
}
function $93381684554307cb$export$fe386877a696ae78(writeTo, context = []) {
  function write(str) {
    if ("update" in writeTo) return writeTo.update(str, "utf8");
    else return writeTo.write(str);
  }
  return {
    dispatch: function(value) {
      value = $93381684554307cb$var$hashReplacer(value);
      const type = typeof value;
      if (value === null) this["_null"]();
      else
        this["_" + type](value);
    },
    _object: function(object) {
      const pattern = /\[object (.*)\]/i;
      const objString = Object.prototype.toString.call(object);
      let objType = pattern.exec(objString)?.[1] ?? "unknown:[" + objString + "]";
      objType = objType.toLowerCase();
      let objectNumber = null;
      if ((objectNumber = context.indexOf(object)) >= 0) {
        this.dispatch("[CIRCULAR:" + objectNumber + "]");
        return;
      } else context.push(object);
      if (Buffer.isBuffer(object)) {
        write("buffer:");
        return write(object.toString("utf8"));
      }
      if (objType !== "object" && objType !== "function" && objType !== "asyncfunction") {
        if (this["_" + objType])
          this["_" + objType](object);
        else throw new Error('Unknown object type "' + objType + '"');
      } else {
        let keys = Object.keys(object);
        keys = keys.sort();
        if (!$93381684554307cb$var$isNativeFunction(object)) keys.splice(0, 0, "prototype", "__proto__", "constructor");
        write("object:" + keys.length + ":");
        const self = this;
        return keys.forEach(function(key) {
          self.dispatch(key);
          write(":");
          self.dispatch(object[key]);
          write(",");
        });
      }
    },
    _array: function(arr, unordered) {
      unordered = typeof unordered !== "undefined" ? unordered : false;
      const self = this;
      write("array:" + arr.length + ":");
      if (!unordered || arr.length <= 1) {
        arr.forEach(function(entry) {
          self.dispatch(entry);
        });
        return;
      }
      let contextAdditions = [];
      const entries = arr.map(function(entry) {
        const strm = $93381684554307cb$var$PassThrough();
        const localContext = context.slice();
        const hasher = $93381684554307cb$export$fe386877a696ae78(strm, localContext);
        hasher.dispatch(entry);
        contextAdditions = contextAdditions.concat(localContext.slice(context.length));
        return strm.read().toString();
      });
      context = context.concat(contextAdditions);
      entries.sort();
      this._array(entries, false);
    },
    _date: function(date) {
      write("date:" + date.toJSON());
    },
    _symbol: function(sym) {
      write("symbol:" + sym.toString());
    },
    _error: function(err) {
      write("error:" + err.toString());
    },
    _boolean: function(bool) {
      write("bool:" + bool.toString());
    },
    _string: function(string) {
      write("string:" + string.length + ":");
      write(string.toString());
    },
    _function: function(fn) {
      write("fn:");
      if ($93381684554307cb$var$isNativeFunction(fn)) this.dispatch("[native]");
      else this.dispatch(fn.toString());
      this.dispatch("function-name:" + String(fn.name));
      this._object(fn);
    },
    _number: function(number) {
      write("number:" + number.toString());
    },
    _xml: function(xml) {
      write("xml:" + xml.toString());
    },
    _null: function() {
      write("Null");
    },
    _undefined: function() {
      write("Undefined");
    },
    _regexp: function(regex) {
      write("regex:" + regex.toString());
    },
    _uint8array: function(arr) {
      write("uint8array:");
      this.dispatch(Array.prototype.slice.call(arr));
    },
    _uint8clampedarray: function(arr) {
      write("uint8clampedarray:");
      this.dispatch(Array.prototype.slice.call(arr));
    },
    _int8array: function(arr) {
      write("int8array:");
      this.dispatch(Array.prototype.slice.call(arr));
    },
    _uint16array: function(arr) {
      write("uint16array:");
      this.dispatch(Array.prototype.slice.call(arr));
    },
    _int16array: function(arr) {
      write("int16array:");
      this.dispatch(Array.prototype.slice.call(arr));
    },
    _uint32array: function(arr) {
      write("uint32array:");
      this.dispatch(Array.prototype.slice.call(arr));
    },
    _int32array: function(arr) {
      write("int32array:");
      this.dispatch(Array.prototype.slice.call(arr));
    },
    _float32array: function(arr) {
      write("float32array:");
      this.dispatch(Array.prototype.slice.call(arr));
    },
    _float64array: function(arr) {
      write("float64array:");
      this.dispatch(Array.prototype.slice.call(arr));
    },
    _arraybuffer: function(arr) {
      write("arraybuffer:");
      this.dispatch(new Uint8Array(arr));
    },
    _url: function(url) {
      write("url:" + url.toString());
    },
    _map: function(map) {
      write("map:");
      const arr = Array.from(map);
      this._array(arr, true);
    },
    _set: function(set) {
      write("set:");
      const arr = Array.from(set);
      this._array(arr, true);
    },
    _file: function(file) {
      write("file:");
      this.dispatch([
        file.name,
        file.size,
        file.type,
        file.lastModified
      ]);
    },
    _blob: function() {
      throw Error('Hashing Blob objects is currently not supported\n(see https://github.com/puleos/object-hash/issues/26)\nUse "options.replacer" or "options.ignoreUnknown"\n');
    },
    _domwindow: function() {
      write("domwindow");
    },
    _bigint: function(number) {
      write("bigint:" + number.toString());
    },
    /* Node.js standard native objects */
    _process: function() {
      write("process");
    },
    _timer: function() {
      write("timer");
    },
    _pipe: function() {
      write("pipe");
    },
    _tcp: function() {
      write("tcp");
    },
    _udp: function() {
      write("udp");
    },
    _tty: function() {
      write("tty");
    },
    _statwatcher: function() {
      write("statwatcher");
    },
    _securecontext: function() {
      write("securecontext");
    },
    _connection: function() {
      write("connection");
    },
    _zlib: function() {
      write("zlib");
    },
    _context: function() {
      write("context");
    },
    _nodescript: function() {
      write("nodescript");
    },
    _httpparser: function() {
      write("httpparser");
    },
    _dataview: function() {
      write("dataview");
    },
    _signal: function() {
      write("signal");
    },
    _fsevent: function() {
      write("fsevent");
    },
    _tlswrap: function() {
      write("tlswrap");
    }
  };
}
function $93381684554307cb$var$PassThrough() {
  return {
    buf: "",
    write: function(b) {
      this.buf += b;
    },
    end: function(b) {
      this.buf += b;
    },
    read: function() {
      return this.buf;
    }
  };
}
function $e2e1ea6dd3b7d2e1$export$b644b65666fe0c18(key, _value) {
  const value = this[key];
  if (value instanceof Date) return `__raycast_cached_date__${value.toISOString()}`;
  if (Buffer.isBuffer(value)) return `__raycast_cached_buffer__${value.toString("base64")}`;
  return _value;
}
function $e2e1ea6dd3b7d2e1$export$63698c10df99509c(_key, value) {
  if (typeof value === "string" && value.startsWith("__raycast_cached_date__")) return new Date(value.replace("__raycast_cached_date__", ""));
  if (typeof value === "string" && value.startsWith("__raycast_cached_buffer__")) return Buffer.from(value.replace("__raycast_cached_buffer__", ""), "base64");
  return value;
}
function $e2e1ea6dd3b7d2e1$export$d6af199866bfb566(object) {
  const hashingStream = (0, import_node_crypto.default).createHash("sha1");
  const hasher = (0, $93381684554307cb$export$fe386877a696ae78)(hashingStream);
  hasher.dispatch(object);
  return hashingStream.digest("hex");
}
var $c40d7eded38ca69c$var$rootCache = /* @__PURE__ */ Symbol("cache without namespace");
var $c40d7eded38ca69c$var$cacheMap = /* @__PURE__ */ new Map();
function $c40d7eded38ca69c$export$14afb9e4c16377d3(key, initialState, config) {
  const cacheKey = config?.cacheNamespace || $c40d7eded38ca69c$var$rootCache;
  const cache = $c40d7eded38ca69c$var$cacheMap.get(cacheKey) || $c40d7eded38ca69c$var$cacheMap.set(cacheKey, new (0, import_api2.Cache)({
    namespace: config?.cacheNamespace
  })).get(cacheKey);
  if (!cache) throw new Error("Missing cache");
  const keyRef = (0, $bfcf6ee368b3bd9f$export$d4b699e2c1148419)(key);
  const initialValueRef = (0, $bfcf6ee368b3bd9f$export$d4b699e2c1148419)(initialState);
  const cachedState = (0, import_react.useSyncExternalStore)(cache.subscribe, () => {
    try {
      return cache.get(keyRef.current);
    } catch (error) {
      console.error("Could not get Cache data:", error);
      return void 0;
    }
  });
  const state = (0, import_react.useMemo)(() => {
    if (typeof cachedState !== "undefined") {
      if (cachedState === "undefined") return void 0;
      try {
        return JSON.parse(cachedState, (0, $e2e1ea6dd3b7d2e1$export$63698c10df99509c));
      } catch (err) {
        console.warn("The cached data is corrupted", err);
        return initialValueRef.current;
      }
    } else return initialValueRef.current;
  }, [
    cachedState,
    initialValueRef
  ]);
  const stateRef = (0, $bfcf6ee368b3bd9f$export$d4b699e2c1148419)(state);
  const setStateAndCache = (0, import_react.useCallback)((updater) => {
    const newValue = typeof updater === "function" ? updater(stateRef.current) : updater;
    if (typeof newValue === "undefined") cache.set(keyRef.current, "undefined");
    else {
      const stringifiedValue = JSON.stringify(newValue, (0, $e2e1ea6dd3b7d2e1$export$b644b65666fe0c18));
      cache.set(keyRef.current, stringifiedValue);
    }
    return newValue;
  }, [
    cache,
    keyRef,
    stateRef
  ]);
  return [
    state,
    setStateAndCache
  ];
}
var $a7f3824c7be647eb$var$emptyCache = /* @__PURE__ */ Symbol();
function $a7f3824c7be647eb$export$b15740c74e256244(fn, args, options) {
  const { initialData, keepPreviousData, internal_cacheKeySuffix, ...usePromiseOptions } = options || {};
  const lastUpdateFrom = (0, import_react.useRef)(null);
  const [cachedData, mutateCache] = (0, $c40d7eded38ca69c$export$14afb9e4c16377d3)((0, $e2e1ea6dd3b7d2e1$export$d6af199866bfb566)(args || []) + internal_cacheKeySuffix, $a7f3824c7be647eb$var$emptyCache, {
    cacheNamespace: (0, $e2e1ea6dd3b7d2e1$export$d6af199866bfb566)(fn)
  });
  const laggyDataRef = (0, import_react.useRef)(cachedData !== $a7f3824c7be647eb$var$emptyCache ? cachedData : initialData);
  const paginationArgsRef = (0, import_react.useRef)(void 0);
  const { mutate: _mutate, revalidate, ...state } = (0, $cefc05764ce5eacd$export$dd6b79aaabe7bc37)(fn, args || [], {
    ...usePromiseOptions,
    onData(data, pagination2) {
      paginationArgsRef.current = pagination2;
      if (usePromiseOptions.onData) usePromiseOptions.onData(data, pagination2);
      if (pagination2 && pagination2.page > 0)
        return;
      lastUpdateFrom.current = "promise";
      laggyDataRef.current = data;
      mutateCache(data);
    }
  });
  let returnedData;
  const pagination = state.pagination;
  if (paginationArgsRef.current && paginationArgsRef.current.page > 0 && state.data) returnedData = state.data;
  else if (lastUpdateFrom.current === "promise") returnedData = laggyDataRef.current;
  else if (keepPreviousData && cachedData !== $a7f3824c7be647eb$var$emptyCache) {
    returnedData = cachedData;
    if (pagination) {
      pagination.hasMore = true;
      pagination.pageSize = cachedData.length;
    }
  } else if (keepPreviousData && cachedData === $a7f3824c7be647eb$var$emptyCache)
    returnedData = laggyDataRef.current;
  else if (cachedData !== $a7f3824c7be647eb$var$emptyCache) {
    returnedData = cachedData;
    if (pagination) {
      pagination.hasMore = true;
      pagination.pageSize = cachedData.length;
    }
  } else returnedData = initialData;
  const latestData = (0, $bfcf6ee368b3bd9f$export$d4b699e2c1148419)(returnedData);
  const mutate = (0, import_react.useCallback)(async (asyncUpdate, options2) => {
    let dataBeforeOptimisticUpdate;
    try {
      if (options2?.optimisticUpdate) {
        if (typeof options2?.rollbackOnError !== "function" && options2?.rollbackOnError !== false)
          dataBeforeOptimisticUpdate = structuredClone(latestData.current);
        const data = options2.optimisticUpdate(latestData.current);
        lastUpdateFrom.current = "cache";
        laggyDataRef.current = data;
        mutateCache(data);
      }
      return await _mutate(asyncUpdate, {
        shouldRevalidateAfter: options2?.shouldRevalidateAfter
      });
    } catch (err) {
      if (typeof options2?.rollbackOnError === "function") {
        const data = options2.rollbackOnError(latestData.current);
        lastUpdateFrom.current = "cache";
        laggyDataRef.current = data;
        mutateCache(data);
      } else if (options2?.optimisticUpdate && options2?.rollbackOnError !== false) {
        lastUpdateFrom.current = "cache";
        laggyDataRef.current = dataBeforeOptimisticUpdate;
        mutateCache(dataBeforeOptimisticUpdate);
      }
      throw err;
    }
  }, [
    mutateCache,
    _mutate,
    latestData,
    laggyDataRef,
    lastUpdateFrom
  ]);
  (0, import_react.useEffect)(() => {
    if (cachedData !== $a7f3824c7be647eb$var$emptyCache) {
      lastUpdateFrom.current = "cache";
      laggyDataRef.current = cachedData;
    }
  }, [
    cachedData
  ]);
  return {
    data: returnedData,
    isLoading: state.isLoading,
    error: state.error,
    mutate: paginationArgsRef.current && paginationArgsRef.current.page > 0 ? _mutate : mutate,
    pagination,
    revalidate
  };
}
var $e6272883088c6834$var$processOk = (process1) => !!process1 && typeof process1 === "object" && typeof process1.removeListener === "function" && typeof process1.emit === "function" && typeof process1.reallyExit === "function" && typeof process1.listeners === "function" && typeof process1.kill === "function" && typeof process1.pid === "number" && typeof process1.on === "function";
var $e6272883088c6834$var$kExitEmitter = /* @__PURE__ */ Symbol.for("signal-exit emitter");
var $e6272883088c6834$var$Emitter = class {
  constructor() {
    this.emitted = {
      afterExit: false,
      exit: false
    };
    this.listeners = {
      afterExit: [],
      exit: []
    };
    this.count = 0;
    this.id = Math.random();
    if ($parcel$global[$e6272883088c6834$var$kExitEmitter])
      return $parcel$global[$e6272883088c6834$var$kExitEmitter];
    Object.defineProperty($parcel$global, $e6272883088c6834$var$kExitEmitter, {
      value: this,
      writable: false,
      enumerable: false,
      configurable: false
    });
  }
  on(ev, fn) {
    this.listeners[ev].push(fn);
  }
  removeListener(ev, fn) {
    const list = this.listeners[ev];
    const i = list.indexOf(fn);
    if (i === -1) return;
    if (i === 0 && list.length === 1) list.length = 0;
    else list.splice(i, 1);
  }
  emit(ev, code, signal) {
    if (this.emitted[ev]) return false;
    this.emitted[ev] = true;
    let ret = false;
    for (const fn of this.listeners[ev]) ret = fn(code, signal) === true || ret;
    if (ev === "exit") ret = this.emit("afterExit", code, signal) || ret;
    return ret;
  }
};
var $e6272883088c6834$var$SignalExitFallback = class {
  onExit() {
    return () => {
    };
  }
  load() {
  }
  unload() {
  }
};
var $e6272883088c6834$var$SignalExit = class {
  // "SIGHUP" throws an `ENOSYS` error on Windows,
  // so use a supported signal instead
  /* c8 ignore start */
  // @ts-ignore
  #hupSig;
  /* c8 ignore stop */
  #emitter;
  #process;
  #originalProcessEmit;
  #originalProcessReallyExit;
  #sigListeners;
  #loaded;
  #signals;
  constructor(process1) {
    this.#hupSig = process.platform === "win32" ? "SIGINT" : "SIGHUP";
    this.#emitter = new $e6272883088c6834$var$Emitter();
    this.#sigListeners = {};
    this.#loaded = false;
    this.#signals = [];
    this.#signals.push("SIGHUP", "SIGINT", "SIGTERM");
    if (globalThis.process.platform !== "win32") this.#signals.push("SIGALRM", "SIGABRT", "SIGVTALRM", "SIGXCPU", "SIGXFSZ", "SIGUSR2", "SIGTRAP", "SIGSYS", "SIGQUIT", "SIGIOT");
    if (globalThis.process.platform === "linux") this.#signals.push("SIGIO", "SIGPOLL", "SIGPWR", "SIGSTKFLT");
    this.#process = process1;
    this.#sigListeners = {};
    for (const sig of this.#signals)
      this.#sigListeners[sig] = () => {
        const listeners = this.#process.listeners(sig);
        let { count } = this.#emitter;
        const p = process1;
        if (typeof p.__signal_exit_emitter__ === "object" && typeof p.__signal_exit_emitter__.count === "number") count += p.__signal_exit_emitter__.count;
        if (listeners.length === count) {
          this.unload();
          const ret = this.#emitter.emit("exit", null, sig);
          const s = sig === "SIGHUP" ? this.#hupSig : sig;
          if (!ret) process1.kill(process1.pid, s);
        }
      };
    this.#originalProcessReallyExit = process1.reallyExit;
    this.#originalProcessEmit = process1.emit;
  }
  onExit(cb, opts) {
    if (!$e6272883088c6834$var$processOk(this.#process)) return () => {
    };
    if (this.#loaded === false) this.load();
    const ev = opts?.alwaysLast ? "afterExit" : "exit";
    this.#emitter.on(ev, cb);
    return () => {
      this.#emitter.removeListener(ev, cb);
      if (this.#emitter.listeners["exit"].length === 0 && this.#emitter.listeners["afterExit"].length === 0) this.unload();
    };
  }
  load() {
    if (this.#loaded) return;
    this.#loaded = true;
    this.#emitter.count += 1;
    for (const sig of this.#signals) try {
      const fn = this.#sigListeners[sig];
      if (fn) this.#process.on(sig, fn);
    } catch (_) {
    }
    this.#process.emit = (ev, ...a) => {
      return this.#processEmit(ev, ...a);
    };
    this.#process.reallyExit = (code) => {
      return this.#processReallyExit(code);
    };
  }
  unload() {
    if (!this.#loaded) return;
    this.#loaded = false;
    this.#signals.forEach((sig) => {
      const listener = this.#sigListeners[sig];
      if (!listener) throw new Error("Listener not defined for signal: " + sig);
      try {
        this.#process.removeListener(sig, listener);
      } catch (_) {
      }
    });
    this.#process.emit = this.#originalProcessEmit;
    this.#process.reallyExit = this.#originalProcessReallyExit;
    this.#emitter.count -= 1;
  }
  #processReallyExit(code) {
    if (!$e6272883088c6834$var$processOk(this.#process)) return 0;
    this.#process.exitCode = code || 0;
    this.#emitter.emit("exit", this.#process.exitCode, null);
    return this.#originalProcessReallyExit.call(this.#process, this.#process.exitCode);
  }
  #processEmit(ev, ...args) {
    const og = this.#originalProcessEmit;
    if (ev === "exit" && $e6272883088c6834$var$processOk(this.#process)) {
      if (typeof args[0] === "number") this.#process.exitCode = args[0];
      const ret = og.call(this.#process, ev, ...args);
      this.#emitter.emit("exit", this.#process.exitCode, null);
      return ret;
    } else return og.call(this.#process, ev, ...args);
  }
};
var $e6272883088c6834$var$signalExit = null;
var $e6272883088c6834$export$47a57ed64c292d4f = (cb, opts) => {
  if (!$e6272883088c6834$var$signalExit) $e6272883088c6834$var$signalExit = $e6272883088c6834$var$processOk(process) ? new $e6272883088c6834$var$SignalExit(process) : new $e6272883088c6834$var$SignalExitFallback();
  return $e6272883088c6834$var$signalExit.onExit(cb, opts);
};
function $c86e3701e284ece4$export$6e3a9b5342d42997(spawned, { timeout } = {}) {
  const spawnedPromise = new Promise((resolve, reject) => {
    spawned.on("exit", (exitCode, signal) => {
      resolve({
        exitCode,
        signal,
        timedOut: false
      });
    });
    spawned.on("error", (error) => {
      reject(error);
    });
    if (spawned.stdin) spawned.stdin.on("error", (error) => {
      reject(error);
    });
  });
  const removeExitHandler = (0, $e6272883088c6834$export$47a57ed64c292d4f)(() => {
    spawned.kill();
  });
  if (timeout === 0 || timeout === void 0) return spawnedPromise.finally(() => removeExitHandler());
  let timeoutId;
  const timeoutPromise = new Promise((_resolve, reject) => {
    timeoutId = setTimeout(() => {
      spawned.kill("SIGTERM");
      reject(Object.assign(new Error("Timed out"), {
        timedOut: true,
        signal: "SIGTERM"
      }));
    }, timeout);
  });
  const safeSpawnedPromise = spawnedPromise.finally(() => {
    clearTimeout(timeoutId);
  });
  return Promise.race([
    timeoutPromise,
    safeSpawnedPromise
  ]).finally(() => removeExitHandler());
}
var $c86e3701e284ece4$var$MaxBufferError = class extends Error {
  constructor() {
    super("The output is too big");
    this.name = "MaxBufferError";
  }
};
function $c86e3701e284ece4$var$bufferStream(options) {
  const { encoding } = options;
  const isBuffer = encoding === "buffer";
  const stream = new (0, import_node_stream.default).PassThrough({
    objectMode: false
  });
  if (encoding && encoding !== "buffer") stream.setEncoding(encoding);
  let length = 0;
  const chunks = [];
  stream.on("data", (chunk) => {
    chunks.push(chunk);
    length += chunk.length;
  });
  stream.getBufferedValue = () => {
    return isBuffer ? Buffer.concat(chunks, length) : chunks.join("");
  };
  stream.getBufferedLength = () => length;
  return stream;
}
async function $c86e3701e284ece4$var$getStream(inputStream, options) {
  const stream = $c86e3701e284ece4$var$bufferStream(options);
  await new Promise((resolve, reject) => {
    const rejectPromise = (error) => {
      if (error && stream.getBufferedLength() <= (0, import_node_buffer.constants).MAX_LENGTH) error.bufferedData = stream.getBufferedValue();
      reject(error);
    };
    (async () => {
      try {
        await (0, import_node_util.promisify)((0, import_node_stream.default).pipeline)(inputStream, stream);
        resolve();
      } catch (error) {
        rejectPromise(error);
      }
    })();
    stream.on("data", () => {
      if (stream.getBufferedLength() > 8e7) rejectPromise(new $c86e3701e284ece4$var$MaxBufferError());
    });
  });
  return stream.getBufferedValue();
}
async function $c86e3701e284ece4$var$getBufferedData(stream, streamPromise) {
  stream.destroy();
  try {
    return await streamPromise;
  } catch (error) {
    return error.bufferedData;
  }
}
async function $c86e3701e284ece4$export$67b768ac9e1c70fa({ stdout, stderr }, { encoding }, processDone) {
  const stdoutPromise = $c86e3701e284ece4$var$getStream(stdout, {
    encoding
  });
  const stderrPromise = $c86e3701e284ece4$var$getStream(stderr, {
    encoding
  });
  try {
    return await Promise.all([
      processDone,
      stdoutPromise,
      stderrPromise
    ]);
  } catch (error) {
    return Promise.all([
      {
        error,
        exitCode: null,
        signal: error.signal,
        timedOut: error.timedOut || false
      },
      $c86e3701e284ece4$var$getBufferedData(stdout, stdoutPromise),
      $c86e3701e284ece4$var$getBufferedData(stderr, stderrPromise)
    ]);
  }
}
function $c86e3701e284ece4$var$stripFinalNewline(input) {
  const LF = typeof input === "string" ? "\n" : "\n".charCodeAt(0);
  const CR = typeof input === "string" ? "\r" : "\r".charCodeAt(0);
  if (input[input.length - 1] === LF)
    input = input.slice(0, -1);
  if (input[input.length - 1] === CR)
    input = input.slice(0, -1);
  return input;
}
function $c86e3701e284ece4$export$200978bbc0b73ca(options, value) {
  if (options.stripFinalNewline) return $c86e3701e284ece4$var$stripFinalNewline(value);
  return value;
}
function $c86e3701e284ece4$var$getErrorPrefix({ timedOut, timeout, signal, exitCode }) {
  if (timedOut) return `timed out after ${timeout} milliseconds`;
  if (signal !== void 0 && signal !== null) return `was killed with ${signal}`;
  if (exitCode !== void 0 && exitCode !== null) return `failed with exit code ${exitCode}`;
  return "failed";
}
function $c86e3701e284ece4$var$makeError({ stdout, stderr, error, signal, exitCode, command, timedOut, options, parentError }) {
  const prefix = $c86e3701e284ece4$var$getErrorPrefix({
    timedOut,
    timeout: options?.timeout,
    signal,
    exitCode
  });
  const execaMessage = `Command ${prefix}: ${command}`;
  const shortMessage = error ? `${execaMessage}
${error.message}` : execaMessage;
  const message = [
    shortMessage,
    stderr,
    stdout
  ].filter(Boolean).join("\n");
  if (error)
    error.originalMessage = error.message;
  else error = parentError;
  error.message = message;
  error.shortMessage = shortMessage;
  error.command = command;
  error.exitCode = exitCode;
  error.signal = signal;
  error.stdout = stdout;
  error.stderr = stderr;
  if ("bufferedData" in error) delete error["bufferedData"];
  return error;
}
function $c86e3701e284ece4$export$a8f5efe603803b77({ stdout, stderr, error, exitCode, signal, timedOut, command, options, parentError }) {
  if (error || exitCode !== 0 || signal !== null) {
    const returnedError = $c86e3701e284ece4$var$makeError({
      error,
      exitCode,
      signal,
      stdout,
      stderr,
      command,
      timedOut,
      options,
      parentError
    });
    throw returnedError;
  }
  return stdout;
}
var $da578bce0e88fb2a$export$cb7dc23b705f5c86 = class extends Error {
  constructor(message) {
    super(message);
    this.name = "PermissionError";
  }
};
function $da578bce0e88fb2a$export$e11674744930cd15(error) {
  return error instanceof Error && error.name === "PermissionError";
}
async function $da578bce0e88fb2a$export$4cff4f142f384da7(databasePath, query, options) {
  if (!(0, import_node_fs.existsSync)(databasePath)) throw new Error("The database does not exist");
  let sqlite3;
  try {
    const dynamicImport = (module2) => import(module2);
    sqlite3 = await dynamicImport("node:sqlite");
  } catch (error) {
    return $da578bce0e88fb2a$var$sqliteFallback(databasePath, query, options);
  }
  let db = new sqlite3.DatabaseSync(databasePath, {
    open: false,
    readOnly: true
  });
  const abortSignal = options?.signal;
  try {
    db.open();
  } catch (error) {
    console.log(error);
    if (error.message.match("(5)") || error.message.match("(14)")) {
      let workaroundCopiedDb;
      if (!workaroundCopiedDb) {
        const tempFolder = (0, import_node_path.default).join((0, import_node_os.default).tmpdir(), "useSQL", (0, $e2e1ea6dd3b7d2e1$export$d6af199866bfb566)(databasePath));
        await (0, import_promises.mkdir)(tempFolder, {
          recursive: true
        });
        $da578bce0e88fb2a$var$checkAborted(abortSignal);
        workaroundCopiedDb = (0, import_node_path.default).join(tempFolder, "db.db");
        await (0, import_promises.copyFile)(databasePath, workaroundCopiedDb);
        await (0, import_promises.writeFile)(workaroundCopiedDb + "-shm", "");
        await (0, import_promises.writeFile)(workaroundCopiedDb + "-wal", "");
        $da578bce0e88fb2a$var$checkAborted(abortSignal);
      }
      db = new sqlite3.DatabaseSync(workaroundCopiedDb, {
        open: false,
        readOnly: true
      });
      db.open();
      $da578bce0e88fb2a$var$checkAborted(abortSignal);
    }
  }
  const statement = db.prepare(query);
  $da578bce0e88fb2a$var$checkAborted(abortSignal);
  const result = statement.all();
  db.close();
  return result;
}
async function $da578bce0e88fb2a$var$sqliteFallback(databasePath, query, options) {
  const abortSignal = options?.signal;
  let spawned = (0, import_node_child_process.default).spawn("sqlite3", [
    "--json",
    "--readonly",
    databasePath,
    query
  ], {
    signal: abortSignal
  });
  let spawnedPromise = (0, $c86e3701e284ece4$export$6e3a9b5342d42997)(spawned);
  let [{ error, exitCode, signal }, stdoutResult, stderrResult] = await (0, $c86e3701e284ece4$export$67b768ac9e1c70fa)(spawned, {
    encoding: "utf-8"
  }, spawnedPromise);
  $da578bce0e88fb2a$var$checkAborted(abortSignal);
  if (stderrResult.match("(5)") || stderrResult.match("(14)")) {
    let workaroundCopiedDb;
    if (!workaroundCopiedDb) {
      const tempFolder = (0, import_node_path.default).join((0, import_node_os.default).tmpdir(), "useSQL", (0, $e2e1ea6dd3b7d2e1$export$d6af199866bfb566)(databasePath));
      await (0, import_promises.mkdir)(tempFolder, {
        recursive: true
      });
      $da578bce0e88fb2a$var$checkAborted(abortSignal);
      workaroundCopiedDb = (0, import_node_path.default).join(tempFolder, "db.db");
      await (0, import_promises.copyFile)(databasePath, workaroundCopiedDb);
      await (0, import_promises.writeFile)(workaroundCopiedDb + "-shm", "");
      await (0, import_promises.writeFile)(workaroundCopiedDb + "-wal", "");
      $da578bce0e88fb2a$var$checkAborted(abortSignal);
    }
    spawned = (0, import_node_child_process.default).spawn("sqlite3", [
      "--json",
      "--readonly",
      "--vfs",
      "unix-none",
      workaroundCopiedDb,
      query
    ], {
      signal: abortSignal
    });
    spawnedPromise = (0, $c86e3701e284ece4$export$6e3a9b5342d42997)(spawned);
    [{ error, exitCode, signal }, stdoutResult, stderrResult] = await (0, $c86e3701e284ece4$export$67b768ac9e1c70fa)(spawned, {
      encoding: "utf-8"
    }, spawnedPromise);
    $da578bce0e88fb2a$var$checkAborted(abortSignal);
  }
  if (error || exitCode !== 0 || signal !== null) {
    if (stderrResult.includes("authorization denied")) throw new $da578bce0e88fb2a$export$cb7dc23b705f5c86("You do not have permission to access the database.");
    else throw new Error(stderrResult || "Unknown error");
  }
  return JSON.parse(stdoutResult.trim() || "[]");
}
function $da578bce0e88fb2a$var$checkAborted(signal) {
  if (signal?.aborted) {
    const error = new Error("aborted");
    error.name = "AbortError";
    throw error;
  }
}
function $e88ea8aee5e4e2a5$export$d74ef0af94fb1db6(databasePath, query, options) {
  const { permissionPriming, ...usePromiseOptions } = options || {};
  const [permissionView, setPermissionView] = (0, import_react.useState)(null);
  const latestOptions = (0, $bfcf6ee368b3bd9f$export$d4b699e2c1148419)(options || {});
  const abortable = (0, import_react.useRef)(null);
  const handleError = (0, import_react.useCallback)((_error) => {
    console.error(_error);
    const error = _error instanceof Error && _error.message.includes("authorization denied") ? new (0, $da578bce0e88fb2a$export$cb7dc23b705f5c86)("You do not have permission to access the database.") : _error;
    if ((0, $da578bce0e88fb2a$export$e11674744930cd15)(error)) setPermissionView(/* @__PURE__ */ (0, import_jsx_runtime.jsx)($e88ea8aee5e4e2a5$var$PermissionErrorScreen, {
      priming: latestOptions.current.permissionPriming
    }));
    else {
      if (latestOptions.current.onError) latestOptions.current.onError(error);
      else if ((0, import_api2.environment).launchType !== (0, import_api2.LaunchType).Background) (0, $c718fd03aba6111c$export$80e5033e369189f3)(error, {
        title: "Cannot query the data"
      });
    }
  }, [
    latestOptions
  ]);
  const fn = (0, import_react.useMemo)(() => {
    if (!(0, import_node_fs.existsSync)(databasePath)) throw new Error("The database does not exist");
    return async (databasePath2, query2) => {
      const abortSignal = abortable.current?.signal;
      return (0, $da578bce0e88fb2a$export$4cff4f142f384da7)(databasePath2, query2, {
        signal: abortSignal
      });
    };
  }, [
    databasePath
  ]);
  return {
    ...(0, $cefc05764ce5eacd$export$dd6b79aaabe7bc37)(fn, [
      databasePath,
      query
    ], {
      ...usePromiseOptions,
      onError: handleError
    }),
    permissionView
  };
}
function $e88ea8aee5e4e2a5$var$PermissionErrorScreen(props) {
  const macosVenturaAndLater = parseInt((0, import_node_os.default).release().split(".")[0]) >= 22;
  const preferencesString = macosVenturaAndLater ? "Settings" : "Preferences";
  const action = macosVenturaAndLater ? {
    title: "Open System Settings -> Privacy",
    target: "x-apple.systempreferences:com.apple.preference.security?Privacy_AllFiles"
  } : {
    title: "Open System Preferences -> Security",
    target: "x-apple.systempreferences:com.apple.preference.security?Privacy_AllFiles"
  };
  if ((0, import_api2.environment).commandMode === "menu-bar") return /* @__PURE__ */ (0, import_jsx_runtime.jsxs)((0, import_api2.MenuBarExtra), {
    icon: (0, import_api2.Icon).Warning,
    title: (0, import_api2.environment).commandName,
    children: [
      /* @__PURE__ */ (0, import_jsx_runtime.jsx)((0, import_api2.MenuBarExtra).Item, {
        title: "Raycast needs full disk access",
        tooltip: `You can revert this access in ${preferencesString} whenever you want`
      }),
      props.priming ? /* @__PURE__ */ (0, import_jsx_runtime.jsx)((0, import_api2.MenuBarExtra).Item, {
        title: props.priming,
        tooltip: `You can revert this access in ${preferencesString} whenever you want`
      }) : null,
      /* @__PURE__ */ (0, import_jsx_runtime.jsx)((0, import_api2.MenuBarExtra).Separator, {}),
      /* @__PURE__ */ (0, import_jsx_runtime.jsx)((0, import_api2.MenuBarExtra).Item, {
        title: action.title,
        onAction: () => (0, import_api2.open)(action.target)
      })
    ]
  });
  return /* @__PURE__ */ (0, import_jsx_runtime.jsx)((0, import_api2.List), {
    children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)((0, import_api2.List).EmptyView, {
      icon: {
        source: {
          light: "https://raycast.com/uploads/extensions-utils-security-permissions-light.png",
          dark: "https://raycast.com/uploads/extensions-utils-security-permissions-dark.png"
        }
      },
      title: "Raycast needs full disk access.",
      description: `${props.priming ? props.priming + "\n" : ""}You can revert this access in ${preferencesString} whenever you want.`,
      actions: /* @__PURE__ */ (0, import_jsx_runtime.jsx)((0, import_api2.ActionPanel), {
        children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)((0, import_api2.Action).Open, {
          ...action
        })
      })
    })
  });
}
function $d64c8f690cf3b07a$export$30c2a0095db95d06(url, options) {
  try {
    const sanitize = (url2) => {
      if (!url2.startsWith("http")) return `https://${url2}`;
      return url2;
    };
    const urlObj = typeof url === "string" ? new (0, import_node_url.URL)(sanitize(url)) : url;
    const hostname = urlObj.hostname;
    const faviconProvider = process.env.FAVICON_PROVIDER ?? "raycast";
    switch (faviconProvider) {
      case "none":
        return {
          source: options?.fallback ?? (0, import_api2.Icon).Link,
          mask: options?.mask
        };
      case "apple":
        return {
          source: options?.fallback ?? (0, import_api2.Icon).Link,
          mask: options?.mask
        };
      case "duckduckgo":
      case "duckDuckGo":
        return {
          source: `https://icons.duckduckgo.com/ip3/${hostname}.ico`,
          fallback: options?.fallback ?? (0, import_api2.Icon).Link,
          mask: options?.mask
        };
      case "google":
        return {
          source: `https://www.google.com/s2/favicons?sz=${options?.size ?? 64}&domain=${hostname}`,
          fallback: options?.fallback ?? (0, import_api2.Icon).Link,
          mask: options?.mask
        };
      case "legacy":
      case "raycast":
      default:
        return {
          source: `https://api.ray.so/favicon?url=${hostname}&size=${options?.size ?? 64}`,
          fallback: options?.fallback ?? (0, import_api2.Icon).Link,
          mask: options?.mask
        };
    }
  } catch (e) {
    console.error(e);
    return (0, import_api2.Icon).Link;
  }
}
async function $179449bbef1d262b$export$8982d27dc997624f(script, optionsOrArgs, options) {
  if (process.platform !== "darwin") throw new Error("AppleScript is only supported on macOS");
  const { humanReadableOutput, language, timeout, ...execOptions } = Array.isArray(optionsOrArgs) ? options || {} : optionsOrArgs || {};
  const outputArguments = humanReadableOutput !== false ? [] : [
    "-ss"
  ];
  if (language === "JavaScript") outputArguments.push("-l", "JavaScript");
  if (Array.isArray(optionsOrArgs)) outputArguments.push("-", ...optionsOrArgs);
  const spawned = (0, import_node_child_process.default).spawn("osascript", outputArguments, {
    ...execOptions,
    env: {
      PATH: "/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin"
    }
  });
  const spawnedPromise = (0, $c86e3701e284ece4$export$6e3a9b5342d42997)(spawned, {
    timeout: timeout ?? 1e4
  });
  spawned.stdin.end(script);
  const [{ error, exitCode, signal, timedOut }, stdoutResult, stderrResult] = await (0, $c86e3701e284ece4$export$67b768ac9e1c70fa)(spawned, {
    encoding: "utf8"
  }, spawnedPromise);
  const stdout = (0, $c86e3701e284ece4$export$200978bbc0b73ca)({
    stripFinalNewline: true
  }, stdoutResult);
  const stderr = (0, $c86e3701e284ece4$export$200978bbc0b73ca)({
    stripFinalNewline: true
  }, stderrResult);
  return (0, $c86e3701e284ece4$export$a8f5efe603803b77)({
    stdout,
    stderr,
    error,
    exitCode,
    signal,
    timedOut,
    command: "osascript",
    options,
    parentError: new Error()
  });
}

// src/hooks/useHistorySearch.tsx
var whereClauses = (tableTitle, terms) => {
  return terms.map((t) => `(${tableTitle}.title LIKE '%${t}%' OR ${tableTitle}.url LIKE '%${t}%')`).join(" AND ");
};
var getHistoryQuery = (table, date_field, terms) => `SELECT id,
            url,
             title,
             datetime(${date_field} / 1000000 + (strftime('%s', '1601-01-01')), 'unixepoch', 'localtime') as lastVisited
      FROM ${table}
      WHERE ${whereClauses(table, terms)}
      ORDER BY ${date_field} DESC LIMIT 100;`;
function useHistorySearch(profiles, query) {
  const [profileHistories, setProfileHistories] = (0, import_react2.useState)({});
  const [currentProfileIndex, setCurrentProfileIndex] = (0, import_react2.useState)(0);
  const [dbPath, setDbPath] = (0, import_react2.useState)(getHistoryDbPath(profiles[0].id));
  const terms = query ? query.trim().split(" ") : [""];
  const historyQuery = getHistoryQuery("urls", "last_visit_time", terms);
  const { data, isLoading, permissionView, revalidate } = $e88ea8aee5e4e2a5$export$d74ef0af94fb1db6(dbPath, historyQuery);
  (0, import_react2.useEffect)(() => {
    if (data != void 0 && !isLoading) {
      const newHistories = { ...profileHistories };
      newHistories[profiles[currentProfileIndex].id] = {
        data,
        isLoading,
        errorView: permissionView,
        revalidate,
        profile: profiles[currentProfileIndex]
      };
      setProfileHistories(newHistories);
      if (currentProfileIndex < profiles.length - 1 && (0, import_fs.existsSync)(getHistoryDbPath(profiles[currentProfileIndex + 1].id))) {
        setDbPath(getHistoryDbPath(profiles[currentProfileIndex + 1].id));
        setCurrentProfileIndex(currentProfileIndex + 1);
      }
    }
  }, [data, dbPath, isLoading]);
  (0, import_react2.useEffect)(() => {
    revalidate();
  }, [currentProfileIndex]);
  return Object.values(profileHistories);
}

// src/components/error/NotInstalledError.tsx
var import_react3 = require("react");
var import_api3 = require("@raycast/api");
var import_child_process = require("child_process");
var import_os = require("os");
var import_jsx_runtime2 = require("react/jsx-runtime");
var brewPrefix = (() => {
  try {
    return (0, import_child_process.execSync)("brew --prefix", { encoding: "utf8" }).trim();
  } catch {
    return (0, import_os.cpus)()[0].model.includes("Apple") ? "/opt/homebrew" : "/usr/local";
  }
})();

// src/components/error/UnknownError.tsx
var import_api4 = require("@raycast/api");
var import_jsx_runtime3 = require("react/jsx-runtime");

// src/components/BraveActions.tsx
var import_api6 = require("@raycast/api");

// src/actions/index.tsx
var import_api5 = require("@raycast/api");
var import_child_process2 = require("child_process");
async function openAllBookmarksInFolder({
  urls,
  profileCurrent,
  openTabInProfile
}) {
  try {
    const { browserOption: browserOption2 } = (0, import_api5.getPreferenceValues)();
    const buildArgs = (profile) => {
      const args2 = [];
      if (profile) {
        args2.push(`--profile-directory=${profile}`);
      }
      return args2;
    };
    let args = [];
    switch (openTabInProfile) {
      case "default" /* Default */:
        args = buildArgs();
        break;
      case "profile_current" /* ProfileCurrent */:
        args = buildArgs(profileCurrent);
        break;
      case "profile_original" /* ProfileOriginal */:
        args = buildArgs(profileCurrent);
        break;
    }
    const urlsString = urls.map((url) => `"${url}"`).join(" ");
    const argsString = args.map((arg) => `"${arg}"`).join(" ");
    const command = `open -na "${browserOption2}" --args ${argsString} ${urlsString}`;
    await new Promise((resolve, reject) => {
      (0, import_child_process2.exec)(command, (error) => {
        if (error) {
          reject(error);
        } else {
          (0, import_api5.closeMainWindow)({ clearRootSearch: true });
          resolve(true);
        }
      });
    });
  } catch (e) {
    console.error(e);
    await $c718fd03aba6111c$export$80e5033e369189f3("Could not open all bookmarks", {
      message: e instanceof Error ? e.message : String(e)
    });
  }
}
async function openNewTab({
  url,
  query,
  profileCurrent,
  profileOriginal,
  openTabInProfile,
  newWindow,
  incognito
}) {
  setTimeout(() => {
    (0, import_api5.popToRoot)({ clearSearchBar: true });
  }, 3e3);
  const installed = await checkAppInstalled();
  if (installed) {
    (0, import_api5.closeMainWindow)({ clearRootSearch: true });
  }
  const { browserOption: browserOption2 } = (0, import_api5.getPreferenceValues)();
  const targetUrl = url ? url : query ? `https://www.google.com/search?q=${encodeURIComponent(query)}` : "";
  const runShellCommand = (command2) => {
    return new Promise((resolve, reject) => {
      (0, import_child_process2.exec)(command2, (error) => {
        if (error) {
          reject(error);
        } else {
          resolve(true);
        }
      });
    });
  };
  const buildArgs = (profile) => {
    const args2 = [];
    if (profile) {
      args2.push(`--profile-directory=${profile}`);
    }
    if (newWindow) {
      args2.push("--new-window");
    }
    if (incognito) {
      args2.push("--incognito");
    }
    if (targetUrl) {
      args2.push(targetUrl);
    }
    return args2;
  };
  let args = [];
  switch (openTabInProfile) {
    case "default" /* Default */:
      args = buildArgs();
      break;
    case "profile_current" /* ProfileCurrent */:
      args = buildArgs(profileCurrent);
      break;
    case "profile_original" /* ProfileOriginal */:
      args = buildArgs(profileOriginal);
      break;
  }
  const argsString = args.map((arg) => `"${arg}"`).join(" ");
  const command = `open -na "${browserOption2}" --args ${argsString}`;
  return runShellCommand(command);
}
async function closeTab(tabIndex) {
  const { browserOption: browserOption2 } = (0, import_api5.getPreferenceValues)();
  await $179449bbef1d262b$export$8982d27dc997624f(`tell application "${browserOption2}}"
    tell window 1
      delete tab ${tabIndex}
    end tell
  end tell`);
}
async function setActiveTab(tab) {
  const { browserOption: browserOption2 } = (0, import_api5.getPreferenceValues)();
  await $179449bbef1d262b$export$8982d27dc997624f(`
    tell application "${browserOption2}"
      activate
      set index of window (${tab.windowsIndex} as number) to (${tab.windowsIndex} as number)
      set active tab index of window (${tab.windowsIndex} as number) to (${tab.tabIndex} as number)
    end tell
    return true
  `);
}
var checkAppInstalled = async () => {
  const { browserOption: browserOption2 } = (0, import_api5.getPreferenceValues)();
  const appInstalled = await $179449bbef1d262b$export$8982d27dc997624f(`
set isInstalled to false
try
    do shell script "osascript -e 'exists application \\"${browserOption2}\\"'"
    set isInstalled to true
end try

return isInstalled`);
  if (appInstalled === "false") {
    throw new Error(NOT_INSTALLED_MESSAGE);
  }
  return true;
};
async function executeJavascript(code) {
  const { browserOption: browserOption2 } = (0, import_api5.getPreferenceValues)();
  try {
    const decodedCode = decodeURIComponent(code);
    const escapedCode = decodedCode.replace(/\\/g, "\\\\").replace(/"/g, '\\"').replace(/\r/g, "\\r").replace(/\n/g, "\\n").replace(/\t/g, "\\t").replace(/[\b]/g, "\\b").replace(/\f/g, "\\f");
    const script = `
      tell application "${browserOption2}"
        activate
        tell active tab of front window
          execute javascript "${escapedCode}"
        end tell
      end tell
    `;
    await $179449bbef1d262b$export$8982d27dc997624f(script);
    await (0, import_api5.closeMainWindow)();
  } catch (e) {
    console.error(e);
    if (e instanceof Error && e.message.includes("Allow JavaScript from Apple Events")) {
      await $c718fd03aba6111c$export$80e5033e369189f3("Enable 'View > Developer > Allow JavaScript from Apple Events' in Brave.");
    } else {
      await $c718fd03aba6111c$export$80e5033e369189f3("Could not run bookmarklet", {
        message: e instanceof Error ? e.message : String(e)
      });
    }
  }
}

// src/components/BraveActions.tsx
var import_jsx_runtime4 = require("react/jsx-runtime");
var BraveActions = class {
  static NewTab = NewTabActions;
  static TabList = TabListItemActions;
  static TabHistory = HistoryItemActions;
  static OpenAllBookmarksInFolder = OpenAllBookmarksInFolderAction;
};
function OpenAllBookmarksInFolderAction(props) {
  const { openTabInProfile } = (0, import_api6.getPreferenceValues)();
  const [profileCurrent] = $c40d7eded38ca69c$export$14afb9e4c16377d3(BRAVE_PROFILE_KEY, DEFAULT_BRAVE_PROFILE_ID);
  return /* @__PURE__ */ (0, import_jsx_runtime4.jsx)(import_api6.ActionPanel, { title: "Open All Bookmarks In Folder", children: /* @__PURE__ */ (0, import_jsx_runtime4.jsx)(
    import_api6.Action,
    {
      title: "Open All Bookmarks in Folder",
      onAction: () => openAllBookmarksInFolder({
        urls: props.urls,
        profileCurrent,
        openTabInProfile
      })
    }
  ) });
}
function NewTabActions({ query, incognito }) {
  const { openTabInProfile } = (0, import_api6.getPreferenceValues)();
  const [profileCurrent] = $c40d7eded38ca69c$export$14afb9e4c16377d3(BRAVE_PROFILE_KEY, DEFAULT_BRAVE_PROFILE_ID);
  return /* @__PURE__ */ (0, import_jsx_runtime4.jsx)(import_api6.ActionPanel, { title: "New Tab", children: /* @__PURE__ */ (0, import_jsx_runtime4.jsx)(
    import_api6.Action,
    {
      onAction: () => openNewTab({ query, profileCurrent, openTabInProfile, incognito }),
      title: query ? `Search "${query}"` : "Open New Tab",
      icon: import_api6.Icon.Globe
    }
  ) });
}
function TabListItemActions({ tab }) {
  const { openTabInProfile } = (0, import_api6.getPreferenceValues)();
  const [profileCurrent] = $c40d7eded38ca69c$export$14afb9e4c16377d3(BRAVE_PROFILE_KEY, DEFAULT_BRAVE_PROFILE_ID);
  return /* @__PURE__ */ (0, import_jsx_runtime4.jsxs)(import_api6.ActionPanel, { title: tab.title, children: [
    /* @__PURE__ */ (0, import_jsx_runtime4.jsx)(GoToTab, { tab }),
    /* @__PURE__ */ (0, import_jsx_runtime4.jsx)(
      import_api6.Action,
      {
        title: "Move to New Window",
        icon: import_api6.Icon.Window,
        onAction: async () => {
          await closeTab(tab.tabIndex);
          await openNewTab({ url: tab.url, profileCurrent, openTabInProfile, newWindow: true });
        }
      }
    ),
    /* @__PURE__ */ (0, import_jsx_runtime4.jsx)(
      import_api6.Action,
      {
        title: "Move to Incognito Window",
        icon: import_api6.Icon.EyeDisabled,
        onAction: async () => {
          await closeTab(tab.tabIndex);
          await openNewTab({ url: tab.url, profileCurrent, openTabInProfile, incognito: true });
        }
      }
    ),
    /* @__PURE__ */ (0, import_jsx_runtime4.jsx)(import_api6.Action.CopyToClipboard, { title: "Copy URL", content: tab.url })
  ] });
}
function HistoryItemActions({
  title,
  url,
  profile: profileOriginal
}) {
  const { openTabInProfile } = (0, import_api6.getPreferenceValues)();
  const [profileCurrent] = $c40d7eded38ca69c$export$14afb9e4c16377d3(BRAVE_PROFILE_KEY, DEFAULT_BRAVE_PROFILE_ID);
  if (url.startsWith("javascript:")) {
    const code = url.substring("javascript:".length);
    return /* @__PURE__ */ (0, import_jsx_runtime4.jsxs)(import_api6.ActionPanel, { title, children: [
      /* @__PURE__ */ (0, import_jsx_runtime4.jsx)(import_api6.Action, { onAction: () => executeJavascript(code), icon: import_api6.Icon.Play, title: "Run Bookmarklet" }),
      /* @__PURE__ */ (0, import_jsx_runtime4.jsx)(import_api6.Action.CopyToClipboard, { title: "Copy Code", content: code, shortcut: { modifiers: ["cmd"], key: "c" } })
    ] });
  }
  return /* @__PURE__ */ (0, import_jsx_runtime4.jsxs)(import_api6.ActionPanel, { title, children: [
    /* @__PURE__ */ (0, import_jsx_runtime4.jsx)(
      import_api6.Action,
      {
        onAction: async () => await openNewTab({ url, profileOriginal, profileCurrent, openTabInProfile }),
        icon: import_api6.Icon.Eye,
        title: "Open"
      }
    ),
    /* @__PURE__ */ (0, import_jsx_runtime4.jsx)(
      import_api6.Action,
      {
        title: "Open in New Window",
        icon: import_api6.Icon.Window,
        onAction: async () => await openNewTab({ url, profileOriginal, profileCurrent, openTabInProfile, newWindow: true })
      }
    ),
    /* @__PURE__ */ (0, import_jsx_runtime4.jsx)(
      import_api6.Action,
      {
        title: "Open in Incognito Window",
        icon: import_api6.Icon.EyeDisabled,
        onAction: async () => await openNewTab({ url, profileOriginal, profileCurrent, openTabInProfile, incognito: true })
      }
    ),
    /* @__PURE__ */ (0, import_jsx_runtime4.jsxs)(import_api6.ActionPanel.Section, { title: "Open in profile", children: [
      /* @__PURE__ */ (0, import_jsx_runtime4.jsx)(
        import_api6.Action,
        {
          onAction: () => openNewTab({
            url,
            profileOriginal,
            profileCurrent,
            openTabInProfile: "profile_current" /* ProfileCurrent */
          }),
          title: "Open in Current Profile"
        }
      ),
      /* @__PURE__ */ (0, import_jsx_runtime4.jsx)(
        import_api6.Action,
        {
          onAction: () => openNewTab({
            url,
            profileOriginal,
            profileCurrent,
            openTabInProfile: "profile_original" /* ProfileOriginal */
          }),
          title: "Open in Original Profile"
        }
      )
    ] }),
    /* @__PURE__ */ (0, import_jsx_runtime4.jsx)(import_api6.Action.CopyToClipboard, { title: "Copy URL", content: url, shortcut: { modifiers: ["cmd"], key: "c" } })
  ] });
}
function GoToTab(props) {
  async function handleAction() {
    try {
      await setActiveTab(props.tab);
      await (0, import_api6.closeMainWindow)();
    } catch {
      await $c718fd03aba6111c$export$80e5033e369189f3("Tab no longer exists", {
        message: "The tab may have been closed. Try searching again."
      });
    }
  }
  return /* @__PURE__ */ (0, import_jsx_runtime4.jsx)(import_api6.ActionPanel.Item, { title: "Open Tab", icon: { source: import_api6.Icon.Eye }, onAction: handleAction });
}

// src/components/BraveListItems.tsx
var import_api7 = require("@raycast/api");
var import_jsx_runtime5 = require("react/jsx-runtime");
var BraveListItems = class {
  static TabList = TabListItem;
  static TabHistory = HistoryItem;
  static BookmarkFolder = BookmarkFolderItem;
};
function isValidHttpUrl(url) {
  try {
    const parsed = new URL(url);
    return parsed.protocol === "http:" || parsed.protocol === "https:";
  } catch {
    return false;
  }
}
function getUrlKeywords(url) {
  try {
    const parsed = new URL(url);
    const hostParts = parsed.hostname.replace("www.", "").split(".");
    const pathParts = parsed.pathname.split("/").filter((p) => p.length > 0);
    return [...hostParts, ...pathParts, parsed.hostname, url];
  } catch {
    return [url];
  }
}
function BookmarkFolderItem({
  profile,
  entry: { name, children, id }
}) {
  const urls = children.filter((c) => c.type === "url").map((c) => c.url);
  return /* @__PURE__ */ (0, import_jsx_runtime5.jsx)(
    import_api7.List.Item,
    {
      id: `${profile}-${id}`,
      title: name,
      subtitle: `${urls.length} bookmarks`,
      icon: import_api7.Icon.Folder,
      actions: /* @__PURE__ */ (0, import_jsx_runtime5.jsx)(BraveActions.OpenAllBookmarksInFolder, { urls, profile })
    }
  );
}
function HistoryItem({ profile, entry: { url, title, id } }) {
  return /* @__PURE__ */ (0, import_jsx_runtime5.jsx)(
    import_api7.List.Item,
    {
      id: `${profile}-${id}`,
      title,
      subtitle: url,
      keywords: getUrlKeywords(url),
      icon: isValidHttpUrl(url) ? $d64c8f690cf3b07a$export$30c2a0095db95d06(url) : import_api7.Icon.Globe,
      actions: /* @__PURE__ */ (0, import_jsx_runtime5.jsx)(BraveActions.TabHistory, { title, url, profile })
    }
  );
}
function TabListItem(props) {
  return /* @__PURE__ */ (0, import_jsx_runtime5.jsx)(
    import_api7.List.Item,
    {
      title: props.tab.title,
      subtitle: props.tab.urlWithoutScheme(),
      keywords: getUrlKeywords(props.tab.url),
      actions: /* @__PURE__ */ (0, import_jsx_runtime5.jsx)(BraveActions.TabList, { tab: props.tab }),
      icon: props.useOriginalFavicon ? props.tab.favicon : props.tab.googleFavicon()
    }
  );
}

// src/components/BraveProfileDropdown.tsx
var import_api8 = require("@raycast/api");
var import_react4 = require("react");
var import_fs2 = require("fs");
var import_jsx_runtime6 = require("react/jsx-runtime");
async function loadBraveProfiles() {
  const path2 = getLocalStatePath();
  if (!(0, import_fs2.existsSync)(path2)) {
    return [{ name: "Default", id: "Default" }];
  }
  const braveState = await import_fs2.promises.readFile(path2, "utf-8");
  const profiles = JSON.parse(braveState).profile.info_cache;
  return Object.entries(profiles).map(([key, val]) => ({
    name: val.name,
    id: key
  }));
}
function BraveProfileDropDown({ onProfileSelected }) {
  const [selectedProfile, setSelectedProfile] = $c40d7eded38ca69c$export$14afb9e4c16377d3(BRAVE_PROFILE_KEY, DEFAULT_BRAVE_PROFILE_ID);
  const [profiles, setProfiles] = $c40d7eded38ca69c$export$14afb9e4c16377d3(BRAVE_PROFILES_KEY, [
    { name: "Default", id: DEFAULT_BRAVE_PROFILE_ID }
  ]);
  const { data: loadedProfiles } = $a7f3824c7be647eb$export$b15740c74e256244(loadBraveProfiles);
  (0, import_react4.useEffect)(() => {
    if (loadedProfiles) {
      setProfiles(loadedProfiles);
      if (!selectedProfile) {
        setSelectedProfile(profiles[0].id);
      }
    }
  }, [loadedProfiles]);
  (0, import_react4.useEffect)(() => {
    if (selectedProfile) {
      onProfileSelected?.(selectedProfile);
    }
  }, [selectedProfile]);
  if (!profiles || profiles.length < 2) {
    return null;
  }
  return /* @__PURE__ */ (0, import_jsx_runtime6.jsx)(import_api8.List.Dropdown, { tooltip: "Select Brave Profile", value: selectedProfile, onChange: setSelectedProfile, children: profiles.map((profile) => /* @__PURE__ */ (0, import_jsx_runtime6.jsx)(import_api8.List.Dropdown.Item, { value: profile.id, title: profile.name }, profile.id)) });
}

// src/search-history.tsx
var import_jsx_runtime7 = require("react/jsx-runtime");
var groupEntries = (allEntries) => allEntries ? allEntries.reduce((acc, cur) => {
  const title = new Date(cur.lastVisited).toLocaleDateString(void 0, {
    weekday: "long",
    year: "numeric",
    month: "long",
    day: "numeric"
  });
  const groupEntries2 = acc.get(title) ?? [];
  groupEntries2.push(cur);
  acc.set(title, groupEntries2);
  return acc;
}, /* @__PURE__ */ new Map()) : /* @__PURE__ */ new Map();
function Command() {
  const [searchText, setSearchText] = (0, import_react5.useState)();
  const [profiles] = $c40d7eded38ca69c$export$14afb9e4c16377d3(BRAVE_PROFILES_KEY, [
    { name: "Default", id: DEFAULT_BRAVE_PROFILE_ID }
  ]);
  const [profile] = $c40d7eded38ca69c$export$14afb9e4c16377d3(BRAVE_PROFILE_KEY, DEFAULT_BRAVE_PROFILE_ID);
  const histories = useHistorySearch(profiles, searchText);
  (0, import_react5.useEffect)(() => {
    if (histories[0]) {
      histories[0].revalidate?.(profile);
    }
  }, [profile]);
  const profileHistory = histories.length ? histories.find((e) => e.profile.id == profile) : void 0;
  if (!profileHistory) {
    return /* @__PURE__ */ (0, import_jsx_runtime7.jsx)(import_api9.List, { searchBarAccessory: /* @__PURE__ */ (0, import_jsx_runtime7.jsx)(BraveProfileDropDown, {}) });
  }
  if (profileHistory.errorView) {
    return profileHistory.errorView;
  }
  const groupedEntries = groupEntries(profileHistory.data);
  const groups = Array.from(groupedEntries.keys());
  return /* @__PURE__ */ (0, import_jsx_runtime7.jsx)(
    import_api9.List,
    {
      onSearchTextChange: setSearchText,
      isLoading: profileHistory.isLoading,
      throttle: true,
      searchBarAccessory: /* @__PURE__ */ (0, import_jsx_runtime7.jsx)(BraveProfileDropDown, {}),
      children: groups?.map((group) => /* @__PURE__ */ (0, import_jsx_runtime7.jsx)(import_api9.List.Section, { title: group, children: groupedEntries?.get(group)?.map((e) => /* @__PURE__ */ (0, import_jsx_runtime7.jsx)(BraveListItems.TabHistory, { entry: e, profile }, e.id)) }, group))
    }
  );
}
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiLi4vLi4vLi4vLi4vUHJvamVjdHMvZ2l0aHViL2thbGxlcHlvcmFsYS9yYXljYXN0LWV4dGVuc2lvbnMvYnJhdmUvc3JjL3NlYXJjaC1oaXN0b3J5LnRzeCIsICIuLi8uLi8uLi8uLi9Qcm9qZWN0cy9naXRodWIva2FsbGVweW9yYWxhL3JheWNhc3QtZXh0ZW5zaW9ucy9icmF2ZS9zcmMvaG9va3MvdXNlSGlzdG9yeVNlYXJjaC50c3giLCAiLi4vLi4vLi4vLi4vUHJvamVjdHMvZ2l0aHViL2thbGxlcHlvcmFsYS9yYXljYXN0LWV4dGVuc2lvbnMvYnJhdmUvc3JjL3V0aWwvaW5kZXgudHMiLCAiLi4vLi4vLi4vLi4vUHJvamVjdHMvZ2l0aHViL2thbGxlcHlvcmFsYS9yYXljYXN0LWV4dGVuc2lvbnMvYnJhdmUvc3JjL2NvbnN0YW50cy50cyIsICIuLi8uLi8uLi8uLi9Qcm9qZWN0cy9naXRodWIva2FsbGVweW9yYWxhL3JheWNhc3QtZXh0ZW5zaW9ucy9icmF2ZS9ub2RlX21vZHVsZXMvZGVxdWFsL2xpdGUvaW5kZXgubWpzIiwgIi4uLy4uLy4uLy4uL1Byb2plY3RzL2dpdGh1Yi9rYWxsZXB5b3JhbGEvcmF5Y2FzdC1leHRlbnNpb25zL2JyYXZlL25vZGVfbW9kdWxlcy9AcmF5Y2FzdC91dGlscy9kaXN0L3NyYy9pbmRleC50cyIsICIuLi8uLi8uLi8uLi9Qcm9qZWN0cy9naXRodWIva2FsbGVweW9yYWxhL3JheWNhc3QtZXh0ZW5zaW9ucy9icmF2ZS9ub2RlX21vZHVsZXMvQHJheWNhc3QvdXRpbHMvZGlzdC9zcmMvdXNlUHJvbWlzZS50cyIsICIuLi8uLi8uLi8uLi9Qcm9qZWN0cy9naXRodWIva2FsbGVweW9yYWxhL3JheWNhc3QtZXh0ZW5zaW9ucy9icmF2ZS9ub2RlX21vZHVsZXMvQHJheWNhc3QvdXRpbHMvZGlzdC9zcmMvdXNlRGVlcE1lbW8udHMiLCAiLi4vLi4vLi4vLi4vUHJvamVjdHMvZ2l0aHViL2thbGxlcHlvcmFsYS9yYXljYXN0LWV4dGVuc2lvbnMvYnJhdmUvbm9kZV9tb2R1bGVzL0ByYXljYXN0L3V0aWxzL2Rpc3Qvc3JjL3VzZUxhdGVzdC50cyIsICIuLi8uLi8uLi8uLi9Qcm9qZWN0cy9naXRodWIva2FsbGVweW9yYWxhL3JheWNhc3QtZXh0ZW5zaW9ucy9icmF2ZS9ub2RlX21vZHVsZXMvQHJheWNhc3QvdXRpbHMvZGlzdC9zcmMvc2hvd0ZhaWx1cmVUb2FzdC50cyIsICIuLi8uLi8uLi8uLi9Qcm9qZWN0cy9naXRodWIva2FsbGVweW9yYWxhL3JheWNhc3QtZXh0ZW5zaW9ucy9icmF2ZS9ub2RlX21vZHVsZXMvQHJheWNhc3QvdXRpbHMvZGlzdC9zcmMvdXNlQ2FjaGVkU3RhdGUudHMiLCAiLi4vLi4vLi4vLi4vUHJvamVjdHMvZ2l0aHViL2thbGxlcHlvcmFsYS9yYXljYXN0LWV4dGVuc2lvbnMvYnJhdmUvbm9kZV9tb2R1bGVzL0ByYXljYXN0L3V0aWxzL2Rpc3Qvc3JjL2hlbHBlcnMudHMiLCAiLi4vLi4vLi4vLi4vUHJvamVjdHMvZ2l0aHViL2thbGxlcHlvcmFsYS9yYXljYXN0LWV4dGVuc2lvbnMvYnJhdmUvbm9kZV9tb2R1bGVzL0ByYXljYXN0L3V0aWxzL2Rpc3Qvc3JjL3ZlbmRvcnMvdHlwZS1oYXNoZXIudHMiLCAiLi4vLi4vLi4vLi4vUHJvamVjdHMvZ2l0aHViL2thbGxlcHlvcmFsYS9yYXljYXN0LWV4dGVuc2lvbnMvYnJhdmUvbm9kZV9tb2R1bGVzL0ByYXljYXN0L3V0aWxzL2Rpc3Qvc3JjL3VzZUNhY2hlZFByb21pc2UudHMiLCAiLi4vLi4vLi4vLi4vUHJvamVjdHMvZ2l0aHViL2thbGxlcHlvcmFsYS9yYXljYXN0LWV4dGVuc2lvbnMvYnJhdmUvbm9kZV9tb2R1bGVzL0ByYXljYXN0L3V0aWxzL2Rpc3Qvc3JjL3VzZUZldGNoLnRzIiwgIi4uLy4uLy4uLy4uL1Byb2plY3RzL2dpdGh1Yi9rYWxsZXB5b3JhbGEvcmF5Y2FzdC1leHRlbnNpb25zL2JyYXZlL25vZGVfbW9kdWxlcy9AcmF5Y2FzdC91dGlscy9kaXN0L3NyYy9mZXRjaC11dGlscy50cyIsICIuLi8uLi8uLi8uLi9Qcm9qZWN0cy9naXRodWIva2FsbGVweW9yYWxhL3JheWNhc3QtZXh0ZW5zaW9ucy9icmF2ZS9ub2RlX21vZHVsZXMvQHJheWNhc3QvdXRpbHMvZGlzdC9zcmMvdXNlRXhlYy50cyIsICIuLi8uLi8uLi8uLi9Qcm9qZWN0cy9naXRodWIva2FsbGVweW9yYWxhL3JheWNhc3QtZXh0ZW5zaW9ucy9icmF2ZS9ub2RlX21vZHVsZXMvQHJheWNhc3QvdXRpbHMvZGlzdC9zcmMvZXhlYy11dGlscy50cyIsICIuLi8uLi8uLi8uLi9Qcm9qZWN0cy9naXRodWIva2FsbGVweW9yYWxhL3JheWNhc3QtZXh0ZW5zaW9ucy9icmF2ZS9ub2RlX21vZHVsZXMvQHJheWNhc3QvdXRpbHMvZGlzdC9zcmMvdmVuZG9ycy9zaWduYWwtZXhpdC50cyIsICIuLi8uLi8uLi8uLi9Qcm9qZWN0cy9naXRodWIva2FsbGVweW9yYWxhL3JheWNhc3QtZXh0ZW5zaW9ucy9icmF2ZS9ub2RlX21vZHVsZXMvQHJheWNhc3QvdXRpbHMvZGlzdC9zcmMvdXNlU3RyZWFtSlNPTi50cyIsICIuLi8uLi8uLi8uLi9Qcm9qZWN0cy9naXRodWIva2FsbGVweW9yYWxhL3JheWNhc3QtZXh0ZW5zaW9ucy9icmF2ZS9ub2RlX21vZHVsZXMvQHJheWNhc3QvdXRpbHMvZGlzdC9zcmMvdmVuZG9ycy9zdHJlYW0tY2hhaW4udHMiLCAiLi4vLi4vLi4vLi4vUHJvamVjdHMvZ2l0aHViL2thbGxlcHlvcmFsYS9yYXljYXN0LWV4dGVuc2lvbnMvYnJhdmUvbm9kZV9tb2R1bGVzL0ByYXljYXN0L3V0aWxzL2Rpc3Qvc3JjL3ZlbmRvcnMvc3RyZWFtLWpzb24udHMiLCAiLi4vLi4vLi4vLi4vUHJvamVjdHMvZ2l0aHViL2thbGxlcHlvcmFsYS9yYXljYXN0LWV4dGVuc2lvbnMvYnJhdmUvbm9kZV9tb2R1bGVzL0ByYXljYXN0L3V0aWxzL2Rpc3Qvc3JjL3VzZVNRTC50c3giLCAiLi4vLi4vLi4vLi4vUHJvamVjdHMvZ2l0aHViL2thbGxlcHlvcmFsYS9yYXljYXN0LWV4dGVuc2lvbnMvYnJhdmUvbm9kZV9tb2R1bGVzL0ByYXljYXN0L3V0aWxzL2Rpc3Qvc3JjL3NxbC11dGlscy50cyIsICIuLi8uLi8uLi8uLi9Qcm9qZWN0cy9naXRodWIva2FsbGVweW9yYWxhL3JheWNhc3QtZXh0ZW5zaW9ucy9icmF2ZS9ub2RlX21vZHVsZXMvQHJheWNhc3QvdXRpbHMvZGlzdC9zcmMvdXNlRm9ybS50c3giLCAiLi4vLi4vLi4vLi4vUHJvamVjdHMvZ2l0aHViL2thbGxlcHlvcmFsYS9yYXljYXN0LWV4dGVuc2lvbnMvYnJhdmUvbm9kZV9tb2R1bGVzL0ByYXljYXN0L3V0aWxzL2Rpc3Qvc3JjL3VzZUFJLnRzIiwgIi4uLy4uLy4uLy4uL1Byb2plY3RzL2dpdGh1Yi9rYWxsZXB5b3JhbGEvcmF5Y2FzdC1leHRlbnNpb25zL2JyYXZlL25vZGVfbW9kdWxlcy9AcmF5Y2FzdC91dGlscy9kaXN0L3NyYy91c2VGcmVjZW5jeVNvcnRpbmcudHMiLCAiLi4vLi4vLi4vLi4vUHJvamVjdHMvZ2l0aHViL2thbGxlcHlvcmFsYS9yYXljYXN0LWV4dGVuc2lvbnMvYnJhdmUvbm9kZV9tb2R1bGVzL0ByYXljYXN0L3V0aWxzL2Rpc3Qvc3JjL3VzZUxvY2FsU3RvcmFnZS50cyIsICIuLi8uLi8uLi8uLi9Qcm9qZWN0cy9naXRodWIva2FsbGVweW9yYWxhL3JheWNhc3QtZXh0ZW5zaW9ucy9icmF2ZS9ub2RlX21vZHVsZXMvQHJheWNhc3QvdXRpbHMvZGlzdC9zcmMvaWNvbi9pbmRleC50cyIsICIuLi8uLi8uLi8uLi9Qcm9qZWN0cy9naXRodWIva2FsbGVweW9yYWxhL3JheWNhc3QtZXh0ZW5zaW9ucy9icmF2ZS9ub2RlX21vZHVsZXMvQHJheWNhc3QvdXRpbHMvZGlzdC9zcmMvaWNvbi9hdmF0YXIudHMiLCAiLi4vLi4vLi4vLi4vUHJvamVjdHMvZ2l0aHViL2thbGxlcHlvcmFsYS9yYXljYXN0LWV4dGVuc2lvbnMvYnJhdmUvbm9kZV9tb2R1bGVzL0ByYXljYXN0L3V0aWxzL2Rpc3Qvc3JjL2ljb24vY29sb3IudHMiLCAiLi4vLi4vLi4vLi4vUHJvamVjdHMvZ2l0aHViL2thbGxlcHlvcmFsYS9yYXljYXN0LWV4dGVuc2lvbnMvYnJhdmUvbm9kZV9tb2R1bGVzL0ByYXljYXN0L3V0aWxzL2Rpc3Qvc3JjL2ljb24vZmF2aWNvbi50cyIsICIuLi8uLi8uLi8uLi9Qcm9qZWN0cy9naXRodWIva2FsbGVweW9yYWxhL3JheWNhc3QtZXh0ZW5zaW9ucy9icmF2ZS9ub2RlX21vZHVsZXMvQHJheWNhc3QvdXRpbHMvZGlzdC9zcmMvaWNvbi9wcm9ncmVzcy50cyIsICIuLi8uLi8uLi8uLi9Qcm9qZWN0cy9naXRodWIva2FsbGVweW9yYWxhL3JheWNhc3QtZXh0ZW5zaW9ucy9icmF2ZS9ub2RlX21vZHVsZXMvQHJheWNhc3QvdXRpbHMvZGlzdC9zcmMvb2F1dGgvaW5kZXgudHMiLCAiLi4vLi4vLi4vLi4vUHJvamVjdHMvZ2l0aHViL2thbGxlcHlvcmFsYS9yYXljYXN0LWV4dGVuc2lvbnMvYnJhdmUvbm9kZV9tb2R1bGVzL0ByYXljYXN0L3V0aWxzL2Rpc3Qvc3JjL29hdXRoL09BdXRoU2VydmljZS50cyIsICIuLi8uLi8uLi8uLi9Qcm9qZWN0cy9naXRodWIva2FsbGVweW9yYWxhL3JheWNhc3QtZXh0ZW5zaW9ucy9icmF2ZS9ub2RlX21vZHVsZXMvQHJheWNhc3QvdXRpbHMvZGlzdC9zcmMvb2F1dGgvcHJvdmlkZXJzLnRzIiwgIi4uLy4uLy4uLy4uL1Byb2plY3RzL2dpdGh1Yi9rYWxsZXB5b3JhbGEvcmF5Y2FzdC1leHRlbnNpb25zL2JyYXZlL25vZGVfbW9kdWxlcy9AcmF5Y2FzdC91dGlscy9kaXN0L3NyYy9vYXV0aC93aXRoQWNjZXNzVG9rZW4udHN4IiwgIi4uLy4uLy4uLy4uL1Byb2plY3RzL2dpdGh1Yi9rYWxsZXB5b3JhbGEvcmF5Y2FzdC1leHRlbnNpb25zL2JyYXZlL25vZGVfbW9kdWxlcy9AcmF5Y2FzdC91dGlscy9kaXN0L3NyYy9jcmVhdGVEZWVwbGluay50cyIsICIuLi8uLi8uLi8uLi9Qcm9qZWN0cy9naXRodWIva2FsbGVweW9yYWxhL3JheWNhc3QtZXh0ZW5zaW9ucy9icmF2ZS9ub2RlX21vZHVsZXMvQHJheWNhc3QvdXRpbHMvZGlzdC9zcmMvZXhlY3V0ZVNRTC50cyIsICIuLi8uLi8uLi8uLi9Qcm9qZWN0cy9naXRodWIva2FsbGVweW9yYWxhL3JheWNhc3QtZXh0ZW5zaW9ucy9icmF2ZS9ub2RlX21vZHVsZXMvQHJheWNhc3QvdXRpbHMvZGlzdC9zcmMvcnVuLWFwcGxlc2NyaXB0LnRzIiwgIi4uLy4uLy4uLy4uL1Byb2plY3RzL2dpdGh1Yi9rYWxsZXB5b3JhbGEvcmF5Y2FzdC1leHRlbnNpb25zL2JyYXZlL25vZGVfbW9kdWxlcy9AcmF5Y2FzdC91dGlscy9kaXN0L3NyYy9ydW4tcG93ZXJzaGVsbC1zY3JpcHQudHMiLCAiLi4vLi4vLi4vLi4vUHJvamVjdHMvZ2l0aHViL2thbGxlcHlvcmFsYS9yYXljYXN0LWV4dGVuc2lvbnMvYnJhdmUvbm9kZV9tb2R1bGVzL0ByYXljYXN0L3V0aWxzL2Rpc3Qvc3JjL2NhY2hlLnRzIiwgIi4uLy4uLy4uLy4uL1Byb2plY3RzL2dpdGh1Yi9rYWxsZXB5b3JhbGEvcmF5Y2FzdC1leHRlbnNpb25zL2JyYXZlL3NyYy9jb21wb25lbnRzL2Vycm9yL05vdEluc3RhbGxlZEVycm9yLnRzeCIsICIuLi8uLi8uLi8uLi9Qcm9qZWN0cy9naXRodWIva2FsbGVweW9yYWxhL3JheWNhc3QtZXh0ZW5zaW9ucy9icmF2ZS9zcmMvY29tcG9uZW50cy9lcnJvci9Vbmtub3duRXJyb3IudHN4IiwgIi4uLy4uLy4uLy4uL1Byb2plY3RzL2dpdGh1Yi9rYWxsZXB5b3JhbGEvcmF5Y2FzdC1leHRlbnNpb25zL2JyYXZlL3NyYy9jb21wb25lbnRzL0JyYXZlQWN0aW9ucy50c3giLCAiLi4vLi4vLi4vLi4vUHJvamVjdHMvZ2l0aHViL2thbGxlcHlvcmFsYS9yYXljYXN0LWV4dGVuc2lvbnMvYnJhdmUvc3JjL2FjdGlvbnMvaW5kZXgudHN4IiwgIi4uLy4uLy4uLy4uL1Byb2plY3RzL2dpdGh1Yi9rYWxsZXB5b3JhbGEvcmF5Y2FzdC1leHRlbnNpb25zL2JyYXZlL3NyYy9jb21wb25lbnRzL0JyYXZlTGlzdEl0ZW1zLnRzeCIsICIuLi8uLi8uLi8uLi9Qcm9qZWN0cy9naXRodWIva2FsbGVweW9yYWxhL3JheWNhc3QtZXh0ZW5zaW9ucy9icmF2ZS9zcmMvY29tcG9uZW50cy9CcmF2ZVByb2ZpbGVEcm9wZG93bi50c3giXSwKICAic291cmNlc0NvbnRlbnQiOiBbImltcG9ydCB7IExpc3QgfSBmcm9tIFwiQHJheWNhc3QvYXBpXCI7XG5pbXBvcnQgeyB1c2VTdGF0ZSwgUmVhY3RFbGVtZW50LCB1c2VFZmZlY3QgfSBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCB7IHVzZUhpc3RvcnlTZWFyY2ggfSBmcm9tIFwiLi9ob29rcy91c2VIaXN0b3J5U2VhcmNoXCI7XG5pbXBvcnQgeyBCcmF2ZVByb2ZpbGUsIEdyb3VwZWRFbnRyaWVzLCBIaXN0b3J5RW50cnkgfSBmcm9tIFwiLi9pbnRlcmZhY2VzXCI7XG5pbXBvcnQgeyBCcmF2ZUxpc3RJdGVtcyB9IGZyb20gXCIuL2NvbXBvbmVudHNcIjtcbmltcG9ydCB7IHVzZUNhY2hlZFN0YXRlIH0gZnJvbSBcIkByYXljYXN0L3V0aWxzXCI7XG5pbXBvcnQgeyBCUkFWRV9QUk9GSUxFU19LRVksIEJSQVZFX1BST0ZJTEVfS0VZLCBERUZBVUxUX0JSQVZFX1BST0ZJTEVfSUQgfSBmcm9tIFwiLi9jb25zdGFudHNcIjtcbmltcG9ydCBCcmF2ZVByb2ZpbGVEcm9wRG93biBmcm9tIFwiLi9jb21wb25lbnRzL0JyYXZlUHJvZmlsZURyb3Bkb3duXCI7XG5cbmNvbnN0IGdyb3VwRW50cmllcyA9IChhbGxFbnRyaWVzPzogSGlzdG9yeUVudHJ5W10pOiBHcm91cGVkRW50cmllcyA9PlxuICBhbGxFbnRyaWVzXG4gICAgPyBhbGxFbnRyaWVzLnJlZHVjZSgoYWNjLCBjdXIpID0+IHtcbiAgICAgICAgY29uc3QgdGl0bGUgPSBuZXcgRGF0ZShjdXIubGFzdFZpc2l0ZWQpLnRvTG9jYWxlRGF0ZVN0cmluZyh1bmRlZmluZWQsIHtcbiAgICAgICAgICB3ZWVrZGF5OiBcImxvbmdcIixcbiAgICAgICAgICB5ZWFyOiBcIm51bWVyaWNcIixcbiAgICAgICAgICBtb250aDogXCJsb25nXCIsXG4gICAgICAgICAgZGF5OiBcIm51bWVyaWNcIixcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IGdyb3VwRW50cmllcyA9IGFjYy5nZXQodGl0bGUpID8/IFtdO1xuICAgICAgICBncm91cEVudHJpZXMucHVzaChjdXIpO1xuICAgICAgICBhY2Muc2V0KHRpdGxlLCBncm91cEVudHJpZXMpO1xuICAgICAgICByZXR1cm4gYWNjO1xuICAgICAgfSwgbmV3IE1hcDxzdHJpbmcsIEhpc3RvcnlFbnRyeVtdPigpKVxuICAgIDogbmV3IE1hcDxzdHJpbmcsIEhpc3RvcnlFbnRyeVtdPigpO1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBDb21tYW5kKCk6IFJlYWN0RWxlbWVudCB7XG4gIGNvbnN0IFtzZWFyY2hUZXh0LCBzZXRTZWFyY2hUZXh0XSA9IHVzZVN0YXRlPHN0cmluZz4oKTtcbiAgY29uc3QgW3Byb2ZpbGVzXSA9IHVzZUNhY2hlZFN0YXRlPEJyYXZlUHJvZmlsZVtdPihCUkFWRV9QUk9GSUxFU19LRVksIFtcbiAgICB7IG5hbWU6IFwiRGVmYXVsdFwiLCBpZDogREVGQVVMVF9CUkFWRV9QUk9GSUxFX0lEIH0sXG4gIF0pO1xuICBjb25zdCBbcHJvZmlsZV0gPSB1c2VDYWNoZWRTdGF0ZTxzdHJpbmc+KEJSQVZFX1BST0ZJTEVfS0VZLCBERUZBVUxUX0JSQVZFX1BST0ZJTEVfSUQpO1xuICBjb25zdCBoaXN0b3JpZXMgPSB1c2VIaXN0b3J5U2VhcmNoKHByb2ZpbGVzLCBzZWFyY2hUZXh0KTtcblxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmIChoaXN0b3JpZXNbMF0pIHtcbiAgICAgIGhpc3Rvcmllc1swXS5yZXZhbGlkYXRlPy4ocHJvZmlsZSk7XG4gICAgfVxuICB9LCBbcHJvZmlsZV0pO1xuXG4gIGNvbnN0IHByb2ZpbGVIaXN0b3J5ID0gaGlzdG9yaWVzLmxlbmd0aCA/IGhpc3Rvcmllcy5maW5kKChlKSA9PiBlLnByb2ZpbGUuaWQgPT0gcHJvZmlsZSkgOiB1bmRlZmluZWQ7XG5cbiAgaWYgKCFwcm9maWxlSGlzdG9yeSkge1xuICAgIHJldHVybiA8TGlzdCBzZWFyY2hCYXJBY2Nlc3Nvcnk9ezxCcmF2ZVByb2ZpbGVEcm9wRG93biAvPn0gLz47XG4gIH1cblxuICBpZiAocHJvZmlsZUhpc3RvcnkuZXJyb3JWaWV3KSB7XG4gICAgcmV0dXJuIHByb2ZpbGVIaXN0b3J5LmVycm9yVmlldyBhcyBSZWFjdEVsZW1lbnQ7XG4gIH1cblxuICBjb25zdCBncm91cGVkRW50cmllcyA9IGdyb3VwRW50cmllcyhwcm9maWxlSGlzdG9yeS5kYXRhKTtcbiAgY29uc3QgZ3JvdXBzID0gQXJyYXkuZnJvbShncm91cGVkRW50cmllcy5rZXlzKCkpO1xuXG4gIHJldHVybiAoXG4gICAgPExpc3RcbiAgICAgIG9uU2VhcmNoVGV4dENoYW5nZT17c2V0U2VhcmNoVGV4dH1cbiAgICAgIGlzTG9hZGluZz17cHJvZmlsZUhpc3RvcnkuaXNMb2FkaW5nfVxuICAgICAgdGhyb3R0bGU9e3RydWV9XG4gICAgICBzZWFyY2hCYXJBY2Nlc3Nvcnk9ezxCcmF2ZVByb2ZpbGVEcm9wRG93biAvPn1cbiAgICA+XG4gICAgICB7Z3JvdXBzPy5tYXAoKGdyb3VwKSA9PiAoXG4gICAgICAgIDxMaXN0LlNlY3Rpb24gdGl0bGU9e2dyb3VwfSBrZXk9e2dyb3VwfT5cbiAgICAgICAgICB7Z3JvdXBlZEVudHJpZXM/LmdldChncm91cCk/Lm1hcCgoZSkgPT4gKFxuICAgICAgICAgICAgPEJyYXZlTGlzdEl0ZW1zLlRhYkhpc3RvcnkgZW50cnk9e2V9IGtleT17ZS5pZH0gcHJvZmlsZT17cHJvZmlsZX0gLz5cbiAgICAgICAgICApKX1cbiAgICAgICAgPC9MaXN0LlNlY3Rpb24+XG4gICAgICApKX1cbiAgICA8L0xpc3Q+XG4gICk7XG59XG4iLCAiaW1wb3J0IHsgZXhpc3RzU3luYyB9IGZyb20gXCJmc1wiO1xuaW1wb3J0IHsgQnJhdmVQcm9maWxlLCBIaXN0b3J5RW50cnksIFNlYXJjaFJlc3VsdCB9IGZyb20gXCIuLi9pbnRlcmZhY2VzXCI7XG5pbXBvcnQgeyBnZXRIaXN0b3J5RGJQYXRoIH0gZnJvbSBcIi4uL3V0aWxcIjtcbmltcG9ydCB7IHVzZUVmZmVjdCwgdXNlU3RhdGUgfSBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCB7IHVzZVNRTCB9IGZyb20gXCJAcmF5Y2FzdC91dGlsc1wiO1xuXG5jb25zdCB3aGVyZUNsYXVzZXMgPSAodGFibGVUaXRsZTogc3RyaW5nLCB0ZXJtczogc3RyaW5nW10pID0+IHtcbiAgcmV0dXJuIHRlcm1zLm1hcCgodCkgPT4gYCgke3RhYmxlVGl0bGV9LnRpdGxlIExJS0UgJyUke3R9JScgT1IgJHt0YWJsZVRpdGxlfS51cmwgTElLRSAnJSR7dH0lJylgKS5qb2luKFwiIEFORCBcIik7XG59O1xuXG5jb25zdCBnZXRIaXN0b3J5UXVlcnkgPSAodGFibGU6IHN0cmluZywgZGF0ZV9maWVsZDogc3RyaW5nLCB0ZXJtczogc3RyaW5nW10pID0+XG4gIGBTRUxFQ1QgaWQsXG4gICAgICAgICAgICB1cmwsXG4gICAgICAgICAgICAgdGl0bGUsXG4gICAgICAgICAgICAgZGF0ZXRpbWUoJHtkYXRlX2ZpZWxkfSAvIDEwMDAwMDAgKyAoc3RyZnRpbWUoJyVzJywgJzE2MDEtMDEtMDEnKSksICd1bml4ZXBvY2gnLCAnbG9jYWx0aW1lJykgYXMgbGFzdFZpc2l0ZWRcbiAgICAgIEZST00gJHt0YWJsZX1cbiAgICAgIFdIRVJFICR7d2hlcmVDbGF1c2VzKHRhYmxlLCB0ZXJtcyl9XG4gICAgICBPUkRFUiBCWSAke2RhdGVfZmllbGR9IERFU0MgTElNSVQgMTAwO2A7XG5cbmV4cG9ydCBmdW5jdGlvbiB1c2VIaXN0b3J5U2VhcmNoKHByb2ZpbGVzOiBCcmF2ZVByb2ZpbGVbXSwgcXVlcnk/OiBzdHJpbmcpOiBTZWFyY2hSZXN1bHQ8SGlzdG9yeUVudHJ5PltdIHtcbiAgY29uc3QgW3Byb2ZpbGVIaXN0b3JpZXMsIHNldFByb2ZpbGVIaXN0b3JpZXNdID0gdXNlU3RhdGU8eyBbaWQ6IHN0cmluZ106IFNlYXJjaFJlc3VsdDxIaXN0b3J5RW50cnk+IH0+KHt9KTtcbiAgY29uc3QgW2N1cnJlbnRQcm9maWxlSW5kZXgsIHNldEN1cnJlbnRQcm9maWxlSW5kZXhdID0gdXNlU3RhdGU8bnVtYmVyPigwKTtcbiAgY29uc3QgW2RiUGF0aCwgc2V0RGJQYXRoXSA9IHVzZVN0YXRlPHN0cmluZz4oZ2V0SGlzdG9yeURiUGF0aChwcm9maWxlc1swXS5pZCkpO1xuXG4gIGNvbnN0IHRlcm1zID0gcXVlcnkgPyBxdWVyeS50cmltKCkuc3BsaXQoXCIgXCIpIDogW1wiXCJdO1xuICBjb25zdCBoaXN0b3J5UXVlcnkgPSBnZXRIaXN0b3J5UXVlcnkoXCJ1cmxzXCIsIFwibGFzdF92aXNpdF90aW1lXCIsIHRlcm1zKTtcblxuICBjb25zdCB7IGRhdGEsIGlzTG9hZGluZywgcGVybWlzc2lvblZpZXcsIHJldmFsaWRhdGUgfSA9IHVzZVNRTDxIaXN0b3J5RW50cnk+KGRiUGF0aCwgaGlzdG9yeVF1ZXJ5KTtcblxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmIChkYXRhICE9IHVuZGVmaW5lZCAmJiAhaXNMb2FkaW5nKSB7XG4gICAgICBjb25zdCBuZXdIaXN0b3JpZXMgPSB7IC4uLnByb2ZpbGVIaXN0b3JpZXMgfTtcbiAgICAgIG5ld0hpc3Rvcmllc1twcm9maWxlc1tjdXJyZW50UHJvZmlsZUluZGV4XS5pZF0gPSB7XG4gICAgICAgIGRhdGEsXG4gICAgICAgIGlzTG9hZGluZyxcbiAgICAgICAgZXJyb3JWaWV3OiBwZXJtaXNzaW9uVmlldyxcbiAgICAgICAgcmV2YWxpZGF0ZSxcbiAgICAgICAgcHJvZmlsZTogcHJvZmlsZXNbY3VycmVudFByb2ZpbGVJbmRleF0sXG4gICAgICB9O1xuICAgICAgc2V0UHJvZmlsZUhpc3RvcmllcyhuZXdIaXN0b3JpZXMpO1xuXG4gICAgICBpZiAoXG4gICAgICAgIGN1cnJlbnRQcm9maWxlSW5kZXggPCBwcm9maWxlcy5sZW5ndGggLSAxICYmXG4gICAgICAgIGV4aXN0c1N5bmMoZ2V0SGlzdG9yeURiUGF0aChwcm9maWxlc1tjdXJyZW50UHJvZmlsZUluZGV4ICsgMV0uaWQpKVxuICAgICAgKSB7XG4gICAgICAgIHNldERiUGF0aChnZXRIaXN0b3J5RGJQYXRoKHByb2ZpbGVzW2N1cnJlbnRQcm9maWxlSW5kZXggKyAxXS5pZCkpO1xuICAgICAgICBzZXRDdXJyZW50UHJvZmlsZUluZGV4KGN1cnJlbnRQcm9maWxlSW5kZXggKyAxKTtcbiAgICAgIH1cbiAgICB9XG4gIH0sIFtkYXRhLCBkYlBhdGgsIGlzTG9hZGluZ10pO1xuXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgcmV2YWxpZGF0ZSgpO1xuICB9LCBbY3VycmVudFByb2ZpbGVJbmRleF0pO1xuXG4gIHJldHVybiBPYmplY3QudmFsdWVzKHByb2ZpbGVIaXN0b3JpZXMpO1xufVxuIiwgImltcG9ydCBwYXRoIGZyb20gXCJwYXRoXCI7XG5pbXBvcnQge1xuICBERUZBVUxUX0JSQVZFX1BST0ZJTEVfSUQsXG4gIGRlZmF1bHRCcmF2ZVByb2ZpbGVQYXRoLFxuICBkZWZhdWx0QnJhdmVCZXRhUHJvZmlsZVBhdGgsXG4gIGRlZmF1bHRCcmF2ZU5pZ2h0bHlQcm9maWxlUGF0aCxcbiAgZGVmYXVsdEJyYXZlU3RhdGVQYXRoLFxufSBmcm9tIFwiLi4vY29uc3RhbnRzXCI7XG5pbXBvcnQgeyBnZXRQcmVmZXJlbmNlVmFsdWVzIH0gZnJvbSBcIkByYXljYXN0L2FwaVwiO1xuXG5jb25zdCB7IGJyb3dzZXJPcHRpb24gfSA9IGdldFByZWZlcmVuY2VWYWx1ZXM8UHJlZmVyZW5jZXM+KCk7XG5cbmxldCBwcmVmUHJvZmlsZTogc3RyaW5nW107XG5cbnN3aXRjaCAoYnJvd3Nlck9wdGlvbikge1xuICBjYXNlIFwiQnJhdmUgQnJvd3NlciBCZXRhXCI6XG4gICAgcHJlZlByb2ZpbGUgPSBkZWZhdWx0QnJhdmVCZXRhUHJvZmlsZVBhdGg7XG4gICAgYnJlYWs7XG4gIGNhc2UgXCJCcmF2ZSBCcm93c2VyIE5pZ2h0bHlcIjpcbiAgICBwcmVmUHJvZmlsZSA9IGRlZmF1bHRCcmF2ZU5pZ2h0bHlQcm9maWxlUGF0aDtcbiAgICBicmVhaztcbiAgZGVmYXVsdDpcbiAgICBwcmVmUHJvZmlsZSA9IGRlZmF1bHRCcmF2ZVByb2ZpbGVQYXRoO1xufVxuXG5jb25zdCB1c2VyTGlicmFyeURpcmVjdG9yeVBhdGggPSAoKSA9PiB7XG4gIGlmICghcHJvY2Vzcy5lbnYuSE9NRSkge1xuICAgIHRocm93IG5ldyBFcnJvcihcIiRIT01FIGVudmlyb25tZW50IHZhcmlhYmxlIGlzIG5vdCBzZXQuXCIpO1xuICB9XG5cbiAgcmV0dXJuIHBhdGguam9pbihwcm9jZXNzLmVudi5IT01FLCBcIkxpYnJhcnlcIik7XG59O1xuXG5leHBvcnQgY29uc3QgZ2V0SGlzdG9yeURiUGF0aCA9IChwcm9maWxlPzogc3RyaW5nKSA9PlxuICBwYXRoLmpvaW4odXNlckxpYnJhcnlEaXJlY3RvcnlQYXRoKCksIC4uLnByZWZQcm9maWxlLCBwcm9maWxlID8/IERFRkFVTFRfQlJBVkVfUFJPRklMRV9JRCwgXCJIaXN0b3J5XCIpO1xuXG5leHBvcnQgY29uc3QgZ2V0TG9jYWxTdGF0ZVBhdGggPSAoKSA9PiBwYXRoLmpvaW4odXNlckxpYnJhcnlEaXJlY3RvcnlQYXRoKCksIC4uLmRlZmF1bHRCcmF2ZVN0YXRlUGF0aCk7XG5cbmV4cG9ydCBjb25zdCBnZXRCb29rbWFya3NGaWxlUGF0aCA9IChwcm9maWxlPzogc3RyaW5nKSA9PlxuICBwYXRoLmpvaW4odXNlckxpYnJhcnlEaXJlY3RvcnlQYXRoKCksIC4uLnByZWZQcm9maWxlLCBwcm9maWxlID8/IERFRkFVTFRfQlJBVkVfUFJPRklMRV9JRCwgXCJCb29rbWFya3NcIik7XG4iLCAiZXhwb3J0IGNvbnN0IGRlZmF1bHRCcmF2ZVByb2ZpbGVQYXRoID0gW1wiQXBwbGljYXRpb24gU3VwcG9ydFwiLCBcIkJyYXZlU29mdHdhcmVcIiwgXCJCcmF2ZS1Ccm93c2VyXCJdO1xuZXhwb3J0IGNvbnN0IGRlZmF1bHRCcmF2ZUJldGFQcm9maWxlUGF0aCA9IFtcIkFwcGxpY2F0aW9uIFN1cHBvcnRcIiwgXCJCcmF2ZVNvZnR3YXJlXCIsIFwiQnJhdmUtQnJvd3Nlci1CZXRhXCJdO1xuZXhwb3J0IGNvbnN0IGRlZmF1bHRCcmF2ZU5pZ2h0bHlQcm9maWxlUGF0aCA9IFtcIkFwcGxpY2F0aW9uIFN1cHBvcnRcIiwgXCJCcmF2ZVNvZnR3YXJlXCIsIFwiQnJhdmUtQnJvd3Nlci1OaWdodGx5XCJdO1xuZXhwb3J0IGNvbnN0IGRlZmF1bHRCcmF2ZVN0YXRlUGF0aCA9IFtcIkFwcGxpY2F0aW9uIFN1cHBvcnRcIiwgXCJCcmF2ZVNvZnR3YXJlXCIsIFwiQnJhdmUtQnJvd3NlclwiLCBcIkxvY2FsIFN0YXRlXCJdO1xuZXhwb3J0IGNvbnN0IERFRkFVTFRfQlJBVkVfUFJPRklMRV9JRCA9IFwiRGVmYXVsdFwiO1xuZXhwb3J0IGNvbnN0IEJSQVZFX1BST0ZJTEVfS0VZID0gXCJCUkFWRV9QUk9GSUxFX0tFWVwiO1xuZXhwb3J0IGNvbnN0IEJSQVZFX1BST0ZJTEVTX0tFWSA9IFwiQlJBVkVfUFJPRklMRVNfS0VZXCI7XG5cbmV4cG9ydCBjb25zdCBEb3dubG9hZFRleHQgPSBgXG4jIFx1RDgzRFx1REVBOEVycm9yOiBCcmF2ZSBicm93c2VyIGlzIG5vdCBpbnN0YWxsZWRcbiMjIFRoaXMgZXh0ZW5zaW9uIGRlcGVuZHMgb24gQnJhdmUgYnJvd3Nlci4gWW91IG11c3QgaW5zdGFsbCBpdCB0byBjb250aW51ZS5cbiAgXG5JZiB5b3UgaGF2ZSBbSG9tZWJyZXddKGh0dHBzOi8vYnJldy5zaC8pIGluc3RhbGxlZCB0aGVuIHByZXNzIFx1MjNDRSAoRW50ZXIgS2V5KSB0byBpbnN0YWxsIEJyYXZlIGJyb3dzZXIuXG5cbltDbGljayBoZXJlXShodHRwczovL2JyYXZlLmNvbS9kb3dubG9hZC8pIGlmIHlvdSB3YW50IHRvIGRvd25sb2FkIG1hbnVhbGx5LlxuICBcblshW0JyYXZlXShodHRwczovL2JyYXZlLmNvbS9zdGF0aWMtYXNzZXRzL2ltYWdlcy9icmF2ZS1sb2dvLnN2ZyldKClcbmA7XG5cbmV4cG9ydCBjb25zdCBOb0Jvb2ttYXJrc1RleHQgPSBgVGhpcyBwcm9maWxlIGhhcyBubyBib29rbWFya3MuYDtcblxuZXhwb3J0IGNvbnN0IFVua25vd25FcnJvclRleHQgPSBgXG4jIFx1RDgzRFx1REVBOEVycm9yOiBTb21ldGhpbmcgaGFwcGVuZWQgd2hpbGUgdHJ5aW5nIHRvIHJ1biB5b3VyIGNvbW1hbmRcbiAgXG5bIVtCcmF2ZV0oaHR0cHM6Ly9icmF2ZS5jb20vc3RhdGljLWFzc2V0cy9pbWFnZXMvYnJhdmUtbG9nby5zdmcpXSgpXG5gO1xuXG5leHBvcnQgY29uc3QgREVGQVVMVF9FUlJPUl9USVRMRSA9IFwiQW4gRXJyb3IgT2NjdXJyZWRcIjtcblxuZXhwb3J0IGNvbnN0IE5PVF9JTlNUQUxMRURfTUVTU0FHRSA9IFwiQnJhdmUgbm90IGluc3RhbGxlZFwiO1xuZXhwb3J0IGNvbnN0IE5PX0JPT0tNQVJLU19NRVNTQUdFID0gXCJCcmF2ZSBoYXMgbm8gYm9va21hcmtzXCI7XG4iLCAidmFyIGhhcyA9IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHk7XG5cbmV4cG9ydCBmdW5jdGlvbiBkZXF1YWwoZm9vLCBiYXIpIHtcblx0dmFyIGN0b3IsIGxlbjtcblx0aWYgKGZvbyA9PT0gYmFyKSByZXR1cm4gdHJ1ZTtcblxuXHRpZiAoZm9vICYmIGJhciAmJiAoY3Rvcj1mb28uY29uc3RydWN0b3IpID09PSBiYXIuY29uc3RydWN0b3IpIHtcblx0XHRpZiAoY3RvciA9PT0gRGF0ZSkgcmV0dXJuIGZvby5nZXRUaW1lKCkgPT09IGJhci5nZXRUaW1lKCk7XG5cdFx0aWYgKGN0b3IgPT09IFJlZ0V4cCkgcmV0dXJuIGZvby50b1N0cmluZygpID09PSBiYXIudG9TdHJpbmcoKTtcblxuXHRcdGlmIChjdG9yID09PSBBcnJheSkge1xuXHRcdFx0aWYgKChsZW49Zm9vLmxlbmd0aCkgPT09IGJhci5sZW5ndGgpIHtcblx0XHRcdFx0d2hpbGUgKGxlbi0tICYmIGRlcXVhbChmb29bbGVuXSwgYmFyW2xlbl0pKTtcblx0XHRcdH1cblx0XHRcdHJldHVybiBsZW4gPT09IC0xO1xuXHRcdH1cblxuXHRcdGlmICghY3RvciB8fCB0eXBlb2YgZm9vID09PSAnb2JqZWN0Jykge1xuXHRcdFx0bGVuID0gMDtcblx0XHRcdGZvciAoY3RvciBpbiBmb28pIHtcblx0XHRcdFx0aWYgKGhhcy5jYWxsKGZvbywgY3RvcikgJiYgKytsZW4gJiYgIWhhcy5jYWxsKGJhciwgY3RvcikpIHJldHVybiBmYWxzZTtcblx0XHRcdFx0aWYgKCEoY3RvciBpbiBiYXIpIHx8ICFkZXF1YWwoZm9vW2N0b3JdLCBiYXJbY3Rvcl0pKSByZXR1cm4gZmFsc2U7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gT2JqZWN0LmtleXMoYmFyKS5sZW5ndGggPT09IGxlbjtcblx0XHR9XG5cdH1cblxuXHRyZXR1cm4gZm9vICE9PSBmb28gJiYgYmFyICE9PSBiYXI7XG59XG4iLCAiLy8vIDxyZWZlcmVuY2UgdHlwZXM9XCJub2RlXCIgLz5cblxuZXhwb3J0IHsgdXNlUHJvbWlzZSB9IGZyb20gXCIuL3VzZVByb21pc2VcIjtcbmV4cG9ydCB7IHVzZUNhY2hlZFN0YXRlIH0gZnJvbSBcIi4vdXNlQ2FjaGVkU3RhdGVcIjtcbmV4cG9ydCB7IHVzZUNhY2hlZFByb21pc2UgfSBmcm9tIFwiLi91c2VDYWNoZWRQcm9taXNlXCI7XG5leHBvcnQgeyB1c2VGZXRjaCB9IGZyb20gXCIuL3VzZUZldGNoXCI7XG5leHBvcnQgeyB1c2VFeGVjIH0gZnJvbSBcIi4vdXNlRXhlY1wiO1xuZXhwb3J0IHsgdXNlU3RyZWFtSlNPTiB9IGZyb20gXCIuL3VzZVN0cmVhbUpTT05cIjtcbmV4cG9ydCB7IHVzZVNRTCB9IGZyb20gXCIuL3VzZVNRTFwiO1xuZXhwb3J0IHsgdXNlRm9ybSwgRm9ybVZhbGlkYXRpb24gfSBmcm9tIFwiLi91c2VGb3JtXCI7XG5leHBvcnQgeyB1c2VBSSB9IGZyb20gXCIuL3VzZUFJXCI7XG5leHBvcnQgeyB1c2VGcmVjZW5jeVNvcnRpbmcgfSBmcm9tIFwiLi91c2VGcmVjZW5jeVNvcnRpbmdcIjtcbmV4cG9ydCB7IHVzZUxvY2FsU3RvcmFnZSB9IGZyb20gXCIuL3VzZUxvY2FsU3RvcmFnZVwiO1xuXG5leHBvcnQgeyBnZXRBdmF0YXJJY29uLCBnZXRGYXZpY29uLCBnZXRQcm9ncmVzc0ljb24gfSBmcm9tIFwiLi9pY29uXCI7XG5cbmV4cG9ydCB7IE9BdXRoU2VydmljZSwgd2l0aEFjY2Vzc1Rva2VuLCBnZXRBY2Nlc3NUb2tlbiB9IGZyb20gXCIuL29hdXRoXCI7XG5cbmV4cG9ydCB7IGNyZWF0ZURlZXBsaW5rLCBjcmVhdGVFeHRlbnNpb25EZWVwbGluaywgY3JlYXRlU2NyaXB0Q29tbWFuZERlZXBsaW5rLCBEZWVwbGlua1R5cGUgfSBmcm9tIFwiLi9jcmVhdGVEZWVwbGlua1wiO1xuZXhwb3J0IHsgZXhlY3V0ZVNRTCB9IGZyb20gXCIuL2V4ZWN1dGVTUUxcIjtcbmV4cG9ydCB7IHJ1bkFwcGxlU2NyaXB0IH0gZnJvbSBcIi4vcnVuLWFwcGxlc2NyaXB0XCI7XG5leHBvcnQgeyBydW5Qb3dlclNoZWxsU2NyaXB0IH0gZnJvbSBcIi4vcnVuLXBvd2Vyc2hlbGwtc2NyaXB0XCI7XG5leHBvcnQgeyBzaG93RmFpbHVyZVRvYXN0IH0gZnJvbSBcIi4vc2hvd0ZhaWx1cmVUb2FzdFwiO1xuZXhwb3J0IHsgd2l0aENhY2hlIH0gZnJvbSBcIi4vY2FjaGVcIjtcblxuZXhwb3J0IHR5cGUgeyBQcm9taXNlT3B0aW9ucyB9IGZyb20gXCIuL3VzZVByb21pc2VcIjtcbmV4cG9ydCB0eXBlIHsgQ2FjaGVkUHJvbWlzZU9wdGlvbnMgfSBmcm9tIFwiLi91c2VDYWNoZWRQcm9taXNlXCI7XG5leHBvcnQgdHlwZSB7XG4gIE9BdXRoU2VydmljZU9wdGlvbnMsXG4gIE9uQXV0aG9yaXplUGFyYW1zLFxuICBXaXRoQWNjZXNzVG9rZW5Db21wb25lbnRPckZuLFxuICBQcm92aWRlcldpdGhEZWZhdWx0Q2xpZW50T3B0aW9ucyxcbiAgUHJvdmlkZXJPcHRpb25zLFxufSBmcm9tIFwiLi9vYXV0aFwiO1xuZXhwb3J0IHR5cGUgeyBBc3luY1N0YXRlLCBNdXRhdGVQcm9taXNlIH0gZnJvbSBcIi4vdHlwZXNcIjtcbiIsICJpbXBvcnQgeyB1c2VFZmZlY3QsIHVzZUNhbGxiYWNrLCBSZWZPYmplY3QsIHVzZVJlZiwgdXNlU3RhdGUgfSBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCB7IGVudmlyb25tZW50LCBMYXVuY2hUeXBlLCBUb2FzdCB9IGZyb20gXCJAcmF5Y2FzdC9hcGlcIjtcbmltcG9ydCB7IHVzZURlZXBNZW1vIH0gZnJvbSBcIi4vdXNlRGVlcE1lbW9cIjtcbmltcG9ydCB7XG4gIEZ1bmN0aW9uUmV0dXJuaW5nUHJvbWlzZSxcbiAgTXV0YXRlUHJvbWlzZSxcbiAgVXNlUHJvbWlzZVJldHVyblR5cGUsXG4gIEFzeW5jU3RhdGUsXG4gIEZ1bmN0aW9uUmV0dXJuaW5nUGFnaW5hdGVkUHJvbWlzZSxcbiAgVW53cmFwUmV0dXJuLFxuICBQYWdpbmF0aW9uT3B0aW9ucyxcbn0gZnJvbSBcIi4vdHlwZXNcIjtcbmltcG9ydCB7IHVzZUxhdGVzdCB9IGZyb20gXCIuL3VzZUxhdGVzdFwiO1xuaW1wb3J0IHsgc2hvd0ZhaWx1cmVUb2FzdCB9IGZyb20gXCIuL3Nob3dGYWlsdXJlVG9hc3RcIjtcblxuZXhwb3J0IHR5cGUgUHJvbWlzZU9wdGlvbnM8VCBleHRlbmRzIEZ1bmN0aW9uUmV0dXJuaW5nUHJvbWlzZSB8IEZ1bmN0aW9uUmV0dXJuaW5nUGFnaW5hdGVkUHJvbWlzZT4gPSB7XG4gIC8qKlxuICAgKiBBIHJlZmVyZW5jZSB0byBhbiBgQWJvcnRDb250cm9sbGVyYCB0byBjYW5jZWwgYSBwcmV2aW91cyBjYWxsIHdoZW4gdHJpZ2dlcmluZyBhIG5ldyBvbmVcbiAgICovXG4gIGFib3J0YWJsZT86IFJlZk9iamVjdDxBYm9ydENvbnRyb2xsZXIgfCBudWxsIHwgdW5kZWZpbmVkPjtcbiAgLyoqXG4gICAqIFdoZXRoZXIgdG8gYWN0dWFsbHkgZXhlY3V0ZSB0aGUgZnVuY3Rpb24gb3Igbm90LlxuICAgKiBUaGlzIGlzIHVzZWZ1bCBmb3IgY2FzZXMgd2hlcmUgb25lIG9mIHRoZSBmdW5jdGlvbidzIGFyZ3VtZW50cyBkZXBlbmRzIG9uIHNvbWV0aGluZyB0aGF0XG4gICAqIG1pZ2h0IG5vdCBiZSBhdmFpbGFibGUgcmlnaHQgYXdheSAoZm9yIGV4YW1wbGUsIGRlcGVuZHMgb24gc29tZSB1c2VyIGlucHV0cykuIEJlY2F1c2UgUmVhY3QgcmVxdWlyZXNcbiAgICogZXZlcnkgaG9va3MgdG8gYmUgZGVmaW5lZCBvbiB0aGUgcmVuZGVyLCB0aGlzIGZsYWcgZW5hYmxlcyB5b3UgdG8gZGVmaW5lIHRoZSBob29rIHJpZ2h0IGF3YXkgYnV0XG4gICAqIHdhaXQgdXRpbCB5b3UgaGF2ZSBhbGwgdGhlIGFyZ3VtZW50cyByZWFkeSB0byBleGVjdXRlIHRoZSBmdW5jdGlvbi5cbiAgICovXG4gIGV4ZWN1dGU/OiBib29sZWFuO1xuICAvKipcbiAgICogT3B0aW9ucyBmb3IgdGhlIGdlbmVyaWMgZmFpbHVyZSB0b2FzdC5cbiAgICogSXQgYWxsb3dzIHlvdSB0byBjdXN0b21pemUgdGhlIHRpdGxlLCBtZXNzYWdlLCBhbmQgcHJpbWFyeSBhY3Rpb24gb2YgdGhlIGZhaWx1cmUgdG9hc3QuXG4gICAqL1xuICBmYWlsdXJlVG9hc3RPcHRpb25zPzogUGFydGlhbDxQaWNrPFRvYXN0Lk9wdGlvbnMsIFwidGl0bGVcIiB8IFwicHJpbWFyeUFjdGlvblwiIHwgXCJtZXNzYWdlXCI+PjtcbiAgLyoqXG4gICAqIENhbGxlZCB3aGVuIGFuIGV4ZWN1dGlvbiBmYWlscy4gQnkgZGVmYXVsdCBpdCB3aWxsIGxvZyB0aGUgZXJyb3IgYW5kIHNob3dcbiAgICogYSBnZW5lcmljIGZhaWx1cmUgdG9hc3QuXG4gICAqL1xuICBvbkVycm9yPzogKGVycm9yOiBFcnJvcikgPT4gdm9pZCB8IFByb21pc2U8dm9pZD47XG4gIC8qKlxuICAgKiBDYWxsZWQgd2hlbiBhbiBleGVjdXRpb24gc3VjY2VlZHMuXG4gICAqL1xuICBvbkRhdGE/OiAoZGF0YTogVW53cmFwUmV0dXJuPFQ+LCBwYWdpbmF0aW9uPzogUGFnaW5hdGlvbk9wdGlvbnM8VW53cmFwUmV0dXJuPFQ+PikgPT4gdm9pZCB8IFByb21pc2U8dm9pZD47XG4gIC8qKlxuICAgKiBDYWxsZWQgd2hlbiBhbiBleGVjdXRpb24gd2lsbCBzdGFydFxuICAgKi9cbiAgb25XaWxsRXhlY3V0ZT86IChwYXJhbWV0ZXJzOiBQYXJhbWV0ZXJzPFQ+KSA9PiB2b2lkO1xufTtcblxuLyoqXG4gKiBXcmFwcyBhbiBhc3luY2hyb25vdXMgZnVuY3Rpb24gb3IgYSBmdW5jdGlvbiB0aGF0IHJldHVybnMgYSBQcm9taXNlIGluIGFub3RoZXIgZnVuY3Rpb24sIGFuZCByZXR1cm5zIHRoZSB7QGxpbmsgQXN5bmNTdGF0ZX0gY29ycmVzcG9uZGluZyB0byB0aGUgZXhlY3V0aW9uIG9mIHRoZSBmdW5jdGlvbi5cbiAqXG4gKiBAcmVtYXJrIFRoaXMgb3ZlcmxvYWQgc2hvdWxkIGJlIHVzZWQgd2hlbiB3b3JraW5nIHdpdGggcGFnaW5hdGVkIGRhdGEgc291cmNlcy5cbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgXG4gKiBpbXBvcnQgeyBzZXRUaW1lb3V0IH0gZnJvbSBcIm5vZGU6dGltZXJzL3Byb21pc2VzXCI7XG4gKiBpbXBvcnQgeyB1c2VTdGF0ZSB9IGZyb20gXCJyZWFjdFwiO1xuICogaW1wb3J0IHsgTGlzdCB9IGZyb20gXCJAcmF5Y2FzdC9hcGlcIjtcbiAqIGltcG9ydCB7IHVzZVByb21pc2UgfSBmcm9tIFwiQHJheWNhc3QvdXRpbHNcIjtcbiAqXG4gKiBleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBDb21tYW5kKCkge1xuICogICBjb25zdCBbc2VhcmNoVGV4dCwgc2V0U2VhcmNoVGV4dF0gPSB1c2VTdGF0ZShcIlwiKTtcbiAqXG4gKiAgIGNvbnN0IHsgaXNMb2FkaW5nLCBkYXRhLCBwYWdpbmF0aW9uIH0gPSB1c2VQcm9taXNlKFxuICogICAgIChzZWFyY2hUZXh0OiBzdHJpbmcpID0+IGFzeW5jIChvcHRpb25zOiB7IHBhZ2U6IG51bWJlciB9KSA9PiB7XG4gKiAgICAgICBhd2FpdCBzZXRUaW1lb3V0KDIwMCk7XG4gKiAgICAgICBjb25zdCBuZXdEYXRhID0gQXJyYXkuZnJvbSh7IGxlbmd0aDogMjUgfSwgKF92LCBpbmRleCkgPT4gKHtcbiAqICAgICAgICAgaW5kZXgsXG4gKiAgICAgICAgIHBhZ2U6IG9wdGlvbnMucGFnZSxcbiAqICAgICAgICAgdGV4dDogc2VhcmNoVGV4dCxcbiAqICAgICAgIH0pKTtcbiAqICAgICAgIHJldHVybiB7IGRhdGE6IG5ld0RhdGEsIGhhc01vcmU6IG9wdGlvbnMucGFnZSA8IDEwIH07XG4gKiAgICAgfSxcbiAqICAgICBbc2VhcmNoVGV4dF1cbiAqICAgKTtcbiAqXG4gKiAgIHJldHVybiAoXG4gKiAgICAgPExpc3QgaXNMb2FkaW5nPXtpc0xvYWRpbmd9IG9uU2VhcmNoVGV4dENoYW5nZT17c2V0U2VhcmNoVGV4dH0gcGFnaW5hdGlvbj17cGFnaW5hdGlvbn0+XG4gKiAgICAgICB7ZGF0YT8ubWFwKChpdGVtKSA9PiAoXG4gKiAgICAgICAgIDxMaXN0Lkl0ZW1cbiAqICAgICAgICAgICBrZXk9e2Ake2l0ZW0ucGFnZX0gJHtpdGVtLmluZGV4fSAke2l0ZW0udGV4dH1gfVxuICogICAgICAgICAgIHRpdGxlPXtgUGFnZSAke2l0ZW0ucGFnZX0gSXRlbSAke2l0ZW0uaW5kZXh9YH1cbiAqICAgICAgICAgICBzdWJ0aXRsZT17aXRlbS50ZXh0fVxuICogICAgICAgICAvPlxuICogICAgICAgKSl9XG4gKiAgICAgPC9MaXN0PlxuICogICApO1xuICogfTtcbiAqIGBgYFxuICovXG5leHBvcnQgZnVuY3Rpb24gdXNlUHJvbWlzZTxUIGV4dGVuZHMgRnVuY3Rpb25SZXR1cm5pbmdQYWdpbmF0ZWRQcm9taXNlPFtdPj4oXG4gIGZuOiBULFxuKTogVXNlUHJvbWlzZVJldHVyblR5cGU8VW53cmFwUmV0dXJuPFQ+PjtcbmV4cG9ydCBmdW5jdGlvbiB1c2VQcm9taXNlPFQgZXh0ZW5kcyBGdW5jdGlvblJldHVybmluZ1BhZ2luYXRlZFByb21pc2U+KFxuICBmbjogVCxcbiAgYXJnczogUGFyYW1ldGVyczxUPixcbiAgb3B0aW9ucz86IFByb21pc2VPcHRpb25zPFQ+LFxuKTogVXNlUHJvbWlzZVJldHVyblR5cGU8VW53cmFwUmV0dXJuPFQ+PjtcblxuLyoqXG4gKiBXcmFwcyBhbiBhc3luY2hyb25vdXMgZnVuY3Rpb24gb3IgYSBmdW5jdGlvbiB0aGF0IHJldHVybnMgYSBQcm9taXNlIGFuZCByZXR1cm5zIHRoZSB7QGxpbmsgQXN5bmNTdGF0ZX0gY29ycmVzcG9uZGluZyB0byB0aGUgZXhlY3V0aW9uIG9mIHRoZSBmdW5jdGlvbi5cbiAqXG4gKiBAcmVtYXJrIFRoZSBmdW5jdGlvbiBpcyBhc3N1bWVkIHRvIGJlIGNvbnN0YW50IChlZy4gY2hhbmdpbmcgaXQgd29uJ3QgdHJpZ2dlciBhIHJldmFsaWRhdGlvbikuXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYFxuICogaW1wb3J0IHsgdXNlUHJvbWlzZSB9IGZyb20gJ0ByYXljYXN0L3V0aWxzJztcbiAqXG4gKiBleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBDb21tYW5kKCkge1xuICogICBjb25zdCBhYm9ydGFibGUgPSB1c2VSZWY8QWJvcnRDb250cm9sbGVyPigpO1xuICogICBjb25zdCB7IGlzTG9hZGluZywgZGF0YSwgcmV2YWxpZGF0ZSB9ID0gdXNlUHJvbWlzZShhc3luYyAodXJsOiBzdHJpbmcpID0+IHtcbiAqICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHVybCwgeyBzaWduYWw6IGFib3J0YWJsZS5jdXJyZW50Py5zaWduYWwgfSk7XG4gKiAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcmVzcG9uc2UudGV4dCgpO1xuICogICAgIHJldHVybiByZXN1bHRcbiAqICAgfSxcbiAqICAgWydodHRwczovL2FwaS5leGFtcGxlJ10sXG4gKiAgIHtcbiAqICAgICBhYm9ydGFibGVcbiAqICAgfSk7XG4gKlxuICogICByZXR1cm4gKFxuICogICAgIDxEZXRhaWxcbiAqICAgICAgIGlzTG9hZGluZz17aXNMb2FkaW5nfVxuICogICAgICAgbWFya2Rvd249e2RhdGF9XG4gKiAgICAgICBhY3Rpb25zPXtcbiAqICAgICAgICAgPEFjdGlvblBhbmVsPlxuICogICAgICAgICAgIDxBY3Rpb24gdGl0bGU9XCJSZWxvYWRcIiBvbkFjdGlvbj17KCkgPT4gcmV2YWxpZGF0ZSgpfSAvPlxuICogICAgICAgICA8L0FjdGlvblBhbmVsPlxuICogICAgICAgfVxuICogICAgIC8+XG4gKiAgICk7XG4gKiB9O1xuICogYGBgXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB1c2VQcm9taXNlPFQgZXh0ZW5kcyBGdW5jdGlvblJldHVybmluZ1Byb21pc2U8W10+PihmbjogVCk6IFVzZVByb21pc2VSZXR1cm5UeXBlPFVud3JhcFJldHVybjxUPj47XG5leHBvcnQgZnVuY3Rpb24gdXNlUHJvbWlzZTxUIGV4dGVuZHMgRnVuY3Rpb25SZXR1cm5pbmdQcm9taXNlPihcbiAgZm46IFQsXG4gIGFyZ3M6IFBhcmFtZXRlcnM8VD4sXG4gIG9wdGlvbnM/OiBQcm9taXNlT3B0aW9uczxUPixcbik6IFVzZVByb21pc2VSZXR1cm5UeXBlPFVud3JhcFJldHVybjxUPj47XG5cbmV4cG9ydCBmdW5jdGlvbiB1c2VQcm9taXNlPFQgZXh0ZW5kcyBGdW5jdGlvblJldHVybmluZ1Byb21pc2UgfCBGdW5jdGlvblJldHVybmluZ1BhZ2luYXRlZFByb21pc2U+KFxuICBmbjogVCxcbiAgYXJncz86IFBhcmFtZXRlcnM8VD4sXG4gIG9wdGlvbnM/OiBQcm9taXNlT3B0aW9uczxUPixcbik6IFVzZVByb21pc2VSZXR1cm5UeXBlPGFueT4ge1xuICBjb25zdCBsYXN0Q2FsbElkID0gdXNlUmVmKDApO1xuICBjb25zdCBbc3RhdGUsIHNldF0gPSB1c2VTdGF0ZTxBc3luY1N0YXRlPFVud3JhcFJldHVybjxUPj4+KHsgaXNMb2FkaW5nOiB0cnVlIH0pO1xuXG4gIGNvbnN0IGZuUmVmID0gdXNlTGF0ZXN0KGZuKTtcbiAgY29uc3QgbGF0ZXN0QWJvcnRhYmxlID0gdXNlTGF0ZXN0KG9wdGlvbnM/LmFib3J0YWJsZSk7XG4gIGNvbnN0IGxhdGVzdEFyZ3MgPSB1c2VMYXRlc3QoYXJncyB8fCBbXSk7XG4gIGNvbnN0IGxhdGVzdE9uRXJyb3IgPSB1c2VMYXRlc3Qob3B0aW9ucz8ub25FcnJvcik7XG4gIGNvbnN0IGxhdGVzdE9uRGF0YSA9IHVzZUxhdGVzdChvcHRpb25zPy5vbkRhdGEpO1xuICBjb25zdCBsYXRlc3RPbldpbGxFeGVjdXRlID0gdXNlTGF0ZXN0KG9wdGlvbnM/Lm9uV2lsbEV4ZWN1dGUpO1xuICBjb25zdCBsYXRlc3RGYWlsdXJlVG9hc3QgPSB1c2VMYXRlc3Qob3B0aW9ucz8uZmFpbHVyZVRvYXN0T3B0aW9ucyk7XG4gIGNvbnN0IGxhdGVzdFZhbHVlID0gdXNlTGF0ZXN0KHN0YXRlLmRhdGEpO1xuICBjb25zdCBsYXRlc3RDYWxsYmFjayA9IHVzZVJlZjwoLi4uYXJnczogUGFyYW1ldGVyczxUPikgPT4gUHJvbWlzZTxVbndyYXBSZXR1cm48VD4+PihudWxsKTtcblxuICBjb25zdCBwYWdpbmF0aW9uQXJnc1JlZiA9IHVzZVJlZjxQYWdpbmF0aW9uT3B0aW9ucz4oeyBwYWdlOiAwIH0pO1xuICBjb25zdCB1c2VQYWdpbmF0aW9uUmVmID0gdXNlUmVmKGZhbHNlKTtcbiAgY29uc3QgaGFzTW9yZVJlZiA9IHVzZVJlZih0cnVlKTtcbiAgY29uc3QgcGFnZVNpemVSZWYgPSB1c2VSZWYoNTApO1xuXG4gIGNvbnN0IGFib3J0ID0gdXNlQ2FsbGJhY2soKCkgPT4ge1xuICAgIGlmIChsYXRlc3RBYm9ydGFibGUuY3VycmVudCkge1xuICAgICAgbGF0ZXN0QWJvcnRhYmxlLmN1cnJlbnQuY3VycmVudD8uYWJvcnQoKTtcbiAgICAgIGxhdGVzdEFib3J0YWJsZS5jdXJyZW50LmN1cnJlbnQgPSBuZXcgQWJvcnRDb250cm9sbGVyKCk7XG4gICAgfVxuICAgIHJldHVybiArK2xhc3RDYWxsSWQuY3VycmVudDtcbiAgfSwgW2xhdGVzdEFib3J0YWJsZV0pO1xuXG4gIGNvbnN0IGNhbGxiYWNrID0gdXNlQ2FsbGJhY2soXG4gICAgKC4uLmFyZ3M6IFBhcmFtZXRlcnM8VD4pOiBQcm9taXNlPFVud3JhcFJldHVybjxUPj4gPT4ge1xuICAgICAgY29uc3QgY2FsbElkID0gYWJvcnQoKTtcblxuICAgICAgbGF0ZXN0T25XaWxsRXhlY3V0ZS5jdXJyZW50Py4oYXJncyk7XG5cbiAgICAgIHNldCgocHJldlN0YXRlKSA9PiAoeyAuLi5wcmV2U3RhdGUsIGlzTG9hZGluZzogdHJ1ZSB9KSk7XG5cbiAgICAgIGNvbnN0IHByb21pc2VPclBhZ2luYXRlZFByb21pc2UgPSBiaW5kUHJvbWlzZUlmTmVlZGVkKGZuUmVmLmN1cnJlbnQpKC4uLmFyZ3MpO1xuXG4gICAgICBmdW5jdGlvbiBoYW5kbGVFcnJvcihlcnJvcjogYW55KSB7XG4gICAgICAgIGlmIChlcnJvci5uYW1lID09IFwiQWJvcnRFcnJvclwiKSB7XG4gICAgICAgICAgcmV0dXJuIGVycm9yO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGNhbGxJZCA9PT0gbGFzdENhbGxJZC5jdXJyZW50KSB7XG4gICAgICAgICAgLy8gaGFuZGxlIGVycm9yc1xuICAgICAgICAgIGlmIChsYXRlc3RPbkVycm9yLmN1cnJlbnQpIHtcbiAgICAgICAgICAgIGxhdGVzdE9uRXJyb3IuY3VycmVudChlcnJvcik7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmIChlbnZpcm9ubWVudC5sYXVuY2hUeXBlICE9PSBMYXVuY2hUeXBlLkJhY2tncm91bmQpIHtcbiAgICAgICAgICAgICAgc2hvd0ZhaWx1cmVUb2FzdChlcnJvciwge1xuICAgICAgICAgICAgICAgIHRpdGxlOiBcIkZhaWxlZCB0byBmZXRjaCBsYXRlc3QgZGF0YVwiLFxuICAgICAgICAgICAgICAgIHByaW1hcnlBY3Rpb246IHtcbiAgICAgICAgICAgICAgICAgIHRpdGxlOiBcIlJldHJ5XCIsXG4gICAgICAgICAgICAgICAgICBvbkFjdGlvbih0b2FzdCkge1xuICAgICAgICAgICAgICAgICAgICB0b2FzdC5oaWRlKCk7XG4gICAgICAgICAgICAgICAgICAgIGxhdGVzdENhbGxiYWNrLmN1cnJlbnQ/LiguLi4oKGxhdGVzdEFyZ3MuY3VycmVudCB8fCBbXSkgYXMgUGFyYW1ldGVyczxUPikpO1xuICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIC4uLmxhdGVzdEZhaWx1cmVUb2FzdC5jdXJyZW50LFxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgc2V0KHsgZXJyb3IsIGlzTG9hZGluZzogZmFsc2UgfSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gZXJyb3I7XG4gICAgICB9XG5cbiAgICAgIGlmICh0eXBlb2YgcHJvbWlzZU9yUGFnaW5hdGVkUHJvbWlzZSA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgIHVzZVBhZ2luYXRpb25SZWYuY3VycmVudCA9IHRydWU7XG4gICAgICAgIHJldHVybiBwcm9taXNlT3JQYWdpbmF0ZWRQcm9taXNlKHBhZ2luYXRpb25BcmdzUmVmLmN1cnJlbnQpLnRoZW4oXG4gICAgICAgICAgLy8gQHRzLWV4cGVjdC1lcnJvciB0b28gY29tcGxpY2F0ZWQgZm9yIFRTXG4gICAgICAgICAgKHsgZGF0YSwgaGFzTW9yZSwgY3Vyc29yIH06IHsgZGF0YTogVW53cmFwUmV0dXJuPFQ+OyBoYXNNb3JlOiBib29sZWFuOyBjdXJzb3I/OiBhbnkgfSkgPT4ge1xuICAgICAgICAgICAgaWYgKGNhbGxJZCA9PT0gbGFzdENhbGxJZC5jdXJyZW50KSB7XG4gICAgICAgICAgICAgIGlmIChwYWdpbmF0aW9uQXJnc1JlZi5jdXJyZW50KSB7XG4gICAgICAgICAgICAgICAgcGFnaW5hdGlvbkFyZ3NSZWYuY3VycmVudC5jdXJzb3IgPSBjdXJzb3I7XG4gICAgICAgICAgICAgICAgcGFnaW5hdGlvbkFyZ3NSZWYuY3VycmVudC5sYXN0SXRlbSA9IGRhdGE/LltkYXRhLmxlbmd0aCAtIDFdO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgaWYgKGxhdGVzdE9uRGF0YS5jdXJyZW50KSB7XG4gICAgICAgICAgICAgICAgbGF0ZXN0T25EYXRhLmN1cnJlbnQoZGF0YSwgcGFnaW5hdGlvbkFyZ3NSZWYuY3VycmVudCk7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBpZiAoaGFzTW9yZSkge1xuICAgICAgICAgICAgICAgIHBhZ2VTaXplUmVmLmN1cnJlbnQgPSBkYXRhLmxlbmd0aDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBoYXNNb3JlUmVmLmN1cnJlbnQgPSBoYXNNb3JlO1xuXG4gICAgICAgICAgICAgIHNldCgocHJldmlvdXNEYXRhKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKHBhZ2luYXRpb25BcmdzUmVmLmN1cnJlbnQucGFnZSA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIHsgZGF0YSwgaXNMb2FkaW5nOiBmYWxzZSB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBAdHMtZXhwZWN0LWVycm9yIHdlIGtub3cgaXQncyBhbiBhcnJheSBoZXJlXG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgZGF0YTogKHByZXZpb3VzRGF0YS5kYXRhIHx8IFtdKT8uY29uY2F0KGRhdGEpLCBpc0xvYWRpbmc6IGZhbHNlIH07XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gZGF0YTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIChlcnJvcjogdW5rbm93bikgPT4ge1xuICAgICAgICAgICAgaGFzTW9yZVJlZi5jdXJyZW50ID0gZmFsc2U7XG4gICAgICAgICAgICByZXR1cm4gaGFuZGxlRXJyb3IoZXJyb3IpO1xuICAgICAgICAgIH0sXG4gICAgICAgICkgYXMgUHJvbWlzZTxVbndyYXBSZXR1cm48VD4+O1xuICAgICAgfVxuXG4gICAgICB1c2VQYWdpbmF0aW9uUmVmLmN1cnJlbnQgPSBmYWxzZTtcbiAgICAgIHJldHVybiBwcm9taXNlT3JQYWdpbmF0ZWRQcm9taXNlLnRoZW4oKGRhdGE6IFVud3JhcFJldHVybjxUPikgPT4ge1xuICAgICAgICBpZiAoY2FsbElkID09PSBsYXN0Q2FsbElkLmN1cnJlbnQpIHtcbiAgICAgICAgICBpZiAobGF0ZXN0T25EYXRhLmN1cnJlbnQpIHtcbiAgICAgICAgICAgIGxhdGVzdE9uRGF0YS5jdXJyZW50KGRhdGEpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBzZXQoeyBkYXRhLCBpc0xvYWRpbmc6IGZhbHNlIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgICB9LCBoYW5kbGVFcnJvcikgYXMgUHJvbWlzZTxVbndyYXBSZXR1cm48VD4+O1xuICAgIH0sXG4gICAgW1xuICAgICAgbGF0ZXN0T25EYXRhLFxuICAgICAgbGF0ZXN0T25FcnJvcixcbiAgICAgIGxhdGVzdEFyZ3MsXG4gICAgICBmblJlZixcbiAgICAgIHNldCxcbiAgICAgIGxhdGVzdENhbGxiYWNrLFxuICAgICAgbGF0ZXN0T25XaWxsRXhlY3V0ZSxcbiAgICAgIHBhZ2luYXRpb25BcmdzUmVmLFxuICAgICAgbGF0ZXN0RmFpbHVyZVRvYXN0LFxuICAgICAgYWJvcnQsXG4gICAgXSxcbiAgKTtcblxuICBsYXRlc3RDYWxsYmFjay5jdXJyZW50ID0gY2FsbGJhY2s7XG5cbiAgY29uc3QgcmV2YWxpZGF0ZSA9IHVzZUNhbGxiYWNrKCgpID0+IHtcbiAgICAvLyByZXNldCB0aGUgcGFnaW5hdGlvblxuICAgIHBhZ2luYXRpb25BcmdzUmVmLmN1cnJlbnQgPSB7IHBhZ2U6IDAgfTtcblxuICAgIGNvbnN0IGFyZ3MgPSAobGF0ZXN0QXJncy5jdXJyZW50IHx8IFtdKSBhcyBQYXJhbWV0ZXJzPFQ+O1xuICAgIHJldHVybiBjYWxsYmFjayguLi5hcmdzKTtcbiAgfSwgW2NhbGxiYWNrLCBsYXRlc3RBcmdzXSk7XG5cbiAgY29uc3QgbXV0YXRlID0gdXNlQ2FsbGJhY2s8TXV0YXRlUHJvbWlzZTxBd2FpdGVkPFJldHVyblR5cGU8VD4+LCB1bmRlZmluZWQ+PihcbiAgICBhc3luYyAoYXN5bmNVcGRhdGUsIG9wdGlvbnMpID0+IHtcbiAgICAgIGxldCBkYXRhQmVmb3JlT3B0aW1pc3RpY1VwZGF0ZTogQXdhaXRlZDxSZXR1cm5UeXBlPFQ+PiB8IHVuZGVmaW5lZDtcbiAgICAgIHRyeSB7XG4gICAgICAgIGlmIChvcHRpb25zPy5vcHRpbWlzdGljVXBkYXRlKSB7XG4gICAgICAgICAgLy8gY2FuY2VsIHRoZSBpbi1mbGlnaHQgcmVxdWVzdCB0byBtYWtlIHN1cmUgaXQgd29uJ3Qgb3ZlcndyaXRlIHRoZSBvcHRpbWlzdGljIHVwZGF0ZVxuICAgICAgICAgIGFib3J0KCk7XG5cbiAgICAgICAgICBpZiAodHlwZW9mIG9wdGlvbnM/LnJvbGxiYWNrT25FcnJvciAhPT0gXCJmdW5jdGlvblwiICYmIG9wdGlvbnM/LnJvbGxiYWNrT25FcnJvciAhPT0gZmFsc2UpIHtcbiAgICAgICAgICAgIC8vIGtlZXAgdHJhY2sgb2YgdGhlIGRhdGEgYmVmb3JlIHRoZSBvcHRpbWlzdGljIHVwZGF0ZSxcbiAgICAgICAgICAgIC8vIGJ1dCBvbmx5IGlmIHdlIG5lZWQgaXQgKGVnLiBvbmx5IHdoZW4gd2Ugd2FudCB0byBhdXRvbWF0aWNhbGx5IHJvbGxiYWNrIGFmdGVyKVxuICAgICAgICAgICAgZGF0YUJlZm9yZU9wdGltaXN0aWNVcGRhdGUgPSBzdHJ1Y3R1cmVkQ2xvbmUobGF0ZXN0VmFsdWUuY3VycmVudD8udmFsdWUpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCB1cGRhdGUgPSBvcHRpb25zLm9wdGltaXN0aWNVcGRhdGU7XG4gICAgICAgICAgc2V0KChwcmV2U3RhdGUpID0+ICh7IC4uLnByZXZTdGF0ZSwgZGF0YTogdXBkYXRlKHByZXZTdGF0ZS5kYXRhKSB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGF3YWl0IGFzeW5jVXBkYXRlO1xuICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgIGlmICh0eXBlb2Ygb3B0aW9ucz8ucm9sbGJhY2tPbkVycm9yID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICBjb25zdCB1cGRhdGUgPSBvcHRpb25zLnJvbGxiYWNrT25FcnJvcjtcbiAgICAgICAgICBzZXQoKHByZXZTdGF0ZSkgPT4gKHsgLi4ucHJldlN0YXRlLCBkYXRhOiB1cGRhdGUocHJldlN0YXRlLmRhdGEpIH0pKTtcbiAgICAgICAgfSBlbHNlIGlmIChvcHRpb25zPy5vcHRpbWlzdGljVXBkYXRlICYmIG9wdGlvbnM/LnJvbGxiYWNrT25FcnJvciAhPT0gZmFsc2UpIHtcbiAgICAgICAgICBzZXQoKHByZXZTdGF0ZSkgPT4gKHsgLi4ucHJldlN0YXRlLCBkYXRhOiBkYXRhQmVmb3JlT3B0aW1pc3RpY1VwZGF0ZSB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhyb3cgZXJyO1xuICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgaWYgKG9wdGlvbnM/LnNob3VsZFJldmFsaWRhdGVBZnRlciAhPT0gZmFsc2UpIHtcbiAgICAgICAgICBpZiAoZW52aXJvbm1lbnQubGF1bmNoVHlwZSA9PT0gTGF1bmNoVHlwZS5CYWNrZ3JvdW5kIHx8IGVudmlyb25tZW50LmNvbW1hbmRNb2RlID09PSBcIm1lbnUtYmFyXCIpIHtcbiAgICAgICAgICAgIC8vIHdoZW4gaW4gdGhlIGJhY2tncm91bmQgb3IgaW4gYSBtZW51IGJhciwgd2UgYXJlIGdvaW5nIHRvIGF3YWl0IHRoZSByZXZhbGlkYXRpb25cbiAgICAgICAgICAgIC8vIHRvIG1ha2Ugc3VyZSB3ZSBnZXQgdGhlIHJpZ2h0IGRhdGEgYXQgdGhlIGVuZCBvZiB0aGUgbXV0YXRpb25cbiAgICAgICAgICAgIGF3YWl0IHJldmFsaWRhdGUoKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV2YWxpZGF0ZSgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sXG4gICAgW3JldmFsaWRhdGUsIGxhdGVzdFZhbHVlLCBzZXQsIGFib3J0XSxcbiAgKTtcblxuICBjb25zdCBvbkxvYWRNb3JlID0gdXNlQ2FsbGJhY2soKCkgPT4ge1xuICAgIHBhZ2luYXRpb25BcmdzUmVmLmN1cnJlbnQucGFnZSArPSAxO1xuICAgIGNvbnN0IGFyZ3MgPSAobGF0ZXN0QXJncy5jdXJyZW50IHx8IFtdKSBhcyBQYXJhbWV0ZXJzPFQ+O1xuICAgIGNhbGxiYWNrKC4uLmFyZ3MpO1xuICB9LCBbcGFnaW5hdGlvbkFyZ3NSZWYsIGxhdGVzdEFyZ3MsIGNhbGxiYWNrXSk7XG5cbiAgLy8gcmV2YWxpZGF0ZSB3aGVuIHRoZSBhcmdzIGNoYW5nZVxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIC8vIHJlc2V0IHRoZSBwYWdpbmF0aW9uXG4gICAgcGFnaW5hdGlvbkFyZ3NSZWYuY3VycmVudCA9IHsgcGFnZTogMCB9O1xuXG4gICAgaWYgKG9wdGlvbnM/LmV4ZWN1dGUgIT09IGZhbHNlKSB7XG4gICAgICBjYWxsYmFjayguLi4oKGFyZ3MgfHwgW10pIGFzIFBhcmFtZXRlcnM8VD4pKTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gY2FuY2VsIHRoZSBwcmV2aW91cyByZXF1ZXN0IGlmIHdlIGRvbid0IHdhbnQgdG8gZXhlY3V0ZSBhbnltb3JlXG4gICAgICBhYm9ydCgpO1xuICAgIH1cbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcmVhY3QtaG9va3MvZXhoYXVzdGl2ZS1kZXBzXG4gIH0sIFt1c2VEZWVwTWVtbyhbYXJncywgb3B0aW9ucz8uZXhlY3V0ZSwgY2FsbGJhY2tdKSwgbGF0ZXN0QWJvcnRhYmxlLCBwYWdpbmF0aW9uQXJnc1JlZl0pO1xuXG4gIC8vIGFib3J0IHJlcXVlc3Qgd2hlbiB1bm1vdW50aW5nXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgIGFib3J0KCk7XG4gICAgfTtcbiAgfSwgW2Fib3J0XSk7XG5cbiAgLy8gd2Ugb25seSB3YW50IHRvIHNob3cgdGhlIGxvYWRpbmcgaW5kaWNhdG9yIGlmIHRoZSBwcm9taXNlIGlzIGV4ZWN1dGluZ1xuICBjb25zdCBpc0xvYWRpbmcgPSBvcHRpb25zPy5leGVjdXRlICE9PSBmYWxzZSA/IHN0YXRlLmlzTG9hZGluZyA6IGZhbHNlO1xuXG4gIC8vIEB0cy1leHBlY3QtZXJyb3IgbG9hZGluZyBpcyBoYXMgc29tZSBmaXhlZCB2YWx1ZSBpbiB0aGUgZW51bSB3aGljaFxuICBjb25zdCBzdGF0ZVdpdGhMb2FkaW5nRml4ZWQ6IEFzeW5jU3RhdGU8QXdhaXRlZDxSZXR1cm5UeXBlPFQ+Pj4gPSB7IC4uLnN0YXRlLCBpc0xvYWRpbmcgfTtcblxuICBjb25zdCBwYWdpbmF0aW9uID0gdXNlUGFnaW5hdGlvblJlZi5jdXJyZW50XG4gICAgPyB7XG4gICAgICAgIHBhZ2VTaXplOiBwYWdlU2l6ZVJlZi5jdXJyZW50LFxuICAgICAgICBoYXNNb3JlOiBoYXNNb3JlUmVmLmN1cnJlbnQsXG4gICAgICAgIG9uTG9hZE1vcmUsXG4gICAgICB9XG4gICAgOiB1bmRlZmluZWQ7XG5cbiAgcmV0dXJuIHsgLi4uc3RhdGVXaXRoTG9hZGluZ0ZpeGVkLCByZXZhbGlkYXRlLCBtdXRhdGUsIHBhZ2luYXRpb24gfTtcbn1cblxuLyoqIEJpbmQgdGhlIGZuIGlmIGl0J3MgYSBQcm9taXNlIG1ldGhvZCAqL1xuZnVuY3Rpb24gYmluZFByb21pc2VJZk5lZWRlZDxUPihmbjogVCk6IFQge1xuICBpZiAoZm4gPT09IChQcm9taXNlLmFsbCBhcyBhbnkpKSB7XG4gICAgLy8gQHRzLWV4cGVjdC1lcnJvciB0aGlzIGlzIGZpbmVcbiAgICByZXR1cm4gZm4uYmluZChQcm9taXNlKTtcbiAgfVxuICBpZiAoZm4gPT09IChQcm9taXNlLnJhY2UgYXMgYW55KSkge1xuICAgIC8vIEB0cy1leHBlY3QtZXJyb3IgdGhpcyBpcyBmaW5lXG4gICAgcmV0dXJuIGZuLmJpbmQoUHJvbWlzZSk7XG4gIH1cbiAgaWYgKGZuID09PSAoUHJvbWlzZS5yZXNvbHZlIGFzIGFueSkpIHtcbiAgICAvLyBAdHMtZXhwZWN0LWVycm9yIHRoaXMgaXMgZmluZVxuICAgIHJldHVybiBmbi5iaW5kKFByb21pc2UgYXMgYW55KTtcbiAgfVxuICBpZiAoZm4gPT09IChQcm9taXNlLnJlamVjdCBhcyBhbnkpKSB7XG4gICAgLy8gQHRzLWV4cGVjdC1lcnJvciB0aGlzIGlzIGZpbmVcbiAgICByZXR1cm4gZm4uYmluZChQcm9taXNlKTtcbiAgfVxuICByZXR1cm4gZm47XG59XG4iLCAiaW1wb3J0IHsgdXNlUmVmLCB1c2VNZW1vIH0gZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgeyBkZXF1YWwgfSBmcm9tIFwiZGVxdWFsL2xpdGVcIjtcblxuLyoqXG4gKiBAcGFyYW0gdmFsdWUgdGhlIHZhbHVlIHRvIGJlIG1lbW9pemVkICh1c3VhbGx5IGEgZGVwZW5kZW5jeSBsaXN0KVxuICogQHJldHVybnMgYSBtZW1vaXplZCB2ZXJzaW9uIG9mIHRoZSB2YWx1ZSBhcyBsb25nIGFzIGl0IHJlbWFpbnMgZGVlcGx5IGVxdWFsXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB1c2VEZWVwTWVtbzxUPih2YWx1ZTogVCkge1xuICBjb25zdCByZWYgPSB1c2VSZWY8VD4odmFsdWUpO1xuICBjb25zdCBzaWduYWxSZWYgPSB1c2VSZWY8bnVtYmVyPigwKTtcblxuICBpZiAoIWRlcXVhbCh2YWx1ZSwgcmVmLmN1cnJlbnQpKSB7XG4gICAgcmVmLmN1cnJlbnQgPSB2YWx1ZTtcbiAgICBzaWduYWxSZWYuY3VycmVudCArPSAxO1xuICB9XG5cbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHJlYWN0LWhvb2tzL2V4aGF1c3RpdmUtZGVwc1xuICByZXR1cm4gdXNlTWVtbygoKSA9PiByZWYuY3VycmVudCwgW3NpZ25hbFJlZi5jdXJyZW50XSk7XG59XG4iLCAiaW1wb3J0IHsgdXNlUmVmIH0gZnJvbSBcInJlYWN0XCI7XG5cbi8qKlxuICogUmV0dXJucyB0aGUgbGF0ZXN0IHN0YXRlLlxuICpcbiAqIFRoaXMgaXMgbW9zdGx5IHVzZWZ1bCB0byBnZXQgYWNjZXNzIHRvIHRoZSBsYXRlc3QgdmFsdWUgb2Ygc29tZSBwcm9wcyBvciBzdGF0ZSBpbnNpZGUgYW4gYXN5bmNocm9ub3VzIGNhbGxiYWNrLCBpbnN0ZWFkIG9mIHRoYXQgdmFsdWUgYXQgdGhlIHRpbWUgdGhlIGNhbGxiYWNrIHdhcyBjcmVhdGVkIGZyb20uXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB1c2VMYXRlc3Q8VD4odmFsdWU6IFQpOiB7IHJlYWRvbmx5IGN1cnJlbnQ6IFQgfSB7XG4gIGNvbnN0IHJlZiA9IHVzZVJlZih2YWx1ZSk7XG4gIHJlZi5jdXJyZW50ID0gdmFsdWU7XG4gIHJldHVybiByZWY7XG59XG4iLCAiaW1wb3J0ICogYXMgZnMgZnJvbSBcIm5vZGU6ZnNcIjtcbmltcG9ydCAqIGFzIHBhdGggZnJvbSBcIm5vZGU6cGF0aFwiO1xuaW1wb3J0IHsgQ2xpcGJvYXJkLCBlbnZpcm9ubWVudCwgb3BlbiwgVG9hc3QsIHNob3dUb2FzdCB9IGZyb20gXCJAcmF5Y2FzdC9hcGlcIjtcblxuLyoqXG4gKiBTaG93cyBhIGZhaWx1cmUgVG9hc3QgZm9yIGEgZ2l2ZW4gRXJyb3IuXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYHR5cGVzY3JpcHRcbiAqIGltcG9ydCB7IHNob3dIVUQgfSBmcm9tIFwiQHJheWNhc3QvYXBpXCI7XG4gKiBpbXBvcnQgeyBydW5BcHBsZVNjcmlwdCwgc2hvd0ZhaWx1cmVUb2FzdCB9IGZyb20gXCJAcmF5Y2FzdC91dGlsc1wiO1xuICpcbiAqIGV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAqICAgdHJ5IHtcbiAqICAgICBjb25zdCByZXMgPSBhd2FpdCBydW5BcHBsZVNjcmlwdChcbiAqICAgICAgIGBcbiAqICAgICAgIG9uIHJ1biBhcmd2XG4gKiAgICAgICAgIHJldHVybiBcImhlbGxvLCBcIiAmIGl0ZW0gMSBvZiBhcmd2ICYgXCIuXCJcbiAqICAgICAgIGVuZCBydW5cbiAqICAgICAgIGAsXG4gKiAgICAgICBbXCJ3b3JsZFwiXVxuICogICAgICk7XG4gKiAgICAgYXdhaXQgc2hvd0hVRChyZXMpO1xuICogICB9IGNhdGNoIChlcnJvcikge1xuICogICAgIHNob3dGYWlsdXJlVG9hc3QoZXJyb3IsIHsgdGl0bGU6IFwiQ291bGQgbm90IHJ1biBBcHBsZVNjcmlwdFwiIH0pO1xuICogICB9XG4gKiB9XG4gKiBgYGBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNob3dGYWlsdXJlVG9hc3QoXG4gIGVycm9yOiB1bmtub3duLFxuICBvcHRpb25zPzogUGFydGlhbDxQaWNrPFRvYXN0Lk9wdGlvbnMsIFwidGl0bGVcIiB8IFwicHJpbWFyeUFjdGlvblwiIHwgXCJtZXNzYWdlXCI+Pixcbikge1xuICBjb25zdCBtZXNzYWdlID0gZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBTdHJpbmcoZXJyb3IpO1xuICByZXR1cm4gc2hvd1RvYXN0KHtcbiAgICBzdHlsZTogVG9hc3QuU3R5bGUuRmFpbHVyZSxcbiAgICB0aXRsZTogb3B0aW9ucz8udGl0bGUgPz8gXCJTb21ldGhpbmcgd2VudCB3cm9uZ1wiLFxuICAgIG1lc3NhZ2U6IG9wdGlvbnM/Lm1lc3NhZ2UgPz8gbWVzc2FnZSxcbiAgICBwcmltYXJ5QWN0aW9uOiBvcHRpb25zPy5wcmltYXJ5QWN0aW9uID8/IGhhbmRsZUVycm9yVG9hc3RBY3Rpb24oZXJyb3IpLFxuICAgIHNlY29uZGFyeUFjdGlvbjogb3B0aW9ucz8ucHJpbWFyeUFjdGlvbiA/IGhhbmRsZUVycm9yVG9hc3RBY3Rpb24oZXJyb3IpIDogdW5kZWZpbmVkLFxuICB9KTtcbn1cblxuY29uc3QgaGFuZGxlRXJyb3JUb2FzdEFjdGlvbiA9IChlcnJvcjogdW5rbm93bik6IFRvYXN0LkFjdGlvbk9wdGlvbnMgPT4ge1xuICBsZXQgcHJpdmF0ZUV4dGVuc2lvbiA9IHRydWU7XG4gIGxldCB0aXRsZSA9IFwiW0V4dGVuc2lvbiBOYW1lXS4uLlwiO1xuICBsZXQgZXh0ZW5zaW9uVVJMID0gXCJcIjtcbiAgdHJ5IHtcbiAgICBjb25zdCBwYWNrYWdlSlNPTiA9IEpTT04ucGFyc2UoZnMucmVhZEZpbGVTeW5jKHBhdGguam9pbihlbnZpcm9ubWVudC5hc3NldHNQYXRoLCBcIi4uXCIsIFwicGFja2FnZS5qc29uXCIpLCBcInV0ZjhcIikpO1xuICAgIHRpdGxlID0gYFske3BhY2thZ2VKU09OLnRpdGxlfV0uLi5gO1xuICAgIGV4dGVuc2lvblVSTCA9IGBodHRwczovL3JheWNhc3QuY29tLyR7cGFja2FnZUpTT04ub3duZXIgfHwgcGFja2FnZUpTT04uYXV0aG9yfS8ke3BhY2thZ2VKU09OLm5hbWV9YDtcbiAgICBpZiAoIXBhY2thZ2VKU09OLm93bmVyIHx8IHBhY2thZ2VKU09OLmFjY2VzcyA9PT0gXCJwdWJsaWNcIikge1xuICAgICAgcHJpdmF0ZUV4dGVuc2lvbiA9IGZhbHNlO1xuICAgIH1cbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgLy8gbm8tb3BcbiAgfVxuXG4gIC8vIGlmIGl0J3MgYSBwcml2YXRlIGV4dGVuc2lvbiwgd2UgY2FuJ3QgY29uc3RydWN0IHRoZSBVUkwgdG8gcmVwb3J0IHRoZSBlcnJvclxuICAvLyBzbyB3ZSBmYWxsYmFjayB0byBjb3B5aW5nIHRoZSBlcnJvciB0byB0aGUgY2xpcGJvYXJkXG4gIGNvbnN0IGZhbGxiYWNrID0gZW52aXJvbm1lbnQuaXNEZXZlbG9wbWVudCB8fCBwcml2YXRlRXh0ZW5zaW9uO1xuXG4gIGNvbnN0IHN0YWNrID0gZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yPy5zdGFjayB8fCBlcnJvcj8ubWVzc2FnZSB8fCBcIlwiIDogU3RyaW5nKGVycm9yKTtcblxuICByZXR1cm4ge1xuICAgIHRpdGxlOiBmYWxsYmFjayA/IFwiQ29weSBMb2dzXCIgOiBcIlJlcG9ydCBFcnJvclwiLFxuICAgIG9uQWN0aW9uKHRvYXN0KSB7XG4gICAgICB0b2FzdC5oaWRlKCk7XG4gICAgICBpZiAoZmFsbGJhY2spIHtcbiAgICAgICAgQ2xpcGJvYXJkLmNvcHkoc3RhY2spO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgb3BlbihcbiAgICAgICAgICBgaHR0cHM6Ly9naXRodWIuY29tL3JheWNhc3QvZXh0ZW5zaW9ucy9pc3N1ZXMvbmV3PyZsYWJlbHM9ZXh0ZW5zaW9uJTJDYnVnJnRlbXBsYXRlPWV4dGVuc2lvbl9idWdfcmVwb3J0LnltbCZ0aXRsZT0ke2VuY29kZVVSSUNvbXBvbmVudChcbiAgICAgICAgICAgIHRpdGxlLFxuICAgICAgICAgICl9JmV4dGVuc2lvbi11cmw9JHtlbmNvZGVVUkkoZXh0ZW5zaW9uVVJMKX0mZGVzY3JpcHRpb249JHtlbmNvZGVVUklDb21wb25lbnQoXG4gICAgICAgICAgICBgIyMjIyBFcnJvcjpcblxcYFxcYFxcYFxuJHtzdGFja31cblxcYFxcYFxcYFxuYCxcbiAgICAgICAgICApfWAsXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfSxcbiAgfTtcbn07XG4iLCAiaW1wb3J0IHsgdXNlQ2FsbGJhY2ssIERpc3BhdGNoLCBTZXRTdGF0ZUFjdGlvbiwgdXNlU3luY0V4dGVybmFsU3RvcmUsIHVzZU1lbW8gfSBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCB7IENhY2hlIH0gZnJvbSBcIkByYXljYXN0L2FwaVwiO1xuaW1wb3J0IHsgdXNlTGF0ZXN0IH0gZnJvbSBcIi4vdXNlTGF0ZXN0XCI7XG5pbXBvcnQgeyByZXBsYWNlciwgcmV2aXZlciB9IGZyb20gXCIuL2hlbHBlcnNcIjtcblxuY29uc3Qgcm9vdENhY2hlID0gLyogI19fUFVSRV9fICovIFN5bWJvbChcImNhY2hlIHdpdGhvdXQgbmFtZXNwYWNlXCIpO1xuY29uc3QgY2FjaGVNYXAgPSAvKiAjX19QVVJFX18gKi8gbmV3IE1hcDxzdHJpbmcgfCBzeW1ib2wsIENhY2hlPigpO1xuXG4vKipcbiAqIFJldHVybnMgYSBzdGF0ZWZ1bCB2YWx1ZSwgYW5kIGEgZnVuY3Rpb24gdG8gdXBkYXRlIGl0LiBUaGUgdmFsdWUgd2lsbCBiZSBrZXB0IGJldHdlZW4gY29tbWFuZCBydW5zLlxuICpcbiAqIEByZW1hcmsgVGhlIHZhbHVlIG5lZWRzIHRvIGJlIEpTT04gc2VyaWFsaXphYmxlLlxuICpcbiAqIEBwYXJhbSBrZXkgLSBUaGUgdW5pcXVlIGlkZW50aWZpZXIgb2YgdGhlIHN0YXRlLiBUaGlzIGNhbiBiZSB1c2VkIHRvIHNoYXJlIHRoZSBzdGF0ZSBhY3Jvc3MgY29tcG9uZW50cyBhbmQvb3IgY29tbWFuZHMuXG4gKiBAcGFyYW0gaW5pdGlhbFN0YXRlIC0gVGhlIGluaXRpYWwgdmFsdWUgb2YgdGhlIHN0YXRlIGlmIHRoZXJlIGFyZW4ndCBhbnkgaW4gdGhlIENhY2hlIHlldC5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHVzZUNhY2hlZFN0YXRlPFQ+KFxuICBrZXk6IHN0cmluZyxcbiAgaW5pdGlhbFN0YXRlOiBULFxuICBjb25maWc/OiB7IGNhY2hlTmFtZXNwYWNlPzogc3RyaW5nIH0sXG4pOiBbVCwgRGlzcGF0Y2g8U2V0U3RhdGVBY3Rpb248VD4+XTtcbmV4cG9ydCBmdW5jdGlvbiB1c2VDYWNoZWRTdGF0ZTxUID0gdW5kZWZpbmVkPihrZXk6IHN0cmluZyk6IFtUIHwgdW5kZWZpbmVkLCBEaXNwYXRjaDxTZXRTdGF0ZUFjdGlvbjxUIHwgdW5kZWZpbmVkPj5dO1xuZXhwb3J0IGZ1bmN0aW9uIHVzZUNhY2hlZFN0YXRlPFQ+KFxuICBrZXk6IHN0cmluZyxcbiAgaW5pdGlhbFN0YXRlPzogVCxcbiAgY29uZmlnPzogeyBjYWNoZU5hbWVzcGFjZT86IHN0cmluZyB9LFxuKTogW1QsIERpc3BhdGNoPFNldFN0YXRlQWN0aW9uPFQ+Pl0ge1xuICBjb25zdCBjYWNoZUtleSA9IGNvbmZpZz8uY2FjaGVOYW1lc3BhY2UgfHwgcm9vdENhY2hlO1xuICBjb25zdCBjYWNoZSA9XG4gICAgY2FjaGVNYXAuZ2V0KGNhY2hlS2V5KSB8fCBjYWNoZU1hcC5zZXQoY2FjaGVLZXksIG5ldyBDYWNoZSh7IG5hbWVzcGFjZTogY29uZmlnPy5jYWNoZU5hbWVzcGFjZSB9KSkuZ2V0KGNhY2hlS2V5KTtcblxuICBpZiAoIWNhY2hlKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiTWlzc2luZyBjYWNoZVwiKTtcbiAgfVxuXG4gIGNvbnN0IGtleVJlZiA9IHVzZUxhdGVzdChrZXkpO1xuICBjb25zdCBpbml0aWFsVmFsdWVSZWYgPSB1c2VMYXRlc3QoaW5pdGlhbFN0YXRlKTtcblxuICBjb25zdCBjYWNoZWRTdGF0ZSA9IHVzZVN5bmNFeHRlcm5hbFN0b3JlKGNhY2hlLnN1YnNjcmliZSwgKCkgPT4ge1xuICAgIHRyeSB7XG4gICAgICByZXR1cm4gY2FjaGUuZ2V0KGtleVJlZi5jdXJyZW50KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihcIkNvdWxkIG5vdCBnZXQgQ2FjaGUgZGF0YTpcIiwgZXJyb3IpO1xuICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG4gIH0pO1xuXG4gIGNvbnN0IHN0YXRlID0gdXNlTWVtbygoKSA9PiB7XG4gICAgaWYgKHR5cGVvZiBjYWNoZWRTdGF0ZSAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgaWYgKGNhY2hlZFN0YXRlID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICB9XG4gICAgICB0cnkge1xuICAgICAgICByZXR1cm4gSlNPTi5wYXJzZShjYWNoZWRTdGF0ZSwgcmV2aXZlcik7XG4gICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgLy8gdGhlIGRhdGEgZ290IGNvcnJ1cHRlZCBzb21laG93XG4gICAgICAgIGNvbnNvbGUud2FybihcIlRoZSBjYWNoZWQgZGF0YSBpcyBjb3JydXB0ZWRcIiwgZXJyKTtcbiAgICAgICAgcmV0dXJuIGluaXRpYWxWYWx1ZVJlZi5jdXJyZW50O1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gaW5pdGlhbFZhbHVlUmVmLmN1cnJlbnQ7XG4gICAgfVxuICB9LCBbY2FjaGVkU3RhdGUsIGluaXRpYWxWYWx1ZVJlZl0pO1xuXG4gIGNvbnN0IHN0YXRlUmVmID0gdXNlTGF0ZXN0KHN0YXRlKTtcblxuICBjb25zdCBzZXRTdGF0ZUFuZENhY2hlID0gdXNlQ2FsbGJhY2soXG4gICAgKHVwZGF0ZXI6IFNldFN0YXRlQWN0aW9uPFQ+KSA9PiB7XG4gICAgICAvLyBAdHMtZXhwZWN0LWVycm9yIFRTIHN0cnVnZ2xlcyB0byBpbmZlciB0aGUgdHlwZXMgYXMgVCBjb3VsZCBwb3RlbnRpYWxseSBiZSBhIGZ1bmN0aW9uXG4gICAgICBjb25zdCBuZXdWYWx1ZSA9IHR5cGVvZiB1cGRhdGVyID09PSBcImZ1bmN0aW9uXCIgPyB1cGRhdGVyKHN0YXRlUmVmLmN1cnJlbnQpIDogdXBkYXRlcjtcbiAgICAgIGlmICh0eXBlb2YgbmV3VmFsdWUgPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgY2FjaGUuc2V0KGtleVJlZi5jdXJyZW50LCBcInVuZGVmaW5lZFwiKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IHN0cmluZ2lmaWVkVmFsdWUgPSBKU09OLnN0cmluZ2lmeShuZXdWYWx1ZSwgcmVwbGFjZXIpO1xuICAgICAgICBjYWNoZS5zZXQoa2V5UmVmLmN1cnJlbnQsIHN0cmluZ2lmaWVkVmFsdWUpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIG5ld1ZhbHVlO1xuICAgIH0sXG4gICAgW2NhY2hlLCBrZXlSZWYsIHN0YXRlUmVmXSxcbiAgKTtcblxuICByZXR1cm4gW3N0YXRlLCBzZXRTdGF0ZUFuZENhY2hlXTtcbn1cbiIsICJpbXBvcnQgY3J5cHRvIGZyb20gXCJub2RlOmNyeXB0b1wiO1xuaW1wb3J0IHsgdHlwZUhhc2hlciB9IGZyb20gXCIuL3ZlbmRvcnMvdHlwZS1oYXNoZXJcIjtcblxuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbmV4cG9ydCBmdW5jdGlvbiByZXBsYWNlcih0aGlzOiBhbnksIGtleTogc3RyaW5nLCBfdmFsdWU6IHVua25vd24pIHtcbiAgY29uc3QgdmFsdWUgPSB0aGlzW2tleV07XG4gIGlmICh2YWx1ZSBpbnN0YW5jZW9mIERhdGUpIHtcbiAgICByZXR1cm4gYF9fcmF5Y2FzdF9jYWNoZWRfZGF0ZV9fJHt2YWx1ZS50b0lTT1N0cmluZygpfWA7XG4gIH1cbiAgaWYgKEJ1ZmZlci5pc0J1ZmZlcih2YWx1ZSkpIHtcbiAgICByZXR1cm4gYF9fcmF5Y2FzdF9jYWNoZWRfYnVmZmVyX18ke3ZhbHVlLnRvU3RyaW5nKFwiYmFzZTY0XCIpfWA7XG4gIH1cbiAgcmV0dXJuIF92YWx1ZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHJldml2ZXIoX2tleTogc3RyaW5nLCB2YWx1ZTogdW5rbm93bikge1xuICBpZiAodHlwZW9mIHZhbHVlID09PSBcInN0cmluZ1wiICYmIHZhbHVlLnN0YXJ0c1dpdGgoXCJfX3JheWNhc3RfY2FjaGVkX2RhdGVfX1wiKSkge1xuICAgIHJldHVybiBuZXcgRGF0ZSh2YWx1ZS5yZXBsYWNlKFwiX19yYXljYXN0X2NhY2hlZF9kYXRlX19cIiwgXCJcIikpO1xuICB9XG4gIGlmICh0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIgJiYgdmFsdWUuc3RhcnRzV2l0aChcIl9fcmF5Y2FzdF9jYWNoZWRfYnVmZmVyX19cIikpIHtcbiAgICByZXR1cm4gQnVmZmVyLmZyb20odmFsdWUucmVwbGFjZShcIl9fcmF5Y2FzdF9jYWNoZWRfYnVmZmVyX19cIiwgXCJcIiksIFwiYmFzZTY0XCIpO1xuICB9XG4gIHJldHVybiB2YWx1ZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGhhc2gob2JqZWN0OiBhbnkpIHtcbiAgY29uc3QgaGFzaGluZ1N0cmVhbSA9IGNyeXB0by5jcmVhdGVIYXNoKFwic2hhMVwiKTtcbiAgY29uc3QgaGFzaGVyID0gdHlwZUhhc2hlcihoYXNoaW5nU3RyZWFtKTtcbiAgaGFzaGVyLmRpc3BhdGNoKG9iamVjdCk7XG5cbiAgcmV0dXJuIGhhc2hpbmdTdHJlYW0uZGlnZXN0KFwiaGV4XCIpO1xufVxuIiwgIi8qIGVzbGludC1kaXNhYmxlIEB0eXBlc2NyaXB0LWVzbGludC9iYW4tdHMtY29tbWVudCAqL1xuLyogZXNsaW50LWRpc2FibGUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXRoaXMtYWxpYXMgKi9cbi8qIGVzbGludC1kaXNhYmxlIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnkgKi9cbmltcG9ydCBjcnlwdG8gZnJvbSBcIm5vZGU6Y3J5cHRvXCI7XG5cbi8qKiBDaGVjayBpZiB0aGUgZ2l2ZW4gZnVuY3Rpb24gaXMgYSBuYXRpdmUgZnVuY3Rpb24gKi9cbmZ1bmN0aW9uIGlzTmF0aXZlRnVuY3Rpb24oZjogYW55KSB7XG4gIGlmICh0eXBlb2YgZiAhPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIGNvbnN0IGV4cCA9IC9eZnVuY3Rpb25cXHMrXFx3KlxccypcXChcXHMqXFwpXFxzKntcXHMrXFxbbmF0aXZlIGNvZGVcXF1cXHMrfSQvaTtcbiAgcmV0dXJuIGV4cC5leGVjKEZ1bmN0aW9uLnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGYpKSAhPT0gbnVsbDtcbn1cblxuZnVuY3Rpb24gaGFzaFJlcGxhY2VyKHZhbHVlOiBhbnkpOiBzdHJpbmcge1xuICBpZiAodmFsdWUgaW5zdGFuY2VvZiBVUkxTZWFyY2hQYXJhbXMpIHtcbiAgICByZXR1cm4gdmFsdWUudG9TdHJpbmcoKTtcbiAgfVxuICByZXR1cm4gdmFsdWU7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB0eXBlSGFzaGVyKFxuICB3cml0ZVRvOlxuICAgIHwgY3J5cHRvLkhhc2hcbiAgICB8IHtcbiAgICAgICAgYnVmOiBzdHJpbmc7XG4gICAgICAgIHdyaXRlOiAoYjogYW55KSA9PiB2b2lkO1xuICAgICAgICBlbmQ6IChiOiBhbnkpID0+IHZvaWQ7XG4gICAgICAgIHJlYWQ6ICgpID0+IHN0cmluZztcbiAgICAgIH0sXG4gIGNvbnRleHQ6IGFueVtdID0gW10sXG4pIHtcbiAgZnVuY3Rpb24gd3JpdGUoc3RyOiBzdHJpbmcpIHtcbiAgICBpZiAoXCJ1cGRhdGVcIiBpbiB3cml0ZVRvKSB7XG4gICAgICByZXR1cm4gd3JpdGVUby51cGRhdGUoc3RyLCBcInV0ZjhcIik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB3cml0ZVRvLndyaXRlKHN0cik7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBkaXNwYXRjaDogZnVuY3Rpb24gKHZhbHVlOiBhbnkpIHtcbiAgICAgIHZhbHVlID0gaGFzaFJlcGxhY2VyKHZhbHVlKTtcblxuICAgICAgY29uc3QgdHlwZSA9IHR5cGVvZiB2YWx1ZTtcbiAgICAgIGlmICh2YWx1ZSA9PT0gbnVsbCkge1xuICAgICAgICB0aGlzW1wiX251bGxcIl0oKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgdGhpc1tcIl9cIiArIHR5cGVdKHZhbHVlKTtcbiAgICAgIH1cbiAgICB9LFxuICAgIF9vYmplY3Q6IGZ1bmN0aW9uIChvYmplY3Q6IGFueSkge1xuICAgICAgY29uc3QgcGF0dGVybiA9IC9cXFtvYmplY3QgKC4qKVxcXS9pO1xuICAgICAgY29uc3Qgb2JqU3RyaW5nID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKG9iamVjdCk7XG4gICAgICBsZXQgb2JqVHlwZSA9IHBhdHRlcm4uZXhlYyhvYmpTdHJpbmcpPy5bMV0gPz8gXCJ1bmtub3duOltcIiArIG9ialN0cmluZyArIFwiXVwiO1xuICAgICAgb2JqVHlwZSA9IG9ialR5cGUudG9Mb3dlckNhc2UoKTtcblxuICAgICAgbGV0IG9iamVjdE51bWJlciA9IG51bGwgYXMgYW55O1xuXG4gICAgICBpZiAoKG9iamVjdE51bWJlciA9IGNvbnRleHQuaW5kZXhPZihvYmplY3QpKSA+PSAwKSB7XG4gICAgICAgIHRoaXMuZGlzcGF0Y2goXCJbQ0lSQ1VMQVI6XCIgKyBvYmplY3ROdW1iZXIgKyBcIl1cIik7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnRleHQucHVzaChvYmplY3QpO1xuICAgICAgfVxuXG4gICAgICBpZiAoQnVmZmVyLmlzQnVmZmVyKG9iamVjdCkpIHtcbiAgICAgICAgd3JpdGUoXCJidWZmZXI6XCIpO1xuICAgICAgICByZXR1cm4gd3JpdGUob2JqZWN0LnRvU3RyaW5nKFwidXRmOFwiKSk7XG4gICAgICB9XG5cbiAgICAgIGlmIChvYmpUeXBlICE9PSBcIm9iamVjdFwiICYmIG9ialR5cGUgIT09IFwiZnVuY3Rpb25cIiAmJiBvYmpUeXBlICE9PSBcImFzeW5jZnVuY3Rpb25cIikge1xuICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgIGlmICh0aGlzW1wiX1wiICsgb2JqVHlwZV0pIHtcbiAgICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgICAgdGhpc1tcIl9cIiArIG9ialR5cGVdKG9iamVjdCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdVbmtub3duIG9iamVjdCB0eXBlIFwiJyArIG9ialR5cGUgKyAnXCInKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbGV0IGtleXMgPSBPYmplY3Qua2V5cyhvYmplY3QpO1xuICAgICAgICBrZXlzID0ga2V5cy5zb3J0KCk7XG4gICAgICAgIC8vIE1ha2Ugc3VyZSB0byBpbmNvcnBvcmF0ZSBzcGVjaWFsIHByb3BlcnRpZXMsIHNvXG4gICAgICAgIC8vIFR5cGVzIHdpdGggZGlmZmVyZW50IHByb3RvdHlwZXMgd2lsbCBwcm9kdWNlXG4gICAgICAgIC8vIGEgZGlmZmVyZW50IGhhc2ggYW5kIG9iamVjdHMgZGVyaXZlZCBmcm9tXG4gICAgICAgIC8vIGRpZmZlcmVudCBmdW5jdGlvbnMgKGBuZXcgRm9vYCwgYG5ldyBCYXJgKSB3aWxsXG4gICAgICAgIC8vIHByb2R1Y2UgZGlmZmVyZW50IGhhc2hlcy5cbiAgICAgICAgLy8gV2UgbmV2ZXIgZG8gdGhpcyBmb3IgbmF0aXZlIGZ1bmN0aW9ucyBzaW5jZSBzb21lXG4gICAgICAgIC8vIHNlZW0gdG8gYnJlYWsgYmVjYXVzZSBvZiB0aGF0LlxuICAgICAgICBpZiAoIWlzTmF0aXZlRnVuY3Rpb24ob2JqZWN0KSkge1xuICAgICAgICAgIGtleXMuc3BsaWNlKDAsIDAsIFwicHJvdG90eXBlXCIsIFwiX19wcm90b19fXCIsIFwiY29uc3RydWN0b3JcIik7XG4gICAgICAgIH1cblxuICAgICAgICB3cml0ZShcIm9iamVjdDpcIiArIGtleXMubGVuZ3RoICsgXCI6XCIpO1xuICAgICAgICBjb25zdCBzZWxmID0gdGhpcztcbiAgICAgICAgcmV0dXJuIGtleXMuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgICAgc2VsZi5kaXNwYXRjaChrZXkpO1xuICAgICAgICAgIHdyaXRlKFwiOlwiKTtcbiAgICAgICAgICBzZWxmLmRpc3BhdGNoKG9iamVjdFtrZXldKTtcbiAgICAgICAgICB3cml0ZShcIixcIik7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0sXG4gICAgX2FycmF5OiBmdW5jdGlvbiAoYXJyOiBhbnlbXSwgdW5vcmRlcmVkOiBib29sZWFuKSB7XG4gICAgICB1bm9yZGVyZWQgPSB0eXBlb2YgdW5vcmRlcmVkICE9PSBcInVuZGVmaW5lZFwiID8gdW5vcmRlcmVkIDogZmFsc2U7IC8vIGRlZmF1bHQgdG8gb3B0aW9ucy51bm9yZGVyZWRBcnJheXNcblxuICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XG4gICAgICB3cml0ZShcImFycmF5OlwiICsgYXJyLmxlbmd0aCArIFwiOlwiKTtcbiAgICAgIGlmICghdW5vcmRlcmVkIHx8IGFyci5sZW5ndGggPD0gMSkge1xuICAgICAgICBhcnIuZm9yRWFjaChmdW5jdGlvbiAoZW50cnk6IGFueSkge1xuICAgICAgICAgIHNlbGYuZGlzcGF0Y2goZW50cnkpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAvLyB0aGUgdW5vcmRlcmVkIGNhc2UgaXMgYSBsaXR0bGUgbW9yZSBjb21wbGljYXRlZDpcbiAgICAgIC8vIHNpbmNlIHRoZXJlIGlzIG5vIGNhbm9uaWNhbCBvcmRlcmluZyBvbiBvYmplY3RzLFxuICAgICAgLy8gaS5lLiB7YToxfSA8IHthOjJ9IGFuZCB7YToxfSA+IHthOjJ9IGFyZSBib3RoIGZhbHNlLFxuICAgICAgLy8gd2UgZmlyc3Qgc2VyaWFsaXplIGVhY2ggZW50cnkgdXNpbmcgYSBQYXNzVGhyb3VnaCBzdHJlYW1cbiAgICAgIC8vIGJlZm9yZSBzb3J0aW5nLlxuICAgICAgLy8gYWxzbzogd2UgY2Fu4oCZdCB1c2UgdGhlIHNhbWUgY29udGV4dCBhcnJheSBmb3IgYWxsIGVudHJpZXNcbiAgICAgIC8vIHNpbmNlIHRoZSBvcmRlciBvZiBoYXNoaW5nIHNob3VsZCAqbm90KiBtYXR0ZXIuIGluc3RlYWQsXG4gICAgICAvLyB3ZSBrZWVwIHRyYWNrIG9mIHRoZSBhZGRpdGlvbnMgdG8gYSBjb3B5IG9mIHRoZSBjb250ZXh0IGFycmF5XG4gICAgICAvLyBhbmQgYWRkIGFsbCBvZiB0aGVtIHRvIHRoZSBnbG9iYWwgY29udGV4dCBhcnJheSB3aGVuIHdl4oCZcmUgZG9uZVxuICAgICAgbGV0IGNvbnRleHRBZGRpdGlvbnM6IGFueVtdID0gW107XG4gICAgICBjb25zdCBlbnRyaWVzID0gYXJyLm1hcChmdW5jdGlvbiAoZW50cnk6IGFueSkge1xuICAgICAgICBjb25zdCBzdHJtID0gUGFzc1Rocm91Z2goKTtcbiAgICAgICAgY29uc3QgbG9jYWxDb250ZXh0ID0gY29udGV4dC5zbGljZSgpOyAvLyBtYWtlIGNvcHlcbiAgICAgICAgY29uc3QgaGFzaGVyID0gdHlwZUhhc2hlcihzdHJtLCBsb2NhbENvbnRleHQpO1xuICAgICAgICBoYXNoZXIuZGlzcGF0Y2goZW50cnkpO1xuICAgICAgICAvLyB0YWtlIG9ubHkgd2hhdCB3YXMgYWRkZWQgdG8gbG9jYWxDb250ZXh0IGFuZCBhcHBlbmQgaXQgdG8gY29udGV4dEFkZGl0aW9uc1xuICAgICAgICBjb250ZXh0QWRkaXRpb25zID0gY29udGV4dEFkZGl0aW9ucy5jb25jYXQobG9jYWxDb250ZXh0LnNsaWNlKGNvbnRleHQubGVuZ3RoKSk7XG4gICAgICAgIHJldHVybiBzdHJtLnJlYWQoKS50b1N0cmluZygpO1xuICAgICAgfSk7XG4gICAgICBjb250ZXh0ID0gY29udGV4dC5jb25jYXQoY29udGV4dEFkZGl0aW9ucyk7XG4gICAgICBlbnRyaWVzLnNvcnQoKTtcbiAgICAgIHRoaXMuX2FycmF5KGVudHJpZXMsIGZhbHNlKTtcbiAgICB9LFxuICAgIF9kYXRlOiBmdW5jdGlvbiAoZGF0ZTogRGF0ZSkge1xuICAgICAgd3JpdGUoXCJkYXRlOlwiICsgZGF0ZS50b0pTT04oKSk7XG4gICAgfSxcbiAgICBfc3ltYm9sOiBmdW5jdGlvbiAoc3ltOiBzeW1ib2wpIHtcbiAgICAgIHdyaXRlKFwic3ltYm9sOlwiICsgc3ltLnRvU3RyaW5nKCkpO1xuICAgIH0sXG4gICAgX2Vycm9yOiBmdW5jdGlvbiAoZXJyOiBFcnJvcikge1xuICAgICAgd3JpdGUoXCJlcnJvcjpcIiArIGVyci50b1N0cmluZygpKTtcbiAgICB9LFxuICAgIF9ib29sZWFuOiBmdW5jdGlvbiAoYm9vbDogYm9vbGVhbikge1xuICAgICAgd3JpdGUoXCJib29sOlwiICsgYm9vbC50b1N0cmluZygpKTtcbiAgICB9LFxuICAgIF9zdHJpbmc6IGZ1bmN0aW9uIChzdHJpbmc6IHN0cmluZykge1xuICAgICAgd3JpdGUoXCJzdHJpbmc6XCIgKyBzdHJpbmcubGVuZ3RoICsgXCI6XCIpO1xuICAgICAgd3JpdGUoc3RyaW5nLnRvU3RyaW5nKCkpO1xuICAgIH0sXG4gICAgX2Z1bmN0aW9uOiBmdW5jdGlvbiAoZm46IGFueSkge1xuICAgICAgd3JpdGUoXCJmbjpcIik7XG4gICAgICBpZiAoaXNOYXRpdmVGdW5jdGlvbihmbikpIHtcbiAgICAgICAgdGhpcy5kaXNwYXRjaChcIltuYXRpdmVdXCIpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5kaXNwYXRjaChmbi50b1N0cmluZygpKTtcbiAgICAgIH1cblxuICAgICAgLy8gTWFrZSBzdXJlIHdlIGNhbiBzdGlsbCBkaXN0aW5ndWlzaCBuYXRpdmUgZnVuY3Rpb25zXG4gICAgICAvLyBieSB0aGVpciBuYW1lLCBvdGhlcndpc2UgU3RyaW5nIGFuZCBGdW5jdGlvbiB3aWxsXG4gICAgICAvLyBoYXZlIHRoZSBzYW1lIGhhc2hcbiAgICAgIHRoaXMuZGlzcGF0Y2goXCJmdW5jdGlvbi1uYW1lOlwiICsgU3RyaW5nKGZuLm5hbWUpKTtcblxuICAgICAgdGhpcy5fb2JqZWN0KGZuKTtcbiAgICB9LFxuICAgIF9udW1iZXI6IGZ1bmN0aW9uIChudW1iZXI6IG51bWJlcikge1xuICAgICAgd3JpdGUoXCJudW1iZXI6XCIgKyBudW1iZXIudG9TdHJpbmcoKSk7XG4gICAgfSxcbiAgICBfeG1sOiBmdW5jdGlvbiAoeG1sOiBhbnkpIHtcbiAgICAgIHdyaXRlKFwieG1sOlwiICsgeG1sLnRvU3RyaW5nKCkpO1xuICAgIH0sXG4gICAgX251bGw6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHdyaXRlKFwiTnVsbFwiKTtcbiAgICB9LFxuICAgIF91bmRlZmluZWQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHdyaXRlKFwiVW5kZWZpbmVkXCIpO1xuICAgIH0sXG4gICAgX3JlZ2V4cDogZnVuY3Rpb24gKHJlZ2V4OiBSZWdFeHApIHtcbiAgICAgIHdyaXRlKFwicmVnZXg6XCIgKyByZWdleC50b1N0cmluZygpKTtcbiAgICB9LFxuICAgIF91aW50OGFycmF5OiBmdW5jdGlvbiAoYXJyOiBVaW50OEFycmF5KSB7XG4gICAgICB3cml0ZShcInVpbnQ4YXJyYXk6XCIpO1xuICAgICAgdGhpcy5kaXNwYXRjaChBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcnIpKTtcbiAgICB9LFxuICAgIF91aW50OGNsYW1wZWRhcnJheTogZnVuY3Rpb24gKGFycjogVWludDhDbGFtcGVkQXJyYXkpIHtcbiAgICAgIHdyaXRlKFwidWludDhjbGFtcGVkYXJyYXk6XCIpO1xuICAgICAgdGhpcy5kaXNwYXRjaChBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcnIpKTtcbiAgICB9LFxuICAgIF9pbnQ4YXJyYXk6IGZ1bmN0aW9uIChhcnI6IEludDhBcnJheSkge1xuICAgICAgd3JpdGUoXCJpbnQ4YXJyYXk6XCIpO1xuICAgICAgdGhpcy5kaXNwYXRjaChBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcnIpKTtcbiAgICB9LFxuICAgIF91aW50MTZhcnJheTogZnVuY3Rpb24gKGFycjogVWludDE2QXJyYXkpIHtcbiAgICAgIHdyaXRlKFwidWludDE2YXJyYXk6XCIpO1xuICAgICAgdGhpcy5kaXNwYXRjaChBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcnIpKTtcbiAgICB9LFxuICAgIF9pbnQxNmFycmF5OiBmdW5jdGlvbiAoYXJyOiBJbnQxNkFycmF5KSB7XG4gICAgICB3cml0ZShcImludDE2YXJyYXk6XCIpO1xuICAgICAgdGhpcy5kaXNwYXRjaChBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcnIpKTtcbiAgICB9LFxuICAgIF91aW50MzJhcnJheTogZnVuY3Rpb24gKGFycjogVWludDMyQXJyYXkpIHtcbiAgICAgIHdyaXRlKFwidWludDMyYXJyYXk6XCIpO1xuICAgICAgdGhpcy5kaXNwYXRjaChBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcnIpKTtcbiAgICB9LFxuICAgIF9pbnQzMmFycmF5OiBmdW5jdGlvbiAoYXJyOiBJbnQzMkFycmF5KSB7XG4gICAgICB3cml0ZShcImludDMyYXJyYXk6XCIpO1xuICAgICAgdGhpcy5kaXNwYXRjaChBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcnIpKTtcbiAgICB9LFxuICAgIF9mbG9hdDMyYXJyYXk6IGZ1bmN0aW9uIChhcnI6IEZsb2F0MzJBcnJheSkge1xuICAgICAgd3JpdGUoXCJmbG9hdDMyYXJyYXk6XCIpO1xuICAgICAgdGhpcy5kaXNwYXRjaChBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcnIpKTtcbiAgICB9LFxuICAgIF9mbG9hdDY0YXJyYXk6IGZ1bmN0aW9uIChhcnI6IEZsb2F0NjRBcnJheSkge1xuICAgICAgd3JpdGUoXCJmbG9hdDY0YXJyYXk6XCIpO1xuICAgICAgdGhpcy5kaXNwYXRjaChBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcnIpKTtcbiAgICB9LFxuICAgIF9hcnJheWJ1ZmZlcjogZnVuY3Rpb24gKGFycjogQXJyYXlCdWZmZXIpIHtcbiAgICAgIHdyaXRlKFwiYXJyYXlidWZmZXI6XCIpO1xuICAgICAgdGhpcy5kaXNwYXRjaChuZXcgVWludDhBcnJheShhcnIpKTtcbiAgICB9LFxuICAgIF91cmw6IGZ1bmN0aW9uICh1cmw6IFVSTCkge1xuICAgICAgd3JpdGUoXCJ1cmw6XCIgKyB1cmwudG9TdHJpbmcoKSk7XG4gICAgfSxcbiAgICBfbWFwOiBmdW5jdGlvbiAobWFwOiBNYXA8YW55LCBhbnk+KSB7XG4gICAgICB3cml0ZShcIm1hcDpcIik7XG4gICAgICBjb25zdCBhcnIgPSBBcnJheS5mcm9tKG1hcCk7XG4gICAgICB0aGlzLl9hcnJheShhcnIsIHRydWUpO1xuICAgIH0sXG4gICAgX3NldDogZnVuY3Rpb24gKHNldDogU2V0PGFueT4pIHtcbiAgICAgIHdyaXRlKFwic2V0OlwiKTtcbiAgICAgIGNvbnN0IGFyciA9IEFycmF5LmZyb20oc2V0KTtcbiAgICAgIHRoaXMuX2FycmF5KGFyciwgdHJ1ZSk7XG4gICAgfSxcbiAgICBfZmlsZTogZnVuY3Rpb24gKGZpbGU6IGFueSkge1xuICAgICAgd3JpdGUoXCJmaWxlOlwiKTtcbiAgICAgIHRoaXMuZGlzcGF0Y2goW2ZpbGUubmFtZSwgZmlsZS5zaXplLCBmaWxlLnR5cGUsIGZpbGUubGFzdE1vZGlmaWVkXSk7XG4gICAgfSxcbiAgICBfYmxvYjogZnVuY3Rpb24gKCkge1xuICAgICAgdGhyb3cgRXJyb3IoXG4gICAgICAgIFwiSGFzaGluZyBCbG9iIG9iamVjdHMgaXMgY3VycmVudGx5IG5vdCBzdXBwb3J0ZWRcXG5cIiArXG4gICAgICAgICAgXCIoc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9wdWxlb3Mvb2JqZWN0LWhhc2gvaXNzdWVzLzI2KVxcblwiICtcbiAgICAgICAgICAnVXNlIFwib3B0aW9ucy5yZXBsYWNlclwiIG9yIFwib3B0aW9ucy5pZ25vcmVVbmtub3duXCJcXG4nLFxuICAgICAgKTtcbiAgICB9LFxuICAgIF9kb213aW5kb3c6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHdyaXRlKFwiZG9td2luZG93XCIpO1xuICAgIH0sXG4gICAgX2JpZ2ludDogZnVuY3Rpb24gKG51bWJlcjogYmlnaW50KSB7XG4gICAgICB3cml0ZShcImJpZ2ludDpcIiArIG51bWJlci50b1N0cmluZygpKTtcbiAgICB9LFxuICAgIC8qIE5vZGUuanMgc3RhbmRhcmQgbmF0aXZlIG9iamVjdHMgKi9cbiAgICBfcHJvY2VzczogZnVuY3Rpb24gKCkge1xuICAgICAgd3JpdGUoXCJwcm9jZXNzXCIpO1xuICAgIH0sXG4gICAgX3RpbWVyOiBmdW5jdGlvbiAoKSB7XG4gICAgICB3cml0ZShcInRpbWVyXCIpO1xuICAgIH0sXG4gICAgX3BpcGU6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHdyaXRlKFwicGlwZVwiKTtcbiAgICB9LFxuICAgIF90Y3A6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHdyaXRlKFwidGNwXCIpO1xuICAgIH0sXG4gICAgX3VkcDogZnVuY3Rpb24gKCkge1xuICAgICAgd3JpdGUoXCJ1ZHBcIik7XG4gICAgfSxcbiAgICBfdHR5OiBmdW5jdGlvbiAoKSB7XG4gICAgICB3cml0ZShcInR0eVwiKTtcbiAgICB9LFxuICAgIF9zdGF0d2F0Y2hlcjogZnVuY3Rpb24gKCkge1xuICAgICAgd3JpdGUoXCJzdGF0d2F0Y2hlclwiKTtcbiAgICB9LFxuICAgIF9zZWN1cmVjb250ZXh0OiBmdW5jdGlvbiAoKSB7XG4gICAgICB3cml0ZShcInNlY3VyZWNvbnRleHRcIik7XG4gICAgfSxcbiAgICBfY29ubmVjdGlvbjogZnVuY3Rpb24gKCkge1xuICAgICAgd3JpdGUoXCJjb25uZWN0aW9uXCIpO1xuICAgIH0sXG4gICAgX3psaWI6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHdyaXRlKFwiemxpYlwiKTtcbiAgICB9LFxuICAgIF9jb250ZXh0OiBmdW5jdGlvbiAoKSB7XG4gICAgICB3cml0ZShcImNvbnRleHRcIik7XG4gICAgfSxcbiAgICBfbm9kZXNjcmlwdDogZnVuY3Rpb24gKCkge1xuICAgICAgd3JpdGUoXCJub2Rlc2NyaXB0XCIpO1xuICAgIH0sXG4gICAgX2h0dHBwYXJzZXI6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHdyaXRlKFwiaHR0cHBhcnNlclwiKTtcbiAgICB9LFxuICAgIF9kYXRhdmlldzogZnVuY3Rpb24gKCkge1xuICAgICAgd3JpdGUoXCJkYXRhdmlld1wiKTtcbiAgICB9LFxuICAgIF9zaWduYWw6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHdyaXRlKFwic2lnbmFsXCIpO1xuICAgIH0sXG4gICAgX2ZzZXZlbnQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHdyaXRlKFwiZnNldmVudFwiKTtcbiAgICB9LFxuICAgIF90bHN3cmFwOiBmdW5jdGlvbiAoKSB7XG4gICAgICB3cml0ZShcInRsc3dyYXBcIik7XG4gICAgfSxcbiAgfTtcbn1cblxuLy8gTWluaS1pbXBsZW1lbnRhdGlvbiBvZiBzdHJlYW0uUGFzc1Rocm91Z2hcbi8vIFdlIGFyZSBmYXIgZnJvbSBoYXZpbmcgbmVlZCBmb3IgdGhlIGZ1bGwgaW1wbGVtZW50YXRpb24sIGFuZCB3ZSBjYW5cbi8vIG1ha2UgYXNzdW1wdGlvbnMgbGlrZSBcIm1hbnkgd3JpdGVzLCB0aGVuIG9ubHkgb25lIGZpbmFsIHJlYWRcIlxuLy8gYW5kIHdlIGNhbiBpZ25vcmUgZW5jb2Rpbmcgc3BlY2lmaWNzXG5mdW5jdGlvbiBQYXNzVGhyb3VnaCgpIHtcbiAgcmV0dXJuIHtcbiAgICBidWY6IFwiXCIsXG5cbiAgICB3cml0ZTogZnVuY3Rpb24gKGI6IHN0cmluZykge1xuICAgICAgdGhpcy5idWYgKz0gYjtcbiAgICB9LFxuXG4gICAgZW5kOiBmdW5jdGlvbiAoYjogc3RyaW5nKSB7XG4gICAgICB0aGlzLmJ1ZiArPSBiO1xuICAgIH0sXG5cbiAgICByZWFkOiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5idWY7XG4gICAgfSxcbiAgfTtcbn1cbiIsICJpbXBvcnQgeyB1c2VFZmZlY3QsIHVzZVJlZiwgdXNlQ2FsbGJhY2sgfSBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCB7XG4gIEZ1bmN0aW9uUmV0dXJuaW5nUHJvbWlzZSxcbiAgVXNlQ2FjaGVkUHJvbWlzZVJldHVyblR5cGUsXG4gIE11dGF0ZVByb21pc2UsXG4gIEZ1bmN0aW9uUmV0dXJuaW5nUGFnaW5hdGVkUHJvbWlzZSxcbiAgVW53cmFwUmV0dXJuLFxuICBQYWdpbmF0aW9uT3B0aW9ucyxcbn0gZnJvbSBcIi4vdHlwZXNcIjtcbmltcG9ydCB7IHVzZUNhY2hlZFN0YXRlIH0gZnJvbSBcIi4vdXNlQ2FjaGVkU3RhdGVcIjtcbmltcG9ydCB7IHVzZVByb21pc2UsIFByb21pc2VPcHRpb25zIH0gZnJvbSBcIi4vdXNlUHJvbWlzZVwiO1xuaW1wb3J0IHsgdXNlTGF0ZXN0IH0gZnJvbSBcIi4vdXNlTGF0ZXN0XCI7XG5pbXBvcnQgeyBoYXNoIH0gZnJvbSBcIi4vaGVscGVyc1wiO1xuXG4vLyBTeW1ib2wgdG8gZGlmZmVyZW50aWF0ZSBhbiBlbXB0eSBjYWNoZSBmcm9tIGB1bmRlZmluZWRgXG5jb25zdCBlbXB0eUNhY2hlID0gLyogI19fUFVSRV9fICovIFN5bWJvbCgpO1xuXG5leHBvcnQgdHlwZSBDYWNoZWRQcm9taXNlT3B0aW9uczxcbiAgVCBleHRlbmRzIEZ1bmN0aW9uUmV0dXJuaW5nUHJvbWlzZSB8IEZ1bmN0aW9uUmV0dXJuaW5nUGFnaW5hdGVkUHJvbWlzZSxcbiAgVSxcbj4gPSBQcm9taXNlT3B0aW9uczxUPiAmIHtcbiAgLyoqXG4gICAqIFRoZSBpbml0aWFsIGRhdGEgaWYgdGhlcmUgYXJlbid0IGFueSBpbiB0aGUgQ2FjaGUgeWV0LlxuICAgKi9cbiAgaW5pdGlhbERhdGE/OiBVO1xuICAvKipcbiAgICogVGVsbHMgdGhlIGhvb2sgdG8ga2VlcCB0aGUgcHJldmlvdXMgcmVzdWx0cyBpbnN0ZWFkIG9mIHJldHVybmluZyB0aGUgaW5pdGlhbCB2YWx1ZVxuICAgKiBpZiB0aGVyZSBhcmVuJ3QgYW55IGluIHRoZSBjYWNoZSBmb3IgdGhlIG5ldyBhcmd1bWVudHMuXG4gICAqIFRoaXMgaXMgcGFydGljdWxhcmx5IHVzZWZ1bCB3aGVuIHVzZWQgZm9yIGRhdGEgZm9yIGEgTGlzdCB0byBhdm9pZCBmbGlja2VyaW5nLlxuICAgKi9cbiAga2VlcFByZXZpb3VzRGF0YT86IGJvb2xlYW47XG59O1xuXG4vKipcbiAqIFdyYXBzIGFuIGFzeW5jaHJvbm91cyBmdW5jdGlvbiBvciBhIGZ1bmN0aW9uIHRoYXQgcmV0dXJucyBhIFByb21pc2UgaW4gYW5vdGhlciBmdW5jdGlvbiwgYW5kIHJldHVybnMgdGhlIHtAbGluayBBc3luY1N0YXRlfSBjb3JyZXNwb25kaW5nIHRvIHRoZSBleGVjdXRpb24gb2YgdGhlIGZ1bmN0aW9uLiBUaGUgbGFzdCB2YWx1ZSB3aWxsIGJlIGtlcHQgYmV0d2VlbiBjb21tYW5kIHJ1bnMuXG4gKlxuICogQHJlbWFyayBUaGlzIG92ZXJsb2FkIHNob3VsZCBiZSB1c2VkIHdoZW4gd29ya2luZyB3aXRoIHBhZ2luYXRlZCBkYXRhIHNvdXJjZXMuXG4gKiBAcmVtYXJrIFdoZW4gcGFnaW5hdGluZywgb25seSB0aGUgZmlyc3QgcGFnZSB3aWxsIGJlIGNhY2hlZC5cbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgXG4gKiBpbXBvcnQgeyBzZXRUaW1lb3V0IH0gZnJvbSBcIm5vZGU6dGltZXJzL3Byb21pc2VzXCI7XG4gKiBpbXBvcnQgeyB1c2VTdGF0ZSB9IGZyb20gXCJyZWFjdFwiO1xuICogaW1wb3J0IHsgTGlzdCB9IGZyb20gXCJAcmF5Y2FzdC9hcGlcIjtcbiAqIGltcG9ydCB7IHVzZUNhY2hlZFByb21pc2UgfSBmcm9tIFwiQHJheWNhc3QvdXRpbHNcIjtcbiAqXG4gKiBleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBDb21tYW5kKCkge1xuICogICBjb25zdCBbc2VhcmNoVGV4dCwgc2V0U2VhcmNoVGV4dF0gPSB1c2VTdGF0ZShcIlwiKTtcbiAqXG4gKiAgIGNvbnN0IHsgaXNMb2FkaW5nLCBkYXRhLCBwYWdpbmF0aW9uIH0gPSB1c2VDYWNoZWRQcm9taXNlKFxuICogICAgIChzZWFyY2hUZXh0OiBzdHJpbmcpID0+IGFzeW5jIChvcHRpb25zOiB7IHBhZ2U6IG51bWJlciB9KSA9PiB7XG4gKiAgICAgICBhd2FpdCBzZXRUaW1lb3V0KDIwMCk7XG4gKiAgICAgICBjb25zdCBuZXdEYXRhID0gQXJyYXkuZnJvbSh7IGxlbmd0aDogMjUgfSwgKF92LCBpbmRleCkgPT4gKHtcbiAqICAgICAgICAgaW5kZXgsXG4gKiAgICAgICAgIHBhZ2U6IG9wdGlvbnMucGFnZSxcbiAqICAgICAgICAgdGV4dDogc2VhcmNoVGV4dCxcbiAqICAgICAgIH0pKTtcbiAqICAgICAgIHJldHVybiB7IGRhdGE6IG5ld0RhdGEsIGhhc01vcmU6IG9wdGlvbnMucGFnZSA8IDEwIH07XG4gKiAgICAgfSxcbiAqICAgICBbc2VhcmNoVGV4dF0sXG4gKiAgICk7XG4gKlxuICogICByZXR1cm4gKFxuICogICAgIDxMaXN0IGlzTG9hZGluZz17aXNMb2FkaW5nfSBvblNlYXJjaFRleHRDaGFuZ2U9e3NldFNlYXJjaFRleHR9IHBhZ2luYXRpb249e3BhZ2luYXRpb259PlxuICogICAgICAge2RhdGE/Lm1hcCgoaXRlbSkgPT4gKFxuICogICAgICAgICA8TGlzdC5JdGVtXG4gKiAgICAgICAgICAga2V5PXtgJHtpdGVtLnBhZ2V9ICR7aXRlbS5pbmRleH0gJHtpdGVtLnRleHR9YH1cbiAqICAgICAgICAgICB0aXRsZT17YFBhZ2UgJHtpdGVtLnBhZ2V9IEl0ZW0gJHtpdGVtLmluZGV4fWB9XG4gKiAgICAgICAgICAgc3VidGl0bGU9e2l0ZW0udGV4dH1cbiAqICAgICAgICAgLz5cbiAqICAgICAgICkpfVxuICogICAgIDwvTGlzdD5cbiAqICAgKTtcbiAqIH1cbiAqIGBgYFxuICovXG5leHBvcnQgZnVuY3Rpb24gdXNlQ2FjaGVkUHJvbWlzZTxUIGV4dGVuZHMgRnVuY3Rpb25SZXR1cm5pbmdQYWdpbmF0ZWRQcm9taXNlPFtdPj4oXG4gIGZuOiBULFxuKTogVXNlQ2FjaGVkUHJvbWlzZVJldHVyblR5cGU8VW53cmFwUmV0dXJuPFQ+LCB1bmRlZmluZWQ+O1xuZXhwb3J0IGZ1bmN0aW9uIHVzZUNhY2hlZFByb21pc2U8VCBleHRlbmRzIEZ1bmN0aW9uUmV0dXJuaW5nUGFnaW5hdGVkUHJvbWlzZSwgVSBleHRlbmRzIGFueVtdID0gYW55W10+KFxuICBmbjogVCxcbiAgYXJnczogUGFyYW1ldGVyczxUPixcbiAgb3B0aW9ucz86IENhY2hlZFByb21pc2VPcHRpb25zPFQsIFU+LFxuKTogVXNlQ2FjaGVkUHJvbWlzZVJldHVyblR5cGU8VW53cmFwUmV0dXJuPFQ+LCBVPjtcblxuLyoqXG4gKiBXcmFwcyBhbiBhc3luY2hyb25vdXMgZnVuY3Rpb24gb3IgYSBmdW5jdGlvbiB0aGF0IHJldHVybnMgYSBQcm9taXNlIGFuZCByZXR1cm5zIHRoZSB7QGxpbmsgQXN5bmNTdGF0ZX0gY29ycmVzcG9uZGluZyB0byB0aGUgZXhlY3V0aW9uIG9mIHRoZSBmdW5jdGlvbi4gVGhlIGxhc3QgdmFsdWUgd2lsbCBiZSBrZXB0IGJldHdlZW4gY29tbWFuZCBydW5zLlxuICpcbiAqIEByZW1hcmsgVGhlIHZhbHVlIG5lZWRzIHRvIGJlIEpTT04gc2VyaWFsaXphYmxlLlxuICogQHJlbWFyayBUaGUgZnVuY3Rpb24gaXMgYXNzdW1lZCB0byBiZSBjb25zdGFudCAoZWcuIGNoYW5naW5nIGl0IHdvbid0IHRyaWdnZXIgYSByZXZhbGlkYXRpb24pLlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGBcbiAqIGltcG9ydCB7IHVzZUNhY2hlZFByb21pc2UgfSBmcm9tICdAcmF5Y2FzdC91dGlscyc7XG4gKlxuICogZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gQ29tbWFuZCgpIHtcbiAqICAgY29uc3QgYWJvcnRhYmxlID0gdXNlUmVmPEFib3J0Q29udHJvbGxlcj4oKTtcbiAqICAgY29uc3QgeyBpc0xvYWRpbmcsIGRhdGEsIHJldmFsaWRhdGUgfSA9IHVzZUNhY2hlZFByb21pc2UoYXN5bmMgKHVybDogc3RyaW5nKSA9PiB7XG4gKiAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh1cmwsIHsgc2lnbmFsOiBhYm9ydGFibGUuY3VycmVudD8uc2lnbmFsIH0pO1xuICogICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHJlc3BvbnNlLnRleHQoKTtcbiAqICAgICByZXR1cm4gcmVzdWx0XG4gKiAgIH0sXG4gKiAgIFsnaHR0cHM6Ly9hcGkuZXhhbXBsZSddLFxuICogICB7XG4gKiAgICAgYWJvcnRhYmxlXG4gKiAgIH0pO1xuICpcbiAqICAgcmV0dXJuIChcbiAqICAgICA8RGV0YWlsXG4gKiAgICAgICBpc0xvYWRpbmc9e2lzTG9hZGluZ31cbiAqICAgICAgIG1hcmtkb3duPXtkYXRhfVxuICogICAgICAgYWN0aW9ucz17XG4gKiAgICAgICAgIDxBY3Rpb25QYW5lbD5cbiAqICAgICAgICAgICA8QWN0aW9uIHRpdGxlPVwiUmVsb2FkXCIgb25BY3Rpb249eygpID0+IHJldmFsaWRhdGUoKX0gLz5cbiAqICAgICAgICAgPC9BY3Rpb25QYW5lbD5cbiAqICAgICAgIH1cbiAqICAgICAvPlxuICogICApO1xuICogfTtcbiAqIGBgYFxuICovXG5leHBvcnQgZnVuY3Rpb24gdXNlQ2FjaGVkUHJvbWlzZTxUIGV4dGVuZHMgRnVuY3Rpb25SZXR1cm5pbmdQcm9taXNlPFtdPj4oXG4gIGZuOiBULFxuKTogVXNlQ2FjaGVkUHJvbWlzZVJldHVyblR5cGU8VW53cmFwUmV0dXJuPFQ+LCB1bmRlZmluZWQ+O1xuZXhwb3J0IGZ1bmN0aW9uIHVzZUNhY2hlZFByb21pc2U8VCBleHRlbmRzIEZ1bmN0aW9uUmV0dXJuaW5nUHJvbWlzZSwgVSA9IHVuZGVmaW5lZD4oXG4gIGZuOiBULFxuICBhcmdzOiBQYXJhbWV0ZXJzPFQ+LFxuICBvcHRpb25zPzogQ2FjaGVkUHJvbWlzZU9wdGlvbnM8VCwgVT4sXG4pOiBVc2VDYWNoZWRQcm9taXNlUmV0dXJuVHlwZTxVbndyYXBSZXR1cm48VD4sIFU+O1xuXG5leHBvcnQgZnVuY3Rpb24gdXNlQ2FjaGVkUHJvbWlzZTxcbiAgVCBleHRlbmRzIEZ1bmN0aW9uUmV0dXJuaW5nUHJvbWlzZSB8IEZ1bmN0aW9uUmV0dXJuaW5nUGFnaW5hdGVkUHJvbWlzZSxcbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgVSBleHRlbmRzIGFueVtdIHwgdW5kZWZpbmVkID0gdW5kZWZpbmVkLFxuPihmbjogVCwgYXJncz86IFBhcmFtZXRlcnM8VD4sIG9wdGlvbnM/OiBDYWNoZWRQcm9taXNlT3B0aW9uczxULCBVPikge1xuICAvKipcbiAgICogVGhlIGhvb2sgZ2VuZXJhdGVzIGEgY2FjaGUga2V5IGZyb20gdGhlIHByb21pc2UgaXQgcmVjZWl2ZXMgJiBpdHMgYXJndW1lbnRzLlxuICAgKiBTb21ldGltZXMgdGhhdCdzIG5vdCBlbm91Z2ggdG8gZ3VhcmFudGVlIHVuaXF1ZW5lc3MsIHNvIGhvb2tzIHRoYXQgYnVpbGQgb24gdG9wIG9mIGB1c2VDYWNoZWRQcm9taXNlYCBjYW5cbiAgICogdXNlIGFuIGBpbnRlcm5hbF9jYWNoZUtleVN1ZmZpeGAgdG8gaGVscCBpdC5cbiAgICpcbiAgICogQHJlbWFyayBGb3IgaW50ZXJuYWwgdXNlIG9ubHkuXG4gICAqL1xuICBjb25zdCB7XG4gICAgaW5pdGlhbERhdGEsXG4gICAga2VlcFByZXZpb3VzRGF0YSxcbiAgICBpbnRlcm5hbF9jYWNoZUtleVN1ZmZpeCxcbiAgICAuLi51c2VQcm9taXNlT3B0aW9uc1xuICB9OiBDYWNoZWRQcm9taXNlT3B0aW9uczxULCBVPiAmIHsgaW50ZXJuYWxfY2FjaGVLZXlTdWZmaXg/OiBzdHJpbmcgfSA9IG9wdGlvbnMgfHwge307XG4gIGNvbnN0IGxhc3RVcGRhdGVGcm9tID0gdXNlUmVmPFwiY2FjaGVcIiB8IFwicHJvbWlzZVwiPihudWxsKTtcblxuICBjb25zdCBbY2FjaGVkRGF0YSwgbXV0YXRlQ2FjaGVdID0gdXNlQ2FjaGVkU3RhdGU8dHlwZW9mIGVtcHR5Q2FjaGUgfCAoVW53cmFwUmV0dXJuPFQ+IHwgVSk+KFxuICAgIGhhc2goYXJncyB8fCBbXSkgKyBpbnRlcm5hbF9jYWNoZUtleVN1ZmZpeCxcbiAgICBlbXB0eUNhY2hlLFxuICAgIHtcbiAgICAgIGNhY2hlTmFtZXNwYWNlOiBoYXNoKGZuKSxcbiAgICB9LFxuICApO1xuXG4gIC8vIFVzZSBhIHJlZiB0byBzdG9yZSBwcmV2aW91cyByZXR1cm5lZCBkYXRhLiBVc2UgdGhlIGluaXRhbCBkYXRhIGFzIGl0cyBpbml0YWwgdmFsdWUgZnJvbSB0aGUgY2FjaGUuXG4gIGNvbnN0IGxhZ2d5RGF0YVJlZiA9IHVzZVJlZjxBd2FpdGVkPFJldHVyblR5cGU8VD4+IHwgVT4oY2FjaGVkRGF0YSAhPT0gZW1wdHlDYWNoZSA/IGNhY2hlZERhdGEgOiAoaW5pdGlhbERhdGEgYXMgVSkpO1xuICBjb25zdCBwYWdpbmF0aW9uQXJnc1JlZiA9IHVzZVJlZjxQYWdpbmF0aW9uT3B0aW9uczxVbndyYXBSZXR1cm48VD4gfCBVPiB8IHVuZGVmaW5lZD4odW5kZWZpbmVkKTtcblxuICBjb25zdCB7XG4gICAgbXV0YXRlOiBfbXV0YXRlLFxuICAgIHJldmFsaWRhdGUsXG4gICAgLi4uc3RhdGVcbiAgICAvLyBAdHMtZXhwZWN0LWVycm9yIGZuIGhhcyB0aGUgc2FtZSBzaWduYXR1cmUgaW4gYm90aCB1c2VQcm9taXNlIGFuZCB1c2VDYWNoZWRQcm9taXNlXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgfSA9IHVzZVByb21pc2UoZm4sIGFyZ3MgfHwgKFtdIGFzIGFueSBhcyBQYXJhbWV0ZXJzPFQ+KSwge1xuICAgIC4uLnVzZVByb21pc2VPcHRpb25zLFxuICAgIG9uRGF0YShkYXRhLCBwYWdpbmF0aW9uKSB7XG4gICAgICBwYWdpbmF0aW9uQXJnc1JlZi5jdXJyZW50ID0gcGFnaW5hdGlvbjtcbiAgICAgIGlmICh1c2VQcm9taXNlT3B0aW9ucy5vbkRhdGEpIHtcbiAgICAgICAgdXNlUHJvbWlzZU9wdGlvbnMub25EYXRhKGRhdGEsIHBhZ2luYXRpb24pO1xuICAgICAgfVxuICAgICAgaWYgKHBhZ2luYXRpb24gJiYgcGFnaW5hdGlvbi5wYWdlID4gMCkge1xuICAgICAgICAvLyBkb24ndCBjYWNoZSBiZXlvbmQgdGhlIGZpcnN0IHBhZ2VcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgbGFzdFVwZGF0ZUZyb20uY3VycmVudCA9IFwicHJvbWlzZVwiO1xuICAgICAgbGFnZ3lEYXRhUmVmLmN1cnJlbnQgPSBkYXRhO1xuICAgICAgbXV0YXRlQ2FjaGUoZGF0YSk7XG4gICAgfSxcbiAgfSk7XG5cbiAgbGV0IHJldHVybmVkRGF0YTogVSB8IEF3YWl0ZWQ8UmV0dXJuVHlwZTxUPj4gfCBVbndyYXBSZXR1cm48VD47XG4gIGNvbnN0IHBhZ2luYXRpb24gPSBzdGF0ZS5wYWdpbmF0aW9uO1xuICAvLyB3aGVuIHBhZ2luYXRpbmcsIG9ubHkgdGhlIGZpcnN0IHBhZ2UgZ2V0cyBjYWNoZWQsIHNvIHdlIHJldHVybiB0aGUgZGF0YSB3ZSBnZXQgZnJvbSBgdXNlUHJvbWlzZWAsIGJlY2F1c2VcbiAgLy8gaXQgd2lsbCBiZSBhY2N1bXVsYXRlZC5cbiAgaWYgKHBhZ2luYXRpb25BcmdzUmVmLmN1cnJlbnQgJiYgcGFnaW5hdGlvbkFyZ3NSZWYuY3VycmVudC5wYWdlID4gMCAmJiBzdGF0ZS5kYXRhKSB7XG4gICAgcmV0dXJuZWREYXRhID0gc3RhdGUuZGF0YSBhcyBVbndyYXBSZXR1cm48VD47XG4gICAgLy8gaWYgdGhlIGxhdGVzdCB1cGRhdGUgaWYgZnJvbSB0aGUgUHJvbWlzZSwgd2Uga2VlcCBpdFxuICB9IGVsc2UgaWYgKGxhc3RVcGRhdGVGcm9tLmN1cnJlbnQgPT09IFwicHJvbWlzZVwiKSB7XG4gICAgcmV0dXJuZWREYXRhID0gbGFnZ3lEYXRhUmVmLmN1cnJlbnQ7XG4gIH0gZWxzZSBpZiAoa2VlcFByZXZpb3VzRGF0YSAmJiBjYWNoZWREYXRhICE9PSBlbXB0eUNhY2hlKSB7XG4gICAgLy8gaWYgd2Ugd2FudCB0byBrZWVwIHRoZSBsYXRlc3QgZGF0YSwgd2UgcGljayB0aGUgY2FjaGUgYnV0IG9ubHkgaWYgaXQncyBub3QgZW1wdHlcbiAgICByZXR1cm5lZERhdGEgPSBjYWNoZWREYXRhO1xuICAgIGlmIChwYWdpbmF0aW9uKSB7XG4gICAgICBwYWdpbmF0aW9uLmhhc01vcmUgPSB0cnVlO1xuICAgICAgcGFnaW5hdGlvbi5wYWdlU2l6ZSA9IGNhY2hlZERhdGEubGVuZ3RoO1xuICAgIH1cbiAgfSBlbHNlIGlmIChrZWVwUHJldmlvdXNEYXRhICYmIGNhY2hlZERhdGEgPT09IGVtcHR5Q2FjaGUpIHtcbiAgICAvLyBpZiB0aGUgY2FjaGUgaXMgZW1wdHksIHdlIHdpbGwgcmV0dXJuIHRoZSBwcmV2aW91cyBkYXRhXG4gICAgcmV0dXJuZWREYXRhID0gbGFnZ3lEYXRhUmVmLmN1cnJlbnQ7XG4gICAgLy8gdGhlcmUgYXJlIG5vIHNwZWNpYWwgY2FzZXMsIHNvIGVpdGhlciByZXR1cm4gdGhlIGNhY2hlIG9yIGluaXRpYWwgZGF0YVxuICB9IGVsc2UgaWYgKGNhY2hlZERhdGEgIT09IGVtcHR5Q2FjaGUpIHtcbiAgICByZXR1cm5lZERhdGEgPSBjYWNoZWREYXRhO1xuICAgIGlmIChwYWdpbmF0aW9uKSB7XG4gICAgICBwYWdpbmF0aW9uLmhhc01vcmUgPSB0cnVlO1xuICAgICAgcGFnaW5hdGlvbi5wYWdlU2l6ZSA9IGNhY2hlZERhdGEubGVuZ3RoO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICByZXR1cm5lZERhdGEgPSBpbml0aWFsRGF0YSBhcyBVO1xuICB9XG5cbiAgY29uc3QgbGF0ZXN0RGF0YSA9IHVzZUxhdGVzdChyZXR1cm5lZERhdGEpO1xuXG4gIC8vIHdlIHJld3JpdGUgdGhlIG11dGF0ZSBmdW5jdGlvbiB0byB1cGRhdGUgdGhlIGNhY2hlIGluc3RlYWRcbiAgY29uc3QgbXV0YXRlID0gdXNlQ2FsbGJhY2s8TXV0YXRlUHJvbWlzZTxBd2FpdGVkPFJldHVyblR5cGU8VD4+IHwgVT4+KFxuICAgIGFzeW5jIChhc3luY1VwZGF0ZSwgb3B0aW9ucykgPT4ge1xuICAgICAgbGV0IGRhdGFCZWZvcmVPcHRpbWlzdGljVXBkYXRlO1xuICAgICAgdHJ5IHtcbiAgICAgICAgaWYgKG9wdGlvbnM/Lm9wdGltaXN0aWNVcGRhdGUpIHtcbiAgICAgICAgICBpZiAodHlwZW9mIG9wdGlvbnM/LnJvbGxiYWNrT25FcnJvciAhPT0gXCJmdW5jdGlvblwiICYmIG9wdGlvbnM/LnJvbGxiYWNrT25FcnJvciAhPT0gZmFsc2UpIHtcbiAgICAgICAgICAgIC8vIGtlZXAgdHJhY2sgb2YgdGhlIGRhdGEgYmVmb3JlIHRoZSBvcHRpbWlzdGljIHVwZGF0ZSxcbiAgICAgICAgICAgIC8vIGJ1dCBvbmx5IGlmIHdlIG5lZWQgaXQgKGVnLiBvbmx5IHdoZW4gd2Ugd2FudCB0byBhdXRvbWF0aWNhbGx5IHJvbGxiYWNrIGFmdGVyKVxuICAgICAgICAgICAgZGF0YUJlZm9yZU9wdGltaXN0aWNVcGRhdGUgPSBzdHJ1Y3R1cmVkQ2xvbmUobGF0ZXN0RGF0YS5jdXJyZW50KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3QgZGF0YSA9IG9wdGlvbnMub3B0aW1pc3RpY1VwZGF0ZShsYXRlc3REYXRhLmN1cnJlbnQpO1xuICAgICAgICAgIGxhc3RVcGRhdGVGcm9tLmN1cnJlbnQgPSBcImNhY2hlXCI7XG4gICAgICAgICAgbGFnZ3lEYXRhUmVmLmN1cnJlbnQgPSBkYXRhO1xuICAgICAgICAgIG11dGF0ZUNhY2hlKGRhdGEpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhd2FpdCBfbXV0YXRlKGFzeW5jVXBkYXRlLCB7IHNob3VsZFJldmFsaWRhdGVBZnRlcjogb3B0aW9ucz8uc2hvdWxkUmV2YWxpZGF0ZUFmdGVyIH0pO1xuICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgIGlmICh0eXBlb2Ygb3B0aW9ucz8ucm9sbGJhY2tPbkVycm9yID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICBjb25zdCBkYXRhID0gb3B0aW9ucy5yb2xsYmFja09uRXJyb3IobGF0ZXN0RGF0YS5jdXJyZW50KTtcbiAgICAgICAgICBsYXN0VXBkYXRlRnJvbS5jdXJyZW50ID0gXCJjYWNoZVwiO1xuICAgICAgICAgIGxhZ2d5RGF0YVJlZi5jdXJyZW50ID0gZGF0YTtcbiAgICAgICAgICBtdXRhdGVDYWNoZShkYXRhKTtcbiAgICAgICAgfSBlbHNlIGlmIChvcHRpb25zPy5vcHRpbWlzdGljVXBkYXRlICYmIG9wdGlvbnM/LnJvbGxiYWNrT25FcnJvciAhPT0gZmFsc2UpIHtcbiAgICAgICAgICBsYXN0VXBkYXRlRnJvbS5jdXJyZW50ID0gXCJjYWNoZVwiO1xuICAgICAgICAgIC8vIEB0cy1leHBlY3QtZXJyb3Igd2hlbiB1bmRlZmluZWQsIGl0J3MgZXhwZWN0ZWRcbiAgICAgICAgICBsYWdneURhdGFSZWYuY3VycmVudCA9IGRhdGFCZWZvcmVPcHRpbWlzdGljVXBkYXRlO1xuICAgICAgICAgIC8vIEB0cy1leHBlY3QtZXJyb3Igd2hlbiB1bmRlZmluZWQsIGl0J3MgZXhwZWN0ZWRcbiAgICAgICAgICBtdXRhdGVDYWNoZShkYXRhQmVmb3JlT3B0aW1pc3RpY1VwZGF0ZSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhyb3cgZXJyO1xuICAgICAgfVxuICAgIH0sXG4gICAgW211dGF0ZUNhY2hlLCBfbXV0YXRlLCBsYXRlc3REYXRhLCBsYWdneURhdGFSZWYsIGxhc3RVcGRhdGVGcm9tXSxcbiAgKTtcblxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmIChjYWNoZWREYXRhICE9PSBlbXB0eUNhY2hlKSB7XG4gICAgICBsYXN0VXBkYXRlRnJvbS5jdXJyZW50ID0gXCJjYWNoZVwiO1xuICAgICAgbGFnZ3lEYXRhUmVmLmN1cnJlbnQgPSBjYWNoZWREYXRhO1xuICAgIH1cbiAgfSwgW2NhY2hlZERhdGFdKTtcblxuICByZXR1cm4ge1xuICAgIGRhdGE6IHJldHVybmVkRGF0YSxcbiAgICBpc0xvYWRpbmc6IHN0YXRlLmlzTG9hZGluZyxcbiAgICBlcnJvcjogc3RhdGUuZXJyb3IsXG4gICAgbXV0YXRlOiBwYWdpbmF0aW9uQXJnc1JlZi5jdXJyZW50ICYmIHBhZ2luYXRpb25BcmdzUmVmLmN1cnJlbnQucGFnZSA+IDAgPyBfbXV0YXRlIDogbXV0YXRlLFxuICAgIHBhZ2luYXRpb24sXG4gICAgcmV2YWxpZGF0ZSxcbiAgfTtcbn1cbiIsICJpbXBvcnQgeyB1c2VDYWxsYmFjaywgdXNlTWVtbywgdXNlUmVmIH0gZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgeyB1c2VDYWNoZWRQcm9taXNlLCBDYWNoZWRQcm9taXNlT3B0aW9ucyB9IGZyb20gXCIuL3VzZUNhY2hlZFByb21pc2VcIjtcbmltcG9ydCB7IHVzZUxhdGVzdCB9IGZyb20gXCIuL3VzZUxhdGVzdFwiO1xuaW1wb3J0IHsgRnVuY3Rpb25SZXR1cm5pbmdQYWdpbmF0ZWRQcm9taXNlLCBGdW5jdGlvblJldHVybmluZ1Byb21pc2UsIFVzZUNhY2hlZFByb21pc2VSZXR1cm5UeXBlIH0gZnJvbSBcIi4vdHlwZXNcIjtcbmltcG9ydCB7IGlzSlNPTiB9IGZyb20gXCIuL2ZldGNoLXV0aWxzXCI7XG5pbXBvcnQgeyBoYXNoIH0gZnJvbSBcIi4vaGVscGVyc1wiO1xuXG5hc3luYyBmdW5jdGlvbiBkZWZhdWx0UGFyc2luZyhyZXNwb25zZTogUmVzcG9uc2UpIHtcbiAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgIHRocm93IG5ldyBFcnJvcihyZXNwb25zZS5zdGF0dXNUZXh0KTtcbiAgfVxuXG4gIGNvbnN0IGNvbnRlbnRUeXBlSGVhZGVyID0gcmVzcG9uc2UuaGVhZGVycy5nZXQoXCJjb250ZW50LXR5cGVcIik7XG5cbiAgaWYgKGNvbnRlbnRUeXBlSGVhZGVyICYmIGlzSlNPTihjb250ZW50VHlwZUhlYWRlcikpIHtcbiAgICByZXR1cm4gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICB9XG4gIHJldHVybiBhd2FpdCByZXNwb25zZS50ZXh0KCk7XG59XG5cbmZ1bmN0aW9uIGRlZmF1bHRNYXBwaW5nPFYsIFQgZXh0ZW5kcyB1bmtub3duW10+KHJlc3VsdDogVik6IHsgZGF0YTogVDsgaGFzTW9yZT86IGJvb2xlYW47IGN1cnNvcj86IGFueSB9IHtcbiAgcmV0dXJuIHsgZGF0YTogcmVzdWx0IGFzIHVua25vd24gYXMgVCwgaGFzTW9yZTogZmFsc2UgfTtcbn1cblxudHlwZSBSZXF1ZXN0SW5mbyA9IHN0cmluZyB8IFVSTCB8IGdsb2JhbFRoaXMuUmVxdWVzdDtcbnR5cGUgUGFnaW5hdGVkUmVxdWVzdEluZm8gPSAocGFnaW5hdGlvbjogeyBwYWdlOiBudW1iZXI7IGxhc3RJdGVtPzogYW55OyBjdXJzb3I/OiBhbnkgfSkgPT4gUmVxdWVzdEluZm87XG5cbi8qKlxuICogRmV0Y2hlcyB0aGUgcGFnaW5hdGVkVVJMIGFuZCByZXR1cm5zIHRoZSB7QGxpbmsgQXN5bmNTdGF0ZX0gY29ycmVzcG9uZGluZyB0byB0aGUgZXhlY3V0aW9uIG9mIHRoZSBmZXRjaC4gVGhlIGxhc3QgdmFsdWUgd2lsbCBiZSBrZXB0IGJldHdlZW4gY29tbWFuZCBydW5zLlxuICpcbiAqIEByZW1hcmsgVGhpcyBvdmVybG9hZCBzaG91bGQgYmUgdXNlZCB3aGVuIHdvcmtpbmcgd2l0aCBwYWdpbmF0ZWQgZGF0YSBzb3VyY2VzLlxuICogQHJlbWFyayBXaGVuIHBhZ2luYXRpbmcsIG9ubHkgdGhlIGZpcnN0IHBhZ2Ugd2lsbCBiZSBjYWNoZWQuXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYFxuICogaW1wb3J0IHsgSWNvbiwgSW1hZ2UsIExpc3QgfSBmcm9tIFwiQHJheWNhc3QvYXBpXCI7XG4gKiBpbXBvcnQgeyB1c2VGZXRjaCB9IGZyb20gXCJAcmF5Y2FzdC91dGlsc1wiO1xuICogaW1wb3J0IHsgdXNlU3RhdGUgfSBmcm9tIFwicmVhY3RcIjtcbiAqXG4gKiB0eXBlIFNlYXJjaFJlc3VsdCA9IHsgY29tcGFuaWVzOiBDb21wYW55W107IHBhZ2U6IG51bWJlcjsgdG90YWxQYWdlczogbnVtYmVyIH07XG4gKiB0eXBlIENvbXBhbnkgPSB7IGlkOiBudW1iZXI7IG5hbWU6IHN0cmluZzsgc21hbGxMb2dvVXJsPzogc3RyaW5nIH07XG4gKiBleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBDb21tYW5kKCkge1xuICogICBjb25zdCBbc2VhcmNoVGV4dCwgc2V0U2VhcmNoVGV4dF0gPSB1c2VTdGF0ZShcIlwiKTtcbiAqICAgY29uc3QgeyBpc0xvYWRpbmcsIGRhdGEsIHBhZ2luYXRpb24gfSA9IHVzZUZldGNoKFxuICogICAgIChvcHRpb25zKSA9PlxuICogICAgICAgXCJodHRwczovL2FwaS55Y29tYmluYXRvci5jb20vdjAuMS9jb21wYW5pZXM/XCIgK1xuICogICAgICAgbmV3IFVSTFNlYXJjaFBhcmFtcyh7IHBhZ2U6IFN0cmluZyhvcHRpb25zLnBhZ2UgKyAxKSwgcTogc2VhcmNoVGV4dCB9KS50b1N0cmluZygpLFxuICogICAgIHtcbiAqICAgICAgIG1hcFJlc3VsdChyZXN1bHQ6IFNlYXJjaFJlc3VsdCkge1xuICogICAgICAgICByZXR1cm4ge1xuICogICAgICAgICAgIGRhdGE6IHJlc3VsdC5jb21wYW5pZXMsXG4gKiAgICAgICAgICAgaGFzTW9yZTogcmVzdWx0LnBhZ2UgPCByZXN1bHQudG90YWxQYWdlcyxcbiAqICAgICAgICAgfTtcbiAqICAgICAgIH0sXG4gKiAgICAgICBrZWVwUHJldmlvdXNEYXRhOiB0cnVlLFxuICogICAgICAgaW5pdGlhbERhdGE6IFtdLFxuICogICAgIH0sXG4gKiAgICk7XG4gKlxuICogICByZXR1cm4gKFxuICogICAgIDxMaXN0IGlzTG9hZGluZz17aXNMb2FkaW5nfSBwYWdpbmF0aW9uPXtwYWdpbmF0aW9ufSBvblNlYXJjaFRleHRDaGFuZ2U9e3NldFNlYXJjaFRleHR9PlxuICogICAgICAge2RhdGEubWFwKChjb21wYW55KSA9PiAoXG4gKiAgICAgICAgIDxMaXN0Lkl0ZW1cbiAqICAgICAgICAgICBrZXk9e2NvbXBhbnkuaWR9XG4gKiAgICAgICAgICAgaWNvbj17eyBzb3VyY2U6IGNvbXBhbnkuc21hbGxMb2dvVXJsID8/IEljb24uTWludXNDaXJjbGUsIG1hc2s6IEltYWdlLk1hc2suUm91bmRlZFJlY3RhbmdsZSB9fVxuICogICAgICAgICAgIHRpdGxlPXtjb21wYW55Lm5hbWV9XG4gKiAgICAgICAgIC8+XG4gKiAgICAgICApKX1cbiAqICAgICA8L0xpc3Q+XG4gKiAgICk7XG4gKiB9XG4gKiBgYGBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHVzZUZldGNoPFYgPSB1bmtub3duLCBVID0gdW5kZWZpbmVkLCBUIGV4dGVuZHMgdW5rbm93bltdID0gdW5rbm93bltdPihcbiAgdXJsOiBQYWdpbmF0ZWRSZXF1ZXN0SW5mbyxcbiAgb3B0aW9uczogUmVxdWVzdEluaXQgJiB7XG4gICAgbWFwUmVzdWx0OiAocmVzdWx0OiBWKSA9PiB7IGRhdGE6IFQ7IGhhc01vcmU/OiBib29sZWFuOyBjdXJzb3I/OiBhbnkgfTtcbiAgICBwYXJzZVJlc3BvbnNlPzogKHJlc3BvbnNlOiBSZXNwb25zZSkgPT4gUHJvbWlzZTxWPjtcbiAgfSAmIE9taXQ8Q2FjaGVkUHJvbWlzZU9wdGlvbnM8KHVybDogUmVxdWVzdEluZm8sIG9wdGlvbnM/OiBSZXF1ZXN0SW5pdCkgPT4gUHJvbWlzZTxUPiwgVT4sIFwiYWJvcnRhYmxlXCI+LFxuKTogVXNlQ2FjaGVkUHJvbWlzZVJldHVyblR5cGU8VCwgVT47XG4vKipcbiAqIEZldGNoIHRoZSBVUkwgYW5kIHJldHVybnMgdGhlIHtAbGluayBBc3luY1N0YXRlfSBjb3JyZXNwb25kaW5nIHRvIHRoZSBleGVjdXRpb24gb2YgdGhlIGZldGNoLiBUaGUgbGFzdCB2YWx1ZSB3aWxsIGJlIGtlcHQgYmV0d2VlbiBjb21tYW5kIHJ1bnMuXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYFxuICogaW1wb3J0IHsgdXNlRmV0Y2ggfSBmcm9tICdAcmF5Y2FzdC91dGlscyc7XG4gKlxuICogZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gQ29tbWFuZCgpIHtcbiAqICAgY29uc3QgeyBpc0xvYWRpbmcsIGRhdGEsIHJldmFsaWRhdGUgfSA9IHVzZUZldGNoKCdodHRwczovL2FwaS5leGFtcGxlJyk7XG4gKlxuICogICByZXR1cm4gKFxuICogICAgIDxEZXRhaWxcbiAqICAgICAgIGlzTG9hZGluZz17aXNMb2FkaW5nfVxuICogICAgICAgbWFya2Rvd249e2RhdGF9XG4gKiAgICAgICBhY3Rpb25zPXtcbiAqICAgICAgICAgPEFjdGlvblBhbmVsPlxuICogICAgICAgICAgIDxBY3Rpb24gdGl0bGU9XCJSZWxvYWRcIiBvbkFjdGlvbj17KCkgPT4gcmV2YWxpZGF0ZSgpfSAvPlxuICogICAgICAgICA8L0FjdGlvblBhbmVsPlxuICogICAgICAgfVxuICogICAgIC8+XG4gKiAgICk7XG4gKiB9O1xuICogYGBgXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB1c2VGZXRjaDxWID0gdW5rbm93biwgVSA9IHVuZGVmaW5lZCwgVCA9IFY+KFxuICB1cmw6IFJlcXVlc3RJbmZvLFxuICBvcHRpb25zPzogUmVxdWVzdEluaXQgJiB7XG4gICAgbWFwUmVzdWx0PzogKHJlc3VsdDogVikgPT4geyBkYXRhOiBUOyBoYXNNb3JlPzogYm9vbGVhbjsgY3Vyc29yPzogYW55IH07XG4gICAgcGFyc2VSZXNwb25zZT86IChyZXNwb25zZTogUmVzcG9uc2UpID0+IFByb21pc2U8Vj47XG4gIH0gJiBPbWl0PENhY2hlZFByb21pc2VPcHRpb25zPCh1cmw6IFJlcXVlc3RJbmZvLCBvcHRpb25zPzogUmVxdWVzdEluaXQpID0+IFByb21pc2U8VD4sIFU+LCBcImFib3J0YWJsZVwiPixcbik6IFVzZUNhY2hlZFByb21pc2VSZXR1cm5UeXBlPFQsIFU+ICYgeyBwYWdpbmF0aW9uOiB1bmRlZmluZWQgfTtcblxuZXhwb3J0IGZ1bmN0aW9uIHVzZUZldGNoPFYgPSB1bmtub3duLCBVID0gdW5kZWZpbmVkLCBUIGV4dGVuZHMgdW5rbm93bltdID0gdW5rbm93bltdPihcbiAgdXJsOiBSZXF1ZXN0SW5mbyB8IFBhZ2luYXRlZFJlcXVlc3RJbmZvLFxuICBvcHRpb25zPzogUmVxdWVzdEluaXQgJiB7XG4gICAgbWFwUmVzdWx0PzogKHJlc3VsdDogVikgPT4geyBkYXRhOiBUOyBoYXNNb3JlPzogYm9vbGVhbjsgY3Vyc29yPzogYW55IH07XG4gICAgcGFyc2VSZXNwb25zZT86IChyZXNwb25zZTogUmVzcG9uc2UpID0+IFByb21pc2U8Vj47XG4gIH0gJiBPbWl0PENhY2hlZFByb21pc2VPcHRpb25zPCh1cmw6IFJlcXVlc3RJbmZvLCBvcHRpb25zPzogUmVxdWVzdEluaXQpID0+IFByb21pc2U8VD4sIFU+LCBcImFib3J0YWJsZVwiPixcbik6IFVzZUNhY2hlZFByb21pc2VSZXR1cm5UeXBlPFQsIFU+IHtcbiAgY29uc3Qge1xuICAgIHBhcnNlUmVzcG9uc2UsXG4gICAgbWFwUmVzdWx0LFxuICAgIGluaXRpYWxEYXRhLFxuICAgIGV4ZWN1dGUsXG4gICAga2VlcFByZXZpb3VzRGF0YSxcbiAgICBvbkVycm9yLFxuICAgIG9uRGF0YSxcbiAgICBvbldpbGxFeGVjdXRlLFxuICAgIGZhaWx1cmVUb2FzdE9wdGlvbnMsXG4gICAgLi4uZmV0Y2hPcHRpb25zXG4gIH0gPSBvcHRpb25zIHx8IHt9O1xuXG4gIGNvbnN0IHVzZUNhY2hlZFByb21pc2VPcHRpb25zOiBDYWNoZWRQcm9taXNlT3B0aW9uczwodXJsOiBSZXF1ZXN0SW5mbywgb3B0aW9ucz86IFJlcXVlc3RJbml0KSA9PiBQcm9taXNlPFQ+LCBVPiA9IHtcbiAgICBpbml0aWFsRGF0YSxcbiAgICBleGVjdXRlLFxuICAgIGtlZXBQcmV2aW91c0RhdGEsXG4gICAgb25FcnJvcixcbiAgICBvbkRhdGEsXG4gICAgb25XaWxsRXhlY3V0ZSxcbiAgICBmYWlsdXJlVG9hc3RPcHRpb25zLFxuICB9O1xuXG4gIGNvbnN0IHBhcnNlUmVzcG9uc2VSZWYgPSB1c2VMYXRlc3QocGFyc2VSZXNwb25zZSB8fCBkZWZhdWx0UGFyc2luZyk7XG4gIGNvbnN0IG1hcFJlc3VsdFJlZiA9IHVzZUxhdGVzdChtYXBSZXN1bHQgfHwgZGVmYXVsdE1hcHBpbmcpO1xuICBjb25zdCB1cmxSZWYgPSB1c2VSZWY8UmVxdWVzdEluZm8gfCBQYWdpbmF0ZWRSZXF1ZXN0SW5mbz4obnVsbCk7XG4gIGNvbnN0IGZpcnN0UGFnZVVybFJlZiA9IHVzZVJlZjxSZXF1ZXN0SW5mbyB8IHVuZGVmaW5lZD4obnVsbCk7XG4gIGNvbnN0IGZpcnN0UGFnZVVybCA9IHR5cGVvZiB1cmwgPT09IFwiZnVuY3Rpb25cIiA/IHVybCh7IHBhZ2U6IDAgfSkgOiB1bmRlZmluZWQ7XG4gIC8qKlxuICAgKiBXaGVuIHBhZ2luYXRpbmcsIGB1cmxgIGlzIGEgYFBhZ2luYXRlZFJlcXVlc3RJbmZvYCwgc28gd2Ugb25seSB3YW50IHRvIHVwZGF0ZSB0aGUgcmVmIHdoZW4gdGhlIGBmaXJzdFBhZ2VVcmxgIGNoYW5nZXMuXG4gICAqIFdoZW4gbm90IHBhZ2luYXRpbmcsIGB1cmxgIGlzIGEgYFJlcXVlc3RJbmZvYCwgc28gd2Ugd2FudCB0byB1cGRhdGUgdGhlIHJlZiB3aGVuZXZlciBgdXJsYCBjaGFuZ2VzLlxuICAgKi9cbiAgaWYgKCF1cmxSZWYuY3VycmVudCB8fCB0eXBlb2YgZmlyc3RQYWdlVXJsUmVmLmN1cnJlbnQgPT09IFwidW5kZWZpbmVkXCIgfHwgZmlyc3RQYWdlVXJsUmVmLmN1cnJlbnQgIT09IGZpcnN0UGFnZVVybCkge1xuICAgIHVybFJlZi5jdXJyZW50ID0gdXJsO1xuICB9XG4gIGZpcnN0UGFnZVVybFJlZi5jdXJyZW50ID0gZmlyc3RQYWdlVXJsO1xuICBjb25zdCBhYm9ydGFibGUgPSB1c2VSZWY8QWJvcnRDb250cm9sbGVyPihudWxsKTtcblxuICBjb25zdCBwYWdpbmF0ZWRGbjogRnVuY3Rpb25SZXR1cm5pbmdQYWdpbmF0ZWRQcm9taXNlPFtQYWdpbmF0ZWRSZXF1ZXN0SW5mbywgdHlwZW9mIGZldGNoT3B0aW9uc10sIFQ+ID0gdXNlQ2FsbGJhY2soXG4gICAgKHVybDogUGFnaW5hdGVkUmVxdWVzdEluZm8sIG9wdGlvbnM/OiBSZXF1ZXN0SW5pdCkgPT4gYXN5bmMgKHBhZ2luYXRpb246IHsgcGFnZTogbnVtYmVyIH0pID0+IHtcbiAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoKHVybChwYWdpbmF0aW9uKSwgeyBzaWduYWw6IGFib3J0YWJsZS5jdXJyZW50Py5zaWduYWwsIC4uLm9wdGlvbnMgfSk7XG4gICAgICBjb25zdCBwYXJzZWQgPSAoYXdhaXQgcGFyc2VSZXNwb25zZVJlZi5jdXJyZW50KHJlcykpIGFzIFY7XG4gICAgICByZXR1cm4gbWFwUmVzdWx0UmVmLmN1cnJlbnQ/LihwYXJzZWQpO1xuICAgIH0sXG4gICAgW3BhcnNlUmVzcG9uc2VSZWYsIG1hcFJlc3VsdFJlZl0sXG4gICk7XG4gIGNvbnN0IGZuOiBGdW5jdGlvblJldHVybmluZ1Byb21pc2U8W1JlcXVlc3RJbmZvLCBSZXF1ZXN0SW5pdD9dLCBUPiA9IHVzZUNhbGxiYWNrKFxuICAgIGFzeW5jICh1cmw6IFJlcXVlc3RJbmZvLCBvcHRpb25zPzogUmVxdWVzdEluaXQpID0+IHtcbiAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoKHVybCwgeyBzaWduYWw6IGFib3J0YWJsZS5jdXJyZW50Py5zaWduYWwsIC4uLm9wdGlvbnMgfSk7XG4gICAgICBjb25zdCBwYXJzZWQgPSAoYXdhaXQgcGFyc2VSZXNwb25zZVJlZi5jdXJyZW50KHJlcykpIGFzIFY7XG4gICAgICBjb25zdCBtYXBwZWQgPSBtYXBSZXN1bHRSZWYuY3VycmVudChwYXJzZWQpO1xuICAgICAgcmV0dXJuIG1hcHBlZD8uZGF0YSBhcyB1bmtub3duIGFzIFQ7XG4gICAgfSxcbiAgICBbcGFyc2VSZXNwb25zZVJlZiwgbWFwUmVzdWx0UmVmXSxcbiAgKTtcblxuICBjb25zdCBwcm9taXNlID0gdXNlTWVtbygoKSA9PiB7XG4gICAgaWYgKGZpcnN0UGFnZVVybFJlZi5jdXJyZW50KSB7XG4gICAgICByZXR1cm4gcGFnaW5hdGVkRm47XG4gICAgfVxuICAgIHJldHVybiBmbjtcbiAgfSwgW2ZpcnN0UGFnZVVybFJlZiwgZm4sIHBhZ2luYXRlZEZuXSk7XG5cbiAgLy8gQHRzLWV4cGVjdC1lcnJvciBsYXN0SXRlbSBjYW4ndCBiZSBpbmZlcnJlZCBwcm9wZXJseVxuICByZXR1cm4gdXNlQ2FjaGVkUHJvbWlzZShwcm9taXNlLCBbdXJsUmVmLmN1cnJlbnQgYXMgUGFnaW5hdGVkUmVxdWVzdEluZm8sIGZldGNoT3B0aW9uc10sIHtcbiAgICAuLi51c2VDYWNoZWRQcm9taXNlT3B0aW9ucyxcbiAgICBpbnRlcm5hbF9jYWNoZUtleVN1ZmZpeDogZmlyc3RQYWdlVXJsUmVmLmN1cnJlbnQgKyBoYXNoKG1hcFJlc3VsdFJlZi5jdXJyZW50KSArIGhhc2gocGFyc2VSZXNwb25zZVJlZi5jdXJyZW50KSxcbiAgICBhYm9ydGFibGUsXG4gIH0pO1xufVxuIiwgImV4cG9ydCBmdW5jdGlvbiBpc0pTT04oY29udGVudFR5cGVIZWFkZXI6IHN0cmluZyB8IG51bGwgfCB1bmRlZmluZWQpOiBib29sZWFuIHtcbiAgaWYgKGNvbnRlbnRUeXBlSGVhZGVyKSB7XG4gICAgY29uc3QgbWVkaWFUeXBlID0gcGFyc2VDb250ZW50VHlwZShjb250ZW50VHlwZUhlYWRlcik7XG5cbiAgICBpZiAoIW1lZGlhVHlwZSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIGlmIChtZWRpYVR5cGUuc3VidHlwZSA9PT0gXCJqc29uXCIpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIGlmIChtZWRpYVR5cGUuc3VmZml4ID09PSBcImpzb25cIikge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgaWYgKG1lZGlhVHlwZS5zdWZmaXggJiYgL1xcYmpzb25cXGIvaS50ZXN0KG1lZGlhVHlwZS5zdWZmaXgpKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICBpZiAobWVkaWFUeXBlLnN1YnR5cGUgJiYgL1xcYmpzb25cXGIvaS50ZXN0KG1lZGlhVHlwZS5zdWJ0eXBlKSkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICB9XG4gIHJldHVybiBmYWxzZTtcbn1cblxuLyoqXG4gKiBSZWdFeHAgdG8gbWF0Y2ggdHlwZSBpbiBSRkMgNjgzOCB3aXRoIGFuIG9wdGlvbmFsIHRyYWlsaW5nIGA7YCBiZWNhdXNlIHNvbWUgQXBwbGUgQVBJcyByZXR1cm5zIG9uZS4uLlxuICpcbiAqIHR5cGUtbmFtZSA9IHJlc3RyaWN0ZWQtbmFtZVxuICogc3VidHlwZS1uYW1lID0gcmVzdHJpY3RlZC1uYW1lXG4gKiByZXN0cmljdGVkLW5hbWUgPSByZXN0cmljdGVkLW5hbWUtZmlyc3QgKjEyNnJlc3RyaWN0ZWQtbmFtZS1jaGFyc1xuICogcmVzdHJpY3RlZC1uYW1lLWZpcnN0ICA9IEFMUEhBIC8gRElHSVRcbiAqIHJlc3RyaWN0ZWQtbmFtZS1jaGFycyAgPSBBTFBIQSAvIERJR0lUIC8gXCIhXCIgLyBcIiNcIiAvXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgXCIkXCIgLyBcIiZcIiAvIFwiLVwiIC8gXCJeXCIgLyBcIl9cIlxuICogcmVzdHJpY3RlZC1uYW1lLWNoYXJzID0vIFwiLlwiIDsgQ2hhcmFjdGVycyBiZWZvcmUgZmlyc3QgZG90IGFsd2F5c1xuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICA7IHNwZWNpZnkgYSBmYWNldCBuYW1lXG4gKiByZXN0cmljdGVkLW5hbWUtY2hhcnMgPS8gXCIrXCIgOyBDaGFyYWN0ZXJzIGFmdGVyIGxhc3QgcGx1cyBhbHdheXNcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOyBzcGVjaWZ5IGEgc3RydWN0dXJlZCBzeW50YXggc3VmZml4XG4gKiBBTFBIQSA9ICAleDQxLTVBIC8gJXg2MS03QSAgIDsgQS1aIC8gYS16XG4gKiBESUdJVCA9ICAleDMwLTM5ICAgICAgICAgICAgIDsgMC05XG4gKi9cbmNvbnN0IE1FRElBX1RZUEVfUkVHRVhQID0gL14oW0EtWmEtejAtOV1bQS1aYS16MC05ISMkJl5fLV17MCwxMjZ9KVxcLyhbQS1aYS16MC05XVtBLVphLXowLTkhIyQmXl8uKy1dezAsMTI2fSk7PyQvO1xuXG5mdW5jdGlvbiBwYXJzZUNvbnRlbnRUeXBlKGhlYWRlcjogc3RyaW5nKSB7XG4gIGNvbnN0IGhlYWRlckRlbGltaXRhdGlvbmluZGV4ID0gaGVhZGVyLmluZGV4T2YoXCI7XCIpO1xuICBjb25zdCBjb250ZW50VHlwZSA9IGhlYWRlckRlbGltaXRhdGlvbmluZGV4ICE9PSAtMSA/IGhlYWRlci5zbGljZSgwLCBoZWFkZXJEZWxpbWl0YXRpb25pbmRleCkudHJpbSgpIDogaGVhZGVyLnRyaW0oKTtcblxuICBjb25zdCBtYXRjaCA9IE1FRElBX1RZUEVfUkVHRVhQLmV4ZWMoY29udGVudFR5cGUudG9Mb3dlckNhc2UoKS50b0xvd2VyQ2FzZSgpKTtcblxuICBpZiAoIW1hdGNoKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgY29uc3QgdHlwZSA9IG1hdGNoWzFdO1xuICBsZXQgc3VidHlwZSA9IG1hdGNoWzJdO1xuICBsZXQgc3VmZml4O1xuXG4gIC8vIHN1ZmZpeCBhZnRlciBsYXN0ICtcbiAgY29uc3QgaW5kZXggPSBzdWJ0eXBlLmxhc3RJbmRleE9mKFwiK1wiKTtcbiAgaWYgKGluZGV4ICE9PSAtMSkge1xuICAgIHN1ZmZpeCA9IHN1YnR5cGUuc3Vic3RyaW5nKGluZGV4ICsgMSk7XG4gICAgc3VidHlwZSA9IHN1YnR5cGUuc3Vic3RyaW5nKDAsIGluZGV4KTtcbiAgfVxuXG4gIHJldHVybiB7IHR5cGUsIHN1YnR5cGUsIHN1ZmZpeCB9O1xufVxuIiwgIi8qXG4gKiBJbnNwaXJlZCBieSBFeGVjYVxuICovXG5cbmltcG9ydCBjaGlsZFByb2Nlc3MgZnJvbSBcIm5vZGU6Y2hpbGRfcHJvY2Vzc1wiO1xuaW1wb3J0IHsgdXNlQ2FsbGJhY2ssIHVzZVJlZiB9IGZyb20gXCJyZWFjdFwiO1xuXG5pbXBvcnQgeyB1c2VDYWNoZWRQcm9taXNlLCBDYWNoZWRQcm9taXNlT3B0aW9ucyB9IGZyb20gXCIuL3VzZUNhY2hlZFByb21pc2VcIjtcbmltcG9ydCB7IHVzZUxhdGVzdCB9IGZyb20gXCIuL3VzZUxhdGVzdFwiO1xuaW1wb3J0IHsgVXNlQ2FjaGVkUHJvbWlzZVJldHVyblR5cGUgfSBmcm9tIFwiLi90eXBlc1wiO1xuaW1wb3J0IHtcbiAgZ2V0U3Bhd25lZFByb21pc2UsXG4gIGdldFNwYXduZWRSZXN1bHQsXG4gIGhhbmRsZU91dHB1dCxcbiAgZGVmYXVsdFBhcnNpbmcsXG4gIFBhcnNlRXhlY091dHB1dEhhbmRsZXIsXG59IGZyb20gXCIuL2V4ZWMtdXRpbHNcIjtcblxudHlwZSBFeGVjT3B0aW9ucyA9IHtcbiAgLyoqXG4gICAqIElmIGB0cnVlYCwgcnVucyB0aGUgY29tbWFuZCBpbnNpZGUgb2YgYSBzaGVsbC4gVXNlcyBgL2Jpbi9zaGAuIEEgZGlmZmVyZW50IHNoZWxsIGNhbiBiZSBzcGVjaWZpZWQgYXMgYSBzdHJpbmcuIFRoZSBzaGVsbCBzaG91bGQgdW5kZXJzdGFuZCB0aGUgYC1jYCBzd2l0Y2guXG4gICAqXG4gICAqIFdlIHJlY29tbWVuZCBhZ2FpbnN0IHVzaW5nIHRoaXMgb3B0aW9uIHNpbmNlIGl0IGlzOlxuICAgKiAtIG5vdCBjcm9zcy1wbGF0Zm9ybSwgZW5jb3VyYWdpbmcgc2hlbGwtc3BlY2lmaWMgc3ludGF4LlxuICAgKiAtIHNsb3dlciwgYmVjYXVzZSBvZiB0aGUgYWRkaXRpb25hbCBzaGVsbCBpbnRlcnByZXRhdGlvbi5cbiAgICogLSB1bnNhZmUsIHBvdGVudGlhbGx5IGFsbG93aW5nIGNvbW1hbmQgaW5qZWN0aW9uLlxuICAgKlxuICAgKiBAZGVmYXVsdCBmYWxzZVxuICAgKi9cbiAgc2hlbGw/OiBib29sZWFuIHwgc3RyaW5nO1xuICAvKipcbiAgICogU3RyaXAgdGhlIGZpbmFsIG5ld2xpbmUgY2hhcmFjdGVyIGZyb20gdGhlIG91dHB1dC5cbiAgICogQGRlZmF1bHQgdHJ1ZVxuICAgKi9cbiAgc3RyaXBGaW5hbE5ld2xpbmU/OiBib29sZWFuO1xuICAvKipcbiAgICogQ3VycmVudCB3b3JraW5nIGRpcmVjdG9yeSBvZiB0aGUgY2hpbGQgcHJvY2Vzcy5cbiAgICogQGRlZmF1bHQgcHJvY2Vzcy5jd2QoKVxuICAgKi9cbiAgY3dkPzogc3RyaW5nO1xuICAvKipcbiAgICogRW52aXJvbm1lbnQga2V5LXZhbHVlIHBhaXJzLiBFeHRlbmRzIGF1dG9tYXRpY2FsbHkgZnJvbSBgcHJvY2Vzcy5lbnZgLlxuICAgKiBAZGVmYXVsdCBwcm9jZXNzLmVudlxuICAgKi9cbiAgZW52PzogTm9kZUpTLlByb2Nlc3NFbnY7XG4gIC8qKlxuICAgKiBTcGVjaWZ5IHRoZSBjaGFyYWN0ZXIgZW5jb2RpbmcgdXNlZCB0byBkZWNvZGUgdGhlIHN0ZG91dCBhbmQgc3RkZXJyIG91dHB1dC4gSWYgc2V0IHRvIGBcImJ1ZmZlclwiYCwgdGhlbiBzdGRvdXQgYW5kIHN0ZGVyciB3aWxsIGJlIGEgQnVmZmVyIGluc3RlYWQgb2YgYSBzdHJpbmcuXG4gICAqXG4gICAqIEBkZWZhdWx0IFwidXRmOFwiXG4gICAqL1xuICBlbmNvZGluZz86IEJ1ZmZlckVuY29kaW5nIHwgXCJidWZmZXJcIjtcbiAgLyoqXG4gICAqIFdyaXRlIHNvbWUgaW5wdXQgdG8gdGhlIGBzdGRpbmAgb2YgeW91ciBiaW5hcnkuXG4gICAqL1xuICBpbnB1dD86IHN0cmluZyB8IEJ1ZmZlcjtcbiAgLyoqIElmIHRpbWVvdXQgaXMgZ3JlYXRlciB0aGFuIGAwYCwgdGhlIHBhcmVudCB3aWxsIHNlbmQgdGhlIHNpZ25hbCBgU0lHVEVSTWAgaWYgdGhlIGNoaWxkIHJ1bnMgbG9uZ2VyIHRoYW4gdGltZW91dCBtaWxsaXNlY29uZHMuXG4gICAqXG4gICAqIEBkZWZhdWx0IDEwMDAwXG4gICAqL1xuICB0aW1lb3V0PzogbnVtYmVyO1xufTtcblxuY29uc3QgU1BBQ0VTX1JFR0VYUCA9IC8gKy9nO1xuZnVuY3Rpb24gcGFyc2VDb21tYW5kKGNvbW1hbmQ6IHN0cmluZywgYXJncz86IHN0cmluZ1tdKSB7XG4gIGlmIChhcmdzKSB7XG4gICAgcmV0dXJuIFtjb21tYW5kLCAuLi5hcmdzXTtcbiAgfVxuICBjb25zdCB0b2tlbnM6IHN0cmluZ1tdID0gW107XG4gIGZvciAoY29uc3QgdG9rZW4gb2YgY29tbWFuZC50cmltKCkuc3BsaXQoU1BBQ0VTX1JFR0VYUCkpIHtcbiAgICAvLyBBbGxvdyBzcGFjZXMgdG8gYmUgZXNjYXBlZCBieSBhIGJhY2tzbGFzaCBpZiBub3QgbWVhbnQgYXMgYSBkZWxpbWl0ZXJcbiAgICBjb25zdCBwcmV2aW91c1Rva2VuID0gdG9rZW5zW3Rva2Vucy5sZW5ndGggLSAxXTtcbiAgICBpZiAocHJldmlvdXNUb2tlbiAmJiBwcmV2aW91c1Rva2VuLmVuZHNXaXRoKFwiXFxcXFwiKSkge1xuICAgICAgLy8gTWVyZ2UgcHJldmlvdXMgdG9rZW4gd2l0aCBjdXJyZW50IG9uZVxuICAgICAgdG9rZW5zW3Rva2Vucy5sZW5ndGggLSAxXSA9IGAke3ByZXZpb3VzVG9rZW4uc2xpY2UoMCwgLTEpfSAke3Rva2VufWA7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRva2Vucy5wdXNoKHRva2VuKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gdG9rZW5zO1xufVxuXG50eXBlIEV4ZWNDYWNoZWRQcm9taXNlT3B0aW9uczxULCBVPiA9IE9taXQ8XG4gIENhY2hlZFByb21pc2VPcHRpb25zPFxuICAgIChfY29tbWFuZDogc3RyaW5nLCBfYXJnczogc3RyaW5nW10sIF9vcHRpb25zPzogRXhlY09wdGlvbnMsIGlucHV0Pzogc3RyaW5nIHwgQnVmZmVyKSA9PiBQcm9taXNlPFQ+LFxuICAgIFVcbiAgPixcbiAgXCJhYm9ydGFibGVcIlxuPjtcblxuLyoqXG4gKiBFeGVjdXRlcyBhIGNvbW1hbmQgYW5kIHJldHVybnMgdGhlIHtAbGluayBBc3luY1N0YXRlfSBjb3JyZXNwb25kaW5nIHRvIHRoZSBleGVjdXRpb24gb2YgdGhlIGNvbW1hbmQuIFRoZSBsYXN0IHZhbHVlIHdpbGwgYmUga2VwdCBiZXR3ZWVuIGNvbW1hbmQgcnVucy5cbiAqXG4gKiBAcmVtYXJrIFdoZW4gc3BlY2lmeWluZyB0aGUgYXJndW1lbnRzIHZpYSB0aGUgYGNvbW1hbmRgIHN0cmluZywgaWYgdGhlIGZpbGUgb3IgYW4gYXJndW1lbnQgb2YgdGhlIGNvbW1hbmQgY29udGFpbnMgc3BhY2VzLCB0aGV5IG11c3QgYmUgZXNjYXBlZCB3aXRoIGJhY2tzbGFzaGVzLiBUaGlzIG1hdHRlcnMgZXNwZWNpYWxseSBpZiBgY29tbWFuZGAgaXMgbm90IGEgY29uc3RhbnQgYnV0IGEgdmFyaWFibGUsIGZvciBleGFtcGxlIHdpdGggYF9fZGlybmFtZWAgb3IgYHByb2Nlc3MuY3dkKClgLiBFeGNlcHQgZm9yIHNwYWNlcywgbm8gZXNjYXBpbmcvcXVvdGluZyBpcyBuZWVkZWQuXG4gKlxuICogVGhlIGBzaGVsbGAgb3B0aW9uIG11c3QgYmUgdXNlZCBpZiB0aGUgY29tbWFuZCB1c2VzIHNoZWxsLXNwZWNpZmljIGZlYXR1cmVzIChmb3IgZXhhbXBsZSwgYCYmYCBvciBgfHxgKSwgYXMgb3Bwb3NlZCB0byBiZWluZyBhIHNpbXBsZSBmaWxlIGZvbGxvd2VkIGJ5IGl0cyBhcmd1bWVudHMuXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYFxuICogaW1wb3J0IHsgdXNlRXhlYyB9IGZyb20gJ0ByYXljYXN0L3V0aWxzJztcbiAqXG4gKiBleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBDb21tYW5kKCkge1xuICogICBjb25zdCB7IGlzTG9hZGluZywgZGF0YSwgcmV2YWxpZGF0ZSB9ID0gdXNlRXhlYyhcImJyZXdcIiwgW1wiaW5mb1wiLCBcIi0tanNvbj12MlwiLCBcIi0taW5zdGFsbGVkXCJdKTtcbiAqICAgY29uc3QgcmVzdWx0cyA9IHVzZU1lbW88e31bXT4oKCkgPT4gSlNPTi5wYXJzZShkYXRhIHx8IFwiW11cIiksIFtkYXRhXSk7XG4gKlxuICogICByZXR1cm4gKFxuICogICAgIDxMaXN0IGlzTG9hZGluZz17aXNMb2FkaW5nfT5cbiAqICAgICAgeyhkYXRhIHx8IFtdKS5tYXAoKGl0ZW0pID0+IChcbiAqICAgICAgICA8TGlzdC5JdGVtIGtleT17aXRlbS5pZH0gdGl0bGU9e2l0ZW0ubmFtZX0gLz5cbiAqICAgICAgKSl9XG4gKiAgICA8L0xpc3Q+XG4gKiAgICk7XG4gKiB9O1xuICogYGBgXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB1c2VFeGVjPFQgPSBCdWZmZXIsIFUgPSB1bmRlZmluZWQ+KFxuICBjb21tYW5kOiBzdHJpbmcsXG4gIG9wdGlvbnM6IHtcbiAgICBwYXJzZU91dHB1dD86IFBhcnNlRXhlY091dHB1dEhhbmRsZXI8VCwgQnVmZmVyLCBFeGVjT3B0aW9ucz47XG4gIH0gJiBFeGVjT3B0aW9ucyAmIHtcbiAgICAgIGVuY29kaW5nOiBcImJ1ZmZlclwiO1xuICAgIH0gJiBFeGVjQ2FjaGVkUHJvbWlzZU9wdGlvbnM8VCwgVT4sXG4pOiBVc2VDYWNoZWRQcm9taXNlUmV0dXJuVHlwZTxULCBVPjtcbmV4cG9ydCBmdW5jdGlvbiB1c2VFeGVjPFQgPSBzdHJpbmcsIFUgPSB1bmRlZmluZWQ+KFxuICBjb21tYW5kOiBzdHJpbmcsXG4gIG9wdGlvbnM/OiB7XG4gICAgcGFyc2VPdXRwdXQ/OiBQYXJzZUV4ZWNPdXRwdXRIYW5kbGVyPFQsIHN0cmluZywgRXhlY09wdGlvbnM+O1xuICB9ICYgRXhlY09wdGlvbnMgJiB7XG4gICAgICBlbmNvZGluZz86IEJ1ZmZlckVuY29kaW5nO1xuICAgIH0gJiBFeGVjQ2FjaGVkUHJvbWlzZU9wdGlvbnM8VCwgVT4sXG4pOiBVc2VDYWNoZWRQcm9taXNlUmV0dXJuVHlwZTxULCBVPjtcbmV4cG9ydCBmdW5jdGlvbiB1c2VFeGVjPFQgPSBCdWZmZXIsIFUgPSB1bmRlZmluZWQ+KFxuICBmaWxlOiBzdHJpbmcsXG4gIC8qKlxuICAgKiBUaGUgYXJndW1lbnRzIHRvIHBhc3MgdG8gdGhlIGZpbGUuIE5vIGVzY2FwaW5nL3F1b3RpbmcgaXMgbmVlZGVkLlxuICAgKlxuICAgKiBJZiBkZWZpbmVkLCB0aGUgY29tbWFuZHMgbmVlZHMgdG8gYmUgYSBmaWxlIHRvIGV4ZWN1dGUuIElmIHVuZGVmaW5lZCwgdGhlIGFyZ3VtZW50cyB3aWxsIGJlIHBhcnNlZCBmcm9tIHRoZSBjb21tYW5kLlxuICAgKi9cbiAgYXJnczogc3RyaW5nW10sXG4gIG9wdGlvbnM6IHtcbiAgICBwYXJzZU91dHB1dD86IFBhcnNlRXhlY091dHB1dEhhbmRsZXI8VCwgQnVmZmVyLCBFeGVjT3B0aW9ucz47XG4gIH0gJiBFeGVjT3B0aW9ucyAmIHtcbiAgICAgIGVuY29kaW5nOiBcImJ1ZmZlclwiO1xuICAgIH0gJiBFeGVjQ2FjaGVkUHJvbWlzZU9wdGlvbnM8VCwgVT4sXG4pOiBVc2VDYWNoZWRQcm9taXNlUmV0dXJuVHlwZTxULCBVPjtcbmV4cG9ydCBmdW5jdGlvbiB1c2VFeGVjPFQgPSBzdHJpbmcsIFUgPSB1bmRlZmluZWQ+KFxuICBmaWxlOiBzdHJpbmcsXG4gIC8qKlxuICAgKiBUaGUgYXJndW1lbnRzIHRvIHBhc3MgdG8gdGhlIGZpbGUuIE5vIGVzY2FwaW5nL3F1b3RpbmcgaXMgbmVlZGVkLlxuICAgKlxuICAgKiBJZiBkZWZpbmVkLCB0aGUgY29tbWFuZHMgbmVlZHMgdG8gYmUgYSBmaWxlIHRvIGV4ZWN1dGUuIElmIHVuZGVmaW5lZCwgdGhlIGFyZ3VtZW50cyB3aWxsIGJlIHBhcnNlZCBmcm9tIHRoZSBjb21tYW5kLlxuICAgKi9cbiAgYXJnczogc3RyaW5nW10sXG4gIG9wdGlvbnM/OiB7XG4gICAgcGFyc2VPdXRwdXQ/OiBQYXJzZUV4ZWNPdXRwdXRIYW5kbGVyPFQsIHN0cmluZywgRXhlY09wdGlvbnM+O1xuICB9ICYgRXhlY09wdGlvbnMgJiB7XG4gICAgICBlbmNvZGluZz86IEJ1ZmZlckVuY29kaW5nO1xuICAgIH0gJiBFeGVjQ2FjaGVkUHJvbWlzZU9wdGlvbnM8VCwgVT4sXG4pOiBVc2VDYWNoZWRQcm9taXNlUmV0dXJuVHlwZTxULCBVPjtcbmV4cG9ydCBmdW5jdGlvbiB1c2VFeGVjPFQsIFUgPSB1bmRlZmluZWQ+KFxuICBjb21tYW5kOiBzdHJpbmcsXG4gIG9wdGlvbnNPckFyZ3M/OlxuICAgIHwgc3RyaW5nW11cbiAgICB8ICh7XG4gICAgICAgIHBhcnNlT3V0cHV0PzogUGFyc2VFeGVjT3V0cHV0SGFuZGxlcjxULCBCdWZmZXIsIEV4ZWNPcHRpb25zPiB8IFBhcnNlRXhlY091dHB1dEhhbmRsZXI8VCwgc3RyaW5nLCBFeGVjT3B0aW9ucz47XG4gICAgICB9ICYgRXhlY09wdGlvbnMgJlxuICAgICAgICBFeGVjQ2FjaGVkUHJvbWlzZU9wdGlvbnM8VCwgVT4pLFxuICBvcHRpb25zPzoge1xuICAgIHBhcnNlT3V0cHV0PzogUGFyc2VFeGVjT3V0cHV0SGFuZGxlcjxULCBCdWZmZXIsIEV4ZWNPcHRpb25zPiB8IFBhcnNlRXhlY091dHB1dEhhbmRsZXI8VCwgc3RyaW5nLCBFeGVjT3B0aW9ucz47XG4gIH0gJiBFeGVjT3B0aW9ucyAmXG4gICAgRXhlY0NhY2hlZFByb21pc2VPcHRpb25zPFQsIFU+LFxuKTogVXNlQ2FjaGVkUHJvbWlzZVJldHVyblR5cGU8VCwgVT4ge1xuICBjb25zdCB7XG4gICAgcGFyc2VPdXRwdXQsXG4gICAgaW5wdXQsXG4gICAgb25EYXRhLFxuICAgIG9uV2lsbEV4ZWN1dGUsXG4gICAgaW5pdGlhbERhdGEsXG4gICAgZXhlY3V0ZSxcbiAgICBrZWVwUHJldmlvdXNEYXRhLFxuICAgIG9uRXJyb3IsXG4gICAgZmFpbHVyZVRvYXN0T3B0aW9ucyxcbiAgICAuLi5leGVjT3B0aW9uc1xuICB9ID0gQXJyYXkuaXNBcnJheShvcHRpb25zT3JBcmdzKSA/IG9wdGlvbnMgfHwge30gOiBvcHRpb25zT3JBcmdzIHx8IHt9O1xuXG4gIGNvbnN0IHVzZUNhY2hlZFByb21pc2VPcHRpb25zOiBFeGVjQ2FjaGVkUHJvbWlzZU9wdGlvbnM8VCwgVT4gPSB7XG4gICAgaW5pdGlhbERhdGEsXG4gICAgZXhlY3V0ZSxcbiAgICBrZWVwUHJldmlvdXNEYXRhLFxuICAgIG9uRXJyb3IsXG4gICAgb25EYXRhLFxuICAgIG9uV2lsbEV4ZWN1dGUsXG4gICAgZmFpbHVyZVRvYXN0T3B0aW9ucyxcbiAgfTtcblxuICBjb25zdCBhYm9ydGFibGUgPSB1c2VSZWY8QWJvcnRDb250cm9sbGVyPihudWxsKTtcbiAgY29uc3QgcGFyc2VPdXRwdXRSZWYgPSB1c2VMYXRlc3QocGFyc2VPdXRwdXQgfHwgZGVmYXVsdFBhcnNpbmcpO1xuXG4gIGNvbnN0IGZuID0gdXNlQ2FsbGJhY2soXG4gICAgYXN5bmMgKF9jb21tYW5kOiBzdHJpbmcsIF9hcmdzOiBzdHJpbmdbXSwgX29wdGlvbnM/OiBFeGVjT3B0aW9ucywgaW5wdXQ/OiBzdHJpbmcgfCBCdWZmZXIpID0+IHtcbiAgICAgIGNvbnN0IFtmaWxlLCAuLi5hcmdzXSA9IHBhcnNlQ29tbWFuZChfY29tbWFuZCwgX2FyZ3MpO1xuICAgICAgY29uc3QgY29tbWFuZCA9IFtmaWxlLCAuLi5hcmdzXS5qb2luKFwiIFwiKTtcblxuICAgICAgY29uc3Qgb3B0aW9ucyA9IHtcbiAgICAgICAgc3RyaXBGaW5hbE5ld2xpbmU6IHRydWUsXG4gICAgICAgIC4uLl9vcHRpb25zLFxuICAgICAgICB0aW1lb3V0OiBfb3B0aW9ucz8udGltZW91dCB8fCAxMDAwMCxcbiAgICAgICAgc2lnbmFsOiBhYm9ydGFibGUuY3VycmVudD8uc2lnbmFsLFxuICAgICAgICBlbmNvZGluZzogX29wdGlvbnM/LmVuY29kaW5nID09PSBudWxsID8gXCJidWZmZXJcIiA6IF9vcHRpb25zPy5lbmNvZGluZyB8fCBcInV0ZjhcIixcbiAgICAgICAgZW52OiB7IFBBVEg6IFwiL3Vzci9sb2NhbC9iaW46L3Vzci9iaW46L2JpbjovdXNyL3NiaW46L3NiaW5cIiwgLi4ucHJvY2Vzcy5lbnYsIC4uLl9vcHRpb25zPy5lbnYgfSxcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IHNwYXduZWQgPSBjaGlsZFByb2Nlc3Muc3Bhd24oZmlsZSwgYXJncywgb3B0aW9ucyk7XG4gICAgICBjb25zdCBzcGF3bmVkUHJvbWlzZSA9IGdldFNwYXduZWRQcm9taXNlKHNwYXduZWQsIG9wdGlvbnMpO1xuXG4gICAgICBpZiAoaW5wdXQpIHtcbiAgICAgICAgc3Bhd25lZC5zdGRpbi5lbmQoaW5wdXQpO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBbeyBlcnJvciwgZXhpdENvZGUsIHNpZ25hbCwgdGltZWRPdXQgfSwgc3Rkb3V0UmVzdWx0LCBzdGRlcnJSZXN1bHRdID0gYXdhaXQgZ2V0U3Bhd25lZFJlc3VsdChcbiAgICAgICAgc3Bhd25lZCxcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgc3Bhd25lZFByb21pc2UsXG4gICAgICApO1xuICAgICAgY29uc3Qgc3Rkb3V0ID0gaGFuZGxlT3V0cHV0KG9wdGlvbnMsIHN0ZG91dFJlc3VsdCk7XG4gICAgICBjb25zdCBzdGRlcnIgPSBoYW5kbGVPdXRwdXQob3B0aW9ucywgc3RkZXJyUmVzdWx0KTtcblxuICAgICAgcmV0dXJuIHBhcnNlT3V0cHV0UmVmLmN1cnJlbnQoe1xuICAgICAgICAvLyBAdHMtZXhwZWN0LWVycm9yIHRvbyBtYW55IGdlbmVyaWNzLCBJIGdpdmUgdXBcbiAgICAgICAgc3Rkb3V0LFxuICAgICAgICAvLyBAdHMtZXhwZWN0LWVycm9yIHRvbyBtYW55IGdlbmVyaWNzLCBJIGdpdmUgdXBcbiAgICAgICAgc3RkZXJyLFxuICAgICAgICBlcnJvcixcbiAgICAgICAgZXhpdENvZGUsXG4gICAgICAgIHNpZ25hbCxcbiAgICAgICAgdGltZWRPdXQsXG4gICAgICAgIGNvbW1hbmQsXG4gICAgICAgIG9wdGlvbnMsXG4gICAgICAgIHBhcmVudEVycm9yOiBuZXcgRXJyb3IoKSxcbiAgICAgIH0pIGFzIFQ7XG4gICAgfSxcbiAgICBbcGFyc2VPdXRwdXRSZWZdLFxuICApO1xuXG4gIC8vIEB0cy1leHBlY3QtZXJyb3IgVCBjYW4ndCBiZSBhIFByb21pc2Ugc28gaXQncyBhY3R1YWxseSB0aGUgc2FtZVxuICByZXR1cm4gdXNlQ2FjaGVkUHJvbWlzZShmbiwgW2NvbW1hbmQsIEFycmF5LmlzQXJyYXkob3B0aW9uc09yQXJncykgPyBvcHRpb25zT3JBcmdzIDogW10sIGV4ZWNPcHRpb25zLCBpbnB1dF0sIHtcbiAgICAuLi51c2VDYWNoZWRQcm9taXNlT3B0aW9ucyxcbiAgICBhYm9ydGFibGUsXG4gIH0pO1xufVxuIiwgImltcG9ydCBjaGlsZFByb2Nlc3MgZnJvbSBcIm5vZGU6Y2hpbGRfcHJvY2Vzc1wiO1xuaW1wb3J0IHsgY29uc3RhbnRzIGFzIEJ1ZmZlckNvbnN0YW50cyB9IGZyb20gXCJub2RlOmJ1ZmZlclwiO1xuaW1wb3J0IFN0cmVhbSBmcm9tIFwibm9kZTpzdHJlYW1cIjtcbmltcG9ydCB7IHByb21pc2lmeSB9IGZyb20gXCJub2RlOnV0aWxcIjtcbmltcG9ydCB7IG9uRXhpdCB9IGZyb20gXCIuL3ZlbmRvcnMvc2lnbmFsLWV4aXRcIjtcblxuZXhwb3J0IHR5cGUgU3Bhd25lZFByb21pc2UgPSBQcm9taXNlPHtcbiAgZXhpdENvZGU6IG51bWJlciB8IG51bGw7XG4gIGVycm9yPzogRXJyb3I7XG4gIHNpZ25hbDogTm9kZUpTLlNpZ25hbHMgfCBudWxsO1xuICB0aW1lZE91dDogYm9vbGVhbjtcbn0+O1xuXG5leHBvcnQgZnVuY3Rpb24gZ2V0U3Bhd25lZFByb21pc2UoXG4gIHNwYXduZWQ6IGNoaWxkUHJvY2Vzcy5DaGlsZFByb2Nlc3NXaXRob3V0TnVsbFN0cmVhbXMsXG4gIHsgdGltZW91dCB9OiB7IHRpbWVvdXQ/OiBudW1iZXIgfSA9IHt9LFxuKTogU3Bhd25lZFByb21pc2Uge1xuICBjb25zdCBzcGF3bmVkUHJvbWlzZTogU3Bhd25lZFByb21pc2UgPSBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgc3Bhd25lZC5vbihcImV4aXRcIiwgKGV4aXRDb2RlLCBzaWduYWwpID0+IHtcbiAgICAgIHJlc29sdmUoeyBleGl0Q29kZSwgc2lnbmFsLCB0aW1lZE91dDogZmFsc2UgfSk7XG4gICAgfSk7XG5cbiAgICBzcGF3bmVkLm9uKFwiZXJyb3JcIiwgKGVycm9yKSA9PiB7XG4gICAgICByZWplY3QoZXJyb3IpO1xuICAgIH0pO1xuXG4gICAgaWYgKHNwYXduZWQuc3RkaW4pIHtcbiAgICAgIHNwYXduZWQuc3RkaW4ub24oXCJlcnJvclwiLCAoZXJyb3IpID0+IHtcbiAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfSk7XG5cbiAgY29uc3QgcmVtb3ZlRXhpdEhhbmRsZXIgPSBvbkV4aXQoKCkgPT4ge1xuICAgIHNwYXduZWQua2lsbCgpO1xuICB9KTtcblxuICBpZiAodGltZW91dCA9PT0gMCB8fCB0aW1lb3V0ID09PSB1bmRlZmluZWQpIHtcbiAgICByZXR1cm4gc3Bhd25lZFByb21pc2UuZmluYWxseSgoKSA9PiByZW1vdmVFeGl0SGFuZGxlcigpKTtcbiAgfVxuXG4gIGxldCB0aW1lb3V0SWQ6IE5vZGVKUy5UaW1lb3V0O1xuICBjb25zdCB0aW1lb3V0UHJvbWlzZTogU3Bhd25lZFByb21pc2UgPSBuZXcgUHJvbWlzZSgoX3Jlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgIHRpbWVvdXRJZCA9IHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgc3Bhd25lZC5raWxsKFwiU0lHVEVSTVwiKTtcbiAgICAgIHJlamVjdChPYmplY3QuYXNzaWduKG5ldyBFcnJvcihcIlRpbWVkIG91dFwiKSwgeyB0aW1lZE91dDogdHJ1ZSwgc2lnbmFsOiBcIlNJR1RFUk1cIiB9KSk7XG4gICAgfSwgdGltZW91dCk7XG4gIH0pO1xuXG4gIGNvbnN0IHNhZmVTcGF3bmVkUHJvbWlzZSA9IHNwYXduZWRQcm9taXNlLmZpbmFsbHkoKCkgPT4ge1xuICAgIGNsZWFyVGltZW91dCh0aW1lb3V0SWQpO1xuICB9KTtcblxuICByZXR1cm4gUHJvbWlzZS5yYWNlKFt0aW1lb3V0UHJvbWlzZSwgc2FmZVNwYXduZWRQcm9taXNlXSkuZmluYWxseSgoKSA9PiByZW1vdmVFeGl0SGFuZGxlcigpKTtcbn1cblxuY2xhc3MgTWF4QnVmZmVyRXJyb3IgZXh0ZW5kcyBFcnJvciB7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHN1cGVyKFwiVGhlIG91dHB1dCBpcyB0b28gYmlnXCIpO1xuICAgIHRoaXMubmFtZSA9IFwiTWF4QnVmZmVyRXJyb3JcIjtcbiAgfVxufVxuXG5mdW5jdGlvbiBidWZmZXJTdHJlYW08VCBleHRlbmRzIHN0cmluZyB8IEJ1ZmZlcj4ob3B0aW9uczogeyBlbmNvZGluZzogQnVmZmVyRW5jb2RpbmcgfCBcImJ1ZmZlclwiIH0pIHtcbiAgY29uc3QgeyBlbmNvZGluZyB9ID0gb3B0aW9ucztcbiAgY29uc3QgaXNCdWZmZXIgPSBlbmNvZGluZyA9PT0gXCJidWZmZXJcIjtcblxuICAvLyBAdHMtZXhwZWN0LWVycm9yIG1pc3NpbmcgdGhlIG1ldGhvZHMgd2UgYXJlIGFkZGluZyBiZWxvd1xuICBjb25zdCBzdHJlYW06IFN0cmVhbS5QYXNzVGhyb3VnaCAmIHsgZ2V0QnVmZmVyZWRWYWx1ZTogKCkgPT4gVDsgZ2V0QnVmZmVyZWRMZW5ndGg6ICgpID0+IG51bWJlciB9ID1cbiAgICBuZXcgU3RyZWFtLlBhc3NUaHJvdWdoKHsgb2JqZWN0TW9kZTogZmFsc2UgfSk7XG5cbiAgaWYgKGVuY29kaW5nICYmIGVuY29kaW5nICE9PSBcImJ1ZmZlclwiKSB7XG4gICAgc3RyZWFtLnNldEVuY29kaW5nKGVuY29kaW5nKTtcbiAgfVxuXG4gIGxldCBsZW5ndGggPSAwO1xuICBjb25zdCBjaHVua3M6IGFueVtdID0gW107XG5cbiAgc3RyZWFtLm9uKFwiZGF0YVwiLCAoY2h1bmspID0+IHtcbiAgICBjaHVua3MucHVzaChjaHVuayk7XG5cbiAgICBsZW5ndGggKz0gY2h1bmsubGVuZ3RoO1xuICB9KTtcblxuICBzdHJlYW0uZ2V0QnVmZmVyZWRWYWx1ZSA9ICgpID0+IHtcbiAgICByZXR1cm4gKGlzQnVmZmVyID8gQnVmZmVyLmNvbmNhdChjaHVua3MsIGxlbmd0aCkgOiBjaHVua3Muam9pbihcIlwiKSkgYXMgVDtcbiAgfTtcblxuICBzdHJlYW0uZ2V0QnVmZmVyZWRMZW5ndGggPSAoKSA9PiBsZW5ndGg7XG5cbiAgcmV0dXJuIHN0cmVhbTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gZ2V0U3RyZWFtPFQgZXh0ZW5kcyBzdHJpbmcgfCBCdWZmZXI+KFxuICBpbnB1dFN0cmVhbTogU3RyZWFtLlJlYWRhYmxlLFxuICBvcHRpb25zOiB7IGVuY29kaW5nOiBCdWZmZXJFbmNvZGluZyB8IFwiYnVmZmVyXCIgfSxcbikge1xuICBjb25zdCBzdHJlYW0gPSBidWZmZXJTdHJlYW08VD4ob3B0aW9ucyk7XG5cbiAgYXdhaXQgbmV3IFByb21pc2U8dm9pZD4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgIGNvbnN0IHJlamVjdFByb21pc2UgPSAoZXJyb3I6IEVycm9yICYgeyBidWZmZXJlZERhdGE/OiBUIH0pID0+IHtcbiAgICAgIC8vIERvbid0IHJldHJpZXZlIGFuIG92ZXJzaXplZCBidWZmZXIuXG4gICAgICBpZiAoZXJyb3IgJiYgc3RyZWFtLmdldEJ1ZmZlcmVkTGVuZ3RoKCkgPD0gQnVmZmVyQ29uc3RhbnRzLk1BWF9MRU5HVEgpIHtcbiAgICAgICAgZXJyb3IuYnVmZmVyZWREYXRhID0gc3RyZWFtLmdldEJ1ZmZlcmVkVmFsdWUoKTtcbiAgICAgIH1cblxuICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICB9O1xuXG4gICAgKGFzeW5jICgpID0+IHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGF3YWl0IHByb21pc2lmeShTdHJlYW0ucGlwZWxpbmUpKGlucHV0U3RyZWFtLCBzdHJlYW0pO1xuICAgICAgICByZXNvbHZlKCk7XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICByZWplY3RQcm9taXNlKGVycm9yIGFzIGFueSk7XG4gICAgICB9XG4gICAgfSkoKTtcblxuICAgIHN0cmVhbS5vbihcImRhdGFcIiwgKCkgPT4ge1xuICAgICAgLy8gODBtYlxuICAgICAgaWYgKHN0cmVhbS5nZXRCdWZmZXJlZExlbmd0aCgpID4gMTAwMCAqIDEwMDAgKiA4MCkge1xuICAgICAgICByZWplY3RQcm9taXNlKG5ldyBNYXhCdWZmZXJFcnJvcigpKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG5cbiAgcmV0dXJuIHN0cmVhbS5nZXRCdWZmZXJlZFZhbHVlKCk7XG59XG5cbi8vIE9uIGZhaWx1cmUsIGByZXN1bHQuc3Rkb3V0fHN0ZGVycmAgc2hvdWxkIGNvbnRhaW4gdGhlIGN1cnJlbnRseSBidWZmZXJlZCBzdHJlYW1cbmFzeW5jIGZ1bmN0aW9uIGdldEJ1ZmZlcmVkRGF0YTxUIGV4dGVuZHMgc3RyaW5nIHwgQnVmZmVyPihzdHJlYW06IFN0cmVhbS5SZWFkYWJsZSwgc3RyZWFtUHJvbWlzZTogUHJvbWlzZTxUPikge1xuICBzdHJlYW0uZGVzdHJveSgpO1xuXG4gIHRyeSB7XG4gICAgcmV0dXJuIGF3YWl0IHN0cmVhbVByb21pc2U7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmV0dXJuIChlcnJvciBhcyBhbnkgYXMgeyBidWZmZXJlZERhdGE6IFQgfSkuYnVmZmVyZWREYXRhO1xuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRTcGF3bmVkUmVzdWx0PFQgZXh0ZW5kcyBzdHJpbmcgfCBCdWZmZXI+KFxuICB7IHN0ZG91dCwgc3RkZXJyIH06IGNoaWxkUHJvY2Vzcy5DaGlsZFByb2Nlc3NXaXRob3V0TnVsbFN0cmVhbXMsXG4gIHsgZW5jb2RpbmcgfTogeyBlbmNvZGluZzogQnVmZmVyRW5jb2RpbmcgfCBcImJ1ZmZlclwiIH0sXG4gIHByb2Nlc3NEb25lOiBTcGF3bmVkUHJvbWlzZSxcbikge1xuICBjb25zdCBzdGRvdXRQcm9taXNlID0gZ2V0U3RyZWFtPFQ+KHN0ZG91dCwgeyBlbmNvZGluZyB9KTtcbiAgY29uc3Qgc3RkZXJyUHJvbWlzZSA9IGdldFN0cmVhbTxUPihzdGRlcnIsIHsgZW5jb2RpbmcgfSk7XG5cbiAgdHJ5IHtcbiAgICByZXR1cm4gYXdhaXQgUHJvbWlzZS5hbGwoW3Byb2Nlc3NEb25lLCBzdGRvdXRQcm9taXNlLCBzdGRlcnJQcm9taXNlXSk7XG4gIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICByZXR1cm4gUHJvbWlzZS5hbGwoW1xuICAgICAge1xuICAgICAgICBlcnJvcjogZXJyb3IgYXMgRXJyb3IsXG4gICAgICAgIGV4aXRDb2RlOiBudWxsLFxuICAgICAgICBzaWduYWw6IGVycm9yLnNpZ25hbCBhcyBOb2RlSlMuU2lnbmFscyB8IG51bGwsXG4gICAgICAgIHRpbWVkT3V0OiAoZXJyb3IudGltZWRPdXQgYXMgYm9vbGVhbikgfHwgZmFsc2UsXG4gICAgICB9LFxuICAgICAgZ2V0QnVmZmVyZWREYXRhKHN0ZG91dCwgc3Rkb3V0UHJvbWlzZSksXG4gICAgICBnZXRCdWZmZXJlZERhdGEoc3RkZXJyLCBzdGRlcnJQcm9taXNlKSxcbiAgICBdKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBzdHJpcEZpbmFsTmV3bGluZTxUIGV4dGVuZHMgc3RyaW5nIHwgQnVmZmVyPihpbnB1dDogVCkge1xuICBjb25zdCBMRiA9IHR5cGVvZiBpbnB1dCA9PT0gXCJzdHJpbmdcIiA/IFwiXFxuXCIgOiBcIlxcblwiLmNoYXJDb2RlQXQoMCk7XG4gIGNvbnN0IENSID0gdHlwZW9mIGlucHV0ID09PSBcInN0cmluZ1wiID8gXCJcXHJcIiA6IFwiXFxyXCIuY2hhckNvZGVBdCgwKTtcblxuICBpZiAoaW5wdXRbaW5wdXQubGVuZ3RoIC0gMV0gPT09IExGKSB7XG4gICAgLy8gQHRzLWV4cGVjdC1lcnJvciB3ZSBhcmUgZG9pbmcgc29tZSBuYXN0eSBzdHVmZiBoZXJlXG4gICAgaW5wdXQgPSBpbnB1dC5zbGljZSgwLCAtMSk7XG4gIH1cblxuICBpZiAoaW5wdXRbaW5wdXQubGVuZ3RoIC0gMV0gPT09IENSKSB7XG4gICAgLy8gQHRzLWV4cGVjdC1lcnJvciB3ZSBhcmUgZG9pbmcgc29tZSBuYXN0eSBzdHVmZiBoZXJlXG4gICAgaW5wdXQgPSBpbnB1dC5zbGljZSgwLCAtMSk7XG4gIH1cblxuICByZXR1cm4gaW5wdXQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBoYW5kbGVPdXRwdXQ8VCBleHRlbmRzIHN0cmluZyB8IEJ1ZmZlcj4ob3B0aW9uczogeyBzdHJpcEZpbmFsTmV3bGluZT86IGJvb2xlYW4gfSwgdmFsdWU6IFQpIHtcbiAgaWYgKG9wdGlvbnMuc3RyaXBGaW5hbE5ld2xpbmUpIHtcbiAgICByZXR1cm4gc3RyaXBGaW5hbE5ld2xpbmUodmFsdWUpO1xuICB9XG5cbiAgcmV0dXJuIHZhbHVlO1xufVxuXG5mdW5jdGlvbiBnZXRFcnJvclByZWZpeCh7XG4gIHRpbWVkT3V0LFxuICB0aW1lb3V0LFxuICBzaWduYWwsXG4gIGV4aXRDb2RlLFxufToge1xuICBleGl0Q29kZTogbnVtYmVyIHwgbnVsbDtcbiAgc2lnbmFsOiBOb2RlSlMuU2lnbmFscyB8IG51bGw7XG4gIHRpbWVkT3V0OiBib29sZWFuO1xuICB0aW1lb3V0PzogbnVtYmVyO1xufSkge1xuICBpZiAodGltZWRPdXQpIHtcbiAgICByZXR1cm4gYHRpbWVkIG91dCBhZnRlciAke3RpbWVvdXR9IG1pbGxpc2Vjb25kc2A7XG4gIH1cblxuICBpZiAoc2lnbmFsICE9PSB1bmRlZmluZWQgJiYgc2lnbmFsICE9PSBudWxsKSB7XG4gICAgcmV0dXJuIGB3YXMga2lsbGVkIHdpdGggJHtzaWduYWx9YDtcbiAgfVxuXG4gIGlmIChleGl0Q29kZSAhPT0gdW5kZWZpbmVkICYmIGV4aXRDb2RlICE9PSBudWxsKSB7XG4gICAgcmV0dXJuIGBmYWlsZWQgd2l0aCBleGl0IGNvZGUgJHtleGl0Q29kZX1gO1xuICB9XG5cbiAgcmV0dXJuIFwiZmFpbGVkXCI7XG59XG5cbmZ1bmN0aW9uIG1ha2VFcnJvcih7XG4gIHN0ZG91dCxcbiAgc3RkZXJyLFxuICBlcnJvcixcbiAgc2lnbmFsLFxuICBleGl0Q29kZSxcbiAgY29tbWFuZCxcbiAgdGltZWRPdXQsXG4gIG9wdGlvbnMsXG4gIHBhcmVudEVycm9yLFxufToge1xuICBzdGRvdXQ6IHN0cmluZyB8IEJ1ZmZlcjtcbiAgc3RkZXJyOiBzdHJpbmcgfCBCdWZmZXI7XG4gIGVycm9yPzogRXJyb3I7XG4gIGV4aXRDb2RlOiBudW1iZXIgfCBudWxsO1xuICBzaWduYWw6IE5vZGVKUy5TaWduYWxzIHwgbnVsbDtcbiAgdGltZWRPdXQ6IGJvb2xlYW47XG4gIGNvbW1hbmQ6IHN0cmluZztcbiAgb3B0aW9ucz86IHsgdGltZW91dD86IG51bWJlciB9O1xuICBwYXJlbnRFcnJvcjogRXJyb3I7XG59KSB7XG4gIGNvbnN0IHByZWZpeCA9IGdldEVycm9yUHJlZml4KHsgdGltZWRPdXQsIHRpbWVvdXQ6IG9wdGlvbnM/LnRpbWVvdXQsIHNpZ25hbCwgZXhpdENvZGUgfSk7XG4gIGNvbnN0IGV4ZWNhTWVzc2FnZSA9IGBDb21tYW5kICR7cHJlZml4fTogJHtjb21tYW5kfWA7XG4gIGNvbnN0IHNob3J0TWVzc2FnZSA9IGVycm9yID8gYCR7ZXhlY2FNZXNzYWdlfVxcbiR7ZXJyb3IubWVzc2FnZX1gIDogZXhlY2FNZXNzYWdlO1xuICBjb25zdCBtZXNzYWdlID0gW3Nob3J0TWVzc2FnZSwgc3RkZXJyLCBzdGRvdXRdLmZpbHRlcihCb29sZWFuKS5qb2luKFwiXFxuXCIpO1xuXG4gIGlmIChlcnJvcikge1xuICAgIC8vIEB0cy1leHBlY3QtZXJyb3Igbm90IG9uIEVycm9yXG4gICAgZXJyb3Iub3JpZ2luYWxNZXNzYWdlID0gZXJyb3IubWVzc2FnZTtcbiAgfSBlbHNlIHtcbiAgICBlcnJvciA9IHBhcmVudEVycm9yO1xuICB9XG5cbiAgZXJyb3IubWVzc2FnZSA9IG1lc3NhZ2U7XG5cbiAgLy8gQHRzLWV4cGVjdC1lcnJvciBub3Qgb24gRXJyb3JcbiAgZXJyb3Iuc2hvcnRNZXNzYWdlID0gc2hvcnRNZXNzYWdlO1xuICAvLyBAdHMtZXhwZWN0LWVycm9yIG5vdCBvbiBFcnJvclxuICBlcnJvci5jb21tYW5kID0gY29tbWFuZDtcbiAgLy8gQHRzLWV4cGVjdC1lcnJvciBub3Qgb24gRXJyb3JcbiAgZXJyb3IuZXhpdENvZGUgPSBleGl0Q29kZTtcbiAgLy8gQHRzLWV4cGVjdC1lcnJvciBub3Qgb24gRXJyb3JcbiAgZXJyb3Iuc2lnbmFsID0gc2lnbmFsO1xuICAvLyBAdHMtZXhwZWN0LWVycm9yIG5vdCBvbiBFcnJvclxuICBlcnJvci5zdGRvdXQgPSBzdGRvdXQ7XG4gIC8vIEB0cy1leHBlY3QtZXJyb3Igbm90IG9uIEVycm9yXG4gIGVycm9yLnN0ZGVyciA9IHN0ZGVycjtcblxuICBpZiAoXCJidWZmZXJlZERhdGFcIiBpbiBlcnJvcikge1xuICAgIGRlbGV0ZSBlcnJvcltcImJ1ZmZlcmVkRGF0YVwiXTtcbiAgfVxuXG4gIHJldHVybiBlcnJvcjtcbn1cblxuZXhwb3J0IHR5cGUgUGFyc2VFeGVjT3V0cHV0SGFuZGxlcjxcbiAgVCxcbiAgRGVjb2RlZE91dHB1dCBleHRlbmRzIHN0cmluZyB8IEJ1ZmZlciA9IHN0cmluZyB8IEJ1ZmZlcixcbiAgT3B0aW9ucyA9IHVua25vd24sXG4+ID0gKGFyZ3M6IHtcbiAgLyoqIFRoZSBvdXRwdXQgb2YgdGhlIHByb2Nlc3Mgb24gc3Rkb3V0LiAqL1xuICBzdGRvdXQ6IERlY29kZWRPdXRwdXQ7XG4gIC8qKiBUaGUgb3V0cHV0IG9mIHRoZSBwcm9jZXNzIG9uIHN0ZGVyci4gKi9cbiAgc3RkZXJyOiBEZWNvZGVkT3V0cHV0O1xuICBlcnJvcj86IEVycm9yO1xuICAvKiogVGhlIG51bWVyaWMgZXhpdCBjb2RlIG9mIHRoZSBwcm9jZXNzIHRoYXQgd2FzIHJ1bi4gKi9cbiAgZXhpdENvZGU6IG51bWJlciB8IG51bGw7XG4gIC8qKlxuICAgKiBUaGUgbmFtZSBvZiB0aGUgc2lnbmFsIHRoYXQgd2FzIHVzZWQgdG8gdGVybWluYXRlIHRoZSBwcm9jZXNzLiBGb3IgZXhhbXBsZSwgU0lHRlBFLlxuICAgKlxuICAgKiBJZiBhIHNpZ25hbCB0ZXJtaW5hdGVkIHRoZSBwcm9jZXNzLCB0aGlzIHByb3BlcnR5IGlzIGRlZmluZWQuIE90aGVyd2lzZSBpdCBpcyBudWxsLlxuICAgKi9cbiAgc2lnbmFsOiBOb2RlSlMuU2lnbmFscyB8IG51bGw7XG4gIC8qKiBXaGV0aGVyIHRoZSBwcm9jZXNzIHRpbWVkIG91dC4gKi9cbiAgdGltZWRPdXQ6IGJvb2xlYW47XG4gIC8qKiBUaGUgY29tbWFuZCB0aGF0IHdhcyBydW4sIGZvciBsb2dnaW5nIHB1cnBvc2VzLiAqL1xuICBjb21tYW5kOiBzdHJpbmc7XG4gIG9wdGlvbnM/OiBPcHRpb25zO1xufSkgPT4gVDtcblxuZXhwb3J0IGZ1bmN0aW9uIGRlZmF1bHRQYXJzaW5nPFQgZXh0ZW5kcyBzdHJpbmcgfCBCdWZmZXI+KHtcbiAgc3Rkb3V0LFxuICBzdGRlcnIsXG4gIGVycm9yLFxuICBleGl0Q29kZSxcbiAgc2lnbmFsLFxuICB0aW1lZE91dCxcbiAgY29tbWFuZCxcbiAgb3B0aW9ucyxcbiAgcGFyZW50RXJyb3IsXG59OiB7XG4gIHN0ZG91dDogVDtcbiAgc3RkZXJyOiBUO1xuICBlcnJvcj86IEVycm9yO1xuICBleGl0Q29kZTogbnVtYmVyIHwgbnVsbDtcbiAgc2lnbmFsOiBOb2RlSlMuU2lnbmFscyB8IG51bGw7XG4gIHRpbWVkT3V0OiBib29sZWFuO1xuICBjb21tYW5kOiBzdHJpbmc7XG4gIG9wdGlvbnM/OiB7IHRpbWVvdXQ/OiBudW1iZXIgfTtcbiAgcGFyZW50RXJyb3I6IEVycm9yO1xufSkge1xuICBpZiAoZXJyb3IgfHwgZXhpdENvZGUgIT09IDAgfHwgc2lnbmFsICE9PSBudWxsKSB7XG4gICAgY29uc3QgcmV0dXJuZWRFcnJvciA9IG1ha2VFcnJvcih7XG4gICAgICBlcnJvcixcbiAgICAgIGV4aXRDb2RlLFxuICAgICAgc2lnbmFsLFxuICAgICAgc3Rkb3V0LFxuICAgICAgc3RkZXJyLFxuICAgICAgY29tbWFuZCxcbiAgICAgIHRpbWVkT3V0LFxuICAgICAgb3B0aW9ucyxcbiAgICAgIHBhcmVudEVycm9yLFxuICAgIH0pO1xuXG4gICAgdGhyb3cgcmV0dXJuZWRFcnJvcjtcbiAgfVxuXG4gIHJldHVybiBzdGRvdXQ7XG59XG4iLCAiLyogZXNsaW50LWRpc2FibGUgQHR5cGVzY3JpcHQtZXNsaW50L2Jhbi10cy1jb21tZW50ICovXG4vKiBlc2xpbnQtZGlzYWJsZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55ICovXG4vLyBOb3RlOiBzaW5jZSBueWMgdXNlcyB0aGlzIG1vZHVsZSB0byBvdXRwdXQgY292ZXJhZ2UsIGFueSBsaW5lc1xuLy8gdGhhdCBhcmUgaW4gdGhlIGRpcmVjdCBzeW5jIGZsb3cgb2YgbnljJ3Mgb3V0cHV0Q292ZXJhZ2UgYXJlXG4vLyBpZ25vcmVkLCBzaW5jZSB3ZSBjYW4gbmV2ZXIgZ2V0IGNvdmVyYWdlIGZvciB0aGVtLlxuLy8gZ3JhYiBhIHJlZmVyZW5jZSB0byBub2RlJ3MgcmVhbCBwcm9jZXNzIG9iamVjdCByaWdodCBhd2F5XG5cbmNvbnN0IHByb2Nlc3NPayA9IChwcm9jZXNzOiBhbnkpID0+XG4gICEhcHJvY2VzcyAmJlxuICB0eXBlb2YgcHJvY2VzcyA9PT0gXCJvYmplY3RcIiAmJlxuICB0eXBlb2YgcHJvY2Vzcy5yZW1vdmVMaXN0ZW5lciA9PT0gXCJmdW5jdGlvblwiICYmXG4gIHR5cGVvZiBwcm9jZXNzLmVtaXQgPT09IFwiZnVuY3Rpb25cIiAmJlxuICB0eXBlb2YgcHJvY2Vzcy5yZWFsbHlFeGl0ID09PSBcImZ1bmN0aW9uXCIgJiZcbiAgdHlwZW9mIHByb2Nlc3MubGlzdGVuZXJzID09PSBcImZ1bmN0aW9uXCIgJiZcbiAgdHlwZW9mIHByb2Nlc3Mua2lsbCA9PT0gXCJmdW5jdGlvblwiICYmXG4gIHR5cGVvZiBwcm9jZXNzLnBpZCA9PT0gXCJudW1iZXJcIiAmJlxuICB0eXBlb2YgcHJvY2Vzcy5vbiA9PT0gXCJmdW5jdGlvblwiO1xuY29uc3Qga0V4aXRFbWl0dGVyID0gLyogI19fUFVSRV9fICovIFN5bWJvbC5mb3IoXCJzaWduYWwtZXhpdCBlbWl0dGVyXCIpO1xuLy8gdGVlbnkgc3BlY2lhbCBwdXJwb3NlIGVlXG5jbGFzcyBFbWl0dGVyIHtcbiAgZW1pdHRlZCA9IHtcbiAgICBhZnRlckV4aXQ6IGZhbHNlLFxuICAgIGV4aXQ6IGZhbHNlLFxuICB9O1xuICBsaXN0ZW5lcnMgPSB7XG4gICAgYWZ0ZXJFeGl0OiBbXSxcbiAgICBleGl0OiBbXSxcbiAgfTtcbiAgY291bnQgPSAwO1xuICBpZCA9IE1hdGgucmFuZG9tKCk7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIC8vIEB0cy1pZ25vcmVcbiAgICBpZiAoZ2xvYmFsW2tFeGl0RW1pdHRlcl0pIHtcbiAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgIHJldHVybiBnbG9iYWxba0V4aXRFbWl0dGVyXTtcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGdsb2JhbCwga0V4aXRFbWl0dGVyLCB7XG4gICAgICB2YWx1ZTogdGhpcyxcbiAgICAgIHdyaXRhYmxlOiBmYWxzZSxcbiAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgY29uZmlndXJhYmxlOiBmYWxzZSxcbiAgICB9KTtcbiAgfVxuICBvbihldjogYW55LCBmbjogYW55KSB7XG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIHRoaXMubGlzdGVuZXJzW2V2XS5wdXNoKGZuKTtcbiAgfVxuICByZW1vdmVMaXN0ZW5lcihldjogYW55LCBmbjogYW55KSB7XG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIGNvbnN0IGxpc3QgPSB0aGlzLmxpc3RlbmVyc1tldl07XG4gICAgY29uc3QgaSA9IGxpc3QuaW5kZXhPZihmbik7XG4gICAgLyogYzggaWdub3JlIHN0YXJ0ICovXG4gICAgaWYgKGkgPT09IC0xKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIC8qIGM4IGlnbm9yZSBzdG9wICovXG4gICAgaWYgKGkgPT09IDAgJiYgbGlzdC5sZW5ndGggPT09IDEpIHtcbiAgICAgIGxpc3QubGVuZ3RoID0gMDtcbiAgICB9IGVsc2Uge1xuICAgICAgbGlzdC5zcGxpY2UoaSwgMSk7XG4gICAgfVxuICB9XG4gIGVtaXQoZXY6IGFueSwgY29kZTogYW55LCBzaWduYWw6IGFueSk6IGFueSB7XG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIGlmICh0aGlzLmVtaXR0ZWRbZXZdKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIC8vIEB0cy1pZ25vcmVcbiAgICB0aGlzLmVtaXR0ZWRbZXZdID0gdHJ1ZTtcbiAgICBsZXQgcmV0ID0gZmFsc2U7XG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIGZvciAoY29uc3QgZm4gb2YgdGhpcy5saXN0ZW5lcnNbZXZdKSB7XG4gICAgICByZXQgPSBmbihjb2RlLCBzaWduYWwpID09PSB0cnVlIHx8IHJldDtcbiAgICB9XG4gICAgaWYgKGV2ID09PSBcImV4aXRcIikge1xuICAgICAgcmV0ID0gdGhpcy5lbWl0KFwiYWZ0ZXJFeGl0XCIsIGNvZGUsIHNpZ25hbCkgfHwgcmV0O1xuICAgIH1cbiAgICByZXR1cm4gcmV0O1xuICB9XG59XG5cbmNsYXNzIFNpZ25hbEV4aXRGYWxsYmFjayB7XG4gIG9uRXhpdCgpIHtcbiAgICByZXR1cm4gKCkgPT4ge307XG4gIH1cbiAgbG9hZCgpIHt9XG4gIHVubG9hZCgpIHt9XG59XG5jbGFzcyBTaWduYWxFeGl0IHtcbiAgLy8gXCJTSUdIVVBcIiB0aHJvd3MgYW4gYEVOT1NZU2AgZXJyb3Igb24gV2luZG93cyxcbiAgLy8gc28gdXNlIGEgc3VwcG9ydGVkIHNpZ25hbCBpbnN0ZWFkXG4gIC8qIGM4IGlnbm9yZSBzdGFydCAqL1xuICAvLyBAdHMtaWdub3JlXG4gICNodXBTaWcgPSBwcm9jZXNzLnBsYXRmb3JtID09PSBcIndpbjMyXCIgPyBcIlNJR0lOVFwiIDogXCJTSUdIVVBcIjtcbiAgLyogYzggaWdub3JlIHN0b3AgKi9cbiAgI2VtaXR0ZXIgPSBuZXcgRW1pdHRlcigpO1xuICAjcHJvY2VzczogYW55O1xuICAjb3JpZ2luYWxQcm9jZXNzRW1pdDogYW55O1xuICAjb3JpZ2luYWxQcm9jZXNzUmVhbGx5RXhpdDogYW55O1xuICAjc2lnTGlzdGVuZXJzID0ge307XG4gICNsb2FkZWQgPSBmYWxzZTtcbiAgI3NpZ25hbHM6IHN0cmluZ1tdID0gW107XG4gIGNvbnN0cnVjdG9yKHByb2Nlc3M6IGFueSkge1xuICAgIC8qKlxuICAgICAqIFRoaXMgaXMgbm90IHRoZSBzZXQgb2YgYWxsIHBvc3NpYmxlIHNpZ25hbHMuXG4gICAgICpcbiAgICAgKiBJdCBJUywgaG93ZXZlciwgdGhlIHNldCBvZiBhbGwgc2lnbmFscyB0aGF0IHRyaWdnZXJcbiAgICAgKiBhbiBleGl0IG9uIGVpdGhlciBMaW51eCBvciBCU0Qgc3lzdGVtcy4gIExpbnV4IGlzIGFcbiAgICAgKiBzdXBlcnNldCBvZiB0aGUgc2lnbmFsIG5hbWVzIHN1cHBvcnRlZCBvbiBCU0QsIGFuZFxuICAgICAqIHRoZSB1bmtub3duIHNpZ25hbHMganVzdCBmYWlsIHRvIHJlZ2lzdGVyLCBzbyB3ZSBjYW5cbiAgICAgKiBjYXRjaCB0aGF0IGVhc2lseSBlbm91Z2guXG4gICAgICpcbiAgICAgKiBXaW5kb3dzIHNpZ25hbHMgYXJlIGEgZGlmZmVyZW50IHNldCwgc2luY2UgdGhlcmUgYXJlXG4gICAgICogc2lnbmFscyB0aGF0IHRlcm1pbmF0ZSBXaW5kb3dzIHByb2Nlc3NlcywgYnV0IGRvbid0XG4gICAgICogdGVybWluYXRlIChvciBkb24ndCBldmVuIGV4aXN0KSBvbiBQb3NpeCBzeXN0ZW1zLlxuICAgICAqXG4gICAgICogRG9uJ3QgYm90aGVyIHdpdGggU0lHS0lMTC4gIEl0J3MgdW5jYXRjaGFibGUsIHdoaWNoXG4gICAgICogbWVhbnMgdGhhdCB3ZSBjYW4ndCBmaXJlIGFueSBjYWxsYmFja3MgYW55d2F5LlxuICAgICAqXG4gICAgICogSWYgYSB1c2VyIGRvZXMgaGFwcGVuIHRvIHJlZ2lzdGVyIGEgaGFuZGxlciBvbiBhIG5vbi1cbiAgICAgKiBmYXRhbCBzaWduYWwgbGlrZSBTSUdXSU5DSCBvciBzb21ldGhpbmcsIGFuZCB0aGVuXG4gICAgICogZXhpdCwgaXQnbGwgZW5kIHVwIGZpcmluZyBgcHJvY2Vzcy5lbWl0KCdleGl0JylgLCBzb1xuICAgICAqIHRoZSBoYW5kbGVyIHdpbGwgYmUgZmlyZWQgYW55d2F5LlxuICAgICAqXG4gICAgICogU0lHQlVTLCBTSUdGUEUsIFNJR1NFR1YgYW5kIFNJR0lMTCwgd2hlbiBub3QgcmFpc2VkXG4gICAgICogYXJ0aWZpY2lhbGx5LCBpbmhlcmVudGx5IGxlYXZlIHRoZSBwcm9jZXNzIGluIGFcbiAgICAgKiBzdGF0ZSBmcm9tIHdoaWNoIGl0IGlzIG5vdCBzYWZlIHRvIHRyeSBhbmQgZW50ZXIgSlNcbiAgICAgKiBsaXN0ZW5lcnMuXG4gICAgICovXG4gICAgdGhpcy4jc2lnbmFscy5wdXNoKFwiU0lHSFVQXCIsIFwiU0lHSU5UXCIsIFwiU0lHVEVSTVwiKTtcbiAgICBpZiAoZ2xvYmFsVGhpcy5wcm9jZXNzLnBsYXRmb3JtICE9PSBcIndpbjMyXCIpIHtcbiAgICAgIHRoaXMuI3NpZ25hbHMucHVzaChcbiAgICAgICAgXCJTSUdBTFJNXCIsXG4gICAgICAgIFwiU0lHQUJSVFwiLFxuICAgICAgICBcIlNJR1ZUQUxSTVwiLFxuICAgICAgICBcIlNJR1hDUFVcIixcbiAgICAgICAgXCJTSUdYRlNaXCIsXG4gICAgICAgIFwiU0lHVVNSMlwiLFxuICAgICAgICBcIlNJR1RSQVBcIixcbiAgICAgICAgXCJTSUdTWVNcIixcbiAgICAgICAgXCJTSUdRVUlUXCIsXG4gICAgICAgIFwiU0lHSU9UXCIsXG4gICAgICAgIC8vIHNob3VsZCBkZXRlY3QgcHJvZmlsZXIgYW5kIGVuYWJsZS9kaXNhYmxlIGFjY29yZGluZ2x5LlxuICAgICAgICAvLyBzZWUgIzIxXG4gICAgICAgIC8vICdTSUdQUk9GJ1xuICAgICAgKTtcbiAgICB9XG4gICAgaWYgKGdsb2JhbFRoaXMucHJvY2Vzcy5wbGF0Zm9ybSA9PT0gXCJsaW51eFwiKSB7XG4gICAgICB0aGlzLiNzaWduYWxzLnB1c2goXCJTSUdJT1wiLCBcIlNJR1BPTExcIiwgXCJTSUdQV1JcIiwgXCJTSUdTVEtGTFRcIik7XG4gICAgfVxuICAgIHRoaXMuI3Byb2Nlc3MgPSBwcm9jZXNzO1xuICAgIC8vIHsgPHNpZ25hbD46IDxsaXN0ZW5lciBmbj4sIC4uLiB9XG4gICAgdGhpcy4jc2lnTGlzdGVuZXJzID0ge307XG4gICAgZm9yIChjb25zdCBzaWcgb2YgdGhpcy4jc2lnbmFscykge1xuICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgdGhpcy4jc2lnTGlzdGVuZXJzW3NpZ10gPSAoKSA9PiB7XG4gICAgICAgIC8vIElmIHRoZXJlIGFyZSBubyBvdGhlciBsaXN0ZW5lcnMsIGFuIGV4aXQgaXMgY29taW5nIVxuICAgICAgICAvLyBTaW1wbGVzdCB3YXk6IHJlbW92ZSB1cyBhbmQgdGhlbiByZS1zZW5kIHRoZSBzaWduYWwuXG4gICAgICAgIC8vIFdlIGtub3cgdGhhdCB0aGlzIHdpbGwga2lsbCB0aGUgcHJvY2Vzcywgc28gd2UgY2FuXG4gICAgICAgIC8vIHNhZmVseSBlbWl0IG5vdy5cbiAgICAgICAgY29uc3QgbGlzdGVuZXJzID0gdGhpcy4jcHJvY2Vzcy5saXN0ZW5lcnMoc2lnKTtcbiAgICAgICAgbGV0IHsgY291bnQgfSA9IHRoaXMuI2VtaXR0ZXI7XG4gICAgICAgIC8vIFRoaXMgaXMgYSB3b3JrYXJvdW5kIGZvciB0aGUgZmFjdCB0aGF0IHNpZ25hbC1leGl0IHYzIGFuZCBzaWduYWxcbiAgICAgICAgLy8gZXhpdCB2NCBhcmUgbm90IGF3YXJlIG9mIGVhY2ggb3RoZXIsIGFuZCBlYWNoIHdpbGwgYXR0ZW1wdCB0byBsZXRcbiAgICAgICAgLy8gdGhlIG90aGVyIGhhbmRsZSBpdCwgc28gbmVpdGhlciBvZiB0aGVtIGRvLiBUbyBjb3JyZWN0IHRoaXMsIHdlXG4gICAgICAgIC8vIGRldGVjdCBpZiB3ZSdyZSB0aGUgb25seSBoYW5kbGVyICpleGNlcHQqIGZvciBwcmV2aW91cyB2ZXJzaW9uc1xuICAgICAgICAvLyBvZiBzaWduYWwtZXhpdCwgYW5kIGluY3JlbWVudCBieSB0aGUgY291bnQgb2YgbGlzdGVuZXJzIGl0IGhhc1xuICAgICAgICAvLyBjcmVhdGVkLlxuICAgICAgICAvKiBjOCBpZ25vcmUgc3RhcnQgKi9cbiAgICAgICAgY29uc3QgcCA9IHByb2Nlc3M7XG4gICAgICAgIGlmICh0eXBlb2YgcC5fX3NpZ25hbF9leGl0X2VtaXR0ZXJfXyA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgcC5fX3NpZ25hbF9leGl0X2VtaXR0ZXJfXy5jb3VudCA9PT0gXCJudW1iZXJcIikge1xuICAgICAgICAgIGNvdW50ICs9IHAuX19zaWduYWxfZXhpdF9lbWl0dGVyX18uY291bnQ7XG4gICAgICAgIH1cbiAgICAgICAgLyogYzggaWdub3JlIHN0b3AgKi9cbiAgICAgICAgaWYgKGxpc3RlbmVycy5sZW5ndGggPT09IGNvdW50KSB7XG4gICAgICAgICAgdGhpcy51bmxvYWQoKTtcbiAgICAgICAgICBjb25zdCByZXQgPSB0aGlzLiNlbWl0dGVyLmVtaXQoXCJleGl0XCIsIG51bGwsIHNpZyk7XG4gICAgICAgICAgLyogYzggaWdub3JlIHN0YXJ0ICovXG4gICAgICAgICAgY29uc3QgcyA9IHNpZyA9PT0gXCJTSUdIVVBcIiA/IHRoaXMuI2h1cFNpZyA6IHNpZztcbiAgICAgICAgICBpZiAoIXJldCkgcHJvY2Vzcy5raWxsKHByb2Nlc3MucGlkLCBzKTtcbiAgICAgICAgICAvKiBjOCBpZ25vcmUgc3RvcCAqL1xuICAgICAgICB9XG4gICAgICB9O1xuICAgIH1cbiAgICB0aGlzLiNvcmlnaW5hbFByb2Nlc3NSZWFsbHlFeGl0ID0gcHJvY2Vzcy5yZWFsbHlFeGl0O1xuICAgIHRoaXMuI29yaWdpbmFsUHJvY2Vzc0VtaXQgPSBwcm9jZXNzLmVtaXQ7XG4gIH1cbiAgb25FeGl0KGNiOiBhbnksIG9wdHM6IGFueSkge1xuICAgIC8qIGM4IGlnbm9yZSBzdGFydCAqL1xuICAgIGlmICghcHJvY2Vzc09rKHRoaXMuI3Byb2Nlc3MpKSB7XG4gICAgICByZXR1cm4gKCkgPT4ge307XG4gICAgfVxuICAgIC8qIGM4IGlnbm9yZSBzdG9wICovXG4gICAgaWYgKHRoaXMuI2xvYWRlZCA9PT0gZmFsc2UpIHtcbiAgICAgIHRoaXMubG9hZCgpO1xuICAgIH1cbiAgICBjb25zdCBldiA9IG9wdHM/LmFsd2F5c0xhc3QgPyBcImFmdGVyRXhpdFwiIDogXCJleGl0XCI7XG4gICAgdGhpcy4jZW1pdHRlci5vbihldiwgY2IpO1xuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICB0aGlzLiNlbWl0dGVyLnJlbW92ZUxpc3RlbmVyKGV2LCBjYik7XG4gICAgICBpZiAodGhpcy4jZW1pdHRlci5saXN0ZW5lcnNbXCJleGl0XCJdLmxlbmd0aCA9PT0gMCAmJiB0aGlzLiNlbWl0dGVyLmxpc3RlbmVyc1tcImFmdGVyRXhpdFwiXS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgdGhpcy51bmxvYWQoKTtcbiAgICAgIH1cbiAgICB9O1xuICB9XG4gIGxvYWQoKSB7XG4gICAgaWYgKHRoaXMuI2xvYWRlZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLiNsb2FkZWQgPSB0cnVlO1xuICAgIC8vIFRoaXMgaXMgdGhlIG51bWJlciBvZiBvblNpZ25hbEV4aXQncyB0aGF0IGFyZSBpbiBwbGF5LlxuICAgIC8vIEl0J3MgaW1wb3J0YW50IHNvIHRoYXQgd2UgY2FuIGNvdW50IHRoZSBjb3JyZWN0IG51bWJlciBvZlxuICAgIC8vIGxpc3RlbmVycyBvbiBzaWduYWxzLCBhbmQgZG9uJ3Qgd2FpdCBmb3IgdGhlIG90aGVyIG9uZSB0b1xuICAgIC8vIGhhbmRsZSBpdCBpbnN0ZWFkIG9mIHVzLlxuICAgIHRoaXMuI2VtaXR0ZXIuY291bnQgKz0gMTtcbiAgICBmb3IgKGNvbnN0IHNpZyBvZiB0aGlzLiNzaWduYWxzKSB7XG4gICAgICB0cnkge1xuICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgIGNvbnN0IGZuID0gdGhpcy4jc2lnTGlzdGVuZXJzW3NpZ107XG4gICAgICAgIGlmIChmbikgdGhpcy4jcHJvY2Vzcy5vbihzaWcsIGZuKTtcbiAgICAgIH0gY2F0Y2ggKF8pIHtcbiAgICAgICAgLy8gbm8tb3BcbiAgICAgIH1cbiAgICB9XG4gICAgdGhpcy4jcHJvY2Vzcy5lbWl0ID0gKGV2OiBhbnksIC4uLmE6IGFueSkgPT4ge1xuICAgICAgcmV0dXJuIHRoaXMuI3Byb2Nlc3NFbWl0KGV2LCAuLi5hKTtcbiAgICB9O1xuICAgIHRoaXMuI3Byb2Nlc3MucmVhbGx5RXhpdCA9IChjb2RlOiBhbnkpID0+IHtcbiAgICAgIHJldHVybiB0aGlzLiNwcm9jZXNzUmVhbGx5RXhpdChjb2RlKTtcbiAgICB9O1xuICB9XG4gIHVubG9hZCgpIHtcbiAgICBpZiAoIXRoaXMuI2xvYWRlZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLiNsb2FkZWQgPSBmYWxzZTtcbiAgICB0aGlzLiNzaWduYWxzLmZvckVhY2goKHNpZykgPT4ge1xuICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgY29uc3QgbGlzdGVuZXIgPSB0aGlzLiNzaWdMaXN0ZW5lcnNbc2lnXTtcbiAgICAgIC8qIGM4IGlnbm9yZSBzdGFydCAqL1xuICAgICAgaWYgKCFsaXN0ZW5lcikge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJMaXN0ZW5lciBub3QgZGVmaW5lZCBmb3Igc2lnbmFsOiBcIiArIHNpZyk7XG4gICAgICB9XG4gICAgICAvKiBjOCBpZ25vcmUgc3RvcCAqL1xuICAgICAgdHJ5IHtcbiAgICAgICAgdGhpcy4jcHJvY2Vzcy5yZW1vdmVMaXN0ZW5lcihzaWcsIGxpc3RlbmVyKTtcbiAgICAgICAgLyogYzggaWdub3JlIHN0YXJ0ICovXG4gICAgICB9IGNhdGNoIChfKSB7XG4gICAgICAgIC8vIG5vLW9wXG4gICAgICB9XG4gICAgICAvKiBjOCBpZ25vcmUgc3RvcCAqL1xuICAgIH0pO1xuICAgIHRoaXMuI3Byb2Nlc3MuZW1pdCA9IHRoaXMuI29yaWdpbmFsUHJvY2Vzc0VtaXQ7XG4gICAgdGhpcy4jcHJvY2Vzcy5yZWFsbHlFeGl0ID0gdGhpcy4jb3JpZ2luYWxQcm9jZXNzUmVhbGx5RXhpdDtcbiAgICB0aGlzLiNlbWl0dGVyLmNvdW50IC09IDE7XG4gIH1cbiAgI3Byb2Nlc3NSZWFsbHlFeGl0KGNvZGU6IGFueSkge1xuICAgIC8qIGM4IGlnbm9yZSBzdGFydCAqL1xuICAgIGlmICghcHJvY2Vzc09rKHRoaXMuI3Byb2Nlc3MpKSB7XG4gICAgICByZXR1cm4gMDtcbiAgICB9XG4gICAgdGhpcy4jcHJvY2Vzcy5leGl0Q29kZSA9IGNvZGUgfHwgMDtcbiAgICAvKiBjOCBpZ25vcmUgc3RvcCAqL1xuICAgIHRoaXMuI2VtaXR0ZXIuZW1pdChcImV4aXRcIiwgdGhpcy4jcHJvY2Vzcy5leGl0Q29kZSwgbnVsbCk7XG4gICAgcmV0dXJuIHRoaXMuI29yaWdpbmFsUHJvY2Vzc1JlYWxseUV4aXQuY2FsbCh0aGlzLiNwcm9jZXNzLCB0aGlzLiNwcm9jZXNzLmV4aXRDb2RlKTtcbiAgfVxuICAjcHJvY2Vzc0VtaXQoZXY6IGFueSwgLi4uYXJnczogYW55KSB7XG4gICAgY29uc3Qgb2cgPSB0aGlzLiNvcmlnaW5hbFByb2Nlc3NFbWl0O1xuICAgIGlmIChldiA9PT0gXCJleGl0XCIgJiYgcHJvY2Vzc09rKHRoaXMuI3Byb2Nlc3MpKSB7XG4gICAgICBpZiAodHlwZW9mIGFyZ3NbMF0gPT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgdGhpcy4jcHJvY2Vzcy5leGl0Q29kZSA9IGFyZ3NbMF07XG4gICAgICAgIC8qIGM4IGlnbm9yZSBzdGFydCAqL1xuICAgICAgfVxuICAgICAgLyogYzggaWdub3JlIHN0YXJ0ICovXG4gICAgICBjb25zdCByZXQgPSBvZy5jYWxsKHRoaXMuI3Byb2Nlc3MsIGV2LCAuLi5hcmdzKTtcbiAgICAgIC8qIGM4IGlnbm9yZSBzdGFydCAqL1xuICAgICAgdGhpcy4jZW1pdHRlci5lbWl0KFwiZXhpdFwiLCB0aGlzLiNwcm9jZXNzLmV4aXRDb2RlLCBudWxsKTtcbiAgICAgIC8qIGM4IGlnbm9yZSBzdG9wICovXG4gICAgICByZXR1cm4gcmV0O1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gb2cuY2FsbCh0aGlzLiNwcm9jZXNzLCBldiwgLi4uYXJncyk7XG4gICAgfVxuICB9XG59XG5cbmxldCBzaWduYWxFeGl0OiBTaWduYWxFeGl0IHwgU2lnbmFsRXhpdEZhbGxiYWNrIHwgbnVsbCA9IG51bGw7XG5cbmV4cG9ydCBjb25zdCBvbkV4aXQgPSAoXG4gIGNiOiBhbnksXG4gIG9wdHM/OiB7XG4gICAgYWx3YXlzTGFzdD86IGJvb2xlYW4gfCB1bmRlZmluZWQ7XG4gIH0sXG4pID0+IHtcbiAgaWYgKCFzaWduYWxFeGl0KSB7XG4gICAgc2lnbmFsRXhpdCA9IHByb2Nlc3NPayhwcm9jZXNzKSA/IG5ldyBTaWduYWxFeGl0KHByb2Nlc3MpIDogbmV3IFNpZ25hbEV4aXRGYWxsYmFjaygpO1xuICB9XG4gIHJldHVybiBzaWduYWxFeGl0Lm9uRXhpdChjYiwgb3B0cyk7XG59O1xuIiwgImltcG9ydCB7IGVudmlyb25tZW50IH0gZnJvbSBcIkByYXljYXN0L2FwaVwiO1xuaW1wb3J0IHsgY3JlYXRlUmVhZFN0cmVhbSwgY3JlYXRlV3JpdGVTdHJlYW0sIG1rZGlyU3luYywgU3RhdHMgfSBmcm9tIFwibm9kZTpmc1wiO1xuaW1wb3J0IHsgc3RhdCB9IGZyb20gXCJub2RlOmZzL3Byb21pc2VzXCI7XG5pbXBvcnQgeyBqb2luLCBub3JtYWxpemUgfSBmcm9tIFwibm9kZTpwYXRoXCI7XG5pbXBvcnQgeyBwaXBlbGluZSB9IGZyb20gXCJub2RlOnN0cmVhbS9wcm9taXNlc1wiO1xuaW1wb3J0IHsgdXNlUmVmIH0gZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgQ2hhaW4gZnJvbSBcIi4vdmVuZG9ycy9zdHJlYW0tY2hhaW5cIjtcbmltcG9ydCB7IHBhcnNlciwgUGlja1BhcnNlciwgU3RyZWFtQXJyYXkgfSBmcm9tIFwiLi92ZW5kb3JzL3N0cmVhbS1qc29uXCI7XG5pbXBvcnQgeyBpc0pTT04gfSBmcm9tIFwiLi9mZXRjaC11dGlsc1wiO1xuaW1wb3J0IHsgRmxhdHRlbiwgRnVuY3Rpb25SZXR1cm5pbmdQYWdpbmF0ZWRQcm9taXNlLCBVc2VDYWNoZWRQcm9taXNlUmV0dXJuVHlwZSB9IGZyb20gXCIuL3R5cGVzXCI7XG5pbXBvcnQgeyBDYWNoZWRQcm9taXNlT3B0aW9ucywgdXNlQ2FjaGVkUHJvbWlzZSB9IGZyb20gXCIuL3VzZUNhY2hlZFByb21pc2VcIjtcbmltcG9ydCB7IGhhc2ggfSBmcm9tIFwiLi9oZWxwZXJzXCI7XG5cbnR5cGUgUmVxdWVzdEluZm8gPSBzdHJpbmcgfCBVUkwgfCBnbG9iYWxUaGlzLlJlcXVlc3Q7XG5cbmFzeW5jIGZ1bmN0aW9uIGNhY2hlKHVybDogUmVxdWVzdEluZm8sIGRlc3RpbmF0aW9uOiBzdHJpbmcsIGZldGNoT3B0aW9ucz86IFJlcXVlc3RJbml0KSB7XG4gIGlmICh0eXBlb2YgdXJsID09PSBcIm9iamVjdFwiIHx8IHVybC5zdGFydHNXaXRoKFwiaHR0cDovL1wiKSB8fCB1cmwuc3RhcnRzV2l0aChcImh0dHBzOi8vXCIpKSB7XG4gICAgcmV0dXJuIGF3YWl0IGNhY2hlVVJMKHVybCwgZGVzdGluYXRpb24sIGZldGNoT3B0aW9ucyk7XG4gIH0gZWxzZSBpZiAodXJsLnN0YXJ0c1dpdGgoXCJmaWxlOi8vXCIpKSB7XG4gICAgcmV0dXJuIGF3YWl0IGNhY2hlRmlsZShcbiAgICAgIG5vcm1hbGl6ZShkZWNvZGVVUklDb21wb25lbnQobmV3IFVSTCh1cmwpLnBhdGhuYW1lKSksXG4gICAgICBkZXN0aW5hdGlvbixcbiAgICAgIGZldGNoT3B0aW9ucz8uc2lnbmFsID8gZmV0Y2hPcHRpb25zLnNpZ25hbCA6IHVuZGVmaW5lZCxcbiAgICApO1xuICB9IGVsc2Uge1xuICAgIHRocm93IG5ldyBFcnJvcihcIk9ubHkgSFRUUChTKSBvciBmaWxlIFVSTHMgYXJlIHN1cHBvcnRlZFwiKTtcbiAgfVxufVxuXG5hc3luYyBmdW5jdGlvbiBjYWNoZVVSTCh1cmw6IFJlcXVlc3RJbmZvLCBkZXN0aW5hdGlvbjogc3RyaW5nLCBmZXRjaE9wdGlvbnM/OiBSZXF1ZXN0SW5pdCkge1xuICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHVybCwgZmV0Y2hPcHRpb25zKTtcblxuICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiRmFpbGVkIHRvIGZldGNoIFVSTFwiKTtcbiAgfVxuXG4gIGlmICghaXNKU09OKHJlc3BvbnNlLmhlYWRlcnMuZ2V0KFwiY29udGVudC10eXBlXCIpKSkge1xuICAgIHRocm93IG5ldyBFcnJvcihcIlVSTCBkb2VzIG5vdCByZXR1cm4gSlNPTlwiKTtcbiAgfVxuICBpZiAoIXJlc3BvbnNlLmJvZHkpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJGYWlsZWQgdG8gcmV0cmlldmUgZXhwZWN0ZWQgSlNPTiBjb250ZW50OiBSZXNwb25zZSBib2R5IGlzIG1pc3Npbmcgb3IgaW5hY2Nlc3NpYmxlLlwiKTtcbiAgfVxuICBhd2FpdCBwaXBlbGluZShcbiAgICByZXNwb25zZS5ib2R5IGFzIHVua25vd24gYXMgTm9kZUpTLlJlYWRhYmxlU3RyZWFtLFxuICAgIGNyZWF0ZVdyaXRlU3RyZWFtKGRlc3RpbmF0aW9uKSxcbiAgICBmZXRjaE9wdGlvbnM/LnNpZ25hbCA/IHsgc2lnbmFsOiBmZXRjaE9wdGlvbnMuc2lnbmFsIH0gOiB1bmRlZmluZWQsXG4gICk7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGNhY2hlRmlsZShzb3VyY2U6IHN0cmluZywgZGVzdGluYXRpb246IHN0cmluZywgYWJvcnRTaWduYWw/OiBBYm9ydFNpZ25hbCkge1xuICBhd2FpdCBwaXBlbGluZShcbiAgICBjcmVhdGVSZWFkU3RyZWFtKHNvdXJjZSksXG4gICAgY3JlYXRlV3JpdGVTdHJlYW0oZGVzdGluYXRpb24pLFxuICAgIGFib3J0U2lnbmFsID8geyBzaWduYWw6IGFib3J0U2lnbmFsIH0gOiB1bmRlZmluZWQsXG4gICk7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGNhY2hlVVJMSWZOZWNlc3NhcnkoXG4gIHVybDogUmVxdWVzdEluZm8sXG4gIGZvbGRlcjogc3RyaW5nLFxuICBmaWxlTmFtZTogc3RyaW5nLFxuICBmb3JjZVVwZGF0ZTogYm9vbGVhbixcbiAgZmV0Y2hPcHRpb25zPzogUmVxdWVzdEluaXQsXG4pIHtcbiAgY29uc3QgZGVzdGluYXRpb24gPSBqb2luKGZvbGRlciwgZmlsZU5hbWUpO1xuXG4gIHRyeSB7XG4gICAgYXdhaXQgc3RhdChmb2xkZXIpO1xuICB9IGNhdGNoIChlKSB7XG4gICAgbWtkaXJTeW5jKGZvbGRlciwgeyByZWN1cnNpdmU6IHRydWUgfSk7XG4gICAgYXdhaXQgY2FjaGUodXJsLCBkZXN0aW5hdGlvbiwgZmV0Y2hPcHRpb25zKTtcbiAgICByZXR1cm47XG4gIH1cbiAgaWYgKGZvcmNlVXBkYXRlKSB7XG4gICAgYXdhaXQgY2FjaGUodXJsLCBkZXN0aW5hdGlvbiwgZmV0Y2hPcHRpb25zKTtcbiAgICByZXR1cm47XG4gIH1cblxuICBsZXQgc3RhdHM6IFN0YXRzIHwgdW5kZWZpbmVkID0gdW5kZWZpbmVkO1xuICB0cnkge1xuICAgIHN0YXRzID0gYXdhaXQgc3RhdChkZXN0aW5hdGlvbik7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBhd2FpdCBjYWNoZSh1cmwsIGRlc3RpbmF0aW9uLCBmZXRjaE9wdGlvbnMpO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGlmICh0eXBlb2YgdXJsID09PSBcIm9iamVjdFwiIHx8IHVybC5zdGFydHNXaXRoKFwiaHR0cDovL1wiKSB8fCB1cmwuc3RhcnRzV2l0aChcImh0dHBzOi8vXCIpKSB7XG4gICAgY29uc3QgaGVhZFJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsLCB7IC4uLmZldGNoT3B0aW9ucywgbWV0aG9kOiBcIkhFQURcIiB9KTtcbiAgICBpZiAoIWhlYWRSZXNwb25zZS5vaykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQ291bGQgbm90IGZldGNoIFVSTFwiKTtcbiAgICB9XG5cbiAgICBpZiAoIWlzSlNPTihoZWFkUmVzcG9uc2UuaGVhZGVycy5nZXQoXCJjb250ZW50LXR5cGVcIikpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJVUkwgZG9lcyBub3QgcmV0dXJuIEpTT05cIik7XG4gICAgfVxuXG4gICAgY29uc3QgbGFzdE1vZGlmaWVkID0gRGF0ZS5wYXJzZShoZWFkUmVzcG9uc2UuaGVhZGVycy5nZXQoXCJsYXN0LW1vZGlmaWVkXCIpID8/IFwiXCIpO1xuICAgIGlmIChzdGF0cy5zaXplID09PSAwIHx8IE51bWJlci5pc05hTihsYXN0TW9kaWZpZWQpIHx8IGxhc3RNb2RpZmllZCA+IHN0YXRzLm10aW1lTXMpIHtcbiAgICAgIGF3YWl0IGNhY2hlKHVybCwgZGVzdGluYXRpb24sIGZldGNoT3B0aW9ucyk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICB9IGVsc2UgaWYgKHVybC5zdGFydHNXaXRoKFwiZmlsZTovL1wiKSkge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBzb3VyY2VTdGF0cyA9IGF3YWl0IHN0YXQobm9ybWFsaXplKGRlY29kZVVSSUNvbXBvbmVudChuZXcgVVJMKHVybCkucGF0aG5hbWUpKSk7XG4gICAgICBpZiAoc291cmNlU3RhdHMubXRpbWVNcyA+IHN0YXRzLm10aW1lTXMpIHtcbiAgICAgICAgYXdhaXQgY2FjaGUodXJsLCBkZXN0aW5hdGlvbiwgZmV0Y2hPcHRpb25zKTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJTb3VyY2UgZmlsZSBjb3VsZCBub3QgYmUgcmVhZFwiKTtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiT25seSBIVFRQKFMpIG9yIGZpbGUgVVJMcyBhcmUgc3VwcG9ydGVkXCIpO1xuICB9XG59XG5cbmFzeW5jIGZ1bmN0aW9uKiBzdHJlYW1Kc29uRmlsZTxUPihcbiAgZmlsZVBhdGg6IHN0cmluZyxcbiAgcGFnZVNpemU6IG51bWJlcixcbiAgYWJvcnRTaWduYWw/OiBBYm9ydFNpZ25hbCxcbiAgZGF0YVBhdGg/OiBzdHJpbmcgfCBSZWdFeHAsXG4gIGZpbHRlckZuPzogKGl0ZW06IEZsYXR0ZW48VD4pID0+IGJvb2xlYW4sXG4gIHRyYW5zZm9ybUZuPzogKGl0ZW06IGFueSkgPT4gVCxcbik6IEFzeW5jR2VuZXJhdG9yPFQgZXh0ZW5kcyB1bmtub3duW10gPyBUIDogVFtdPiB7XG4gIGxldCBwYWdlOiBUIGV4dGVuZHMgdW5rbm93bltdID8gVCA6IFRbXSA9IFtdIGFzIFQgZXh0ZW5kcyB1bmtub3duW10gPyBUIDogVFtdO1xuXG4gIGNvbnN0IHBpcGVsaW5lID0gQ2hhaW4oW1xuICAgIGNyZWF0ZVJlYWRTdHJlYW0oZmlsZVBhdGgpLFxuICAgIGRhdGFQYXRoID8gUGlja1BhcnNlcih7IGZpbHRlcjogZGF0YVBhdGggfSkgOiBwYXJzZXIoKSxcbiAgICBTdHJlYW1BcnJheSgpLFxuICAgIChkYXRhOiBhbnkpID0+IHRyYW5zZm9ybUZuPy4oZGF0YS52YWx1ZSkgPz8gZGF0YS52YWx1ZSxcbiAgXSk7XG5cbiAgYWJvcnRTaWduYWw/LmFkZEV2ZW50TGlzdGVuZXIoXCJhYm9ydFwiLCAoKSA9PiB7XG4gICAgcGlwZWxpbmUuZGVzdHJveSgpO1xuICB9KTtcblxuICB0cnkge1xuICAgIGZvciBhd2FpdCAoY29uc3QgZGF0YSBvZiBwaXBlbGluZSkge1xuICAgICAgaWYgKGFib3J0U2lnbmFsPy5hYm9ydGVkKSB7XG4gICAgICAgIHJldHVybiBbXTtcbiAgICAgIH1cbiAgICAgIGlmICghZmlsdGVyRm4gfHwgZmlsdGVyRm4oZGF0YSkpIHtcbiAgICAgICAgcGFnZS5wdXNoKGRhdGEpO1xuICAgICAgfVxuICAgICAgaWYgKHBhZ2UubGVuZ3RoID49IHBhZ2VTaXplKSB7XG4gICAgICAgIHlpZWxkIHBhZ2U7XG4gICAgICAgIHBhZ2UgPSBbXSBhcyBUIGV4dGVuZHMgdW5rbm93bltdID8gVCA6IFRbXTtcbiAgICAgIH1cbiAgICB9XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBwaXBlbGluZS5kZXN0cm95KCk7XG4gICAgdGhyb3cgZTtcbiAgfVxuXG4gIGlmIChwYWdlLmxlbmd0aCA+IDApIHtcbiAgICB5aWVsZCBwYWdlO1xuICB9XG5cbiAgcmV0dXJuIFtdO1xufVxuXG50eXBlIE9wdGlvbnM8VD4gPSB7XG4gIC8qKlxuICAgKiBUaGUgaG9vayBleHBlY3RzIHRvIGl0ZXJhdGUgdGhyb3VnaCBhbiBhcnJheSBvZiBkYXRhLCBzbyBieSBkZWZhdWx0LCBpdCBhc3N1bWVzIHRoZSBKU09OIGl0IHJlY2VpdmVzIGl0c2VsZiByZXByZXNlbnRzIGFuIGFycmF5LiBIb3dldmVyLCBzb21ldGltZXMgdGhlIGFycmF5IG9mIGRhdGEgaXMgd3JhcHBlZCBpbiBhbiBvYmplY3QsXG4gICAqIGkuZS4gYHsgXCJzdWNjZXNzXCI6IHRydWUsIFwiZGF0YVwiOiBb4oCmXSB9YCwgb3IgZXZlbiBgeyBcInN1Y2Nlc3NcIjogdHJ1ZSwgXCJyZXN1bHRzXCI6IHsgXCJkYXRhXCI6IFvigKZdIH0gfWAuIEluIHRob3NlIGNhc2VzLCB5b3UgY2FuIHVzZSBgZGF0YVBhdGhgIHRvIHNwZWNpZnkgd2hlcmUgdGhlIGRhdGEgYXJyYXkgY2FuIGJlIGZvdW5kLlxuICAgKlxuICAgKiBAcmVtYXJrIElmIHlvdXIgSlNPTiBvYmplY3QgaGFzIG11bHRpcGxlIGFycmF5cyB0aGF0IHlvdSB3YW50IHRvIHN0cmVhbSBkYXRhIGZyb20sIHlvdSBjYW4gcGFzcyBhIHJlZ3VsYXIgZXhwcmVzc2lvbiB0byBzdHJlYW0gdGhyb3VnaCBhbGwgb2YgdGhlbS5cbiAgICpcbiAgICogQGV4YW1wbGUgRm9yIGB7IFwic3VjY2Vzc1wiOiB0cnVlLCBcImRhdGFcIjogW+KApl0gfWAsIGRhdGFQYXRoIHdvdWxkIGJlIGBkYXRhYFxuICAgKiBAZXhhbXBsZSBGb3IgYHsgXCJzdWNjZXNzXCI6IHRydWUsIFwicmVzdWx0c1wiOiB7IFwiZGF0YVwiOiBb4oCmXSB9IH1gLCBkYXRhUGF0aCB3b3VsZCBiZSBgcmVzdWx0cy5kYXRhYFxuICAgKiBAZXhhbXBsZSBGb3IgYHsgXCJzdWNjZXNzXCI6IHRydWUsIFwicmVzdWx0c1wiOiB7IFwiZmlyc3RfbGlzdFwiOiBb4oCmXSwgXCJzZWNvbmRfbGlzdFwiOiBb4oCmXSwgXCJ0aGlyZF9saXN0XCI6IFvigKZdIH0gfWAsIGRhdGFQYXRoIHdvdWxkIGJlIGAvXnJlc3VsdHNcXC4oZmlyc3RfbGlzdHxzZWNvbmRfbGlzdHx0aGlyZF9saXN0KSRcbi9gLlxuICAgKi9cbiAgZGF0YVBhdGg/OiBzdHJpbmcgfCBSZWdFeHA7XG4gIC8qKlxuICAgKiBBIGZ1bmN0aW9uIHRvIGRlY2lkZSB3aGV0aGVyIGEgcGFydGljdWxhciBpdGVtIHNob3VsZCBiZSBrZXB0IG9yIG5vdC5cbiAgICogRGVmYXVsdHMgdG8gYHVuZGVmaW5lZGAsIGtlZXBpbmcgYW55IGVuY291bnRlcmVkIGl0ZW0uXG4gICAqXG4gICAqIEByZW1hcmsgVGhlIGhvb2sgd2lsbCByZXZhbGlkYXRlIGV2ZXJ5IHRpbWUgdGhlIGZpbHRlciBmdW5jdGlvbiBjaGFuZ2VzLCBzbyB5b3UgbmVlZCB0byB1c2UgW3VzZUNhbGxiYWNrXShodHRwczovL3JlYWN0LmRldi9yZWZlcmVuY2UvcmVhY3QvdXNlQ2FsbGJhY2spIHRvIG1ha2Ugc3VyZSBpdCBvbmx5IGNoYW5nZXMgd2hlbiBpdCBuZWVkcyB0by5cbiAgICovXG4gIGZpbHRlcj86IChpdGVtOiBGbGF0dGVuPFQ+KSA9PiBib29sZWFuO1xuICAvKipcbiAgICogQSBmdW5jdGlvbiB0byBhcHBseSB0byBlYWNoIGl0ZW0gYXMgaXQgaXMgZW5jb3VudGVyZWQuIFVzZWZ1bCBmb3IgYSBjb3VwbGUgb2YgdGhpbmdzOlxuICAgKiAxLiBlbnN1cmluZyB0aGF0IGFsbCBpdGVtcyBoYXZlIHRoZSBleHBlY3RlZCBwcm9wZXJ0aWVzLCBhbmQsIGFzIG9uIG9wdGltaXphdGlvbiwgZm9yIGdldHRpbmcgcmlkIG9mIHRoZSBwcm9wZXJ0aWVzIHRoYXQgeW91IGRvbid0IGNhcmUgYWJvdXQuXG4gICAqIDIuIHdoZW4gdG9wLWxldmVsIG9iamVjdHMgYWN0dWFsbHkgcmVwcmVzZW50IG5lc3RlZCBkYXRhLCB3aGljaCBzaG91bGQgYmUgZmxhdHRlbmVkLiBJbiB0aGlzIGNhc2UsIGB0cmFuc2Zvcm1gIGNhbiByZXR1cm4gYW4gYXJyYXkgb2YgaXRlbXMsIGFuZCB0aGUgaG9vayB3aWxsIHN0cmVhbSB0aHJvdWdoIGVhY2ggb25lIG9mIHRob3NlIGl0ZW1zLFxuICAgKiBwYXNzaW5nIHRoZW0gdG8gYGZpbHRlcmAgZXRjLlxuICAgKlxuICAgKiBEZWZhdWx0cyB0byBhIHBhc3N0aHJvdWdoIGZ1bmN0aW9uIGlmIG5vdCBwcm92aWRlZC5cbiAgICpcbiAgICogQHJlbWFyayBUaGUgaG9vayB3aWxsIHJldmFsaWRhdGUgZXZlcnkgdGltZSB0aGUgdHJhbnNmb3JtIGZ1bmN0aW9uIGNoYW5nZXMsIHNvIGl0IGlzIGltcG9ydGFudCB0byB1c2UgW3VzZUNhbGxiYWNrXShodHRwczovL3JlYWN0LmRldi9yZWZlcmVuY2UvcmVhY3QvdXNlQ2FsbGJhY2spIHRvIGVuc3VyZSBpdCBvbmx5IGNoYW5nZXMgd2hlbiBuZWNlc3NhcnkgdG8gcHJldmVudCB1bm5lY2Vzc2FyeSByZS1yZW5kZXJzIG9yIGNvbXB1dGF0aW9ucy5cbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogYGBgXG4gICAqIC8vIEZvciBkYXRhOiBgeyBcImRhdGFcIjogWyB7IFwidHlwZVwiOiBcImZvbGRlclwiLCBcIm5hbWVcIjogXCJpdGVtIDFcIiwgXCJjaGlsZHJlblwiOiBbIHsgXCJ0eXBlXCI6IFwiaXRlbVwiLCBcIm5hbWVcIjogXCJpdGVtIDJcIiB9LCB7IFwidHlwZVwiOiBcIml0ZW1cIiwgXCJuYW1lXCI6IFwiaXRlbSAzXCIgfSBdIH0sIHsgXCJ0eXBlXCI6IFwiZm9sZGVyXCIsIFwibmFtZVwiOiBcIml0ZW0gNFwiLCBjaGlsZHJlbjogW10gfSBdIH1gXG4gICAqXG4gICAqIHR5cGUgSXRlbSA9IHtcbiAgICogIHR5cGU6IFwiaXRlbVwiO1xuICAgKiAgbmFtZTogc3RyaW5nO1xuICAgKiB9O1xuICAgKlxuICAgKiB0eXBlIEZvbGRlciA9IHtcbiAgICogICB0eXBlOiBcImZvbGRlclwiO1xuICAgKiAgIG5hbWU6IHN0cmluZztcbiAgICogICBjaGlsZHJlbjogKEl0ZW0gfCBGb2xkZXIpW107XG4gICAqIH07XG4gICAqXG4gICAqIGZ1bmN0aW9uIGZsYXR0ZW4oaXRlbTogSXRlbSB8IEZvbGRlcik6IHsgbmFtZTogc3RyaW5nIH1bXSB7XG4gICAqICAgY29uc3QgZmxhdHRlbmVkOiB7IG5hbWU6IHN0cmluZyB9W10gPSBbXTtcbiAgICogICBpZiAoaXRlbS50eXBlID09PSBcImZvbGRlclwiKSB7XG4gICAqICAgICBmbGF0dGVuZWQucHVzaCguLi5pdGVtLmNoaWxkcmVuLm1hcChmbGF0dGVuKS5mbGF0KCkpO1xuICAgKiAgIH1cbiAgICogICBpZiAoaXRlbS50eXBlID09PSBcIml0ZW1cIikge1xuICAgKiAgICAgZmxhdHRlbmVkLnB1c2goeyBuYW1lOiBpdGVtLm5hbWUgfSk7XG4gICAqICAgfVxuICAgKiAgIHJldHVybiBmbGF0dGVuZWQ7XG4gICAqIH1cbiAgICpcbiAgICogY29uc3QgdHJhbnNmb3JtID0gdXNlQ2FsbGJhY2soZmxhdHRlbiwgW10pO1xuICAgKiBjb25zdCBmaWx0ZXIgPSB1c2VDYWxsYmFjaygoaXRlbTogeyBuYW1lOiBzdHJpbmcgfSkgPT4ge1xuICAgKiAgIOKAplxuICAgKiB9KVxuICAgKiBgYGBcbiAgICovXG4gIHRyYW5zZm9ybT86IChpdGVtOiBhbnkpID0+IFQ7XG4gIC8qKlxuICAgKiBUaGUgYW1vdW50IG9mIGl0ZW1zIHRvIHJldHVybiBmb3IgZWFjaCBwYWdlLlxuICAgKiBEZWZhdWx0cyB0byBgMjBgLlxuICAgKi9cbiAgcGFnZVNpemU/OiBudW1iZXI7XG59O1xuXG4vKipcbiAqIFRha2VzIGEgYGh0dHA6Ly9gLCBgaHR0cHM6Ly9gIG9yIGBmaWxlOi8vL2AgVVJMIHBvaW50aW5nIHRvIGEgSlNPTiByZXNvdXJjZSwgY2FjaGVzIGl0IHRvIHRoZSBjb21tYW5kJ3Mgc3VwcG9ydFxuICogZm9sZGVyLCBhbmQgc3RyZWFtcyB0aHJvdWdoIGl0cyBjb250ZW50LiBVc2VmdWwgd2hlbiBkZWFsaW5nIHdpdGggbGFyZ2UgSlNPTiBhcnJheXMgd2hpY2ggd291bGQgYmUgdG9vIGJpZyB0byBmaXRcbiAqIGluIHRoZSBjb21tYW5kJ3MgbWVtb3J5LlxuICpcbiAqIEByZW1hcmsgVGhlIEpTT04gcmVzb3VyY2UgbmVlZHMgdG8gY29uc2lzdCBvZiBhbiBhcnJheSBvZiBvYmplY3RzXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYFxuICogaW1wb3J0IHsgTGlzdCB9IGZyb20gXCJAcmF5Y2FzdC9hcGlcIjtcbiAqIGltcG9ydCB7IHVzZVN0cmVhbUpTT04gfSBmcm9tIFwiQHJheWNhc3QvdXRpbHNcIjtcbiAqXG4gKiB0eXBlIEZvcm11bGEgPSB7IG5hbWU6IHN0cmluZzsgZGVzYz86IHN0cmluZyB9O1xuICpcbiAqIGV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIE1haW4oKTogUmVhY3QuSlNYLkVsZW1lbnQge1xuICogICBjb25zdCB7IGRhdGEsIGlzTG9hZGluZywgcGFnaW5hdGlvbiB9ID0gdXNlU3RyZWFtSlNPTjxGb3JtdWxhPihcImh0dHBzOi8vZm9ybXVsYWUuYnJldy5zaC9hcGkvZm9ybXVsYS5qc29uXCIpO1xuICpcbiAqICAgcmV0dXJuIChcbiAqICAgICA8TGlzdCBpc0xvYWRpbmc9e2lzTG9hZGluZ30gcGFnaW5hdGlvbj17cGFnaW5hdGlvbn0+XG4gKiAgICAgICA8TGlzdC5TZWN0aW9uIHRpdGxlPVwiRm9ybXVsYWVcIj5cbiAqICAgICAgICAge2RhdGE/Lm1hcCgoZCkgPT4gPExpc3QuSXRlbSBrZXk9e2QubmFtZX0gdGl0bGU9e2QubmFtZX0gc3VidGl0bGU9e2QuZGVzY30gLz4pfVxuICogICAgICAgPC9MaXN0LlNlY3Rpb24+XG4gKiAgICAgPC9MaXN0PlxuICogICApO1xuICogfVxuICogYGBgXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYFxuICogaW1wb3J0IHsgTGlzdCB9IGZyb20gXCJAcmF5Y2FzdC9hcGlcIjtcbiAqIGltcG9ydCB7IHVzZVN0cmVhbUpTT04gfSBmcm9tIFwiQHJheWNhc3QvdXRpbHNcIjtcbiAqIGltcG9ydCB7IGhvbWVkaXIgfSBmcm9tIFwib3NcIjtcbiAqIGltcG9ydCB7IGpvaW4gfSBmcm9tIFwicGF0aFwiO1xuICpcbiAqIHR5cGUgRm9ybXVsYSA9IHsgbmFtZTogc3RyaW5nOyBkZXNjPzogc3RyaW5nIH07XG4gKlxuICogZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gTWFpbigpOiBSZWFjdC5KU1guRWxlbWVudCB7XG4gKiAgIGNvbnN0IHsgZGF0YSwgaXNMb2FkaW5nLCBwYWdpbmF0aW9uIH0gPSB1c2VTdHJlYW1KU09OPEZvcm11bGE+KGBmaWxlOi8vLyR7am9pbihob21lZGlyKCksIFwiRG93bmxvYWRzXCIsIFwiZm9ybXVsYWUuanNvblwiKX1gKTtcbiAqXG4gKiAgIHJldHVybiAoXG4gKiAgICAgPExpc3QgaXNMb2FkaW5nPXtpc0xvYWRpbmd9IHBhZ2luYXRpb249e3BhZ2luYXRpb259PlxuICogICAgICAgPExpc3QuU2VjdGlvbiB0aXRsZT1cIkZvcm11bGFlXCI+XG4gKiAgICAgICAgIHtkYXRhPy5tYXAoKGQpID0+IDxMaXN0Lkl0ZW0ga2V5PXtkLm5hbWV9IHRpdGxlPXtkLm5hbWV9IHN1YnRpdGxlPXtkLmRlc2N9IC8+KX1cbiAqICAgICAgIDwvTGlzdC5TZWN0aW9uPlxuICogICAgIDwvTGlzdD5cbiAqICAgKTtcbiAqIH1cbiAqIGBgYFxuICovXG5leHBvcnQgZnVuY3Rpb24gdXNlU3RyZWFtSlNPTjxULCBVID0gdW5rbm93bj4odXJsOiBSZXF1ZXN0SW5mbyk6IFVzZUNhY2hlZFByb21pc2VSZXR1cm5UeXBlPFQsIFU+O1xuXG4vKipcbiAqIFRha2VzIGEgYGh0dHA6Ly9gLCBgaHR0cHM6Ly9gIG9yIGBmaWxlOi8vL2AgVVJMIHBvaW50aW5nIHRvIGEgSlNPTiByZXNvdXJjZSwgY2FjaGVzIGl0IHRvIHRoZSBjb21tYW5kJ3Mgc3VwcG9ydFxuICogZm9sZGVyLCBhbmQgc3RyZWFtcyB0aHJvdWdoIGl0cyBjb250ZW50LiBVc2VmdWwgd2hlbiBkZWFsaW5nIHdpdGggbGFyZ2UgSlNPTiBhcnJheXMgd2hpY2ggd291bGQgYmUgdG9vIGJpZyB0byBmaXRcbiAqIGluIHRoZSBjb21tYW5kJ3MgbWVtb3J5LlxuICpcbiAqIEByZW1hcmsgVGhlIEpTT04gcmVzb3VyY2UgbmVlZHMgdG8gY29uc2lzdCBvZiBhbiBhcnJheSBvZiBvYmplY3RzXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYFxuICogaW1wb3J0IHsgTGlzdCwgZW52aXJvbm1lbnQgfSBmcm9tIFwiQHJheWNhc3QvYXBpXCI7XG4gKiBpbXBvcnQgeyB1c2VTdHJlYW1KU09OIH0gZnJvbSBcIkByYXljYXN0L3V0aWxzXCI7XG4gKiBpbXBvcnQgeyBqb2luIH0gZnJvbSAncGF0aCc7XG4gKiBpbXBvcnQgeyB1c2VDYWxsYmFjaywgdXNlU3RhdGUgfSBmcm9tIFwicmVhY3RcIjtcbiAqXG4gKiB0eXBlIEZvcm11bGEgPSB7IG5hbWU6IHN0cmluZzsgZGVzYz86IHN0cmluZyB9O1xuICpcbiAqIGV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIE1haW4oKTogUmVhY3QuSlNYLkVsZW1lbnQge1xuICogICBjb25zdCBbc2VhcmNoVGV4dCwgc2V0U2VhcmNoVGV4dF0gPSB1c2VTdGF0ZShcIlwiKTtcbiAqXG4gKiAgIGNvbnN0IGZvcm11bGFGaWx0ZXIgPSB1c2VDYWxsYmFjayhcbiAqICAgICAoaXRlbTogRm9ybXVsYSkgPT4ge1xuICogICAgICAgaWYgKCFzZWFyY2hUZXh0KSByZXR1cm4gdHJ1ZTtcbiAqICAgICAgIHJldHVybiBpdGVtLm5hbWUudG9Mb2NhbGVMb3dlckNhc2UoKS5pbmNsdWRlcyhzZWFyY2hUZXh0KTtcbiAqICAgICB9LFxuICogICAgIFtzZWFyY2hUZXh0XSxcbiAqICAgKTtcbiAqXG4gKiAgIGNvbnN0IGZvcm11bGFUcmFuc2Zvcm0gPSB1c2VDYWxsYmFjaygoaXRlbTogYW55KTogRm9ybXVsYSA9PiB7XG4gKiAgICAgcmV0dXJuIHsgbmFtZTogaXRlbS5uYW1lLCBkZXNjOiBpdGVtLmRlc2MgfTtcbiAqICAgfSwgW10pO1xuICpcbiAqICAgY29uc3QgeyBkYXRhLCBpc0xvYWRpbmcsIHBhZ2luYXRpb24gfSA9IHVzZVN0cmVhbUpTT04oXCJodHRwczovL2Zvcm11bGFlLmJyZXcuc2gvYXBpL2Zvcm11bGEuanNvblwiLCB7XG4gKiAgICAgaW5pdGlhbERhdGE6IFtdIGFzIEZvcm11bGFbXSxcbiAqICAgICBwYWdlU2l6ZTogMjAsXG4gKiAgICAgZmlsdGVyOiBmb3JtdWxhRmlsdGVyLFxuICogICAgIHRyYW5zZm9ybTogZm9ybXVsYVRyYW5zZm9ybSxcbiAqICAgfSk7XG4gKlxuICogICByZXR1cm4gKFxuICogICAgIDxMaXN0IGlzTG9hZGluZz17aXNMb2FkaW5nfSBwYWdpbmF0aW9uPXtwYWdpbmF0aW9ufSBvblNlYXJjaFRleHRDaGFuZ2U9e3NldFNlYXJjaFRleHR9PlxuICogICAgICAgPExpc3QuU2VjdGlvbiB0aXRsZT1cIkZvcm11bGFlXCI+XG4gKiAgICAgICAgIHtkYXRhLm1hcCgoZCkgPT4gKFxuICogICAgICAgICAgIDxMaXN0Lkl0ZW0ga2V5PXtkLm5hbWV9IHRpdGxlPXtkLm5hbWV9IHN1YnRpdGxlPXtkLmRlc2N9IC8+XG4gKiAgICAgICAgICkpfVxuICogICAgICAgPC9MaXN0LlNlY3Rpb24+XG4gKiAgICAgPC9MaXN0PlxuICogICApO1xuICogfVxuICogYGBgIHN1cHBvcnQgZm9sZGVyLCBhbmQgc3RyZWFtcyB0aHJvdWdoIGl0cyBjb250ZW50LlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGBcbiAqIGltcG9ydCB7IExpc3QsIGVudmlyb25tZW50IH0gZnJvbSBcIkByYXljYXN0L2FwaVwiO1xuICogaW1wb3J0IHsgdXNlU3RyZWFtSlNPTiB9IGZyb20gXCJAcmF5Y2FzdC91dGlsc1wiO1xuICogaW1wb3J0IHsgam9pbiB9IGZyb20gXCJwYXRoXCI7XG4gKiBpbXBvcnQgeyBob21lZGlyIH0gZnJvbSBcIm9zXCI7XG4gKiBpbXBvcnQgeyB1c2VDYWxsYmFjaywgdXNlU3RhdGUgfSBmcm9tIFwicmVhY3RcIjtcbiAqXG4gKiB0eXBlIEZvcm11bGEgPSB7IG5hbWU6IHN0cmluZzsgZGVzYz86IHN0cmluZyB9O1xuICpcbiAqIGV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIE1haW4oKTogUmVhY3QuSlNYLkVsZW1lbnQge1xuICogICBjb25zdCBbc2VhcmNoVGV4dCwgc2V0U2VhcmNoVGV4dF0gPSB1c2VTdGF0ZShcIlwiKTtcbiAqXG4gKiAgIGNvbnN0IGZvcm11bGFGaWx0ZXIgPSB1c2VDYWxsYmFjayhcbiAqICAgICAoaXRlbTogRm9ybXVsYSkgPT4ge1xuICogICAgICAgaWYgKCFzZWFyY2hUZXh0KSByZXR1cm4gdHJ1ZTtcbiAqICAgICAgIHJldHVybiBpdGVtLm5hbWUudG9Mb2NhbGVMb3dlckNhc2UoKS5pbmNsdWRlcyhzZWFyY2hUZXh0KTtcbiAqICAgICB9LFxuICogICAgIFtzZWFyY2hUZXh0XSxcbiAqICAgKTtcbiAqXG4gKiAgIGNvbnN0IGZvcm11bGFUcmFuc2Zvcm0gPSB1c2VDYWxsYmFjaygoaXRlbTogYW55KTogRm9ybXVsYSA9PiB7XG4gKiAgICAgcmV0dXJuIHsgbmFtZTogaXRlbS5uYW1lLCBkZXNjOiBpdGVtLmRlc2MgfTtcbiAqICAgfSwgW10pO1xuICpcbiAqICAgY29uc3QgeyBkYXRhLCBpc0xvYWRpbmcsIHBhZ2luYXRpb24gfSA9IHVzZVN0cmVhbUpTT04oYGZpbGU6Ly8vJHtqb2luKGhvbWVkaXIoKSwgXCJEb3dubG9hZHNcIiwgXCJmb3JtdWxhZS5qc29uXCIpfWAsIHtcbiAqICAgICBpbml0aWFsRGF0YTogW10gYXMgRm9ybXVsYVtdLFxuICogICAgIHBhZ2VTaXplOiAyMCxcbiAqICAgICBmaWx0ZXI6IGZvcm11bGFGaWx0ZXIsXG4gKiAgICAgdHJhbnNmb3JtOiBmb3JtdWxhVHJhbnNmb3JtLFxuICogICB9KTtcbiAqXG4gKiAgIHJldHVybiAoXG4gKiAgICAgPExpc3QgaXNMb2FkaW5nPXtpc0xvYWRpbmd9IHBhZ2luYXRpb249e3BhZ2luYXRpb259IG9uU2VhcmNoVGV4dENoYW5nZT17c2V0U2VhcmNoVGV4dH0+XG4gKiAgICAgICA8TGlzdC5TZWN0aW9uIHRpdGxlPVwiRm9ybXVsYWVcIj5cbiAqICAgICAgICAge2RhdGEubWFwKChkKSA9PiAoXG4gKiAgICAgICAgICAgPExpc3QuSXRlbSBrZXk9e2QubmFtZX0gdGl0bGU9e2QubmFtZX0gc3VidGl0bGU9e2QuZGVzY30gLz5cbiAqICAgICAgICAgKSl9XG4gKiAgICAgICA8L0xpc3QuU2VjdGlvbj5cbiAqICAgICA8L0xpc3Q+XG4gKiAgICk7XG4gKiB9XG4gKiBgYGBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHVzZVN0cmVhbUpTT048VCwgVSBleHRlbmRzIGFueVtdID0gYW55W10+KFxuICB1cmw6IFJlcXVlc3RJbmZvLFxuICBvcHRpb25zOiBPcHRpb25zPFQ+ICYgUmVxdWVzdEluaXQgJiBPbWl0PENhY2hlZFByb21pc2VPcHRpb25zPEZ1bmN0aW9uUmV0dXJuaW5nUGFnaW5hdGVkUHJvbWlzZSwgVT4sIFwiYWJvcnRhYmxlXCI+LFxuKTogVXNlQ2FjaGVkUHJvbWlzZVJldHVyblR5cGU8VCBleHRlbmRzIHVua25vd25bXSA/IFQgOiBUW10sIFU+O1xuXG5leHBvcnQgZnVuY3Rpb24gdXNlU3RyZWFtSlNPTjxULCBVIGV4dGVuZHMgYW55W10gPSBhbnlbXT4oXG4gIHVybDogUmVxdWVzdEluZm8sXG4gIG9wdGlvbnM/OiBPcHRpb25zPFQ+ICYgUmVxdWVzdEluaXQgJiBPbWl0PENhY2hlZFByb21pc2VPcHRpb25zPEZ1bmN0aW9uUmV0dXJuaW5nUGFnaW5hdGVkUHJvbWlzZSwgVT4sIFwiYWJvcnRhYmxlXCI+LFxuKTogVXNlQ2FjaGVkUHJvbWlzZVJldHVyblR5cGU8VCBleHRlbmRzIHVua25vd25bXSA/IFQgOiBUW10sIFU+IHtcbiAgY29uc3Qge1xuICAgIGluaXRpYWxEYXRhLFxuICAgIGV4ZWN1dGUsXG4gICAga2VlcFByZXZpb3VzRGF0YSxcbiAgICBvbkVycm9yLFxuICAgIG9uRGF0YSxcbiAgICBvbldpbGxFeGVjdXRlLFxuICAgIGZhaWx1cmVUb2FzdE9wdGlvbnMsXG4gICAgZGF0YVBhdGgsXG4gICAgZmlsdGVyLFxuICAgIHRyYW5zZm9ybSxcbiAgICBwYWdlU2l6ZSA9IDIwLFxuICAgIC4uLmZldGNoT3B0aW9uc1xuICB9ID0gb3B0aW9ucyA/PyB7fTtcbiAgY29uc3QgcHJldmlvdXNVcmwgPSB1c2VSZWY8UmVxdWVzdEluZm8+KG51bGwpO1xuICBjb25zdCBwcmV2aW91c0Rlc3RpbmF0aW9uID0gdXNlUmVmPHN0cmluZz4obnVsbCk7XG5cbiAgY29uc3QgdXNlQ2FjaGVkUHJvbWlzZU9wdGlvbnM6IENhY2hlZFByb21pc2VPcHRpb25zPEZ1bmN0aW9uUmV0dXJuaW5nUGFnaW5hdGVkUHJvbWlzZSwgVT4gPSB7XG4gICAgaW5pdGlhbERhdGEsXG4gICAgZXhlY3V0ZSxcbiAgICBrZWVwUHJldmlvdXNEYXRhLFxuICAgIG9uRXJyb3IsXG4gICAgb25EYXRhLFxuICAgIG9uV2lsbEV4ZWN1dGUsXG4gICAgZmFpbHVyZVRvYXN0T3B0aW9ucyxcbiAgfTtcblxuICBjb25zdCBnZW5lcmF0b3JSZWYgPSB1c2VSZWY8QXN5bmNHZW5lcmF0b3I8VCBleHRlbmRzIHVua25vd25bXSA/IFQgOiBUW10+IHwgbnVsbD4obnVsbCk7XG4gIGNvbnN0IGNvbnRyb2xsZXJSZWYgPSB1c2VSZWY8QWJvcnRDb250cm9sbGVyIHwgbnVsbD4obnVsbCk7XG4gIGNvbnN0IGhhc01vcmVSZWYgPSB1c2VSZWYoZmFsc2UpO1xuXG4gIHJldHVybiB1c2VDYWNoZWRQcm9taXNlKFxuICAgIChcbiAgICAgIHVybDogUmVxdWVzdEluZm8sXG4gICAgICBwYWdlU2l6ZTogbnVtYmVyLFxuICAgICAgZmV0Y2hPcHRpb25zOiBSZXF1ZXN0SW5pdCB8IHVuZGVmaW5lZCxcbiAgICAgIGRhdGFQYXRoOiBzdHJpbmcgfCBSZWdFeHAgfCB1bmRlZmluZWQsXG4gICAgICBmaWx0ZXI6ICgoaXRlbTogRmxhdHRlbjxUPikgPT4gYm9vbGVhbikgfCB1bmRlZmluZWQsXG4gICAgICB0cmFuc2Zvcm06ICgoaXRlbTogdW5rbm93bikgPT4gVCkgfCB1bmRlZmluZWQsXG4gICAgKSA9PlxuICAgICAgYXN5bmMgKHsgcGFnZSB9KSA9PiB7XG4gICAgICAgIGNvbnN0IGZpbGVOYW1lID0gaGFzaCh1cmwpICsgXCIuanNvblwiO1xuICAgICAgICBjb25zdCBmb2xkZXIgPSBlbnZpcm9ubWVudC5zdXBwb3J0UGF0aDtcbiAgICAgICAgaWYgKHBhZ2UgPT09IDApIHtcbiAgICAgICAgICBjb250cm9sbGVyUmVmLmN1cnJlbnQ/LmFib3J0KCk7XG4gICAgICAgICAgY29udHJvbGxlclJlZi5jdXJyZW50ID0gbmV3IEFib3J0Q29udHJvbGxlcigpO1xuICAgICAgICAgIGNvbnN0IGRlc3RpbmF0aW9uID0gam9pbihmb2xkZXIsIGZpbGVOYW1lKTtcbiAgICAgICAgICAvKipcbiAgICAgICAgICAgKiBGb3JjZSB1cGRhdGUgdGhlIGNhY2hlIHdoZW4gdGhlIFVSTCBjaGFuZ2VzIGJ1dCB0aGUgY2FjaGUgZGVzdGluYXRpb24gZG9lcyBub3QuXG4gICAgICAgICAgICovXG4gICAgICAgICAgY29uc3QgZm9yY2VDYWNoZVVwZGF0ZSA9IEJvb2xlYW4oXG4gICAgICAgICAgICBwcmV2aW91c1VybC5jdXJyZW50ICYmXG4gICAgICAgICAgICAgIHByZXZpb3VzVXJsLmN1cnJlbnQgIT09IHVybCAmJlxuICAgICAgICAgICAgICBwcmV2aW91c0Rlc3RpbmF0aW9uLmN1cnJlbnQgJiZcbiAgICAgICAgICAgICAgcHJldmlvdXNEZXN0aW5hdGlvbi5jdXJyZW50ID09PSBkZXN0aW5hdGlvbixcbiAgICAgICAgICApO1xuICAgICAgICAgIHByZXZpb3VzVXJsLmN1cnJlbnQgPSB1cmw7XG4gICAgICAgICAgcHJldmlvdXNEZXN0aW5hdGlvbi5jdXJyZW50ID0gZGVzdGluYXRpb247XG4gICAgICAgICAgYXdhaXQgY2FjaGVVUkxJZk5lY2Vzc2FyeSh1cmwsIGZvbGRlciwgZmlsZU5hbWUsIGZvcmNlQ2FjaGVVcGRhdGUsIHtcbiAgICAgICAgICAgIC4uLmZldGNoT3B0aW9ucyxcbiAgICAgICAgICAgIHNpZ25hbDogY29udHJvbGxlclJlZi5jdXJyZW50Py5zaWduYWwsXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgZ2VuZXJhdG9yUmVmLmN1cnJlbnQgPSBzdHJlYW1Kc29uRmlsZShcbiAgICAgICAgICAgIGRlc3RpbmF0aW9uLFxuICAgICAgICAgICAgcGFnZVNpemUsXG4gICAgICAgICAgICBjb250cm9sbGVyUmVmLmN1cnJlbnQ/LnNpZ25hbCxcbiAgICAgICAgICAgIGRhdGFQYXRoLFxuICAgICAgICAgICAgZmlsdGVyLFxuICAgICAgICAgICAgdHJhbnNmb3JtLFxuICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFnZW5lcmF0b3JSZWYuY3VycmVudCkge1xuICAgICAgICAgIHJldHVybiB7IGhhc01vcmU6IGhhc01vcmVSZWYuY3VycmVudCwgZGF0YTogW10gYXMgVCBleHRlbmRzIHVua25vd25bXSA/IFQgOiBUW10gfTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCB7IHZhbHVlOiBuZXdEYXRhLCBkb25lIH0gPSBhd2FpdCBnZW5lcmF0b3JSZWYuY3VycmVudC5uZXh0KCk7XG4gICAgICAgIGhhc01vcmVSZWYuY3VycmVudCA9ICFkb25lO1xuICAgICAgICByZXR1cm4geyBoYXNNb3JlOiBoYXNNb3JlUmVmLmN1cnJlbnQsIGRhdGE6IChuZXdEYXRhID8/IFtdKSBhcyBUIGV4dGVuZHMgdW5rbm93bltdID8gVCA6IFRbXSB9O1xuICAgICAgfSxcbiAgICBbdXJsLCBwYWdlU2l6ZSwgZmV0Y2hPcHRpb25zLCBkYXRhUGF0aCwgZmlsdGVyLCB0cmFuc2Zvcm1dLFxuICAgIHVzZUNhY2hlZFByb21pc2VPcHRpb25zLFxuICApO1xufVxuIiwgIi8qIGVzbGludC1kaXNhYmxlIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnkgKi9cbi8qIGVzbGludC1kaXNhYmxlIEB0eXBlc2NyaXB0LWVzbGludC9iYW4tdHMtY29tbWVudCAqL1xuaW1wb3J0IHsgUmVhZGFibGUsIFdyaXRhYmxlLCBEdXBsZXggfSBmcm9tIFwibm9kZTpzdHJlYW1cIjtcblxuZXhwb3J0IGNvbnN0IG5vbmUgPSAvKiAjX19QVVJFX18gKi8gU3ltYm9sLmZvcihcIm9iamVjdC1zdHJlYW0ubm9uZVwiKTtcbmNvbnN0IHN0b3AgPSAvKiAjX19QVVJFX18gKi8gU3ltYm9sLmZvcihcIm9iamVjdC1zdHJlYW0uc3RvcFwiKTtcblxuY29uc3QgZmluYWxTeW1ib2wgPSAvKiAjX19QVVJFX18gKi8gU3ltYm9sLmZvcihcIm9iamVjdC1zdHJlYW0uZmluYWxcIik7XG5jb25zdCBtYW55U3ltYm9sID0gLyogI19fUFVSRV9fICovIFN5bWJvbC5mb3IoXCJvYmplY3Qtc3RyZWFtLm1hbnlcIik7XG5jb25zdCBmbHVzaFN5bWJvbCA9IC8qICNfX1BVUkVfXyAqLyBTeW1ib2wuZm9yKFwib2JqZWN0LXN0cmVhbS5mbHVzaFwiKTtcbmNvbnN0IGZMaXN0U3ltYm9sID0gLyogI19fUFVSRV9fICovIFN5bWJvbC5mb3IoXCJvYmplY3Qtc3RyZWFtLmZMaXN0XCIpO1xuXG5jb25zdCBmaW5hbFZhbHVlID0gKHZhbHVlOiBhbnkpID0+ICh7IFtmaW5hbFN5bWJvbF06IDEsIHZhbHVlIH0pO1xuZXhwb3J0IGNvbnN0IG1hbnkgPSAodmFsdWVzOiBhbnkpID0+ICh7IFttYW55U3ltYm9sXTogMSwgdmFsdWVzIH0pO1xuXG5jb25zdCBpc0ZpbmFsVmFsdWUgPSAobzogYW55KSA9PiBvICYmIG9bZmluYWxTeW1ib2xdID09PSAxO1xuY29uc3QgaXNNYW55ID0gKG86IGFueSkgPT4gbyAmJiBvW21hbnlTeW1ib2xdID09PSAxO1xuY29uc3QgaXNGbHVzaGFibGUgPSAobzogYW55KSA9PiBvICYmIG9bZmx1c2hTeW1ib2xdID09PSAxO1xuY29uc3QgaXNGdW5jdGlvbkxpc3QgPSAobzogYW55KSA9PiBvICYmIG9bZkxpc3RTeW1ib2xdID09PSAxO1xuXG5jb25zdCBnZXRGaW5hbFZhbHVlID0gKG86IGFueSkgPT4gby52YWx1ZTtcbmNvbnN0IGdldE1hbnlWYWx1ZXMgPSAobzogYW55KSA9PiBvLnZhbHVlcztcbmNvbnN0IGdldEZ1bmN0aW9uTGlzdCA9IChvOiBhbnkpID0+IG8uZkxpc3Q7XG5cbmV4cG9ydCBjb25zdCBjb21iaW5lTWFueU11dCA9IChhOiBhbnksIGI6IGFueSkgPT4ge1xuICBjb25zdCB2YWx1ZXMgPSBhID09PSBub25lID8gW10gOiBhPy5bbWFueVN5bWJvbF0gPT09IDEgPyBhLnZhbHVlcyA6IFthXTtcbiAgaWYgKGIgPT09IG5vbmUpIHtcbiAgICAvLyBkbyBub3RoaW5nXG4gIH0gZWxzZSBpZiAoYj8uW21hbnlTeW1ib2xdID09PSAxKSB7XG4gICAgdmFsdWVzLnB1c2goLi4uYi52YWx1ZXMpO1xuICB9IGVsc2Uge1xuICAgIHZhbHVlcy5wdXNoKGIpO1xuICB9XG4gIHJldHVybiBtYW55KHZhbHVlcyk7XG59O1xuXG5leHBvcnQgY29uc3QgZmx1c2hhYmxlID0gKHdyaXRlOiAodmFsdWU6IGFueSkgPT4gYW55LCBmaW5hbCA9IG51bGwpID0+IHtcbiAgY29uc3QgZm4gPSBmaW5hbCA/ICh2YWx1ZTogYW55KSA9PiAodmFsdWUgPT09IG5vbmUgPyBmaW5hbFZhbHVlKHVuZGVmaW5lZCkgOiB3cml0ZSh2YWx1ZSkpIDogd3JpdGU7XG4gIC8vIEB0cy1pZ25vcmVcbiAgZm5bZmx1c2hTeW1ib2xdID0gMTtcbiAgcmV0dXJuIGZuO1xufTtcblxuY29uc3Qgc2V0RnVuY3Rpb25MaXN0ID0gKG86IGFueSwgZm5zOiBhbnkpID0+IHtcbiAgby5mTGlzdCA9IGZucztcbiAgb1tmTGlzdFN5bWJvbF0gPSAxO1xuICByZXR1cm4gbztcbn07XG5cbi8vIGlzKk5vZGVTdHJlYW0gZnVuY3Rpb25zIHRha2VuIGZyb20gaHR0cHM6Ly9naXRodWIuY29tL25vZGVqcy9ub2RlL2Jsb2IvbWFzdGVyL2xpYi9pbnRlcm5hbC9zdHJlYW1zL3V0aWxzLmpzXG5jb25zdCBpc1JlYWRhYmxlTm9kZVN0cmVhbSA9IChvYmo6IGFueSkgPT5cbiAgb2JqICYmXG4gIHR5cGVvZiBvYmoucGlwZSA9PT0gXCJmdW5jdGlvblwiICYmXG4gIHR5cGVvZiBvYmoub24gPT09IFwiZnVuY3Rpb25cIiAmJlxuICAoIW9iai5fd3JpdGFibGVTdGF0ZSB8fCAodHlwZW9mIG9iai5fcmVhZGFibGVTdGF0ZSA9PT0gXCJvYmplY3RcIiA/IG9iai5fcmVhZGFibGVTdGF0ZS5yZWFkYWJsZSA6IG51bGwpICE9PSBmYWxzZSkgJiYgLy8gRHVwbGV4XG4gICghb2JqLl93cml0YWJsZVN0YXRlIHx8IG9iai5fcmVhZGFibGVTdGF0ZSk7IC8vIFdyaXRhYmxlIGhhcyAucGlwZS5cblxuY29uc3QgaXNXcml0YWJsZU5vZGVTdHJlYW0gPSAob2JqOiBhbnkpID0+XG4gIG9iaiAmJlxuICB0eXBlb2Ygb2JqLndyaXRlID09PSBcImZ1bmN0aW9uXCIgJiZcbiAgdHlwZW9mIG9iai5vbiA9PT0gXCJmdW5jdGlvblwiICYmXG4gICghb2JqLl9yZWFkYWJsZVN0YXRlIHx8ICh0eXBlb2Ygb2JqLl93cml0YWJsZVN0YXRlID09PSBcIm9iamVjdFwiID8gb2JqLl93cml0YWJsZVN0YXRlLndyaXRhYmxlIDogbnVsbCkgIT09IGZhbHNlKTsgLy8gRHVwbGV4XG5cbmNvbnN0IGlzRHVwbGV4Tm9kZVN0cmVhbSA9IChvYmo6IGFueSkgPT5cbiAgb2JqICYmXG4gIHR5cGVvZiBvYmoucGlwZSA9PT0gXCJmdW5jdGlvblwiICYmXG4gIG9iai5fcmVhZGFibGVTdGF0ZSAmJlxuICB0eXBlb2Ygb2JqLm9uID09PSBcImZ1bmN0aW9uXCIgJiZcbiAgdHlwZW9mIG9iai53cml0ZSA9PT0gXCJmdW5jdGlvblwiO1xuXG5jb25zdCBpc1JlYWRhYmxlV2ViU3RyZWFtID0gKG9iajogYW55KSA9PiBvYmogJiYgZ2xvYmFsVGhpcy5SZWFkYWJsZVN0cmVhbSAmJiBvYmogaW5zdGFuY2VvZiBnbG9iYWxUaGlzLlJlYWRhYmxlU3RyZWFtO1xuXG5jb25zdCBpc1dyaXRhYmxlV2ViU3RyZWFtID0gKG9iajogYW55KSA9PiBvYmogJiYgZ2xvYmFsVGhpcy5Xcml0YWJsZVN0cmVhbSAmJiBvYmogaW5zdGFuY2VvZiBnbG9iYWxUaGlzLldyaXRhYmxlU3RyZWFtO1xuXG5jb25zdCBpc0R1cGxleFdlYlN0cmVhbSA9IChvYmo6IGFueSkgPT5cbiAgb2JqICYmXG4gIGdsb2JhbFRoaXMuUmVhZGFibGVTdHJlYW0gJiZcbiAgb2JqLnJlYWRhYmxlIGluc3RhbmNlb2YgZ2xvYmFsVGhpcy5SZWFkYWJsZVN0cmVhbSAmJlxuICBnbG9iYWxUaGlzLldyaXRhYmxlU3RyZWFtICYmXG4gIG9iai53cml0YWJsZSBpbnN0YW5jZW9mIGdsb2JhbFRoaXMuV3JpdGFibGVTdHJlYW07XG5cbmNvbnN0IGdyb3VwRnVuY3Rpb25zID0gKG91dHB1dDogYW55LCBmbjogYW55LCBpbmRleDogYW55LCBmbnM6IGFueSkgPT4ge1xuICBpZiAoXG4gICAgaXNEdXBsZXhOb2RlU3RyZWFtKGZuKSB8fFxuICAgICghaW5kZXggJiYgaXNSZWFkYWJsZU5vZGVTdHJlYW0oZm4pKSB8fFxuICAgIChpbmRleCA9PT0gZm5zLmxlbmd0aCAtIDEgJiYgaXNXcml0YWJsZU5vZGVTdHJlYW0oZm4pKVxuICApIHtcbiAgICBvdXRwdXQucHVzaChmbik7XG4gICAgcmV0dXJuIG91dHB1dDtcbiAgfVxuICBpZiAoaXNEdXBsZXhXZWJTdHJlYW0oZm4pKSB7XG4gICAgb3V0cHV0LnB1c2goRHVwbGV4LmZyb21XZWIoZm4sIHsgb2JqZWN0TW9kZTogdHJ1ZSB9KSk7XG4gICAgcmV0dXJuIG91dHB1dDtcbiAgfVxuICBpZiAoIWluZGV4ICYmIGlzUmVhZGFibGVXZWJTdHJlYW0oZm4pKSB7XG4gICAgb3V0cHV0LnB1c2goUmVhZGFibGUuZnJvbVdlYihmbiwgeyBvYmplY3RNb2RlOiB0cnVlIH0pKTtcbiAgICByZXR1cm4gb3V0cHV0O1xuICB9XG4gIGlmIChpbmRleCA9PT0gZm5zLmxlbmd0aCAtIDEgJiYgaXNXcml0YWJsZVdlYlN0cmVhbShmbikpIHtcbiAgICBvdXRwdXQucHVzaChXcml0YWJsZS5mcm9tV2ViKGZuLCB7IG9iamVjdE1vZGU6IHRydWUgfSkpO1xuICAgIHJldHVybiBvdXRwdXQ7XG4gIH1cbiAgaWYgKHR5cGVvZiBmbiAhPSBcImZ1bmN0aW9uXCIpIHRocm93IFR5cGVFcnJvcihcIkl0ZW0gI1wiICsgaW5kZXggKyBcIiBpcyBub3QgYSBwcm9wZXIgc3RyZWFtLCBub3IgYSBmdW5jdGlvbi5cIik7XG4gIGlmICghb3V0cHV0Lmxlbmd0aCkgb3V0cHV0LnB1c2goW10pO1xuICBjb25zdCBsYXN0ID0gb3V0cHV0W291dHB1dC5sZW5ndGggLSAxXTtcbiAgaWYgKEFycmF5LmlzQXJyYXkobGFzdCkpIHtcbiAgICBsYXN0LnB1c2goZm4pO1xuICB9IGVsc2Uge1xuICAgIG91dHB1dC5wdXNoKFtmbl0pO1xuICB9XG4gIHJldHVybiBvdXRwdXQ7XG59O1xuXG5jbGFzcyBTdG9wIGV4dGVuZHMgRXJyb3Ige31cblxuZXhwb3J0IGNvbnN0IGFzU3RyZWFtID0gKGZuOiBhbnkpID0+IHtcbiAgaWYgKHR5cGVvZiBmbiAhPSBcImZ1bmN0aW9uXCIpIHRocm93IFR5cGVFcnJvcihcIk9ubHkgYSBmdW5jdGlvbiBpcyBhY2NlcHRlZCBhcyB0aGUgZmlyc3QgYXJndW1lbnRcIik7XG5cbiAgLy8gcHVtcCB2YXJpYWJsZXNcbiAgbGV0IHBhdXNlZCA9IFByb21pc2UucmVzb2x2ZSgpO1xuICBsZXQgcmVzb2x2ZVBhdXNlZDogKCh2YWx1ZTogdm9pZCB8IFByb21pc2VMaWtlPHZvaWQ+KSA9PiB2b2lkKSB8IG51bGwgPSBudWxsO1xuICBjb25zdCBxdWV1ZTogYW55W10gPSBbXTtcblxuICAvLyBwYXVzZS9yZXN1bWVcbiAgY29uc3QgcmVzdW1lOiBhbnkgPSAoKSA9PiB7XG4gICAgaWYgKCFyZXNvbHZlUGF1c2VkKSByZXR1cm47XG4gICAgcmVzb2x2ZVBhdXNlZCgpO1xuICAgIHJlc29sdmVQYXVzZWQgPSBudWxsO1xuICAgIHBhdXNlZCA9IFByb21pc2UucmVzb2x2ZSgpO1xuICB9O1xuICBjb25zdCBwYXVzZTogYW55ID0gKCkgPT4ge1xuICAgIGlmIChyZXNvbHZlUGF1c2VkKSByZXR1cm47XG4gICAgcGF1c2VkID0gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IChyZXNvbHZlUGF1c2VkID0gcmVzb2x2ZSkpO1xuICB9O1xuXG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBwcmVmZXItY29uc3RcbiAgbGV0IHN0cmVhbTogRHVwbGV4OyAvLyB3aWxsIGJlIGFzc2lnbmVkIGxhdGVyXG5cbiAgLy8gZGF0YSBwcm9jZXNzaW5nXG4gIGNvbnN0IHB1c2hSZXN1bHRzOiBhbnkgPSAodmFsdWVzOiBhbnkpID0+IHtcbiAgICBpZiAodmFsdWVzICYmIHR5cGVvZiB2YWx1ZXMubmV4dCA9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgIC8vIGdlbmVyYXRvclxuICAgICAgcXVldWUucHVzaCh2YWx1ZXMpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICAvLyBhcnJheVxuICAgIHF1ZXVlLnB1c2godmFsdWVzW1N5bWJvbC5pdGVyYXRvcl0oKSk7XG4gIH07XG4gIGNvbnN0IHB1bXA6IGFueSA9IGFzeW5jICgpID0+IHtcbiAgICB3aGlsZSAocXVldWUubGVuZ3RoKSB7XG4gICAgICBhd2FpdCBwYXVzZWQ7XG4gICAgICBjb25zdCBnZW4gPSBxdWV1ZVtxdWV1ZS5sZW5ndGggLSAxXTtcbiAgICAgIGxldCByZXN1bHQgPSBnZW4ubmV4dCgpO1xuICAgICAgaWYgKHJlc3VsdCAmJiB0eXBlb2YgcmVzdWx0LnRoZW4gPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgIHJlc3VsdCA9IGF3YWl0IHJlc3VsdDtcbiAgICAgIH1cbiAgICAgIGlmIChyZXN1bHQuZG9uZSkge1xuICAgICAgICBxdWV1ZS5wb3AoKTtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgICBsZXQgdmFsdWUgPSByZXN1bHQudmFsdWU7XG4gICAgICBpZiAodmFsdWUgJiYgdHlwZW9mIHZhbHVlLnRoZW4gPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgIHZhbHVlID0gYXdhaXQgdmFsdWU7XG4gICAgICB9XG4gICAgICBhd2FpdCBzYW5pdGl6ZSh2YWx1ZSk7XG4gICAgfVxuICB9O1xuICBjb25zdCBzYW5pdGl6ZTogYW55ID0gYXN5bmMgKHZhbHVlOiBhbnkpID0+IHtcbiAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCB8fCB2YWx1ZSA9PT0gbnVsbCB8fCB2YWx1ZSA9PT0gbm9uZSkgcmV0dXJuO1xuICAgIGlmICh2YWx1ZSA9PT0gc3RvcCkgdGhyb3cgbmV3IFN0b3AoKTtcblxuICAgIGlmIChpc01hbnkodmFsdWUpKSB7XG4gICAgICBwdXNoUmVzdWx0cyhnZXRNYW55VmFsdWVzKHZhbHVlKSk7XG4gICAgICByZXR1cm4gcHVtcCgpO1xuICAgIH1cblxuICAgIGlmIChpc0ZpbmFsVmFsdWUodmFsdWUpKSB7XG4gICAgICAvLyBhIGZpbmFsIHZhbHVlIGlzIG5vdCBzdXBwb3J0ZWQsIGl0IGlzIHRyZWF0ZWQgYXMgYSByZWd1bGFyIHZhbHVlXG4gICAgICB2YWx1ZSA9IGdldEZpbmFsVmFsdWUodmFsdWUpO1xuICAgICAgcmV0dXJuIHByb2Nlc3NWYWx1ZSh2YWx1ZSk7XG4gICAgfVxuXG4gICAgaWYgKCFzdHJlYW0ucHVzaCh2YWx1ZSkpIHtcbiAgICAgIHBhdXNlKCk7XG4gICAgfVxuICB9O1xuICBjb25zdCBwcm9jZXNzQ2h1bms6IGFueSA9IGFzeW5jIChjaHVuazogYW55LCBlbmNvZGluZzogYW55KSA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHZhbHVlID0gZm4oY2h1bmssIGVuY29kaW5nKTtcbiAgICAgIGF3YWl0IHByb2Nlc3NWYWx1ZSh2YWx1ZSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIFN0b3ApIHtcbiAgICAgICAgc3RyZWFtLnB1c2gobnVsbCk7XG4gICAgICAgIHN0cmVhbS5kZXN0cm95KCk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfTtcbiAgY29uc3QgcHJvY2Vzc1ZhbHVlOiBhbnkgPSBhc3luYyAodmFsdWU6IGFueSkgPT4ge1xuICAgIGlmICh2YWx1ZSAmJiB0eXBlb2YgdmFsdWUudGhlbiA9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgIC8vIHRoZW5hYmxlXG4gICAgICByZXR1cm4gdmFsdWUudGhlbigodmFsdWU6IGFueSkgPT4gcHJvY2Vzc1ZhbHVlKHZhbHVlKSk7XG4gICAgfVxuICAgIGlmICh2YWx1ZSAmJiB0eXBlb2YgdmFsdWUubmV4dCA9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgIC8vIGdlbmVyYXRvclxuICAgICAgcHVzaFJlc3VsdHModmFsdWUpO1xuICAgICAgcmV0dXJuIHB1bXAoKTtcbiAgICB9XG4gICAgcmV0dXJuIHNhbml0aXplKHZhbHVlKTtcbiAgfTtcblxuICBzdHJlYW0gPSBuZXcgRHVwbGV4KFxuICAgIE9iamVjdC5hc3NpZ24oeyB3cml0YWJsZU9iamVjdE1vZGU6IHRydWUsIHJlYWRhYmxlT2JqZWN0TW9kZTogdHJ1ZSB9LCB1bmRlZmluZWQsIHtcbiAgICAgIHdyaXRlKGNodW5rOiBhbnksIGVuY29kaW5nOiBhbnksIGNhbGxiYWNrOiBhbnkpIHtcbiAgICAgICAgcHJvY2Vzc0NodW5rKGNodW5rLCBlbmNvZGluZykudGhlbihcbiAgICAgICAgICAoKSA9PiBjYWxsYmFjayhudWxsKSxcbiAgICAgICAgICAoZXJyb3I6IGFueSkgPT4gY2FsbGJhY2soZXJyb3IpLFxuICAgICAgICApO1xuICAgICAgfSxcbiAgICAgIGZpbmFsKGNhbGxiYWNrOiBhbnkpIHtcbiAgICAgICAgaWYgKCFpc0ZsdXNoYWJsZShmbikpIHtcbiAgICAgICAgICBzdHJlYW0ucHVzaChudWxsKTtcbiAgICAgICAgICBjYWxsYmFjayhudWxsKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgcHJvY2Vzc0NodW5rKG5vbmUsIG51bGwpLnRoZW4oXG4gICAgICAgICAgKCkgPT4gKHN0cmVhbS5wdXNoKG51bGwpLCBjYWxsYmFjayhudWxsKSksXG4gICAgICAgICAgKGVycm9yOiBhbnkpID0+IGNhbGxiYWNrKGVycm9yKSxcbiAgICAgICAgKTtcbiAgICAgIH0sXG4gICAgICByZWFkKCkge1xuICAgICAgICByZXN1bWUoKTtcbiAgICAgIH0sXG4gICAgfSksXG4gICk7XG5cbiAgcmV0dXJuIHN0cmVhbTtcbn07XG5cbmNvbnN0IHByb2R1Y2VTdHJlYW1zID0gKGl0ZW06IGFueSkgPT4ge1xuICBpZiAoQXJyYXkuaXNBcnJheShpdGVtKSkge1xuICAgIGlmICghaXRlbS5sZW5ndGgpIHJldHVybiBudWxsO1xuICAgIGlmIChpdGVtLmxlbmd0aCA9PSAxKSByZXR1cm4gaXRlbVswXSAmJiBhc1N0cmVhbShpdGVtWzBdKTtcbiAgICByZXR1cm4gYXNTdHJlYW0oZ2VuKC4uLml0ZW0pKTtcbiAgfVxuICByZXR1cm4gaXRlbTtcbn07XG5cbmNvbnN0IG5leHQ6IGFueSA9IGFzeW5jIGZ1bmN0aW9uKiAodmFsdWU6IGFueSwgZm5zOiBhbnksIGluZGV4OiBhbnkpIHtcbiAgZm9yIChsZXQgaSA9IGluZGV4OyBpIDw9IGZucy5sZW5ndGg7ICsraSkge1xuICAgIGlmICh2YWx1ZSAmJiB0eXBlb2YgdmFsdWUudGhlbiA9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgIC8vIHRoZW5hYmxlXG4gICAgICB2YWx1ZSA9IGF3YWl0IHZhbHVlO1xuICAgIH1cbiAgICBpZiAodmFsdWUgPT09IG5vbmUpIGJyZWFrO1xuICAgIGlmICh2YWx1ZSA9PT0gc3RvcCkgdGhyb3cgbmV3IFN0b3AoKTtcbiAgICBpZiAoaXNGaW5hbFZhbHVlKHZhbHVlKSkge1xuICAgICAgeWllbGQgZ2V0RmluYWxWYWx1ZSh2YWx1ZSk7XG4gICAgICBicmVhaztcbiAgICB9XG4gICAgaWYgKGlzTWFueSh2YWx1ZSkpIHtcbiAgICAgIGNvbnN0IHZhbHVlcyA9IGdldE1hbnlWYWx1ZXModmFsdWUpO1xuICAgICAgaWYgKGkgPT0gZm5zLmxlbmd0aCkge1xuICAgICAgICB5aWVsZCogdmFsdWVzO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB2YWx1ZXMubGVuZ3RoOyArK2opIHtcbiAgICAgICAgICB5aWVsZCogbmV4dCh2YWx1ZXNbal0sIGZucywgaSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGJyZWFrO1xuICAgIH1cbiAgICBpZiAodmFsdWUgJiYgdHlwZW9mIHZhbHVlLm5leHQgPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAvLyBnZW5lcmF0b3JcbiAgICAgIGZvciAoOzspIHtcbiAgICAgICAgbGV0IGRhdGEgPSB2YWx1ZS5uZXh0KCk7XG4gICAgICAgIGlmIChkYXRhICYmIHR5cGVvZiBkYXRhLnRoZW4gPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgZGF0YSA9IGF3YWl0IGRhdGE7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGRhdGEuZG9uZSkgYnJlYWs7XG4gICAgICAgIGlmIChpID09IGZucy5sZW5ndGgpIHtcbiAgICAgICAgICB5aWVsZCBkYXRhLnZhbHVlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHlpZWxkKiBuZXh0KGRhdGEudmFsdWUsIGZucywgaSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGJyZWFrO1xuICAgIH1cbiAgICBpZiAoaSA9PSBmbnMubGVuZ3RoKSB7XG4gICAgICB5aWVsZCB2YWx1ZTtcbiAgICAgIGJyZWFrO1xuICAgIH1cbiAgICBjb25zdCBmID0gZm5zW2ldO1xuICAgIHZhbHVlID0gZih2YWx1ZSk7XG4gIH1cbn07XG5cbmV4cG9ydCBjb25zdCBnZW4gPSAoLi4uZm5zOiBhbnkpID0+IHtcbiAgZm5zID0gZm5zXG4gICAgLmZpbHRlcigoZm46IGFueSkgPT4gZm4pXG4gICAgLmZsYXQoSW5maW5pdHkpXG4gICAgLm1hcCgoZm46IGFueSkgPT4gKGlzRnVuY3Rpb25MaXN0KGZuKSA/IGdldEZ1bmN0aW9uTGlzdChmbikgOiBmbikpXG4gICAgLmZsYXQoSW5maW5pdHkpO1xuICBpZiAoIWZucy5sZW5ndGgpIHtcbiAgICBmbnMgPSBbKHg6IGFueSkgPT4geF07XG4gIH1cbiAgbGV0IGZsdXNoZWQgPSBmYWxzZTtcbiAgbGV0IGcgPSBhc3luYyBmdW5jdGlvbiogKHZhbHVlOiBhbnkpIHtcbiAgICBpZiAoZmx1c2hlZCkgdGhyb3cgRXJyb3IoXCJDYWxsIHRvIGEgZmx1c2hlZCBwaXBlLlwiKTtcbiAgICBpZiAodmFsdWUgIT09IG5vbmUpIHtcbiAgICAgIHlpZWxkKiBuZXh0KHZhbHVlLCBmbnMsIDApO1xuICAgIH0gZWxzZSB7XG4gICAgICBmbHVzaGVkID0gdHJ1ZTtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZm5zLmxlbmd0aDsgKytpKSB7XG4gICAgICAgIGNvbnN0IGYgPSBmbnNbaV07XG4gICAgICAgIGlmIChpc0ZsdXNoYWJsZShmKSkge1xuICAgICAgICAgIHlpZWxkKiBuZXh0KGYobm9uZSksIGZucywgaSArIDEpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9O1xuICBjb25zdCBuZWVkVG9GbHVzaCA9IGZucy5zb21lKChmbjogYW55KSA9PiBpc0ZsdXNoYWJsZShmbikpO1xuICBpZiAobmVlZFRvRmx1c2gpIGcgPSBmbHVzaGFibGUoZyk7XG4gIHJldHVybiBzZXRGdW5jdGlvbkxpc3QoZywgZm5zKTtcbn07XG5cbmNvbnN0IHdyaXRlID0gKGlucHV0OiBhbnksIGNodW5rOiBhbnksIGVuY29kaW5nOiBhbnksIGNhbGxiYWNrOiBhbnkpID0+IHtcbiAgbGV0IGVycm9yOiBhbnkgPSBudWxsO1xuICB0cnkge1xuICAgIGlucHV0LndyaXRlKGNodW5rLCBlbmNvZGluZywgKGU6IGFueSkgPT4gY2FsbGJhY2soZSB8fCBlcnJvcikpO1xuICB9IGNhdGNoIChlKSB7XG4gICAgZXJyb3IgPSBlO1xuICB9XG59O1xuXG5jb25zdCBmaW5hbCA9IChpbnB1dDogYW55LCBjYWxsYmFjazogYW55KSA9PiB7XG4gIGxldCBlcnJvcjogYW55ID0gbnVsbDtcbiAgdHJ5IHtcbiAgICBpbnB1dC5lbmQobnVsbCwgbnVsbCwgKGU6IGFueSkgPT4gY2FsbGJhY2soZSB8fCBlcnJvcikpO1xuICB9IGNhdGNoIChlKSB7XG4gICAgZXJyb3IgPSBlO1xuICB9XG59O1xuXG5jb25zdCByZWFkID0gKG91dHB1dDogYW55KSA9PiB7XG4gIG91dHB1dC5yZXN1bWUoKTtcbn07XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGNoYWluKGZuczogYW55KSB7XG4gIGZucyA9IGZucy5mbGF0KEluZmluaXR5KS5maWx0ZXIoKGZuOiBhbnkpID0+IGZuKTtcblxuICBjb25zdCBzdHJlYW1zID0gZm5zXG4gICAgICAubWFwKChmbjogYW55KSA9PiAoaXNGdW5jdGlvbkxpc3QoZm4pID8gZ2V0RnVuY3Rpb25MaXN0KGZuKSA6IGZuKSlcbiAgICAgIC5mbGF0KEluZmluaXR5KVxuICAgICAgLnJlZHVjZShncm91cEZ1bmN0aW9ucywgW10pXG4gICAgICAubWFwKHByb2R1Y2VTdHJlYW1zKVxuICAgICAgLmZpbHRlcigoczogYW55KSA9PiBzKSxcbiAgICBpbnB1dCA9IHN0cmVhbXNbMF0sXG4gICAgb3V0cHV0ID0gc3RyZWFtcy5yZWR1Y2UoKG91dHB1dDogYW55LCBpdGVtOiBhbnkpID0+IChvdXRwdXQgJiYgb3V0cHV0LnBpcGUoaXRlbSkpIHx8IGl0ZW0pO1xuXG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBwcmVmZXItY29uc3RcbiAgbGV0IHN0cmVhbTogRHVwbGV4OyAvLyB3aWxsIGJlIGFzc2lnbmVkIGxhdGVyXG5cbiAgbGV0IHdyaXRlTWV0aG9kID0gKGNodW5rOiBhbnksIGVuY29kaW5nOiBhbnksIGNhbGxiYWNrOiBhbnkpID0+IHdyaXRlKGlucHV0LCBjaHVuaywgZW5jb2RpbmcsIGNhbGxiYWNrKSxcbiAgICBmaW5hbE1ldGhvZCA9IChjYWxsYmFjazogYW55KSA9PiBmaW5hbChpbnB1dCwgY2FsbGJhY2spLFxuICAgIHJlYWRNZXRob2QgPSAoKSA9PiByZWFkKG91dHB1dCk7XG5cbiAgaWYgKCFpc1dyaXRhYmxlTm9kZVN0cmVhbShpbnB1dCkpIHtcbiAgICB3cml0ZU1ldGhvZCA9IChfMSwgXzIsIGNhbGxiYWNrKSA9PiBjYWxsYmFjayhudWxsKTtcbiAgICBmaW5hbE1ldGhvZCA9IChjYWxsYmFjaykgPT4gY2FsbGJhY2sobnVsbCk7XG4gICAgaW5wdXQub24oXCJlbmRcIiwgKCkgPT4gc3RyZWFtLmVuZCgpKTtcbiAgfVxuXG4gIGlmIChpc1JlYWRhYmxlTm9kZVN0cmVhbShvdXRwdXQpKSB7XG4gICAgb3V0cHV0Lm9uKFwiZGF0YVwiLCAoY2h1bms6IGFueSkgPT4gIXN0cmVhbS5wdXNoKGNodW5rKSAmJiBvdXRwdXQucGF1c2UoKSk7XG4gICAgb3V0cHV0Lm9uKFwiZW5kXCIsICgpID0+IHN0cmVhbS5wdXNoKG51bGwpKTtcbiAgfSBlbHNlIHtcbiAgICByZWFkTWV0aG9kID0gKCkgPT4ge307IC8vIG5vcFxuICAgIG91dHB1dC5vbihcImZpbmlzaFwiLCAoKSA9PiBzdHJlYW0ucHVzaChudWxsKSk7XG4gIH1cblxuICBzdHJlYW0gPSBuZXcgRHVwbGV4KFxuICAgIE9iamVjdC5hc3NpZ24oXG4gICAgICB7IHdyaXRhYmxlT2JqZWN0TW9kZTogdHJ1ZSwgcmVhZGFibGVPYmplY3RNb2RlOiB0cnVlIH0sXG4gICAgICB7XG4gICAgICAgIHJlYWRhYmxlOiBpc1JlYWRhYmxlTm9kZVN0cmVhbShvdXRwdXQpLFxuICAgICAgICB3cml0YWJsZTogaXNXcml0YWJsZU5vZGVTdHJlYW0oaW5wdXQpLFxuICAgICAgICB3cml0ZTogd3JpdGVNZXRob2QsXG4gICAgICAgIGZpbmFsOiBmaW5hbE1ldGhvZCxcbiAgICAgICAgcmVhZDogcmVhZE1ldGhvZCxcbiAgICAgIH0sXG4gICAgKSxcbiAgKTtcbiAgLy8gQHRzLWlnbm9yZVxuICBzdHJlYW0uc3RyZWFtcyA9IHN0cmVhbXM7XG4gIC8vIEB0cy1pZ25vcmVcbiAgc3RyZWFtLmlucHV0ID0gaW5wdXQ7XG4gIC8vIEB0cy1pZ25vcmVcbiAgc3RyZWFtLm91dHB1dCA9IG91dHB1dDtcblxuICBpZiAoIWlzUmVhZGFibGVOb2RlU3RyZWFtKG91dHB1dCkpIHtcbiAgICBzdHJlYW0ucmVzdW1lKCk7XG4gIH1cblxuICAvLyBjb25uZWN0IGV2ZW50c1xuICBzdHJlYW1zLmZvckVhY2goKGl0ZW06IGFueSkgPT4gaXRlbS5vbihcImVycm9yXCIsIChlcnJvcjogYW55KSA9PiBzdHJlYW0uZW1pdChcImVycm9yXCIsIGVycm9yKSkpO1xuXG4gIHJldHVybiBzdHJlYW07XG59XG4iLCAiLyogZXNsaW50LWRpc2FibGUgQHR5cGVzY3JpcHQtZXNsaW50L2Jhbi10cy1jb21tZW50ICovXG4vKiBlc2xpbnQtZGlzYWJsZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55ICovXG4vKiBlc2xpbnQtZGlzYWJsZSBuby1jb250cm9sLXJlZ2V4ICovXG4vKiBlc2xpbnQtZGlzYWJsZSBuby11c2VsZXNzLWVzY2FwZSAqL1xuaW1wb3J0IHsgZmx1c2hhYmxlLCBnZW4sIG1hbnksIG5vbmUsIGNvbWJpbmVNYW55TXV0IH0gZnJvbSBcIi4vc3RyZWFtLWNoYWluXCI7XG5pbXBvcnQgeyBTdHJpbmdEZWNvZGVyIH0gZnJvbSBcIm5vZGU6c3RyaW5nX2RlY29kZXJcIjtcbmltcG9ydCBFdmVudEVtaXR0ZXIgZnJvbSBcIm5vZGU6ZXZlbnRzXCI7XG5cbmNvbnN0IGZpeFV0ZjhTdHJlYW0gPSAoKSA9PiB7XG4gIGNvbnN0IHN0cmluZ0RlY29kZXIgPSBuZXcgU3RyaW5nRGVjb2RlcigpO1xuICBsZXQgaW5wdXQgPSBcIlwiO1xuICByZXR1cm4gZmx1c2hhYmxlKChjaHVuazogYW55KSA9PiB7XG4gICAgaWYgKGNodW5rID09PSBub25lKSB7XG4gICAgICBjb25zdCByZXN1bHQgPSBpbnB1dCArIHN0cmluZ0RlY29kZXIuZW5kKCk7XG4gICAgICBpbnB1dCA9IFwiXCI7XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiAgICBpZiAodHlwZW9mIGNodW5rID09IFwic3RyaW5nXCIpIHtcbiAgICAgIGlmICghaW5wdXQpIHJldHVybiBjaHVuaztcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGlucHV0ICsgY2h1bms7XG4gICAgICBpbnB1dCA9IFwiXCI7XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiAgICBpZiAoY2h1bmsgaW5zdGFuY2VvZiBCdWZmZXIpIHtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGlucHV0ICsgc3RyaW5nRGVjb2Rlci53cml0ZShjaHVuayk7XG4gICAgICBpbnB1dCA9IFwiXCI7XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiRXhwZWN0ZWQgYSBzdHJpbmcgb3IgYSBCdWZmZXJcIik7XG4gIH0pO1xufTtcblxuY29uc3QgcGF0dGVybnMgPSB7XG4gIHZhbHVlMTogL1tcXFwiXFx7XFxbXFxdXFwtXFxkXXx0cnVlXFxifGZhbHNlXFxifG51bGxcXGJ8XFxzezEsMjU2fS95LFxuICBzdHJpbmc6IC9bXlxceDAwLVxceDFmXFxcIlxcXFxdezEsMjU2fXxcXFxcW2JmbnJ0XFxcIlxcXFxcXC9dfFxcXFx1W1xcZGEtZkEtRl17NH18XFxcIi95LFxuICBrZXkxOiAvW1xcXCJcXH1dfFxcc3sxLDI1Nn0veSxcbiAgY29sb246IC9cXDp8XFxzezEsMjU2fS95LFxuICBjb21tYTogL1tcXCxcXF1cXH1dfFxcc3sxLDI1Nn0veSxcbiAgd3M6IC9cXHN7MSwyNTZ9L3ksXG4gIG51bWJlclN0YXJ0OiAvXFxkL3ksXG4gIG51bWJlckRpZ2l0OiAvXFxkezAsMjU2fS95LFxuICBudW1iZXJGcmFjdGlvbjogL1tcXC5lRV0veSxcbiAgbnVtYmVyRXhwb25lbnQ6IC9bZUVdL3ksXG4gIG51bWJlckV4cFNpZ246IC9bLStdL3ksXG59O1xuY29uc3QgTUFYX1BBVFRFUk5fU0laRSA9IDE2O1xuXG5jb25zdCB2YWx1ZXM6IHsgW2tleTogc3RyaW5nXTogYW55IH0gPSB7IHRydWU6IHRydWUsIGZhbHNlOiBmYWxzZSwgbnVsbDogbnVsbCB9LFxuICBleHBlY3RlZDogeyBba2V5OiBzdHJpbmddOiBzdHJpbmcgfSA9IHsgb2JqZWN0OiBcIm9iamVjdFN0b3BcIiwgYXJyYXk6IFwiYXJyYXlTdG9wXCIsIFwiXCI6IFwiZG9uZVwiIH07XG5cbi8vIGxvbmcgaGV4YWRlY2ltYWwgY29kZXM6IFxcdVhYWFhcbmNvbnN0IGZyb21IZXggPSAoczogc3RyaW5nKSA9PiBTdHJpbmcuZnJvbUNoYXJDb2RlKHBhcnNlSW50KHMuc2xpY2UoMiksIDE2KSk7XG5cbi8vIHNob3J0IGNvZGVzOiBcXGIgXFxmIFxcbiBcXHIgXFx0IFxcXCIgXFxcXCBcXC9cbmNvbnN0IGNvZGVzOiB7IFtrZXk6IHN0cmluZ106IHN0cmluZyB9ID0ge1xuICBiOiBcIlxcYlwiLFxuICBmOiBcIlxcZlwiLFxuICBuOiBcIlxcblwiLFxuICByOiBcIlxcclwiLFxuICB0OiBcIlxcdFwiLFxuICAnXCInOiAnXCInLFxuICBcIlxcXFxcIjogXCJcXFxcXCIsXG4gIFwiL1wiOiBcIi9cIixcbn07XG5cbmNvbnN0IGpzb25QYXJzZXIgPSAob3B0aW9ucz86IGFueSkgPT4ge1xuICBsZXQgcGFja0tleXMgPSB0cnVlLFxuICAgIHBhY2tTdHJpbmdzID0gdHJ1ZSxcbiAgICBwYWNrTnVtYmVycyA9IHRydWUsXG4gICAgc3RyZWFtS2V5cyA9IHRydWUsXG4gICAgc3RyZWFtU3RyaW5ncyA9IHRydWUsXG4gICAgc3RyZWFtTnVtYmVycyA9IHRydWUsXG4gICAganNvblN0cmVhbWluZyA9IGZhbHNlO1xuXG4gIGlmIChvcHRpb25zKSB7XG4gICAgXCJwYWNrVmFsdWVzXCIgaW4gb3B0aW9ucyAmJiAocGFja0tleXMgPSBwYWNrU3RyaW5ncyA9IHBhY2tOdW1iZXJzID0gb3B0aW9ucy5wYWNrVmFsdWVzKTtcbiAgICBcInBhY2tLZXlzXCIgaW4gb3B0aW9ucyAmJiAocGFja0tleXMgPSBvcHRpb25zLnBhY2tLZXlzKTtcbiAgICBcInBhY2tTdHJpbmdzXCIgaW4gb3B0aW9ucyAmJiAocGFja1N0cmluZ3MgPSBvcHRpb25zLnBhY2tTdHJpbmdzKTtcbiAgICBcInBhY2tOdW1iZXJzXCIgaW4gb3B0aW9ucyAmJiAocGFja051bWJlcnMgPSBvcHRpb25zLnBhY2tOdW1iZXJzKTtcbiAgICBcInN0cmVhbVZhbHVlc1wiIGluIG9wdGlvbnMgJiYgKHN0cmVhbUtleXMgPSBzdHJlYW1TdHJpbmdzID0gc3RyZWFtTnVtYmVycyA9IG9wdGlvbnMuc3RyZWFtVmFsdWVzKTtcbiAgICBcInN0cmVhbUtleXNcIiBpbiBvcHRpb25zICYmIChzdHJlYW1LZXlzID0gb3B0aW9ucy5zdHJlYW1LZXlzKTtcbiAgICBcInN0cmVhbVN0cmluZ3NcIiBpbiBvcHRpb25zICYmIChzdHJlYW1TdHJpbmdzID0gb3B0aW9ucy5zdHJlYW1TdHJpbmdzKTtcbiAgICBcInN0cmVhbU51bWJlcnNcIiBpbiBvcHRpb25zICYmIChzdHJlYW1OdW1iZXJzID0gb3B0aW9ucy5zdHJlYW1OdW1iZXJzKTtcbiAgICBqc29uU3RyZWFtaW5nID0gb3B0aW9ucy5qc29uU3RyZWFtaW5nO1xuICB9XG5cbiAgIXBhY2tLZXlzICYmIChzdHJlYW1LZXlzID0gdHJ1ZSk7XG4gICFwYWNrU3RyaW5ncyAmJiAoc3RyZWFtU3RyaW5ncyA9IHRydWUpO1xuICAhcGFja051bWJlcnMgJiYgKHN0cmVhbU51bWJlcnMgPSB0cnVlKTtcblxuICBsZXQgZG9uZSA9IGZhbHNlLFxuICAgIGV4cGVjdCA9IGpzb25TdHJlYW1pbmcgPyBcImRvbmVcIiA6IFwidmFsdWVcIixcbiAgICBwYXJlbnQgPSBcIlwiLFxuICAgIG9wZW5OdW1iZXIgPSBmYWxzZSxcbiAgICBhY2N1bXVsYXRvciA9IFwiXCIsXG4gICAgYnVmZmVyID0gXCJcIjtcblxuICBjb25zdCBzdGFjazogYW55W10gPSBbXTtcblxuICByZXR1cm4gZmx1c2hhYmxlKChidWY6IGFueSkgPT4ge1xuICAgIGNvbnN0IHRva2VuczogYW55W10gPSBbXTtcblxuICAgIGlmIChidWYgPT09IG5vbmUpIHtcbiAgICAgIGRvbmUgPSB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICBidWZmZXIgKz0gYnVmO1xuICAgIH1cblxuICAgIGxldCBtYXRjaDogYW55O1xuICAgIGxldCB2YWx1ZTogYW55O1xuICAgIGxldCBpbmRleCA9IDA7XG5cbiAgICBtYWluOiBmb3IgKDs7KSB7XG4gICAgICBzd2l0Y2ggKGV4cGVjdCkge1xuICAgICAgICBjYXNlIFwidmFsdWUxXCI6XG4gICAgICAgIGNhc2UgXCJ2YWx1ZVwiOlxuICAgICAgICAgIHBhdHRlcm5zLnZhbHVlMS5sYXN0SW5kZXggPSBpbmRleDtcbiAgICAgICAgICBtYXRjaCA9IHBhdHRlcm5zLnZhbHVlMS5leGVjKGJ1ZmZlcik7XG4gICAgICAgICAgaWYgKCFtYXRjaCkge1xuICAgICAgICAgICAgaWYgKGRvbmUgfHwgaW5kZXggKyBNQVhfUEFUVEVSTl9TSVpFIDwgYnVmZmVyLmxlbmd0aCkge1xuICAgICAgICAgICAgICBpZiAoaW5kZXggPCBidWZmZXIubGVuZ3RoKSB0aHJvdyBuZXcgRXJyb3IoXCJQYXJzZXIgY2Fubm90IHBhcnNlIGlucHV0OiBleHBlY3RlZCBhIHZhbHVlXCIpO1xuICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJQYXJzZXIgaGFzIGV4cGVjdGVkIGEgdmFsdWVcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBicmVhayBtYWluOyAvLyB3YWl0IGZvciBtb3JlIGlucHV0XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhbHVlID0gbWF0Y2hbMF07XG4gICAgICAgICAgc3dpdGNoICh2YWx1ZSkge1xuICAgICAgICAgICAgY2FzZSAnXCInOlxuICAgICAgICAgICAgICBpZiAoc3RyZWFtU3RyaW5ncykgdG9rZW5zLnB1c2goeyBuYW1lOiBcInN0YXJ0U3RyaW5nXCIgfSk7XG4gICAgICAgICAgICAgIGV4cGVjdCA9IFwic3RyaW5nXCI7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcIntcIjpcbiAgICAgICAgICAgICAgdG9rZW5zLnB1c2goeyBuYW1lOiBcInN0YXJ0T2JqZWN0XCIgfSk7XG4gICAgICAgICAgICAgIHN0YWNrLnB1c2gocGFyZW50KTtcbiAgICAgICAgICAgICAgcGFyZW50ID0gXCJvYmplY3RcIjtcbiAgICAgICAgICAgICAgZXhwZWN0ID0gXCJrZXkxXCI7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcIltcIjpcbiAgICAgICAgICAgICAgdG9rZW5zLnB1c2goeyBuYW1lOiBcInN0YXJ0QXJyYXlcIiB9KTtcbiAgICAgICAgICAgICAgc3RhY2sucHVzaChwYXJlbnQpO1xuICAgICAgICAgICAgICBwYXJlbnQgPSBcImFycmF5XCI7XG4gICAgICAgICAgICAgIGV4cGVjdCA9IFwidmFsdWUxXCI7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcIl1cIjpcbiAgICAgICAgICAgICAgaWYgKGV4cGVjdCAhPT0gXCJ2YWx1ZTFcIikgdGhyb3cgbmV3IEVycm9yKFwiUGFyc2VyIGNhbm5vdCBwYXJzZSBpbnB1dDogdW5leHBlY3RlZCB0b2tlbiAnXSdcIik7XG4gICAgICAgICAgICAgIGlmIChvcGVuTnVtYmVyKSB7XG4gICAgICAgICAgICAgICAgaWYgKHN0cmVhbU51bWJlcnMpIHRva2Vucy5wdXNoKHsgbmFtZTogXCJlbmROdW1iZXJcIiB9KTtcbiAgICAgICAgICAgICAgICBvcGVuTnVtYmVyID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgaWYgKHBhY2tOdW1iZXJzKSB7XG4gICAgICAgICAgICAgICAgICB0b2tlbnMucHVzaCh7IG5hbWU6IFwibnVtYmVyVmFsdWVcIiwgdmFsdWU6IGFjY3VtdWxhdG9yIH0pO1xuICAgICAgICAgICAgICAgICAgYWNjdW11bGF0b3IgPSBcIlwiO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB0b2tlbnMucHVzaCh7IG5hbWU6IFwiZW5kQXJyYXlcIiB9KTtcbiAgICAgICAgICAgICAgcGFyZW50ID0gc3RhY2sucG9wKCk7XG4gICAgICAgICAgICAgIGV4cGVjdCA9IGV4cGVjdGVkW3BhcmVudF07XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcIi1cIjpcbiAgICAgICAgICAgICAgb3Blbk51bWJlciA9IHRydWU7XG4gICAgICAgICAgICAgIGlmIChzdHJlYW1OdW1iZXJzKSB7XG4gICAgICAgICAgICAgICAgdG9rZW5zLnB1c2goeyBuYW1lOiBcInN0YXJ0TnVtYmVyXCIgfSwgeyBuYW1lOiBcIm51bWJlckNodW5rXCIsIHZhbHVlOiBcIi1cIiB9KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBwYWNrTnVtYmVycyAmJiAoYWNjdW11bGF0b3IgPSBcIi1cIik7XG4gICAgICAgICAgICAgIGV4cGVjdCA9IFwibnVtYmVyU3RhcnRcIjtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiMFwiOlxuICAgICAgICAgICAgICBvcGVuTnVtYmVyID0gdHJ1ZTtcbiAgICAgICAgICAgICAgaWYgKHN0cmVhbU51bWJlcnMpIHtcbiAgICAgICAgICAgICAgICB0b2tlbnMucHVzaCh7IG5hbWU6IFwic3RhcnROdW1iZXJcIiB9LCB7IG5hbWU6IFwibnVtYmVyQ2h1bmtcIiwgdmFsdWU6IFwiMFwiIH0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIHBhY2tOdW1iZXJzICYmIChhY2N1bXVsYXRvciA9IFwiMFwiKTtcbiAgICAgICAgICAgICAgZXhwZWN0ID0gXCJudW1iZXJGcmFjdGlvblwiO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCIxXCI6XG4gICAgICAgICAgICBjYXNlIFwiMlwiOlxuICAgICAgICAgICAgY2FzZSBcIjNcIjpcbiAgICAgICAgICAgIGNhc2UgXCI0XCI6XG4gICAgICAgICAgICBjYXNlIFwiNVwiOlxuICAgICAgICAgICAgY2FzZSBcIjZcIjpcbiAgICAgICAgICAgIGNhc2UgXCI3XCI6XG4gICAgICAgICAgICBjYXNlIFwiOFwiOlxuICAgICAgICAgICAgY2FzZSBcIjlcIjpcbiAgICAgICAgICAgICAgb3Blbk51bWJlciA9IHRydWU7XG4gICAgICAgICAgICAgIGlmIChzdHJlYW1OdW1iZXJzKSB7XG4gICAgICAgICAgICAgICAgdG9rZW5zLnB1c2goeyBuYW1lOiBcInN0YXJ0TnVtYmVyXCIgfSwgeyBuYW1lOiBcIm51bWJlckNodW5rXCIsIHZhbHVlOiB2YWx1ZSB9KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBwYWNrTnVtYmVycyAmJiAoYWNjdW11bGF0b3IgPSB2YWx1ZSk7XG4gICAgICAgICAgICAgIGV4cGVjdCA9IFwibnVtYmVyRGlnaXRcIjtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwidHJ1ZVwiOlxuICAgICAgICAgICAgY2FzZSBcImZhbHNlXCI6XG4gICAgICAgICAgICBjYXNlIFwibnVsbFwiOlxuICAgICAgICAgICAgICBpZiAoYnVmZmVyLmxlbmd0aCAtIGluZGV4ID09PSB2YWx1ZS5sZW5ndGggJiYgIWRvbmUpIGJyZWFrIG1haW47IC8vIHdhaXQgZm9yIG1vcmUgaW5wdXRcbiAgICAgICAgICAgICAgdG9rZW5zLnB1c2goeyBuYW1lOiB2YWx1ZSArIFwiVmFsdWVcIiwgdmFsdWU6IHZhbHVlc1t2YWx1ZV0gfSk7XG4gICAgICAgICAgICAgIGV4cGVjdCA9IGV4cGVjdGVkW3BhcmVudF07XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgLy8gZGVmYXVsdDogLy8gd3NcbiAgICAgICAgICB9XG4gICAgICAgICAgaW5kZXggKz0gdmFsdWUubGVuZ3RoO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIFwia2V5VmFsXCI6XG4gICAgICAgIGNhc2UgXCJzdHJpbmdcIjpcbiAgICAgICAgICBwYXR0ZXJucy5zdHJpbmcubGFzdEluZGV4ID0gaW5kZXg7XG4gICAgICAgICAgbWF0Y2ggPSBwYXR0ZXJucy5zdHJpbmcuZXhlYyhidWZmZXIpO1xuICAgICAgICAgIGlmICghbWF0Y2gpIHtcbiAgICAgICAgICAgIGlmIChpbmRleCA8IGJ1ZmZlci5sZW5ndGggJiYgKGRvbmUgfHwgYnVmZmVyLmxlbmd0aCAtIGluZGV4ID49IDYpKVxuICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJQYXJzZXIgY2Fubm90IHBhcnNlIGlucHV0OiBlc2NhcGVkIGNoYXJhY3RlcnNcIik7XG4gICAgICAgICAgICBpZiAoZG9uZSkgdGhyb3cgbmV3IEVycm9yKFwiUGFyc2VyIGhhcyBleHBlY3RlZCBhIHN0cmluZyB2YWx1ZVwiKTtcbiAgICAgICAgICAgIGJyZWFrIG1haW47IC8vIHdhaXQgZm9yIG1vcmUgaW5wdXRcbiAgICAgICAgICB9XG4gICAgICAgICAgdmFsdWUgPSBtYXRjaFswXTtcbiAgICAgICAgICBpZiAodmFsdWUgPT09ICdcIicpIHtcbiAgICAgICAgICAgIGlmIChleHBlY3QgPT09IFwia2V5VmFsXCIpIHtcbiAgICAgICAgICAgICAgaWYgKHN0cmVhbUtleXMpIHRva2Vucy5wdXNoKHsgbmFtZTogXCJlbmRLZXlcIiB9KTtcbiAgICAgICAgICAgICAgaWYgKHBhY2tLZXlzKSB7XG4gICAgICAgICAgICAgICAgdG9rZW5zLnB1c2goeyBuYW1lOiBcImtleVZhbHVlXCIsIHZhbHVlOiBhY2N1bXVsYXRvciB9KTtcbiAgICAgICAgICAgICAgICBhY2N1bXVsYXRvciA9IFwiXCI7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgZXhwZWN0ID0gXCJjb2xvblwiO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgaWYgKHN0cmVhbVN0cmluZ3MpIHRva2Vucy5wdXNoKHsgbmFtZTogXCJlbmRTdHJpbmdcIiB9KTtcbiAgICAgICAgICAgICAgaWYgKHBhY2tTdHJpbmdzKSB7XG4gICAgICAgICAgICAgICAgdG9rZW5zLnB1c2goeyBuYW1lOiBcInN0cmluZ1ZhbHVlXCIsIHZhbHVlOiBhY2N1bXVsYXRvciB9KTtcbiAgICAgICAgICAgICAgICBhY2N1bXVsYXRvciA9IFwiXCI7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgZXhwZWN0ID0gZXhwZWN0ZWRbcGFyZW50XTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGVsc2UgaWYgKHZhbHVlLmxlbmd0aCA+IDEgJiYgdmFsdWUuY2hhckF0KDApID09PSBcIlxcXFxcIikge1xuICAgICAgICAgICAgY29uc3QgdCA9IHZhbHVlLmxlbmd0aCA9PSAyID8gY29kZXNbdmFsdWUuY2hhckF0KDEpXSA6IGZyb21IZXgodmFsdWUpO1xuICAgICAgICAgICAgaWYgKGV4cGVjdCA9PT0gXCJrZXlWYWxcIiA/IHN0cmVhbUtleXMgOiBzdHJlYW1TdHJpbmdzKSB7XG4gICAgICAgICAgICAgIHRva2Vucy5wdXNoKHsgbmFtZTogXCJzdHJpbmdDaHVua1wiLCB2YWx1ZTogdCB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChleHBlY3QgPT09IFwia2V5VmFsXCIgPyBwYWNrS2V5cyA6IHBhY2tTdHJpbmdzKSB7XG4gICAgICAgICAgICAgIGFjY3VtdWxhdG9yICs9IHQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmIChleHBlY3QgPT09IFwia2V5VmFsXCIgPyBzdHJlYW1LZXlzIDogc3RyZWFtU3RyaW5ncykge1xuICAgICAgICAgICAgICB0b2tlbnMucHVzaCh7IG5hbWU6IFwic3RyaW5nQ2h1bmtcIiwgdmFsdWU6IHZhbHVlIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGV4cGVjdCA9PT0gXCJrZXlWYWxcIiA/IHBhY2tLZXlzIDogcGFja1N0cmluZ3MpIHtcbiAgICAgICAgICAgICAgYWNjdW11bGF0b3IgKz0gdmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGluZGV4ICs9IHZhbHVlLmxlbmd0aDtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBcImtleTFcIjpcbiAgICAgICAgY2FzZSBcImtleVwiOlxuICAgICAgICAgIHBhdHRlcm5zLmtleTEubGFzdEluZGV4ID0gaW5kZXg7XG4gICAgICAgICAgbWF0Y2ggPSBwYXR0ZXJucy5rZXkxLmV4ZWMoYnVmZmVyKTtcbiAgICAgICAgICBpZiAoIW1hdGNoKSB7XG4gICAgICAgICAgICBpZiAoaW5kZXggPCBidWZmZXIubGVuZ3RoIHx8IGRvbmUpIHRocm93IG5ldyBFcnJvcihcIlBhcnNlciBjYW5ub3QgcGFyc2UgaW5wdXQ6IGV4cGVjdGVkIGFuIG9iamVjdCBrZXlcIik7XG4gICAgICAgICAgICBicmVhayBtYWluOyAvLyB3YWl0IGZvciBtb3JlIGlucHV0XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhbHVlID0gbWF0Y2hbMF07XG4gICAgICAgICAgaWYgKHZhbHVlID09PSAnXCInKSB7XG4gICAgICAgICAgICBpZiAoc3RyZWFtS2V5cykgdG9rZW5zLnB1c2goeyBuYW1lOiBcInN0YXJ0S2V5XCIgfSk7XG4gICAgICAgICAgICBleHBlY3QgPSBcImtleVZhbFwiO1xuICAgICAgICAgIH0gZWxzZSBpZiAodmFsdWUgPT09IFwifVwiKSB7XG4gICAgICAgICAgICBpZiAoZXhwZWN0ICE9PSBcImtleTFcIikgdGhyb3cgbmV3IEVycm9yKFwiUGFyc2VyIGNhbm5vdCBwYXJzZSBpbnB1dDogdW5leHBlY3RlZCB0b2tlbiAnfSdcIik7XG4gICAgICAgICAgICB0b2tlbnMucHVzaCh7IG5hbWU6IFwiZW5kT2JqZWN0XCIgfSk7XG4gICAgICAgICAgICBwYXJlbnQgPSBzdGFjay5wb3AoKTtcbiAgICAgICAgICAgIGV4cGVjdCA9IGV4cGVjdGVkW3BhcmVudF07XG4gICAgICAgICAgfVxuICAgICAgICAgIGluZGV4ICs9IHZhbHVlLmxlbmd0aDtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBcImNvbG9uXCI6XG4gICAgICAgICAgcGF0dGVybnMuY29sb24ubGFzdEluZGV4ID0gaW5kZXg7XG4gICAgICAgICAgbWF0Y2ggPSBwYXR0ZXJucy5jb2xvbi5leGVjKGJ1ZmZlcik7XG4gICAgICAgICAgaWYgKCFtYXRjaCkge1xuICAgICAgICAgICAgaWYgKGluZGV4IDwgYnVmZmVyLmxlbmd0aCB8fCBkb25lKSB0aHJvdyBuZXcgRXJyb3IoXCJQYXJzZXIgY2Fubm90IHBhcnNlIGlucHV0OiBleHBlY3RlZCAnOidcIik7XG4gICAgICAgICAgICBicmVhayBtYWluOyAvLyB3YWl0IGZvciBtb3JlIGlucHV0XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhbHVlID0gbWF0Y2hbMF07XG4gICAgICAgICAgdmFsdWUgPT09IFwiOlwiICYmIChleHBlY3QgPSBcInZhbHVlXCIpO1xuICAgICAgICAgIGluZGV4ICs9IHZhbHVlLmxlbmd0aDtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBcImFycmF5U3RvcFwiOlxuICAgICAgICBjYXNlIFwib2JqZWN0U3RvcFwiOlxuICAgICAgICAgIHBhdHRlcm5zLmNvbW1hLmxhc3RJbmRleCA9IGluZGV4O1xuICAgICAgICAgIG1hdGNoID0gcGF0dGVybnMuY29tbWEuZXhlYyhidWZmZXIpO1xuICAgICAgICAgIGlmICghbWF0Y2gpIHtcbiAgICAgICAgICAgIGlmIChpbmRleCA8IGJ1ZmZlci5sZW5ndGggfHwgZG9uZSkgdGhyb3cgbmV3IEVycm9yKFwiUGFyc2VyIGNhbm5vdCBwYXJzZSBpbnB1dDogZXhwZWN0ZWQgJywnXCIpO1xuICAgICAgICAgICAgYnJlYWsgbWFpbjsgLy8gd2FpdCBmb3IgbW9yZSBpbnB1dFxuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAob3Blbk51bWJlcikge1xuICAgICAgICAgICAgaWYgKHN0cmVhbU51bWJlcnMpIHRva2Vucy5wdXNoKHsgbmFtZTogXCJlbmROdW1iZXJcIiB9KTtcbiAgICAgICAgICAgIG9wZW5OdW1iZXIgPSBmYWxzZTtcbiAgICAgICAgICAgIGlmIChwYWNrTnVtYmVycykge1xuICAgICAgICAgICAgICB0b2tlbnMucHVzaCh7IG5hbWU6IFwibnVtYmVyVmFsdWVcIiwgdmFsdWU6IGFjY3VtdWxhdG9yIH0pO1xuICAgICAgICAgICAgICBhY2N1bXVsYXRvciA9IFwiXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhbHVlID0gbWF0Y2hbMF07XG4gICAgICAgICAgaWYgKHZhbHVlID09PSBcIixcIikge1xuICAgICAgICAgICAgZXhwZWN0ID0gZXhwZWN0ID09PSBcImFycmF5U3RvcFwiID8gXCJ2YWx1ZVwiIDogXCJrZXlcIjtcbiAgICAgICAgICB9IGVsc2UgaWYgKHZhbHVlID09PSBcIn1cIiB8fCB2YWx1ZSA9PT0gXCJdXCIpIHtcbiAgICAgICAgICAgIGlmICh2YWx1ZSA9PT0gXCJ9XCIgPyBleHBlY3QgPT09IFwiYXJyYXlTdG9wXCIgOiBleHBlY3QgIT09IFwiYXJyYXlTdG9wXCIpIHtcbiAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiUGFyc2VyIGNhbm5vdCBwYXJzZSBpbnB1dDogZXhwZWN0ZWQgJ1wiICsgKGV4cGVjdCA9PT0gXCJhcnJheVN0b3BcIiA/IFwiXVwiIDogXCJ9XCIpICsgXCInXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdG9rZW5zLnB1c2goeyBuYW1lOiB2YWx1ZSA9PT0gXCJ9XCIgPyBcImVuZE9iamVjdFwiIDogXCJlbmRBcnJheVwiIH0pO1xuICAgICAgICAgICAgcGFyZW50ID0gc3RhY2sucG9wKCk7XG4gICAgICAgICAgICBleHBlY3QgPSBleHBlY3RlZFtwYXJlbnRdO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpbmRleCArPSB2YWx1ZS5sZW5ndGg7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIC8vIG51bWJlciBjaHVua3NcbiAgICAgICAgY2FzZSBcIm51bWJlclN0YXJ0XCI6IC8vIFswLTldXG4gICAgICAgICAgcGF0dGVybnMubnVtYmVyU3RhcnQubGFzdEluZGV4ID0gaW5kZXg7XG4gICAgICAgICAgbWF0Y2ggPSBwYXR0ZXJucy5udW1iZXJTdGFydC5leGVjKGJ1ZmZlcik7XG4gICAgICAgICAgaWYgKCFtYXRjaCkge1xuICAgICAgICAgICAgaWYgKGluZGV4IDwgYnVmZmVyLmxlbmd0aCB8fCBkb25lKSB0aHJvdyBuZXcgRXJyb3IoXCJQYXJzZXIgY2Fubm90IHBhcnNlIGlucHV0OiBleHBlY3RlZCBhIHN0YXJ0aW5nIGRpZ2l0XCIpO1xuICAgICAgICAgICAgYnJlYWsgbWFpbjsgLy8gd2FpdCBmb3IgbW9yZSBpbnB1dFxuICAgICAgICAgIH1cbiAgICAgICAgICB2YWx1ZSA9IG1hdGNoWzBdO1xuICAgICAgICAgIGlmIChzdHJlYW1OdW1iZXJzKSB0b2tlbnMucHVzaCh7IG5hbWU6IFwibnVtYmVyQ2h1bmtcIiwgdmFsdWU6IHZhbHVlIH0pO1xuICAgICAgICAgIHBhY2tOdW1iZXJzICYmIChhY2N1bXVsYXRvciArPSB2YWx1ZSk7XG4gICAgICAgICAgZXhwZWN0ID0gdmFsdWUgPT09IFwiMFwiID8gXCJudW1iZXJGcmFjdGlvblwiIDogXCJudW1iZXJEaWdpdFwiO1xuICAgICAgICAgIGluZGV4ICs9IHZhbHVlLmxlbmd0aDtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBcIm51bWJlckRpZ2l0XCI6IC8vIFswLTldKlxuICAgICAgICAgIHBhdHRlcm5zLm51bWJlckRpZ2l0Lmxhc3RJbmRleCA9IGluZGV4O1xuICAgICAgICAgIG1hdGNoID0gcGF0dGVybnMubnVtYmVyRGlnaXQuZXhlYyhidWZmZXIpO1xuICAgICAgICAgIGlmICghbWF0Y2gpIHtcbiAgICAgICAgICAgIGlmIChpbmRleCA8IGJ1ZmZlci5sZW5ndGggfHwgZG9uZSkgdGhyb3cgbmV3IEVycm9yKFwiUGFyc2VyIGNhbm5vdCBwYXJzZSBpbnB1dDogZXhwZWN0ZWQgYSBkaWdpdFwiKTtcbiAgICAgICAgICAgIGJyZWFrIG1haW47IC8vIHdhaXQgZm9yIG1vcmUgaW5wdXRcbiAgICAgICAgICB9XG4gICAgICAgICAgdmFsdWUgPSBtYXRjaFswXTtcbiAgICAgICAgICBpZiAodmFsdWUpIHtcbiAgICAgICAgICAgIGlmIChzdHJlYW1OdW1iZXJzKSB0b2tlbnMucHVzaCh7IG5hbWU6IFwibnVtYmVyQ2h1bmtcIiwgdmFsdWU6IHZhbHVlIH0pO1xuICAgICAgICAgICAgcGFja051bWJlcnMgJiYgKGFjY3VtdWxhdG9yICs9IHZhbHVlKTtcbiAgICAgICAgICAgIGluZGV4ICs9IHZhbHVlLmxlbmd0aDtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWYgKGluZGV4IDwgYnVmZmVyLmxlbmd0aCkge1xuICAgICAgICAgICAgICBleHBlY3QgPSBcIm51bWJlckZyYWN0aW9uXCI7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGRvbmUpIHtcbiAgICAgICAgICAgICAgZXhwZWN0ID0gZXhwZWN0ZWRbcGFyZW50XTtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBicmVhayBtYWluOyAvLyB3YWl0IGZvciBtb3JlIGlucHV0XG4gICAgICAgICAgfVxuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIFwibnVtYmVyRnJhY3Rpb25cIjogLy8gW1xcLmVFXT9cbiAgICAgICAgICBwYXR0ZXJucy5udW1iZXJGcmFjdGlvbi5sYXN0SW5kZXggPSBpbmRleDtcbiAgICAgICAgICBtYXRjaCA9IHBhdHRlcm5zLm51bWJlckZyYWN0aW9uLmV4ZWMoYnVmZmVyKTtcbiAgICAgICAgICBpZiAoIW1hdGNoKSB7XG4gICAgICAgICAgICBpZiAoaW5kZXggPCBidWZmZXIubGVuZ3RoIHx8IGRvbmUpIHtcbiAgICAgICAgICAgICAgZXhwZWN0ID0gZXhwZWN0ZWRbcGFyZW50XTtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBicmVhayBtYWluOyAvLyB3YWl0IGZvciBtb3JlIGlucHV0XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhbHVlID0gbWF0Y2hbMF07XG4gICAgICAgICAgaWYgKHN0cmVhbU51bWJlcnMpIHRva2Vucy5wdXNoKHsgbmFtZTogXCJudW1iZXJDaHVua1wiLCB2YWx1ZTogdmFsdWUgfSk7XG4gICAgICAgICAgcGFja051bWJlcnMgJiYgKGFjY3VtdWxhdG9yICs9IHZhbHVlKTtcbiAgICAgICAgICBleHBlY3QgPSB2YWx1ZSA9PT0gXCIuXCIgPyBcIm51bWJlckZyYWNTdGFydFwiIDogXCJudW1iZXJFeHBTaWduXCI7XG4gICAgICAgICAgaW5kZXggKz0gdmFsdWUubGVuZ3RoO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIFwibnVtYmVyRnJhY1N0YXJ0XCI6IC8vIFswLTldXG4gICAgICAgICAgcGF0dGVybnMubnVtYmVyU3RhcnQubGFzdEluZGV4ID0gaW5kZXg7XG4gICAgICAgICAgbWF0Y2ggPSBwYXR0ZXJucy5udW1iZXJTdGFydC5leGVjKGJ1ZmZlcik7XG4gICAgICAgICAgaWYgKCFtYXRjaCkge1xuICAgICAgICAgICAgaWYgKGluZGV4IDwgYnVmZmVyLmxlbmd0aCB8fCBkb25lKVxuICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJQYXJzZXIgY2Fubm90IHBhcnNlIGlucHV0OiBleHBlY3RlZCBhIGZyYWN0aW9uYWwgcGFydCBvZiBhIG51bWJlclwiKTtcbiAgICAgICAgICAgIGJyZWFrIG1haW47IC8vIHdhaXQgZm9yIG1vcmUgaW5wdXRcbiAgICAgICAgICB9XG4gICAgICAgICAgdmFsdWUgPSBtYXRjaFswXTtcbiAgICAgICAgICBpZiAoc3RyZWFtTnVtYmVycykgdG9rZW5zLnB1c2goeyBuYW1lOiBcIm51bWJlckNodW5rXCIsIHZhbHVlOiB2YWx1ZSB9KTtcbiAgICAgICAgICBwYWNrTnVtYmVycyAmJiAoYWNjdW11bGF0b3IgKz0gdmFsdWUpO1xuICAgICAgICAgIGV4cGVjdCA9IFwibnVtYmVyRnJhY0RpZ2l0XCI7XG4gICAgICAgICAgaW5kZXggKz0gdmFsdWUubGVuZ3RoO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIFwibnVtYmVyRnJhY0RpZ2l0XCI6IC8vIFswLTldKlxuICAgICAgICAgIHBhdHRlcm5zLm51bWJlckRpZ2l0Lmxhc3RJbmRleCA9IGluZGV4O1xuICAgICAgICAgIG1hdGNoID0gcGF0dGVybnMubnVtYmVyRGlnaXQuZXhlYyhidWZmZXIpO1xuICAgICAgICAgIHZhbHVlID0gbWF0Y2hbMF07XG4gICAgICAgICAgaWYgKHZhbHVlKSB7XG4gICAgICAgICAgICBpZiAoc3RyZWFtTnVtYmVycykgdG9rZW5zLnB1c2goeyBuYW1lOiBcIm51bWJlckNodW5rXCIsIHZhbHVlOiB2YWx1ZSB9KTtcbiAgICAgICAgICAgIHBhY2tOdW1iZXJzICYmIChhY2N1bXVsYXRvciArPSB2YWx1ZSk7XG4gICAgICAgICAgICBpbmRleCArPSB2YWx1ZS5sZW5ndGg7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmIChpbmRleCA8IGJ1ZmZlci5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgZXhwZWN0ID0gXCJudW1iZXJFeHBvbmVudFwiO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChkb25lKSB7XG4gICAgICAgICAgICAgIGV4cGVjdCA9IGV4cGVjdGVkW3BhcmVudF07XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYnJlYWsgbWFpbjsgLy8gd2FpdCBmb3IgbW9yZSBpbnB1dFxuICAgICAgICAgIH1cbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBcIm51bWJlckV4cG9uZW50XCI6IC8vIFtlRV0/XG4gICAgICAgICAgcGF0dGVybnMubnVtYmVyRXhwb25lbnQubGFzdEluZGV4ID0gaW5kZXg7XG4gICAgICAgICAgbWF0Y2ggPSBwYXR0ZXJucy5udW1iZXJFeHBvbmVudC5leGVjKGJ1ZmZlcik7XG4gICAgICAgICAgaWYgKCFtYXRjaCkge1xuICAgICAgICAgICAgaWYgKGluZGV4IDwgYnVmZmVyLmxlbmd0aCkge1xuICAgICAgICAgICAgICBleHBlY3QgPSBleHBlY3RlZFtwYXJlbnRdO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChkb25lKSB7XG4gICAgICAgICAgICAgIGV4cGVjdCA9IFwiZG9uZVwiO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGJyZWFrIG1haW47IC8vIHdhaXQgZm9yIG1vcmUgaW5wdXRcbiAgICAgICAgICB9XG4gICAgICAgICAgdmFsdWUgPSBtYXRjaFswXTtcbiAgICAgICAgICBpZiAoc3RyZWFtTnVtYmVycykgdG9rZW5zLnB1c2goeyBuYW1lOiBcIm51bWJlckNodW5rXCIsIHZhbHVlOiB2YWx1ZSB9KTtcbiAgICAgICAgICBwYWNrTnVtYmVycyAmJiAoYWNjdW11bGF0b3IgKz0gdmFsdWUpO1xuICAgICAgICAgIGV4cGVjdCA9IFwibnVtYmVyRXhwU2lnblwiO1xuICAgICAgICAgIGluZGV4ICs9IHZhbHVlLmxlbmd0aDtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBcIm51bWJlckV4cFNpZ25cIjogLy8gWy0rXT9cbiAgICAgICAgICBwYXR0ZXJucy5udW1iZXJFeHBTaWduLmxhc3RJbmRleCA9IGluZGV4O1xuICAgICAgICAgIG1hdGNoID0gcGF0dGVybnMubnVtYmVyRXhwU2lnbi5leGVjKGJ1ZmZlcik7XG4gICAgICAgICAgaWYgKCFtYXRjaCkge1xuICAgICAgICAgICAgaWYgKGluZGV4IDwgYnVmZmVyLmxlbmd0aCkge1xuICAgICAgICAgICAgICBleHBlY3QgPSBcIm51bWJlckV4cFN0YXJ0XCI7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGRvbmUpIHRocm93IG5ldyBFcnJvcihcIlBhcnNlciBoYXMgZXhwZWN0ZWQgYW4gZXhwb25lbnQgdmFsdWUgb2YgYSBudW1iZXJcIik7XG4gICAgICAgICAgICBicmVhayBtYWluOyAvLyB3YWl0IGZvciBtb3JlIGlucHV0XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhbHVlID0gbWF0Y2hbMF07XG4gICAgICAgICAgaWYgKHN0cmVhbU51bWJlcnMpIHRva2Vucy5wdXNoKHsgbmFtZTogXCJudW1iZXJDaHVua1wiLCB2YWx1ZTogdmFsdWUgfSk7XG4gICAgICAgICAgcGFja051bWJlcnMgJiYgKGFjY3VtdWxhdG9yICs9IHZhbHVlKTtcbiAgICAgICAgICBleHBlY3QgPSBcIm51bWJlckV4cFN0YXJ0XCI7XG4gICAgICAgICAgaW5kZXggKz0gdmFsdWUubGVuZ3RoO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIFwibnVtYmVyRXhwU3RhcnRcIjogLy8gWzAtOV1cbiAgICAgICAgICBwYXR0ZXJucy5udW1iZXJTdGFydC5sYXN0SW5kZXggPSBpbmRleDtcbiAgICAgICAgICBtYXRjaCA9IHBhdHRlcm5zLm51bWJlclN0YXJ0LmV4ZWMoYnVmZmVyKTtcbiAgICAgICAgICBpZiAoIW1hdGNoKSB7XG4gICAgICAgICAgICBpZiAoaW5kZXggPCBidWZmZXIubGVuZ3RoIHx8IGRvbmUpXG4gICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlBhcnNlciBjYW5ub3QgcGFyc2UgaW5wdXQ6IGV4cGVjdGVkIGFuIGV4cG9uZW50IHBhcnQgb2YgYSBudW1iZXJcIik7XG4gICAgICAgICAgICBicmVhayBtYWluOyAvLyB3YWl0IGZvciBtb3JlIGlucHV0XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhbHVlID0gbWF0Y2hbMF07XG4gICAgICAgICAgaWYgKHN0cmVhbU51bWJlcnMpIHRva2Vucy5wdXNoKHsgbmFtZTogXCJudW1iZXJDaHVua1wiLCB2YWx1ZTogdmFsdWUgfSk7XG4gICAgICAgICAgcGFja051bWJlcnMgJiYgKGFjY3VtdWxhdG9yICs9IHZhbHVlKTtcbiAgICAgICAgICBleHBlY3QgPSBcIm51bWJlckV4cERpZ2l0XCI7XG4gICAgICAgICAgaW5kZXggKz0gdmFsdWUubGVuZ3RoO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIFwibnVtYmVyRXhwRGlnaXRcIjogLy8gWzAtOV0qXG4gICAgICAgICAgcGF0dGVybnMubnVtYmVyRGlnaXQubGFzdEluZGV4ID0gaW5kZXg7XG4gICAgICAgICAgbWF0Y2ggPSBwYXR0ZXJucy5udW1iZXJEaWdpdC5leGVjKGJ1ZmZlcik7XG4gICAgICAgICAgdmFsdWUgPSBtYXRjaFswXTtcbiAgICAgICAgICBpZiAodmFsdWUpIHtcbiAgICAgICAgICAgIGlmIChzdHJlYW1OdW1iZXJzKSB0b2tlbnMucHVzaCh7IG5hbWU6IFwibnVtYmVyQ2h1bmtcIiwgdmFsdWU6IHZhbHVlIH0pO1xuICAgICAgICAgICAgcGFja051bWJlcnMgJiYgKGFjY3VtdWxhdG9yICs9IHZhbHVlKTtcbiAgICAgICAgICAgIGluZGV4ICs9IHZhbHVlLmxlbmd0aDtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWYgKGluZGV4IDwgYnVmZmVyLmxlbmd0aCB8fCBkb25lKSB7XG4gICAgICAgICAgICAgIGV4cGVjdCA9IGV4cGVjdGVkW3BhcmVudF07XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYnJlYWsgbWFpbjsgLy8gd2FpdCBmb3IgbW9yZSBpbnB1dFxuICAgICAgICAgIH1cbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBcImRvbmVcIjpcbiAgICAgICAgICBwYXR0ZXJucy53cy5sYXN0SW5kZXggPSBpbmRleDtcbiAgICAgICAgICBtYXRjaCA9IHBhdHRlcm5zLndzLmV4ZWMoYnVmZmVyKTtcbiAgICAgICAgICBpZiAoIW1hdGNoKSB7XG4gICAgICAgICAgICBpZiAoaW5kZXggPCBidWZmZXIubGVuZ3RoKSB7XG4gICAgICAgICAgICAgIGlmIChqc29uU3RyZWFtaW5nKSB7XG4gICAgICAgICAgICAgICAgZXhwZWN0ID0gXCJ2YWx1ZVwiO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlBhcnNlciBjYW5ub3QgcGFyc2UgaW5wdXQ6IHVuZXhwZWN0ZWQgY2hhcmFjdGVyc1wiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGJyZWFrIG1haW47IC8vIHdhaXQgZm9yIG1vcmUgaW5wdXRcbiAgICAgICAgICB9XG4gICAgICAgICAgdmFsdWUgPSBtYXRjaFswXTtcbiAgICAgICAgICBpZiAob3Blbk51bWJlcikge1xuICAgICAgICAgICAgaWYgKHN0cmVhbU51bWJlcnMpIHRva2Vucy5wdXNoKHsgbmFtZTogXCJlbmROdW1iZXJcIiB9KTtcbiAgICAgICAgICAgIG9wZW5OdW1iZXIgPSBmYWxzZTtcbiAgICAgICAgICAgIGlmIChwYWNrTnVtYmVycykge1xuICAgICAgICAgICAgICB0b2tlbnMucHVzaCh7IG5hbWU6IFwibnVtYmVyVmFsdWVcIiwgdmFsdWU6IGFjY3VtdWxhdG9yIH0pO1xuICAgICAgICAgICAgICBhY2N1bXVsYXRvciA9IFwiXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGluZGV4ICs9IHZhbHVlLmxlbmd0aDtcbiAgICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKGRvbmUgJiYgb3Blbk51bWJlcikge1xuICAgICAgaWYgKHN0cmVhbU51bWJlcnMpIHRva2Vucy5wdXNoKHsgbmFtZTogXCJlbmROdW1iZXJcIiB9KTtcbiAgICAgIG9wZW5OdW1iZXIgPSBmYWxzZTtcbiAgICAgIGlmIChwYWNrTnVtYmVycykge1xuICAgICAgICB0b2tlbnMucHVzaCh7IG5hbWU6IFwibnVtYmVyVmFsdWVcIiwgdmFsdWU6IGFjY3VtdWxhdG9yIH0pO1xuICAgICAgICBhY2N1bXVsYXRvciA9IFwiXCI7XG4gICAgICB9XG4gICAgfVxuICAgIGJ1ZmZlciA9IGJ1ZmZlci5zbGljZShpbmRleCk7XG4gICAgcmV0dXJuIHRva2Vucy5sZW5ndGggPyBtYW55KHRva2VucykgOiBub25lO1xuICB9KTtcbn07XG5cbmV4cG9ydCBjb25zdCBwYXJzZXIgPSAob3B0aW9ucz86IGFueSkgPT4gZ2VuKGZpeFV0ZjhTdHJlYW0oKSwganNvblBhcnNlcihvcHRpb25zKSk7XG5cbmNvbnN0IHdpdGhQYXJzZXIgPSAoZm46IGFueSwgb3B0aW9ucz86IGFueSkgPT4gZ2VuKHBhcnNlcihvcHRpb25zKSwgZm4ob3B0aW9ucykpO1xuXG5jb25zdCBjaGVja2FibGVUb2tlbnMgPSB7XG4gICAgc3RhcnRPYmplY3Q6IDEsXG4gICAgc3RhcnRBcnJheTogMSxcbiAgICBzdGFydFN0cmluZzogMSxcbiAgICBzdGFydE51bWJlcjogMSxcbiAgICBudWxsVmFsdWU6IDEsXG4gICAgdHJ1ZVZhbHVlOiAxLFxuICAgIGZhbHNlVmFsdWU6IDEsXG4gICAgc3RyaW5nVmFsdWU6IDEsXG4gICAgbnVtYmVyVmFsdWU6IDEsXG4gIH0sXG4gIHN0b3BUb2tlbnMgPSB7XG4gICAgc3RhcnRPYmplY3Q6IFwiZW5kT2JqZWN0XCIsXG4gICAgc3RhcnRBcnJheTogXCJlbmRBcnJheVwiLFxuICAgIHN0YXJ0U3RyaW5nOiBcImVuZFN0cmluZ1wiLFxuICAgIHN0YXJ0TnVtYmVyOiBcImVuZE51bWJlclwiLFxuICB9LFxuICBvcHRpb25hbFRva2VucyA9IHsgZW5kU3RyaW5nOiBcInN0cmluZ1ZhbHVlXCIsIGVuZE51bWJlcjogXCJudW1iZXJWYWx1ZVwiIH07XG5cbmNvbnN0IGRlZmF1bHRGaWx0ZXIgPSAoX3N0YWNrOiBzdHJpbmdbXSwgX2E6IGFueSkgPT4gdHJ1ZTtcblxuY29uc3Qgc3RyaW5nRmlsdGVyID0gKHN0cmluZzogc3RyaW5nLCBzZXBhcmF0b3I6IHN0cmluZykgPT4ge1xuICBjb25zdCBzdHJpbmdXaXRoU2VwYXJhdG9yID0gc3RyaW5nICsgc2VwYXJhdG9yO1xuICByZXR1cm4gKHN0YWNrOiBzdHJpbmdbXSwgX2E6IGFueSkgPT4ge1xuICAgIGNvbnN0IHBhdGggPSBzdGFjay5qb2luKHNlcGFyYXRvcik7XG4gICAgcmV0dXJuIHBhdGggPT09IHN0cmluZyB8fCBwYXRoLnN0YXJ0c1dpdGgoc3RyaW5nV2l0aFNlcGFyYXRvcik7XG4gIH07XG59O1xuXG5jb25zdCByZWdFeHBGaWx0ZXIgPSAocmVnRXhwOiBSZWdFeHAsIHNlcGFyYXRvcjogc3RyaW5nKSA9PiB7XG4gIHJldHVybiAoc3RhY2s6IHN0cmluZ1tdLCBfYTogYW55KSA9PiByZWdFeHAudGVzdChzdGFjay5qb2luKHNlcGFyYXRvcikpO1xufTtcblxuY29uc3QgZmlsdGVyQmFzZSA9XG4gICh7XG4gICAgc3BlY2lhbEFjdGlvbiA9IFwiYWNjZXB0XCIsXG4gICAgZGVmYXVsdEFjdGlvbiA9IFwiaWdub3JlXCIsXG4gICAgbm9uQ2hlY2thYmxlQWN0aW9uID0gXCJwcm9jZXNzLWtleVwiLFxuICAgIHRyYW5zaXRpb24gPSB1bmRlZmluZWQgYXMgYW55LFxuICB9ID0ge30pID0+XG4gIChvcHRpb25zOiBhbnkpID0+IHtcbiAgICBjb25zdCBvbmNlID0gb3B0aW9ucz8ub25jZSxcbiAgICAgIHNlcGFyYXRvciA9IG9wdGlvbnM/LnBhdGhTZXBhcmF0b3IgfHwgXCIuXCI7XG4gICAgbGV0IGZpbHRlciA9IGRlZmF1bHRGaWx0ZXIsXG4gICAgICBzdHJlYW1LZXlzID0gdHJ1ZTtcbiAgICBpZiAob3B0aW9ucykge1xuICAgICAgaWYgKHR5cGVvZiBvcHRpb25zLmZpbHRlciA9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgZmlsdGVyID0gb3B0aW9ucy5maWx0ZXI7XG4gICAgICB9IGVsc2UgaWYgKHR5cGVvZiBvcHRpb25zLmZpbHRlciA9PSBcInN0cmluZ1wiKSB7XG4gICAgICAgIGZpbHRlciA9IHN0cmluZ0ZpbHRlcihvcHRpb25zLmZpbHRlciwgc2VwYXJhdG9yKTtcbiAgICAgIH0gZWxzZSBpZiAob3B0aW9ucy5maWx0ZXIgaW5zdGFuY2VvZiBSZWdFeHApIHtcbiAgICAgICAgZmlsdGVyID0gcmVnRXhwRmlsdGVyKG9wdGlvbnMuZmlsdGVyLCBzZXBhcmF0b3IpO1xuICAgICAgfVxuICAgICAgaWYgKFwic3RyZWFtVmFsdWVzXCIgaW4gb3B0aW9ucykgc3RyZWFtS2V5cyA9IG9wdGlvbnMuc3RyZWFtVmFsdWVzO1xuICAgICAgaWYgKFwic3RyZWFtS2V5c1wiIGluIG9wdGlvbnMpIHN0cmVhbUtleXMgPSBvcHRpb25zLnN0cmVhbUtleXM7XG4gICAgfVxuICAgIGNvbnN0IHNhbml0aXplZE9wdGlvbnMgPSBPYmplY3QuYXNzaWduKHt9LCBvcHRpb25zLCB7IGZpbHRlciwgc3RyZWFtS2V5cywgc2VwYXJhdG9yIH0pO1xuICAgIGxldCBzdGF0ZSA9IFwiY2hlY2tcIjtcbiAgICBjb25zdCBzdGFjazogYW55W10gPSBbXTtcbiAgICBsZXQgZGVwdGggPSAwLFxuICAgICAgcHJldmlvdXNUb2tlbiA9IFwiXCIsXG4gICAgICBlbmRUb2tlbiA9IFwiXCIsXG4gICAgICBvcHRpb25hbFRva2VuID0gXCJcIixcbiAgICAgIHN0YXJ0VHJhbnNpdGlvbiA9IGZhbHNlO1xuICAgIHJldHVybiBmbHVzaGFibGUoKGNodW5rKSA9PiB7XG4gICAgICAvLyB0aGUgZmx1c2hcbiAgICAgIGlmIChjaHVuayA9PT0gbm9uZSkgcmV0dXJuIHRyYW5zaXRpb24gPyB0cmFuc2l0aW9uKFtdLCBudWxsLCBcImZsdXNoXCIsIHNhbml0aXplZE9wdGlvbnMpIDogbm9uZTtcblxuICAgICAgLy8gcHJvY2VzcyB0aGUgb3B0aW9uYWwgdmFsdWUgdG9rZW4gKHVuZmluaXNoZWQpXG4gICAgICBpZiAob3B0aW9uYWxUb2tlbikge1xuICAgICAgICBpZiAob3B0aW9uYWxUb2tlbiA9PT0gY2h1bmsubmFtZSkge1xuICAgICAgICAgIGxldCByZXR1cm5Ub2tlbiA9IG5vbmU7XG4gICAgICAgICAgc3dpdGNoIChzdGF0ZSkge1xuICAgICAgICAgICAgY2FzZSBcInByb2Nlc3Mta2V5XCI6XG4gICAgICAgICAgICAgIHN0YWNrW3N0YWNrLmxlbmd0aCAtIDFdID0gY2h1bmsudmFsdWU7XG4gICAgICAgICAgICAgIHN0YXRlID0gXCJjaGVja1wiO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJhY2NlcHQtdmFsdWVcIjpcbiAgICAgICAgICAgICAgcmV0dXJuVG9rZW4gPSBjaHVuaztcbiAgICAgICAgICAgICAgc3RhdGUgPSBvbmNlID8gXCJwYXNzXCIgOiBcImNoZWNrXCI7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgc3RhdGUgPSBvbmNlID8gXCJhbGxcIiA6IFwiY2hlY2tcIjtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG9wdGlvbmFsVG9rZW4gPSBcIlwiO1xuICAgICAgICAgIHJldHVybiByZXR1cm5Ub2tlbjtcbiAgICAgICAgfVxuICAgICAgICBvcHRpb25hbFRva2VuID0gXCJcIjtcbiAgICAgICAgc3RhdGUgPSBvbmNlICYmIHN0YXRlICE9PSBcInByb2Nlc3Mta2V5XCIgPyBcInBhc3NcIiA6IFwiY2hlY2tcIjtcbiAgICAgIH1cblxuICAgICAgbGV0IHJldHVyblRva2VuOiBhbnkgPSBub25lO1xuXG4gICAgICByZWNoZWNrOiBmb3IgKDs7KSB7XG4gICAgICAgIC8vIGFjY2VwdC9yZWplY3QgdG9rZW5zXG4gICAgICAgIHN3aXRjaCAoc3RhdGUpIHtcbiAgICAgICAgICBjYXNlIFwicHJvY2Vzcy1rZXlcIjpcbiAgICAgICAgICAgIGlmIChjaHVuay5uYW1lID09PSBcImVuZEtleVwiKSBvcHRpb25hbFRva2VuID0gXCJrZXlWYWx1ZVwiO1xuICAgICAgICAgICAgcmV0dXJuIG5vbmU7XG4gICAgICAgICAgY2FzZSBcInBhc3NcIjpcbiAgICAgICAgICAgIHJldHVybiBub25lO1xuICAgICAgICAgIGNhc2UgXCJhbGxcIjpcbiAgICAgICAgICAgIHJldHVybiBjaHVuaztcbiAgICAgICAgICBjYXNlIFwiYWNjZXB0XCI6XG4gICAgICAgICAgY2FzZSBcInJlamVjdFwiOlxuICAgICAgICAgICAgaWYgKHN0YXJ0VHJhbnNpdGlvbikge1xuICAgICAgICAgICAgICBzdGFydFRyYW5zaXRpb24gPSBmYWxzZTtcbiAgICAgICAgICAgICAgcmV0dXJuVG9rZW4gPSB0cmFuc2l0aW9uKHN0YWNrLCBjaHVuaywgc3RhdGUsIHNhbml0aXplZE9wdGlvbnMpIHx8IG5vbmU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzd2l0Y2ggKGNodW5rLm5hbWUpIHtcbiAgICAgICAgICAgICAgY2FzZSBcInN0YXJ0T2JqZWN0XCI6XG4gICAgICAgICAgICAgIGNhc2UgXCJzdGFydEFycmF5XCI6XG4gICAgICAgICAgICAgICAgKytkZXB0aDtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgY2FzZSBcImVuZE9iamVjdFwiOlxuICAgICAgICAgICAgICBjYXNlIFwiZW5kQXJyYXlcIjpcbiAgICAgICAgICAgICAgICAtLWRlcHRoO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHN0YXRlID09PSBcImFjY2VwdFwiKSB7XG4gICAgICAgICAgICAgIHJldHVyblRva2VuID0gY29tYmluZU1hbnlNdXQocmV0dXJuVG9rZW4sIGNodW5rKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghZGVwdGgpIHtcbiAgICAgICAgICAgICAgaWYgKG9uY2UpIHtcbiAgICAgICAgICAgICAgICBzdGF0ZSA9IHN0YXRlID09PSBcImFjY2VwdFwiID8gXCJwYXNzXCIgOiBcImFsbFwiO1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHN0YXRlID0gXCJjaGVja1wiO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmV0dXJuVG9rZW47XG4gICAgICAgICAgY2FzZSBcImFjY2VwdC12YWx1ZVwiOlxuICAgICAgICAgIGNhc2UgXCJyZWplY3QtdmFsdWVcIjpcbiAgICAgICAgICAgIGlmIChzdGFydFRyYW5zaXRpb24pIHtcbiAgICAgICAgICAgICAgc3RhcnRUcmFuc2l0aW9uID0gZmFsc2U7XG4gICAgICAgICAgICAgIHJldHVyblRva2VuID0gdHJhbnNpdGlvbihzdGFjaywgY2h1bmssIHN0YXRlLCBzYW5pdGl6ZWRPcHRpb25zKSB8fCBub25lO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHN0YXRlID09PSBcImFjY2VwdC12YWx1ZVwiKSB7XG4gICAgICAgICAgICAgIHJldHVyblRva2VuID0gY29tYmluZU1hbnlNdXQocmV0dXJuVG9rZW4sIGNodW5rKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChjaHVuay5uYW1lID09PSBlbmRUb2tlbikge1xuICAgICAgICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgICAgICAgIG9wdGlvbmFsVG9rZW4gPSBvcHRpb25hbFRva2Vuc1tlbmRUb2tlbl0gfHwgXCJcIjtcbiAgICAgICAgICAgICAgZW5kVG9rZW4gPSBcIlwiO1xuICAgICAgICAgICAgICBpZiAoIW9wdGlvbmFsVG9rZW4pIHtcbiAgICAgICAgICAgICAgICBpZiAob25jZSkge1xuICAgICAgICAgICAgICAgICAgc3RhdGUgPSBzdGF0ZSA9PT0gXCJhY2NlcHQtdmFsdWVcIiA/IFwicGFzc1wiIDogXCJhbGxcIjtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgc3RhdGUgPSBcImNoZWNrXCI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmV0dXJuVG9rZW47XG4gICAgICAgIH1cblxuICAgICAgICAvLyB1cGRhdGUgdGhlIGxhc3QgaW5kZXggaW4gdGhlIHN0YWNrXG4gICAgICAgIGlmICh0eXBlb2Ygc3RhY2tbc3RhY2subGVuZ3RoIC0gMV0gPT0gXCJudW1iZXJcIikge1xuICAgICAgICAgIC8vIGFycmF5XG4gICAgICAgICAgc3dpdGNoIChjaHVuay5uYW1lKSB7XG4gICAgICAgICAgICBjYXNlIFwic3RhcnRPYmplY3RcIjpcbiAgICAgICAgICAgIGNhc2UgXCJzdGFydEFycmF5XCI6XG4gICAgICAgICAgICBjYXNlIFwic3RhcnRTdHJpbmdcIjpcbiAgICAgICAgICAgIGNhc2UgXCJzdGFydE51bWJlclwiOlxuICAgICAgICAgICAgY2FzZSBcIm51bGxWYWx1ZVwiOlxuICAgICAgICAgICAgY2FzZSBcInRydWVWYWx1ZVwiOlxuICAgICAgICAgICAgY2FzZSBcImZhbHNlVmFsdWVcIjpcbiAgICAgICAgICAgICAgKytzdGFja1tzdGFjay5sZW5ndGggLSAxXTtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwibnVtYmVyVmFsdWVcIjpcbiAgICAgICAgICAgICAgaWYgKHByZXZpb3VzVG9rZW4gIT09IFwiZW5kTnVtYmVyXCIpICsrc3RhY2tbc3RhY2subGVuZ3RoIC0gMV07XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcInN0cmluZ1ZhbHVlXCI6XG4gICAgICAgICAgICAgIGlmIChwcmV2aW91c1Rva2VuICE9PSBcImVuZFN0cmluZ1wiKSArK3N0YWNrW3N0YWNrLmxlbmd0aCAtIDFdO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaWYgKGNodW5rLm5hbWUgPT09IFwia2V5VmFsdWVcIikgc3RhY2tbc3RhY2subGVuZ3RoIC0gMV0gPSBjaHVuay52YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBwcmV2aW91c1Rva2VuID0gY2h1bmsubmFtZTtcblxuICAgICAgICAvLyBjaGVjayB0aGUgdG9rZW5cbiAgICAgICAgY29uc3QgYWN0aW9uID1cbiAgICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgICAgY2hlY2thYmxlVG9rZW5zW2NodW5rLm5hbWVdICE9PSAxID8gbm9uQ2hlY2thYmxlQWN0aW9uIDogZmlsdGVyKHN0YWNrLCBjaHVuaykgPyBzcGVjaWFsQWN0aW9uIDogZGVmYXVsdEFjdGlvbjtcblxuICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgIGVuZFRva2VuID0gc3RvcFRva2Vuc1tjaHVuay5uYW1lXSB8fCBcIlwiO1xuICAgICAgICBzd2l0Y2ggKGFjdGlvbikge1xuICAgICAgICAgIGNhc2UgXCJwcm9jZXNzLWtleVwiOlxuICAgICAgICAgICAgaWYgKGNodW5rLm5hbWUgPT09IFwic3RhcnRLZXlcIikge1xuICAgICAgICAgICAgICBzdGF0ZSA9IFwicHJvY2Vzcy1rZXlcIjtcbiAgICAgICAgICAgICAgY29udGludWUgcmVjaGVjaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGNhc2UgXCJhY2NlcHQtdG9rZW5cIjpcbiAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICAgIGlmIChlbmRUb2tlbiAmJiBvcHRpb25hbFRva2Vuc1tlbmRUb2tlbl0pIHtcbiAgICAgICAgICAgICAgc3RhdGUgPSBcImFjY2VwdC12YWx1ZVwiO1xuICAgICAgICAgICAgICBzdGFydFRyYW5zaXRpb24gPSAhIXRyYW5zaXRpb247XG4gICAgICAgICAgICAgIGNvbnRpbnVlIHJlY2hlY2s7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodHJhbnNpdGlvbikgcmV0dXJuVG9rZW4gPSB0cmFuc2l0aW9uKHN0YWNrLCBjaHVuaywgYWN0aW9uLCBzYW5pdGl6ZWRPcHRpb25zKTtcbiAgICAgICAgICAgIHJldHVyblRva2VuID0gY29tYmluZU1hbnlNdXQocmV0dXJuVG9rZW4sIGNodW5rKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGNhc2UgXCJhY2NlcHRcIjpcbiAgICAgICAgICAgIGlmIChlbmRUb2tlbikge1xuICAgICAgICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgICAgICAgIHN0YXRlID0gb3B0aW9uYWxUb2tlbnNbZW5kVG9rZW5dID8gXCJhY2NlcHQtdmFsdWVcIiA6IFwiYWNjZXB0XCI7XG4gICAgICAgICAgICAgIHN0YXJ0VHJhbnNpdGlvbiA9ICEhdHJhbnNpdGlvbjtcbiAgICAgICAgICAgICAgY29udGludWUgcmVjaGVjaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0cmFuc2l0aW9uKSByZXR1cm5Ub2tlbiA9IHRyYW5zaXRpb24oc3RhY2ssIGNodW5rLCBhY3Rpb24sIHNhbml0aXplZE9wdGlvbnMpO1xuICAgICAgICAgICAgcmV0dXJuVG9rZW4gPSBjb21iaW5lTWFueU11dChyZXR1cm5Ub2tlbiwgY2h1bmspO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgY2FzZSBcInJlamVjdFwiOlxuICAgICAgICAgICAgaWYgKGVuZFRva2VuKSB7XG4gICAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICAgICAgc3RhdGUgPSBvcHRpb25hbFRva2Vuc1tlbmRUb2tlbl0gPyBcInJlamVjdC12YWx1ZVwiIDogXCJyZWplY3RcIjtcbiAgICAgICAgICAgICAgc3RhcnRUcmFuc2l0aW9uID0gISF0cmFuc2l0aW9uO1xuICAgICAgICAgICAgICBjb250aW51ZSByZWNoZWNrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRyYW5zaXRpb24pIHJldHVyblRva2VuID0gdHJhbnNpdGlvbihzdGFjaywgY2h1bmssIGFjdGlvbiwgc2FuaXRpemVkT3B0aW9ucyk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlIFwicGFzc1wiOlxuICAgICAgICAgICAgc3RhdGUgPSBcInBhc3NcIjtcbiAgICAgICAgICAgIGNvbnRpbnVlIHJlY2hlY2s7XG4gICAgICAgIH1cblxuICAgICAgICBicmVhaztcbiAgICAgIH1cblxuICAgICAgLy8gdXBkYXRlIHRoZSBzdGFja1xuICAgICAgc3dpdGNoIChjaHVuay5uYW1lKSB7XG4gICAgICAgIGNhc2UgXCJzdGFydE9iamVjdFwiOlxuICAgICAgICAgIHN0YWNrLnB1c2gobnVsbCk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgXCJzdGFydEFycmF5XCI6XG4gICAgICAgICAgc3RhY2sucHVzaCgtMSk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgXCJlbmRPYmplY3RcIjpcbiAgICAgICAgY2FzZSBcImVuZEFycmF5XCI6XG4gICAgICAgICAgc3RhY2sucG9wKCk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiByZXR1cm5Ub2tlbjtcbiAgICB9KTtcbiAgfTtcblxuZXhwb3J0IGNvbnN0IFBpY2tQYXJzZXIgPSAob3B0aW9ucz86IGFueSkgPT4gd2l0aFBhcnNlcihmaWx0ZXJCYXNlKCksIE9iamVjdC5hc3NpZ24oeyBwYWNrS2V5czogdHJ1ZSB9LCBvcHRpb25zKSk7XG5cbmNsYXNzIENvdW50ZXIge1xuICBkZXB0aDogbnVtYmVyO1xuICBjb25zdHJ1Y3Rvcihpbml0aWFsRGVwdGg6IG51bWJlcikge1xuICAgIHRoaXMuZGVwdGggPSBpbml0aWFsRGVwdGg7XG4gIH1cbiAgc3RhcnRPYmplY3QoKSB7XG4gICAgKyt0aGlzLmRlcHRoO1xuICB9XG4gIGVuZE9iamVjdCgpIHtcbiAgICAtLXRoaXMuZGVwdGg7XG4gIH1cbiAgc3RhcnRBcnJheSgpIHtcbiAgICArK3RoaXMuZGVwdGg7XG4gIH1cbiAgZW5kQXJyYXkoKSB7XG4gICAgLS10aGlzLmRlcHRoO1xuICB9XG59XG5cbmNsYXNzIEFzc2VtYmxlciBleHRlbmRzIEV2ZW50RW1pdHRlciB7XG4gIHN0YXRpYyBjb25uZWN0VG8oc3RyZWFtOiBhbnksIG9wdGlvbnM6IGFueSkge1xuICAgIHJldHVybiBuZXcgQXNzZW1ibGVyKG9wdGlvbnMpLmNvbm5lY3RUbyhzdHJlYW0pO1xuICB9XG5cbiAgc3RhY2s6IGFueTtcbiAgY3VycmVudDogYW55O1xuICBrZXk6IGFueTtcbiAgZG9uZTogYm9vbGVhbjtcbiAgcmV2aXZlcjogYW55O1xuICAvLyBAdHMtaWdub3JlXG4gIHN0cmluZ1ZhbHVlOiAodmFsdWU6IHN0cmluZykgPT4gdm9pZDtcbiAgdGFwQ2hhaW46IChjaHVuazogYW55KSA9PiBhbnk7XG5cbiAgY29uc3RydWN0b3Iob3B0aW9uczogYW55KSB7XG4gICAgc3VwZXIoKTtcbiAgICB0aGlzLnN0YWNrID0gW107XG4gICAgdGhpcy5jdXJyZW50ID0gdGhpcy5rZXkgPSBudWxsO1xuICAgIHRoaXMuZG9uZSA9IHRydWU7XG4gICAgaWYgKG9wdGlvbnMpIHtcbiAgICAgIHRoaXMucmV2aXZlciA9IHR5cGVvZiBvcHRpb25zLnJldml2ZXIgPT0gXCJmdW5jdGlvblwiICYmIG9wdGlvbnMucmV2aXZlcjtcbiAgICAgIGlmICh0aGlzLnJldml2ZXIpIHtcbiAgICAgICAgdGhpcy5zdHJpbmdWYWx1ZSA9IHRoaXMuX3NhdmVWYWx1ZSA9IHRoaXMuX3NhdmVWYWx1ZVdpdGhSZXZpdmVyO1xuICAgICAgfVxuICAgICAgaWYgKG9wdGlvbnMubnVtYmVyQXNTdHJpbmcpIHtcbiAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICB0aGlzLm51bWJlclZhbHVlID0gdGhpcy5zdHJpbmdWYWx1ZTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICB0aGlzLnRhcENoYWluID0gKGNodW5rKSA9PiB7XG4gICAgICAvLyBAdHMtaWdub3JlXG4gICAgICBpZiAodGhpc1tjaHVuay5uYW1lXSkge1xuICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgIHRoaXNbY2h1bmsubmFtZV0oY2h1bmsudmFsdWUpO1xuICAgICAgICBpZiAodGhpcy5kb25lKSByZXR1cm4gdGhpcy5jdXJyZW50O1xuICAgICAgfVxuICAgICAgcmV0dXJuIG5vbmU7XG4gICAgfTtcblxuICAgIHRoaXMuc3RyaW5nVmFsdWUgPSB0aGlzLl9zYXZlVmFsdWU7XG4gIH1cblxuICBjb25uZWN0VG8oc3RyZWFtOiBhbnkpIHtcbiAgICBzdHJlYW0ub24oXCJkYXRhXCIsIChjaHVuazogYW55KSA9PiB7XG4gICAgICAvLyBAdHMtaWdub3JlXG4gICAgICBpZiAodGhpc1tjaHVuay5uYW1lXSkge1xuICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgIHRoaXNbY2h1bmsubmFtZV0oY2h1bmsudmFsdWUpO1xuICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgIGlmICh0aGlzLmRvbmUpIHRoaXMuZW1pdChcImRvbmVcIiwgdGhpcyk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICBnZXQgZGVwdGgoKSB7XG4gICAgcmV0dXJuICh0aGlzLnN0YWNrLmxlbmd0aCA+PiAxKSArICh0aGlzLmRvbmUgPyAwIDogMSk7XG4gIH1cblxuICBnZXQgcGF0aCgpIHtcbiAgICBjb25zdCBwYXRoOiBhbnlbXSA9IFtdO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5zdGFjay5sZW5ndGg7IGkgKz0gMikge1xuICAgICAgY29uc3Qga2V5ID0gdGhpcy5zdGFja1tpICsgMV07XG4gICAgICBwYXRoLnB1c2goa2V5ID09PSBudWxsID8gdGhpcy5zdGFja1tpXS5sZW5ndGggOiBrZXkpO1xuICAgIH1cbiAgICByZXR1cm4gcGF0aDtcbiAgfVxuXG4gIGRyb3BUb0xldmVsKGxldmVsOiBhbnkpIHtcbiAgICBpZiAobGV2ZWwgPCB0aGlzLmRlcHRoKSB7XG4gICAgICBpZiAobGV2ZWwgPiAwKSB7XG4gICAgICAgIGNvbnN0IGluZGV4ID0gKGxldmVsIC0gMSkgPDwgMTtcbiAgICAgICAgdGhpcy5jdXJyZW50ID0gdGhpcy5zdGFja1tpbmRleF07XG4gICAgICAgIHRoaXMua2V5ID0gdGhpcy5zdGFja1tpbmRleCArIDFdO1xuICAgICAgICB0aGlzLnN0YWNrLnNwbGljZShpbmRleCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLnN0YWNrID0gW107XG4gICAgICAgIHRoaXMuY3VycmVudCA9IHRoaXMua2V5ID0gbnVsbDtcbiAgICAgICAgdGhpcy5kb25lID0gdHJ1ZTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICBjb25zdW1lKGNodW5rOiBhbnkpIHtcbiAgICAvLyBAdHMtaWdub3JlXG4gICAgdGhpc1tjaHVuay5uYW1lXSAmJiB0aGlzW2NodW5rLm5hbWVdKGNodW5rLnZhbHVlKTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIGtleVZhbHVlKHZhbHVlOiBhbnkpIHtcbiAgICB0aGlzLmtleSA9IHZhbHVlO1xuICB9XG5cbiAgLy9zdHJpbmdWYWx1ZSgpIC0gYWxpYXNlZCBiZWxvdyB0byBfc2F2ZVZhbHVlKClcblxuICBudW1iZXJWYWx1ZSh2YWx1ZTogYW55KSB7XG4gICAgdGhpcy5fc2F2ZVZhbHVlKHBhcnNlRmxvYXQodmFsdWUpKTtcbiAgfVxuICBudWxsVmFsdWUoKSB7XG4gICAgdGhpcy5fc2F2ZVZhbHVlKG51bGwpO1xuICB9XG4gIHRydWVWYWx1ZSgpIHtcbiAgICB0aGlzLl9zYXZlVmFsdWUodHJ1ZSk7XG4gIH1cbiAgZmFsc2VWYWx1ZSgpIHtcbiAgICB0aGlzLl9zYXZlVmFsdWUoZmFsc2UpO1xuICB9XG5cbiAgc3RhcnRPYmplY3QoKSB7XG4gICAgaWYgKHRoaXMuZG9uZSkge1xuICAgICAgdGhpcy5kb25lID0gZmFsc2U7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuc3RhY2sucHVzaCh0aGlzLmN1cnJlbnQsIHRoaXMua2V5KTtcbiAgICB9XG4gICAgdGhpcy5jdXJyZW50ID0gbmV3IE9iamVjdCgpO1xuICAgIHRoaXMua2V5ID0gbnVsbDtcbiAgfVxuXG4gIGVuZE9iamVjdCgpIHtcbiAgICBpZiAodGhpcy5zdGFjay5sZW5ndGgpIHtcbiAgICAgIGNvbnN0IHZhbHVlID0gdGhpcy5jdXJyZW50O1xuICAgICAgdGhpcy5rZXkgPSB0aGlzLnN0YWNrLnBvcCgpO1xuICAgICAgdGhpcy5jdXJyZW50ID0gdGhpcy5zdGFjay5wb3AoKTtcbiAgICAgIHRoaXMuX3NhdmVWYWx1ZSh2YWx1ZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuZG9uZSA9IHRydWU7XG4gICAgfVxuICB9XG5cbiAgc3RhcnRBcnJheSgpIHtcbiAgICBpZiAodGhpcy5kb25lKSB7XG4gICAgICB0aGlzLmRvbmUgPSBmYWxzZTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5zdGFjay5wdXNoKHRoaXMuY3VycmVudCwgdGhpcy5rZXkpO1xuICAgIH1cbiAgICB0aGlzLmN1cnJlbnQgPSBbXTtcbiAgICB0aGlzLmtleSA9IG51bGw7XG4gIH1cblxuICBlbmRBcnJheSgpIHtcbiAgICBpZiAodGhpcy5zdGFjay5sZW5ndGgpIHtcbiAgICAgIGNvbnN0IHZhbHVlID0gdGhpcy5jdXJyZW50O1xuICAgICAgdGhpcy5rZXkgPSB0aGlzLnN0YWNrLnBvcCgpO1xuICAgICAgdGhpcy5jdXJyZW50ID0gdGhpcy5zdGFjay5wb3AoKTtcbiAgICAgIHRoaXMuX3NhdmVWYWx1ZSh2YWx1ZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuZG9uZSA9IHRydWU7XG4gICAgfVxuICB9XG5cbiAgX3NhdmVWYWx1ZSh2YWx1ZTogYW55KSB7XG4gICAgaWYgKHRoaXMuZG9uZSkge1xuICAgICAgdGhpcy5jdXJyZW50ID0gdmFsdWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmICh0aGlzLmN1cnJlbnQgaW5zdGFuY2VvZiBBcnJheSkge1xuICAgICAgICB0aGlzLmN1cnJlbnQucHVzaCh2YWx1ZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLmN1cnJlbnRbdGhpcy5rZXldID0gdmFsdWU7XG4gICAgICAgIHRoaXMua2V5ID0gbnVsbDtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgX3NhdmVWYWx1ZVdpdGhSZXZpdmVyKHZhbHVlOiBhbnkpIHtcbiAgICBpZiAodGhpcy5kb25lKSB7XG4gICAgICB0aGlzLmN1cnJlbnQgPSB0aGlzLnJldml2ZXIoXCJcIiwgdmFsdWUpO1xuICAgIH0gZWxzZSB7XG4gICAgICBpZiAodGhpcy5jdXJyZW50IGluc3RhbmNlb2YgQXJyYXkpIHtcbiAgICAgICAgdmFsdWUgPSB0aGlzLnJldml2ZXIoXCJcIiArIHRoaXMuY3VycmVudC5sZW5ndGgsIHZhbHVlKTtcbiAgICAgICAgdGhpcy5jdXJyZW50LnB1c2godmFsdWUpO1xuICAgICAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgIGRlbGV0ZSB0aGlzLmN1cnJlbnRbdGhpcy5jdXJyZW50Lmxlbmd0aCAtIDFdO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB2YWx1ZSA9IHRoaXMucmV2aXZlcih0aGlzLmtleSwgdmFsdWUpO1xuICAgICAgICBpZiAodmFsdWUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgIHRoaXMuY3VycmVudFt0aGlzLmtleV0gPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmtleSA9IG51bGw7XG4gICAgICB9XG4gICAgfVxuICB9XG59XG5cbmNvbnN0IHN0cmVhbUJhc2UgPVxuICAoeyBwdXNoLCBmaXJzdCwgbGV2ZWwgfTogYW55KSA9PlxuICAob3B0aW9ucyA9IHt9IGFzIGFueSkgPT4ge1xuICAgIGNvbnN0IHsgb2JqZWN0RmlsdGVyLCBpbmNsdWRlVW5kZWNpZGVkIH0gPSBvcHRpb25zO1xuICAgIGxldCBhc20gPSBuZXcgQXNzZW1ibGVyKG9wdGlvbnMpIGFzIGFueSxcbiAgICAgIHN0YXRlID0gZmlyc3QgPyBcImZpcnN0XCIgOiBcImNoZWNrXCIsXG4gICAgICBzYXZlZEFzbSA9IG51bGwgYXMgYW55O1xuXG4gICAgaWYgKHR5cGVvZiBvYmplY3RGaWx0ZXIgIT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAvLyBubyBvYmplY3QgZmlsdGVyICsgbm8gZmlyc3QgY2hlY2tcbiAgICAgIGlmIChzdGF0ZSA9PT0gXCJjaGVja1wiKVxuICAgICAgICByZXR1cm4gKGNodW5rOiBhbnkpID0+IHtcbiAgICAgICAgICBpZiAoYXNtW2NodW5rLm5hbWVdKSB7XG4gICAgICAgICAgICBhc21bY2h1bmsubmFtZV0oY2h1bmsudmFsdWUpO1xuICAgICAgICAgICAgaWYgKGFzbS5kZXB0aCA9PT0gbGV2ZWwpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIHB1c2goYXNtKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIG5vbmU7XG4gICAgICAgIH07XG4gICAgICAvLyBubyBvYmplY3QgZmlsdGVyXG4gICAgICByZXR1cm4gKGNodW5rOiBhbnkpID0+IHtcbiAgICAgICAgc3dpdGNoIChzdGF0ZSkge1xuICAgICAgICAgIGNhc2UgXCJmaXJzdFwiOlxuICAgICAgICAgICAgZmlyc3QoY2h1bmspO1xuICAgICAgICAgICAgc3RhdGUgPSBcImFjY2VwdFwiO1xuICAgICAgICAgIC8vIGZhbGwgdGhyb3VnaFxuICAgICAgICAgIGNhc2UgXCJhY2NlcHRcIjpcbiAgICAgICAgICAgIGlmIChhc21bY2h1bmsubmFtZV0pIHtcbiAgICAgICAgICAgICAgYXNtW2NodW5rLm5hbWVdKGNodW5rLnZhbHVlKTtcbiAgICAgICAgICAgICAgaWYgKGFzbS5kZXB0aCA9PT0gbGV2ZWwpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcHVzaChhc20pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbm9uZTtcbiAgICAgIH07XG4gICAgfVxuXG4gICAgLy8gb2JqZWN0IGZpbHRlciArIGEgcG9zc2libGUgZmlyc3QgY2hlY2tcbiAgICByZXR1cm4gKGNodW5rOiBhbnkpID0+IHtcbiAgICAgIHN3aXRjaCAoc3RhdGUpIHtcbiAgICAgICAgY2FzZSBcImZpcnN0XCI6XG4gICAgICAgICAgZmlyc3QoY2h1bmspO1xuICAgICAgICAgIHN0YXRlID0gXCJjaGVja1wiO1xuICAgICAgICAvLyBmYWxsIHRocm91Z2hcbiAgICAgICAgY2FzZSBcImNoZWNrXCI6XG4gICAgICAgICAgaWYgKGFzbVtjaHVuay5uYW1lXSkge1xuICAgICAgICAgICAgYXNtW2NodW5rLm5hbWVdKGNodW5rLnZhbHVlKTtcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IG9iamVjdEZpbHRlcihhc20pO1xuICAgICAgICAgICAgaWYgKHJlc3VsdCkge1xuICAgICAgICAgICAgICBzdGF0ZSA9IFwiYWNjZXB0XCI7XG4gICAgICAgICAgICAgIGlmIChhc20uZGVwdGggPT09IGxldmVsKSByZXR1cm4gcHVzaChhc20pO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChyZXN1bHQgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgIGlmIChhc20uZGVwdGggPT09IGxldmVsKSByZXR1cm4gcHVzaChhc20sIHRydWUpO1xuICAgICAgICAgICAgICBzdGF0ZSA9IFwicmVqZWN0XCI7XG4gICAgICAgICAgICAgIHNhdmVkQXNtID0gYXNtO1xuICAgICAgICAgICAgICBhc20gPSBuZXcgQ291bnRlcihzYXZlZEFzbS5kZXB0aCk7XG4gICAgICAgICAgICAgIHNhdmVkQXNtLmRyb3BUb0xldmVsKGxldmVsKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGlmIChhc20uZGVwdGggPT09IGxldmVsKSByZXR1cm4gcHVzaChhc20sICFpbmNsdWRlVW5kZWNpZGVkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgXCJhY2NlcHRcIjpcbiAgICAgICAgICBpZiAoYXNtW2NodW5rLm5hbWVdKSB7XG4gICAgICAgICAgICBhc21bY2h1bmsubmFtZV0oY2h1bmsudmFsdWUpO1xuICAgICAgICAgICAgaWYgKGFzbS5kZXB0aCA9PT0gbGV2ZWwpIHtcbiAgICAgICAgICAgICAgc3RhdGUgPSBcImNoZWNrXCI7XG4gICAgICAgICAgICAgIHJldHVybiBwdXNoKGFzbSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIFwicmVqZWN0XCI6XG4gICAgICAgICAgaWYgKGFzbVtjaHVuay5uYW1lXSkge1xuICAgICAgICAgICAgYXNtW2NodW5rLm5hbWVdKGNodW5rLnZhbHVlKTtcbiAgICAgICAgICAgIGlmIChhc20uZGVwdGggPT09IGxldmVsKSB7XG4gICAgICAgICAgICAgIHN0YXRlID0gXCJjaGVja1wiO1xuICAgICAgICAgICAgICBhc20gPSBzYXZlZEFzbTtcbiAgICAgICAgICAgICAgc2F2ZWRBc20gPSBudWxsO1xuICAgICAgICAgICAgICByZXR1cm4gcHVzaChhc20sIHRydWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIHJldHVybiBub25lO1xuICAgIH07XG4gIH07XG5cbmV4cG9ydCBjb25zdCBTdHJlYW1BcnJheSA9IChvcHRpb25zPzogYW55KSA9PiB7XG4gIGxldCBrZXkgPSAwO1xuICByZXR1cm4gc3RyZWFtQmFzZSh7XG4gICAgbGV2ZWw6IDEsXG5cbiAgICBmaXJzdChjaHVuazogYW55KSB7XG4gICAgICBpZiAoY2h1bmsubmFtZSAhPT0gXCJzdGFydEFycmF5XCIpIHRocm93IG5ldyBFcnJvcihcIlRvcC1sZXZlbCBvYmplY3Qgc2hvdWxkIGJlIGFuIGFycmF5LlwiKTtcbiAgICB9LFxuXG4gICAgcHVzaChhc206IGFueSwgZGlzY2FyZDogYW55KSB7XG4gICAgICBpZiAoYXNtLmN1cnJlbnQubGVuZ3RoKSB7XG4gICAgICAgIGlmIChkaXNjYXJkKSB7XG4gICAgICAgICAgKytrZXk7XG4gICAgICAgICAgYXNtLmN1cnJlbnQucG9wKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmV0dXJuIHsga2V5OiBrZXkrKywgdmFsdWU6IGFzbS5jdXJyZW50LnBvcCgpIH07XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBub25lO1xuICAgIH0sXG4gIH0pKG9wdGlvbnMpO1xufTtcbiIsICJpbXBvcnQgeyBMaXN0LCBNZW51QmFyRXh0cmEsIEljb24sIG9wZW4sIExhdW5jaFR5cGUsIGVudmlyb25tZW50LCBBY3Rpb25QYW5lbCwgQWN0aW9uIH0gZnJvbSBcIkByYXljYXN0L2FwaVwiO1xuaW1wb3J0IHsgZXhpc3RzU3luYyB9IGZyb20gXCJub2RlOmZzXCI7XG5pbXBvcnQgb3MgZnJvbSBcIm5vZGU6b3NcIjtcbmltcG9ydCB7IHVzZVJlZiwgdXNlU3RhdGUsIHVzZUNhbGxiYWNrLCB1c2VNZW1vIH0gZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgeyB1c2VQcm9taXNlLCBQcm9taXNlT3B0aW9ucyB9IGZyb20gXCIuL3VzZVByb21pc2VcIjtcbmltcG9ydCB7IHVzZUxhdGVzdCB9IGZyb20gXCIuL3VzZUxhdGVzdFwiO1xuaW1wb3J0IHsgc2hvd0ZhaWx1cmVUb2FzdCB9IGZyb20gXCIuL3Nob3dGYWlsdXJlVG9hc3RcIjtcbmltcG9ydCB7IGJhc2VFeGVjdXRlU1FMLCBQZXJtaXNzaW9uRXJyb3IsIGlzUGVybWlzc2lvbkVycm9yIH0gZnJvbSBcIi4vc3FsLXV0aWxzXCI7XG5cbi8qKlxuICogRXhlY3V0ZXMgYSBxdWVyeSBvbiBhIGxvY2FsIFNRTCBkYXRhYmFzZSBhbmQgcmV0dXJucyB0aGUge0BsaW5rIEFzeW5jU3RhdGV9IGNvcnJlc3BvbmRpbmcgdG8gdGhlIHF1ZXJ5IG9mIHRoZSBjb21tYW5kLiBUaGUgbGFzdCB2YWx1ZSB3aWxsIGJlIGtlcHQgYmV0d2VlbiBjb21tYW5kIHJ1bnMuXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYFxuICogaW1wb3J0IHsgdXNlU1FMIH0gZnJvbSBcIkByYXljYXN0L3V0aWxzXCI7XG4gKiBpbXBvcnQgeyByZXNvbHZlIH0gZnJvbSBcInBhdGhcIjtcbiAqIGltcG9ydCB7IGhvbWVkaXIgfSBmcm9tIFwib3NcIjtcbiAqXG4gKiBjb25zdCBOT1RFU19EQiA9IHJlc29sdmUoaG9tZWRpcigpLCBcIkxpYnJhcnkvR3JvdXAgQ29udGFpbmVycy9ncm91cC5jb20uYXBwbGUubm90ZXMvTm90ZVN0b3JlLnNxbGl0ZVwiKTtcbiAqIGNvbnN0IG5vdGVzUXVlcnkgPSBgU0VMRUNUIGlkLCB0aXRsZSBGUk9NIC4uLmA7XG4gKiB0eXBlIE5vdGVJdGVtID0ge1xuICogICBpZDogc3RyaW5nO1xuICogICB0aXRsZTogc3RyaW5nO1xuICogfTtcbiAqXG4gKiBleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBDb21tYW5kKCkge1xuICogICBjb25zdCB7IGlzTG9hZGluZywgZGF0YSwgcGVybWlzc2lvblZpZXcgfSA9IHVzZVNRTDxOb3RlSXRlbT4oTk9URVNfREIsIG5vdGVzUXVlcnkpO1xuICpcbiAqICAgaWYgKHBlcm1pc3Npb25WaWV3KSB7XG4gKiAgICAgcmV0dXJuIHBlcm1pc3Npb25WaWV3O1xuICogICB9XG4gKlxuICogICByZXR1cm4gKFxuICogICAgIDxMaXN0IGlzTG9hZGluZz17aXNMb2FkaW5nfT5cbiAqICAgICAgIHsoZGF0YSB8fCBbXSkubWFwKChpdGVtKSA9PiAoXG4gKiAgICAgICAgIDxMaXN0Lkl0ZW0ga2V5PXtpdGVtLmlkfSB0aXRsZT17aXRlbS50aXRsZX0gLz5cbiAqICAgICAgICkpfVxuICogICAgIDwvTGlzdD5cbiAqICApO1xuICogfTtcbiAqIGBgYFxuICovXG5leHBvcnQgZnVuY3Rpb24gdXNlU1FMPFQgPSB1bmtub3duPihcbiAgZGF0YWJhc2VQYXRoOiBzdHJpbmcsXG4gIHF1ZXJ5OiBzdHJpbmcsXG4gIG9wdGlvbnM/OiB7XG4gICAgLyoqIEEgc3RyaW5nIGV4cGxhaW5pbmcgd2h5IHRoZSBleHRlbnNpb24gbmVlZHMgZnVsbCBkaXNrIGFjY2Vzcy4gRm9yIGV4YW1wbGUsIHRoZSBBcHBsZSBOb3RlcyBleHRlbnNpb24gdXNlcyBgXCJUaGlzIGlzIHJlcXVpcmVkIHRvIHNlYXJjaCB5b3VyIEFwcGxlIE5vdGVzLlwiYC4gV2hpbGUgaXQgaXMgb3B0aW9uYWwsIHdlIHJlY29tbWVuZCBzZXR0aW5nIGl0IHRvIGhlbHAgdXNlcnMgdW5kZXJzdGFuZC4gKi9cbiAgICBwZXJtaXNzaW9uUHJpbWluZz86IHN0cmluZztcbiAgfSAmIE9taXQ8UHJvbWlzZU9wdGlvbnM8KGRhdGFiYXNlOiBzdHJpbmcsIHF1ZXJ5OiBzdHJpbmcpID0+IFByb21pc2U8VFtdPj4sIFwiYWJvcnRhYmxlXCI+LFxuKSB7XG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW51c2VkLXZhcnNcbiAgY29uc3QgeyBwZXJtaXNzaW9uUHJpbWluZywgLi4udXNlUHJvbWlzZU9wdGlvbnMgfSA9IG9wdGlvbnMgfHwge307XG5cbiAgY29uc3QgW3Blcm1pc3Npb25WaWV3LCBzZXRQZXJtaXNzaW9uVmlld10gPSB1c2VTdGF0ZTxSZWFjdC5KU1guRWxlbWVudCB8IG51bGw+KG51bGwpO1xuICBjb25zdCBsYXRlc3RPcHRpb25zID0gdXNlTGF0ZXN0KG9wdGlvbnMgfHwge30pO1xuICBjb25zdCBhYm9ydGFibGUgPSB1c2VSZWY8QWJvcnRDb250cm9sbGVyPihudWxsKTtcblxuICBjb25zdCBoYW5kbGVFcnJvciA9IHVzZUNhbGxiYWNrKFxuICAgIChfZXJyb3I6IEVycm9yKSA9PiB7XG4gICAgICBjb25zb2xlLmVycm9yKF9lcnJvcik7XG4gICAgICBjb25zdCBlcnJvciA9XG4gICAgICAgIF9lcnJvciBpbnN0YW5jZW9mIEVycm9yICYmIF9lcnJvci5tZXNzYWdlLmluY2x1ZGVzKFwiYXV0aG9yaXphdGlvbiBkZW5pZWRcIilcbiAgICAgICAgICA/IG5ldyBQZXJtaXNzaW9uRXJyb3IoXCJZb3UgZG8gbm90IGhhdmUgcGVybWlzc2lvbiB0byBhY2Nlc3MgdGhlIGRhdGFiYXNlLlwiKVxuICAgICAgICAgIDogKF9lcnJvciBhcyBFcnJvcik7XG5cbiAgICAgIGlmIChpc1Blcm1pc3Npb25FcnJvcihlcnJvcikpIHtcbiAgICAgICAgc2V0UGVybWlzc2lvblZpZXcoPFBlcm1pc3Npb25FcnJvclNjcmVlbiBwcmltaW5nPXtsYXRlc3RPcHRpb25zLmN1cnJlbnQucGVybWlzc2lvblByaW1pbmd9IC8+KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmIChsYXRlc3RPcHRpb25zLmN1cnJlbnQub25FcnJvcikge1xuICAgICAgICAgIGxhdGVzdE9wdGlvbnMuY3VycmVudC5vbkVycm9yKGVycm9yKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBpZiAoZW52aXJvbm1lbnQubGF1bmNoVHlwZSAhPT0gTGF1bmNoVHlwZS5CYWNrZ3JvdW5kKSB7XG4gICAgICAgICAgICBzaG93RmFpbHVyZVRvYXN0KGVycm9yLCB7XG4gICAgICAgICAgICAgIHRpdGxlOiBcIkNhbm5vdCBxdWVyeSB0aGUgZGF0YVwiLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSxcbiAgICBbbGF0ZXN0T3B0aW9uc10sXG4gICk7XG5cbiAgY29uc3QgZm4gPSB1c2VNZW1vKCgpID0+IHtcbiAgICBpZiAoIWV4aXN0c1N5bmMoZGF0YWJhc2VQYXRoKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVGhlIGRhdGFiYXNlIGRvZXMgbm90IGV4aXN0XCIpO1xuICAgIH1cblxuICAgIHJldHVybiBhc3luYyAoZGF0YWJhc2VQYXRoOiBzdHJpbmcsIHF1ZXJ5OiBzdHJpbmcpID0+IHtcbiAgICAgIGNvbnN0IGFib3J0U2lnbmFsID0gYWJvcnRhYmxlLmN1cnJlbnQ/LnNpZ25hbDtcbiAgICAgIHJldHVybiBiYXNlRXhlY3V0ZVNRTDxUPihkYXRhYmFzZVBhdGgsIHF1ZXJ5LCB7IHNpZ25hbDogYWJvcnRTaWduYWwgfSk7XG4gICAgfTtcbiAgfSwgW2RhdGFiYXNlUGF0aF0pO1xuXG4gIHJldHVybiB7XG4gICAgLi4udXNlUHJvbWlzZShmbiwgW2RhdGFiYXNlUGF0aCwgcXVlcnldLCB7IC4uLnVzZVByb21pc2VPcHRpb25zLCBvbkVycm9yOiBoYW5kbGVFcnJvciB9KSxcbiAgICBwZXJtaXNzaW9uVmlldyxcbiAgfTtcbn1cblxuZnVuY3Rpb24gUGVybWlzc2lvbkVycm9yU2NyZWVuKHByb3BzOiB7IHByaW1pbmc/OiBzdHJpbmcgfSkge1xuICBjb25zdCBtYWNvc1ZlbnR1cmFBbmRMYXRlciA9IHBhcnNlSW50KG9zLnJlbGVhc2UoKS5zcGxpdChcIi5cIilbMF0pID49IDIyO1xuICBjb25zdCBwcmVmZXJlbmNlc1N0cmluZyA9IG1hY29zVmVudHVyYUFuZExhdGVyID8gXCJTZXR0aW5nc1wiIDogXCJQcmVmZXJlbmNlc1wiO1xuXG4gIGNvbnN0IGFjdGlvbiA9IG1hY29zVmVudHVyYUFuZExhdGVyXG4gICAgPyB7XG4gICAgICAgIHRpdGxlOiBcIk9wZW4gU3lzdGVtIFNldHRpbmdzIC0+IFByaXZhY3lcIixcbiAgICAgICAgdGFyZ2V0OiBcIngtYXBwbGUuc3lzdGVtcHJlZmVyZW5jZXM6Y29tLmFwcGxlLnByZWZlcmVuY2Uuc2VjdXJpdHk/UHJpdmFjeV9BbGxGaWxlc1wiLFxuICAgICAgfVxuICAgIDoge1xuICAgICAgICB0aXRsZTogXCJPcGVuIFN5c3RlbSBQcmVmZXJlbmNlcyAtPiBTZWN1cml0eVwiLFxuICAgICAgICB0YXJnZXQ6IFwieC1hcHBsZS5zeXN0ZW1wcmVmZXJlbmNlczpjb20uYXBwbGUucHJlZmVyZW5jZS5zZWN1cml0eT9Qcml2YWN5X0FsbEZpbGVzXCIsXG4gICAgICB9O1xuXG4gIGlmIChlbnZpcm9ubWVudC5jb21tYW5kTW9kZSA9PT0gXCJtZW51LWJhclwiKSB7XG4gICAgcmV0dXJuIChcbiAgICAgIDxNZW51QmFyRXh0cmEgaWNvbj17SWNvbi5XYXJuaW5nfSB0aXRsZT17ZW52aXJvbm1lbnQuY29tbWFuZE5hbWV9PlxuICAgICAgICA8TWVudUJhckV4dHJhLkl0ZW1cbiAgICAgICAgICB0aXRsZT1cIlJheWNhc3QgbmVlZHMgZnVsbCBkaXNrIGFjY2Vzc1wiXG4gICAgICAgICAgdG9vbHRpcD17YFlvdSBjYW4gcmV2ZXJ0IHRoaXMgYWNjZXNzIGluICR7cHJlZmVyZW5jZXNTdHJpbmd9IHdoZW5ldmVyIHlvdSB3YW50YH1cbiAgICAgICAgLz5cbiAgICAgICAge3Byb3BzLnByaW1pbmcgPyAoXG4gICAgICAgICAgPE1lbnVCYXJFeHRyYS5JdGVtXG4gICAgICAgICAgICB0aXRsZT17cHJvcHMucHJpbWluZ31cbiAgICAgICAgICAgIHRvb2x0aXA9e2BZb3UgY2FuIHJldmVydCB0aGlzIGFjY2VzcyBpbiAke3ByZWZlcmVuY2VzU3RyaW5nfSB3aGVuZXZlciB5b3Ugd2FudGB9XG4gICAgICAgICAgLz5cbiAgICAgICAgKSA6IG51bGx9XG4gICAgICAgIDxNZW51QmFyRXh0cmEuU2VwYXJhdG9yIC8+XG4gICAgICAgIDxNZW51QmFyRXh0cmEuSXRlbSB0aXRsZT17YWN0aW9uLnRpdGxlfSBvbkFjdGlvbj17KCkgPT4gb3BlbihhY3Rpb24udGFyZ2V0KX0gLz5cbiAgICAgIDwvTWVudUJhckV4dHJhPlxuICAgICk7XG4gIH1cblxuICByZXR1cm4gKFxuICAgIDxMaXN0PlxuICAgICAgPExpc3QuRW1wdHlWaWV3XG4gICAgICAgIGljb249e3tcbiAgICAgICAgICBzb3VyY2U6IHtcbiAgICAgICAgICAgIGxpZ2h0OiBcImh0dHBzOi8vcmF5Y2FzdC5jb20vdXBsb2Fkcy9leHRlbnNpb25zLXV0aWxzLXNlY3VyaXR5LXBlcm1pc3Npb25zLWxpZ2h0LnBuZ1wiLFxuICAgICAgICAgICAgZGFyazogXCJodHRwczovL3JheWNhc3QuY29tL3VwbG9hZHMvZXh0ZW5zaW9ucy11dGlscy1zZWN1cml0eS1wZXJtaXNzaW9ucy1kYXJrLnBuZ1wiLFxuICAgICAgICAgIH0sXG4gICAgICAgIH19XG4gICAgICAgIHRpdGxlPVwiUmF5Y2FzdCBuZWVkcyBmdWxsIGRpc2sgYWNjZXNzLlwiXG4gICAgICAgIGRlc2NyaXB0aW9uPXtgJHtcbiAgICAgICAgICBwcm9wcy5wcmltaW5nID8gcHJvcHMucHJpbWluZyArIFwiXFxuXCIgOiBcIlwiXG4gICAgICAgIH1Zb3UgY2FuIHJldmVydCB0aGlzIGFjY2VzcyBpbiAke3ByZWZlcmVuY2VzU3RyaW5nfSB3aGVuZXZlciB5b3Ugd2FudC5gfVxuICAgICAgICBhY3Rpb25zPXtcbiAgICAgICAgICA8QWN0aW9uUGFuZWw+XG4gICAgICAgICAgICA8QWN0aW9uLk9wZW4gey4uLmFjdGlvbn0gLz5cbiAgICAgICAgICA8L0FjdGlvblBhbmVsPlxuICAgICAgICB9XG4gICAgICAvPlxuICAgIDwvTGlzdD5cbiAgKTtcbn1cbiIsICJpbXBvcnQgeyBleGlzdHNTeW5jIH0gZnJvbSBcIm5vZGU6ZnNcIjtcbmltcG9ydCB7IGNvcHlGaWxlLCBta2Rpciwgd3JpdGVGaWxlIH0gZnJvbSBcIm5vZGU6ZnMvcHJvbWlzZXNcIjtcbmltcG9ydCBvcyBmcm9tIFwibm9kZTpvc1wiO1xuaW1wb3J0IGNoaWxkUHJvY2VzcyBmcm9tIFwibm9kZTpjaGlsZF9wcm9jZXNzXCI7XG5pbXBvcnQgcGF0aCBmcm9tIFwibm9kZTpwYXRoXCI7XG5pbXBvcnQgeyBnZXRTcGF3bmVkUHJvbWlzZSwgZ2V0U3Bhd25lZFJlc3VsdCB9IGZyb20gXCIuL2V4ZWMtdXRpbHNcIjtcbmltcG9ydCB7IGhhc2ggfSBmcm9tIFwiLi9oZWxwZXJzXCI7XG5cbmV4cG9ydCBjbGFzcyBQZXJtaXNzaW9uRXJyb3IgZXh0ZW5kcyBFcnJvciB7XG4gIGNvbnN0cnVjdG9yKG1lc3NhZ2U6IHN0cmluZykge1xuICAgIHN1cGVyKG1lc3NhZ2UpO1xuICAgIHRoaXMubmFtZSA9IFwiUGVybWlzc2lvbkVycm9yXCI7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzUGVybWlzc2lvbkVycm9yKGVycm9yOiB1bmtub3duKTogZXJyb3IgaXMgUGVybWlzc2lvbkVycm9yIHtcbiAgcmV0dXJuIGVycm9yIGluc3RhbmNlb2YgRXJyb3IgJiYgZXJyb3IubmFtZSA9PT0gXCJQZXJtaXNzaW9uRXJyb3JcIjtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGJhc2VFeGVjdXRlU1FMPFQgPSB1bmtub3duPihcbiAgZGF0YWJhc2VQYXRoOiBzdHJpbmcsXG4gIHF1ZXJ5OiBzdHJpbmcsXG4gIG9wdGlvbnM/OiB7XG4gICAgc2lnbmFsPzogQWJvcnRTaWduYWw7XG4gIH0sXG4pOiBQcm9taXNlPFRbXT4ge1xuICBpZiAoIWV4aXN0c1N5bmMoZGF0YWJhc2VQYXRoKSkge1xuICAgIHRocm93IG5ldyBFcnJvcihcIlRoZSBkYXRhYmFzZSBkb2VzIG5vdCBleGlzdFwiKTtcbiAgfVxuXG4gIGxldCBzcWxpdGUzOiB0eXBlb2YgaW1wb3J0KFwibm9kZTpzcWxpdGVcIik7XG4gIHRyeSB7XG4gICAgLy8gdGhpcyBpcyBhIGJpdCB1Z2x5IGJ1dCB3ZSBjYW4ndCBkaXJlY3RseSBpbXBvcnQgXCJub2RlOnNxbGl0ZVwiIGhlcmUgYmVjYXVzZSBwYXJjZWwgd2lsbCBob2lzdCBpdCBhbnl3YXkgYW5kIGl0IHdpbGwgYnJlYWsgd2hlbiBpdCdzIG5vdCBhdmFpbGFibGVcbiAgICBjb25zdCBkeW5hbWljSW1wb3J0ID0gKG1vZHVsZTogc3RyaW5nKSA9PiBpbXBvcnQobW9kdWxlKTtcbiAgICBzcWxpdGUzID0gYXdhaXQgZHluYW1pY0ltcG9ydChcIm5vZGU6c3FsaXRlXCIpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIC8vIElmIHNxbGl0ZTMgaXMgbm90IGF2YWlsYWJsZSwgd2UgZmFsbGJhY2sgdG8gdXNpbmcgdGhlIHNxbGl0ZTMgQ0xJIChhdmFpbGFibGUgb24gbWFjT1MgYW5kIExpbnV4IGJ5IGRlZmF1bHQpLlxuICAgIHJldHVybiBzcWxpdGVGYWxsYmFjazxUPihkYXRhYmFzZVBhdGgsIHF1ZXJ5LCBvcHRpb25zKTtcbiAgfVxuXG4gIGxldCBkYiA9IG5ldyBzcWxpdGUzLkRhdGFiYXNlU3luYyhkYXRhYmFzZVBhdGgsIHsgb3BlbjogZmFsc2UsIHJlYWRPbmx5OiB0cnVlIH0pO1xuXG4gIGNvbnN0IGFib3J0U2lnbmFsID0gb3B0aW9ucz8uc2lnbmFsO1xuXG4gIHRyeSB7XG4gICAgZGIub3BlbigpO1xuICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgIGlmIChlcnJvci5tZXNzYWdlLm1hdGNoKFwiKDUpXCIpIHx8IGVycm9yLm1lc3NhZ2UubWF0Y2goXCIoMTQpXCIpKSB7XG4gICAgICAvLyBUaGF0IG1lYW5zIHRoYXQgdGhlIERCIGlzIGJ1c3kgYmVjYXVzZSBvZiBhbm90aGVyIGFwcCBpcyBsb2NraW5nIGl0XG4gICAgICAvLyBUaGlzIGhhcHBlbnMgd2hlbiBDaHJvbWUgb3IgQXJjIGlzIG9wZW5lZDogdGhleSBsb2NrIHRoZSBIaXN0b3J5IGRiLlxuICAgICAgLy8gQXMgYW4gdWdseSB3b3JrYXJvdW5kLCB3ZSBkdXBsaWNhdGUgdGhlIGZpbGUgYW5kIHJlYWQgdGhhdCBpbnN0ZWFkXG4gICAgICAvLyAod2l0aCB2ZnMgdW5peCAtIG5vbmUgdG8ganVzdCBub3QgY2FyZSBhYm91dCBsb2NrcylcbiAgICAgIGxldCB3b3JrYXJvdW5kQ29waWVkRGI6IHN0cmluZyB8IHVuZGVmaW5lZDtcbiAgICAgIGlmICghd29ya2Fyb3VuZENvcGllZERiKSB7XG4gICAgICAgIGNvbnN0IHRlbXBGb2xkZXIgPSBwYXRoLmpvaW4ob3MudG1wZGlyKCksIFwidXNlU1FMXCIsIGhhc2goZGF0YWJhc2VQYXRoKSk7XG4gICAgICAgIGF3YWl0IG1rZGlyKHRlbXBGb2xkZXIsIHsgcmVjdXJzaXZlOiB0cnVlIH0pO1xuICAgICAgICBjaGVja0Fib3J0ZWQoYWJvcnRTaWduYWwpO1xuXG4gICAgICAgIHdvcmthcm91bmRDb3BpZWREYiA9IHBhdGguam9pbih0ZW1wRm9sZGVyLCBcImRiLmRiXCIpO1xuICAgICAgICBhd2FpdCBjb3B5RmlsZShkYXRhYmFzZVBhdGgsIHdvcmthcm91bmRDb3BpZWREYik7XG5cbiAgICAgICAgYXdhaXQgd3JpdGVGaWxlKHdvcmthcm91bmRDb3BpZWREYiArIFwiLXNobVwiLCBcIlwiKTtcbiAgICAgICAgYXdhaXQgd3JpdGVGaWxlKHdvcmthcm91bmRDb3BpZWREYiArIFwiLXdhbFwiLCBcIlwiKTtcblxuICAgICAgICBjaGVja0Fib3J0ZWQoYWJvcnRTaWduYWwpO1xuICAgICAgfVxuXG4gICAgICBkYiA9IG5ldyBzcWxpdGUzLkRhdGFiYXNlU3luYyh3b3JrYXJvdW5kQ29waWVkRGIsIHsgb3BlbjogZmFsc2UsIHJlYWRPbmx5OiB0cnVlIH0pO1xuICAgICAgZGIub3BlbigpO1xuICAgICAgY2hlY2tBYm9ydGVkKGFib3J0U2lnbmFsKTtcbiAgICB9XG4gIH1cblxuICBjb25zdCBzdGF0ZW1lbnQgPSBkYi5wcmVwYXJlKHF1ZXJ5KTtcbiAgY2hlY2tBYm9ydGVkKGFib3J0U2lnbmFsKTtcblxuICBjb25zdCByZXN1bHQgPSBzdGF0ZW1lbnQuYWxsKCk7XG5cbiAgZGIuY2xvc2UoKTtcblxuICByZXR1cm4gcmVzdWx0IGFzIFRbXTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gc3FsaXRlRmFsbGJhY2s8VCA9IHVua25vd24+KFxuICBkYXRhYmFzZVBhdGg6IHN0cmluZyxcbiAgcXVlcnk6IHN0cmluZyxcbiAgb3B0aW9ucz86IHtcbiAgICBzaWduYWw/OiBBYm9ydFNpZ25hbDtcbiAgfSxcbik6IFByb21pc2U8VFtdPiB7XG4gIGNvbnN0IGFib3J0U2lnbmFsID0gb3B0aW9ucz8uc2lnbmFsO1xuXG4gIGxldCBzcGF3bmVkID0gY2hpbGRQcm9jZXNzLnNwYXduKFwic3FsaXRlM1wiLCBbXCItLWpzb25cIiwgXCItLXJlYWRvbmx5XCIsIGRhdGFiYXNlUGF0aCwgcXVlcnldLCB7IHNpZ25hbDogYWJvcnRTaWduYWwgfSk7XG4gIGxldCBzcGF3bmVkUHJvbWlzZSA9IGdldFNwYXduZWRQcm9taXNlKHNwYXduZWQpO1xuICBsZXQgW3sgZXJyb3IsIGV4aXRDb2RlLCBzaWduYWwgfSwgc3Rkb3V0UmVzdWx0LCBzdGRlcnJSZXN1bHRdID0gYXdhaXQgZ2V0U3Bhd25lZFJlc3VsdDxzdHJpbmc+KFxuICAgIHNwYXduZWQsXG4gICAgeyBlbmNvZGluZzogXCJ1dGYtOFwiIH0sXG4gICAgc3Bhd25lZFByb21pc2UsXG4gICk7XG4gIGNoZWNrQWJvcnRlZChhYm9ydFNpZ25hbCk7XG5cbiAgaWYgKHN0ZGVyclJlc3VsdC5tYXRjaChcIig1KVwiKSB8fCBzdGRlcnJSZXN1bHQubWF0Y2goXCIoMTQpXCIpKSB7XG4gICAgLy8gVGhhdCBtZWFucyB0aGF0IHRoZSBEQiBpcyBidXN5IGJlY2F1c2Ugb2YgYW5vdGhlciBhcHAgaXMgbG9ja2luZyBpdFxuICAgIC8vIFRoaXMgaGFwcGVucyB3aGVuIENocm9tZSBvciBBcmMgaXMgb3BlbmVkOiB0aGV5IGxvY2sgdGhlIEhpc3RvcnkgZGIuXG4gICAgLy8gQXMgYW4gdWdseSB3b3JrYXJvdW5kLCB3ZSBkdXBsaWNhdGUgdGhlIGZpbGUgYW5kIHJlYWQgdGhhdCBpbnN0ZWFkXG4gICAgLy8gKHdpdGggdmZzIHVuaXggLSBub25lIHRvIGp1c3Qgbm90IGNhcmUgYWJvdXQgbG9ja3MpXG4gICAgbGV0IHdvcmthcm91bmRDb3BpZWREYjogc3RyaW5nIHwgdW5kZWZpbmVkO1xuICAgIGlmICghd29ya2Fyb3VuZENvcGllZERiKSB7XG4gICAgICBjb25zdCB0ZW1wRm9sZGVyID0gcGF0aC5qb2luKG9zLnRtcGRpcigpLCBcInVzZVNRTFwiLCBoYXNoKGRhdGFiYXNlUGF0aCkpO1xuICAgICAgYXdhaXQgbWtkaXIodGVtcEZvbGRlciwgeyByZWN1cnNpdmU6IHRydWUgfSk7XG4gICAgICBjaGVja0Fib3J0ZWQoYWJvcnRTaWduYWwpO1xuXG4gICAgICB3b3JrYXJvdW5kQ29waWVkRGIgPSBwYXRoLmpvaW4odGVtcEZvbGRlciwgXCJkYi5kYlwiKTtcbiAgICAgIGF3YWl0IGNvcHlGaWxlKGRhdGFiYXNlUGF0aCwgd29ya2Fyb3VuZENvcGllZERiKTtcblxuICAgICAgYXdhaXQgd3JpdGVGaWxlKHdvcmthcm91bmRDb3BpZWREYiArIFwiLXNobVwiLCBcIlwiKTtcbiAgICAgIGF3YWl0IHdyaXRlRmlsZSh3b3JrYXJvdW5kQ29waWVkRGIgKyBcIi13YWxcIiwgXCJcIik7XG5cbiAgICAgIGNoZWNrQWJvcnRlZChhYm9ydFNpZ25hbCk7XG4gICAgfVxuXG4gICAgc3Bhd25lZCA9IGNoaWxkUHJvY2Vzcy5zcGF3bihcInNxbGl0ZTNcIiwgW1wiLS1qc29uXCIsIFwiLS1yZWFkb25seVwiLCBcIi0tdmZzXCIsIFwidW5peC1ub25lXCIsIHdvcmthcm91bmRDb3BpZWREYiwgcXVlcnldLCB7XG4gICAgICBzaWduYWw6IGFib3J0U2lnbmFsLFxuICAgIH0pO1xuICAgIHNwYXduZWRQcm9taXNlID0gZ2V0U3Bhd25lZFByb21pc2Uoc3Bhd25lZCk7XG4gICAgW3sgZXJyb3IsIGV4aXRDb2RlLCBzaWduYWwgfSwgc3Rkb3V0UmVzdWx0LCBzdGRlcnJSZXN1bHRdID0gYXdhaXQgZ2V0U3Bhd25lZFJlc3VsdDxzdHJpbmc+KFxuICAgICAgc3Bhd25lZCxcbiAgICAgIHsgZW5jb2Rpbmc6IFwidXRmLThcIiB9LFxuICAgICAgc3Bhd25lZFByb21pc2UsXG4gICAgKTtcbiAgICBjaGVja0Fib3J0ZWQoYWJvcnRTaWduYWwpO1xuICB9XG5cbiAgaWYgKGVycm9yIHx8IGV4aXRDb2RlICE9PSAwIHx8IHNpZ25hbCAhPT0gbnVsbCkge1xuICAgIGlmIChzdGRlcnJSZXN1bHQuaW5jbHVkZXMoXCJhdXRob3JpemF0aW9uIGRlbmllZFwiKSkge1xuICAgICAgdGhyb3cgbmV3IFBlcm1pc3Npb25FcnJvcihcIllvdSBkbyBub3QgaGF2ZSBwZXJtaXNzaW9uIHRvIGFjY2VzcyB0aGUgZGF0YWJhc2UuXCIpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3Ioc3RkZXJyUmVzdWx0IHx8IFwiVW5rbm93biBlcnJvclwiKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gSlNPTi5wYXJzZShzdGRvdXRSZXN1bHQudHJpbSgpIHx8IFwiW11cIikgYXMgVFtdO1xufVxuXG5mdW5jdGlvbiBjaGVja0Fib3J0ZWQoc2lnbmFsPzogQWJvcnRTaWduYWwpIHtcbiAgaWYgKHNpZ25hbD8uYWJvcnRlZCkge1xuICAgIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKFwiYWJvcnRlZFwiKTtcbiAgICBlcnJvci5uYW1lID0gXCJBYm9ydEVycm9yXCI7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbn1cbiIsICJpbXBvcnQgeyBGb3JtIH0gZnJvbSBcIkByYXljYXN0L2FwaVwiO1xuaW1wb3J0IHsgdXNlU3RhdGUsIHVzZUNhbGxiYWNrLCB1c2VNZW1vLCB1c2VSZWYsIFNldFN0YXRlQWN0aW9uIH0gZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgeyB1c2VMYXRlc3QgfSBmcm9tIFwiLi91c2VMYXRlc3RcIjtcblxuLyoqXG4gKiBTaG9ydGhhbmRzIGZvciBjb21tb24gdmFsaWRhdGlvbiBjYXNlc1xuICovXG5leHBvcnQgZW51bSBGb3JtVmFsaWRhdGlvbiB7XG4gIC8qKiBTaG93IGFuIGVycm9yIHdoZW4gdGhlIHZhbHVlIG9mIHRoZSBpdGVtIGlzIGVtcHR5ICovXG4gIFJlcXVpcmVkID0gXCJyZXF1aXJlZFwiLFxufVxuXG50eXBlIFZhbGlkYXRpb25FcnJvciA9IHN0cmluZyB8IHVuZGVmaW5lZCB8IG51bGw7XG50eXBlIFZhbGlkYXRvcjxWYWx1ZVR5cGU+ID0gKCh2YWx1ZTogVmFsdWVUeXBlIHwgdW5kZWZpbmVkKSA9PiBWYWxpZGF0aW9uRXJyb3IpIHwgRm9ybVZhbGlkYXRpb247XG5cbmZ1bmN0aW9uIHZhbGlkYXRpb25FcnJvcjxWYWx1ZVR5cGU+KFxuICB2YWxpZGF0aW9uOiBWYWxpZGF0b3I8VmFsdWVUeXBlPiB8IHVuZGVmaW5lZCxcbiAgdmFsdWU6IFZhbHVlVHlwZSB8IHVuZGVmaW5lZCxcbik6IFZhbGlkYXRpb25FcnJvciB7XG4gIGlmICh2YWxpZGF0aW9uKSB7XG4gICAgaWYgKHR5cGVvZiB2YWxpZGF0aW9uID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgIHJldHVybiB2YWxpZGF0aW9uKHZhbHVlKTtcbiAgICB9IGVsc2UgaWYgKHZhbGlkYXRpb24gPT09IEZvcm1WYWxpZGF0aW9uLlJlcXVpcmVkKSB7XG4gICAgICBsZXQgdmFsdWVJc1ZhbGlkID0gdHlwZW9mIHZhbHVlICE9PSBcInVuZGVmaW5lZFwiICYmIHZhbHVlICE9PSBudWxsO1xuICAgICAgaWYgKHZhbHVlSXNWYWxpZCkge1xuICAgICAgICBzd2l0Y2ggKHR5cGVvZiB2YWx1ZSkge1xuICAgICAgICAgIGNhc2UgXCJzdHJpbmdcIjpcbiAgICAgICAgICAgIHZhbHVlSXNWYWxpZCA9IHZhbHVlLmxlbmd0aCA+IDA7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlIFwib2JqZWN0XCI6XG4gICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHtcbiAgICAgICAgICAgICAgdmFsdWVJc1ZhbGlkID0gdmFsdWUubGVuZ3RoID4gMDtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodmFsdWUgaW5zdGFuY2VvZiBEYXRlKSB7XG4gICAgICAgICAgICAgIHZhbHVlSXNWYWxpZCA9IHZhbHVlLmdldFRpbWUoKSA+IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmICghdmFsdWVJc1ZhbGlkKSB7XG4gICAgICAgIHJldHVybiBcIlRoZSBpdGVtIGlzIHJlcXVpcmVkXCI7XG4gICAgICB9XG4gICAgfVxuICB9XG59XG5cbnR5cGUgVmFsaWRhdGlvbjxUIGV4dGVuZHMgRm9ybS5WYWx1ZXM+ID0geyBbaWQgaW4ga2V5b2YgVF0/OiBWYWxpZGF0b3I8VFtpZF0+IH07XG5cbmludGVyZmFjZSBGb3JtUHJvcHM8VCBleHRlbmRzIEZvcm0uVmFsdWVzPiB7XG4gIC8qKiBGdW5jdGlvbiB0byBwYXNzIHRvIHRoZSBgb25TdWJtaXRgIHByb3Agb2YgdGhlIGA8QWN0aW9uLlN1Ym1pdEZvcm0+YCBlbGVtZW50LiBJdCB3cmFwcyB0aGUgaW5pdGlhbCBgb25TdWJtaXRgIGFyZ3VtZW50IHdpdGggc29tZSBnb29kaWVzIHJlbGF0ZWQgdG8gdGhlIHZhbGlkYXRpb24uICovXG4gIGhhbmRsZVN1Ym1pdDogKHZhbHVlczogVCkgPT4gdm9pZCB8IGJvb2xlYW4gfCBQcm9taXNlPHZvaWQgfCBib29sZWFuPjtcbiAgLyoqIFRoZSBwcm9wcyB0aGF0IG11c3QgYmUgcGFzc2VkIHRvIHRoZSBgPEZvcm0uSXRlbT5gIGVsZW1lbnRzIHRvIGhhbmRsZSB0aGUgdmFsaWRhdGlvbnMuICovXG4gIGl0ZW1Qcm9wczoge1xuICAgIFtpZCBpbiBrZXlvZiBSZXF1aXJlZDxUPl06IFBhcnRpYWw8Rm9ybS5JdGVtUHJvcHM8VFtpZF0+PiAmIHtcbiAgICAgIGlkOiBzdHJpbmc7XG4gICAgfTtcbiAgfTtcbiAgLyoqIEZ1bmN0aW9uIHRoYXQgY2FuIGJlIHVzZWQgdG8gcHJvZ3JhbW1hdGljYWxseSBzZXQgdGhlIHZhbGlkYXRpb24gb2YgYSBzcGVjaWZpYyBmaWVsZC4gKi9cbiAgc2V0VmFsaWRhdGlvbkVycm9yOiAoaWQ6IGtleW9mIFQsIGVycm9yOiBWYWxpZGF0aW9uRXJyb3IpID0+IHZvaWQ7XG4gIC8qKiBGdW5jdGlvbiB0aGF0IGNhbiBiZSB1c2VkIHRvIHByb2dyYW1tYXRpY2FsbHkgc2V0IHRoZSB2YWx1ZSBvZiBhIHNwZWNpZmljIGZpZWxkLiAqL1xuICBzZXRWYWx1ZTogPEsgZXh0ZW5kcyBrZXlvZiBUPihpZDogSywgdmFsdWU6IFNldFN0YXRlQWN0aW9uPFRbS10+KSA9PiB2b2lkO1xuICAvKiogVGhlIGN1cnJlbnQgdmFsdWVzIG9mIHRoZSBmb3JtLiAqL1xuICB2YWx1ZXM6IFQ7XG4gIC8qKiBGdW5jdGlvbiB0aGF0IGNhbiBiZSB1c2VkIHRvIHByb2dyYW1tYXRpY2FsbHkgZm9jdXMgYSBzcGVjaWZpYyBmaWVsZC4gKi9cbiAgZm9jdXM6IChpZDoga2V5b2YgVCkgPT4gdm9pZDtcbiAgLyoqIEZ1bmN0aW9uIHRoYXQgY2FuIGJlIHVzZWQgdG8gcmVzZXQgdGhlIHZhbHVlcyBvZiB0aGUgRm9ybS4gKi9cbiAgcmVzZXQ6IChpbml0aWFsVmFsdWVzPzogUGFydGlhbDxUPikgPT4gdm9pZDtcbn1cblxuLyoqXG4gKiBIb29rIHRoYXQgcHJvdmlkZXMgYSBoaWdoLWxldmVsIGludGVyZmFjZSB0byB3b3JrIHdpdGggRm9ybXMsIGFuZCBtb3JlIHBhcnRpY3VsYXJseSwgd2l0aCBGb3JtIHZhbGlkYXRpb25zLiBJdCBpbmNvcnBvcmF0ZXMgYWxsIHRoZSBnb29kIHByYWN0aWNlcyB0byBwcm92aWRlIGEgZ3JlYXQgVXNlciBFeHBlcmllbmNlIGZvciB5b3VyIEZvcm1zLlxuICpcbiAqIEByZXR1cm5zIGFuIG9iamVjdCB3aGljaCBjb250YWlucyB0aGUgbmVjZXNzYXJ5IG1ldGhvZHMgYW5kIHByb3BzIHRvIHByb3ZpZGUgYSBnb29kIFVzZXIgRXhwZXJpZW5jZSBpbiB5b3VyIEZvcm0uXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYFxuICogaW1wb3J0IHsgQWN0aW9uLCBBY3Rpb25QYW5lbCwgRm9ybSwgc2hvd1RvYXN0LCBUb2FzdCB9IGZyb20gXCJAcmF5Y2FzdC9hcGlcIjtcbiAqIGltcG9ydCB7IHVzZUZvcm0sIEZvcm1WYWxpZGF0aW9uIH0gZnJvbSBcIkByYXljYXN0L3V0aWxzXCI7XG4gKlxuICogaW50ZXJmYWNlIFNpZ25VcEZvcm1WYWx1ZXMge1xuICogICBuaWNrbmFtZTogc3RyaW5nO1xuICogICBwYXNzd29yZDogc3RyaW5nO1xuICogfVxuICpcbiAqIGV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIENvbW1hbmQoKSB7XG4gKiAgIGNvbnN0IHsgaGFuZGxlU3VibWl0LCBpdGVtUHJvcHMgfSA9IHVzZUZvcm08U2lnblVwRm9ybVZhbHVlcz4oe1xuICogICAgIG9uU3VibWl0KHZhbHVlcykge1xuICogICAgICAgc2hvd1RvYXN0KFRvYXN0LlN0eWxlLlN1Y2Nlc3MsIFwiWWF5IVwiLCBgJHt2YWx1ZXMubmlja25hbWV9IGFjY291bnQgY3JlYXRlZGApO1xuICogICAgIH0sXG4gKiAgICAgdmFsaWRhdGlvbjoge1xuICogICAgICAgbmlja25hbWU6IEZvcm1WYWxpZGF0aW9uLlJlcXVpcmVkLFxuICogICAgICAgcGFzc3dvcmQ6ICh2YWx1ZSkgPT4ge1xuICogICAgICAgICBpZiAodmFsdWUgJiYgdmFsdWUubGVuZ3RoIDwgOCkge1xuICogICAgICAgICAgIHJldHVybiBcIlBhc3N3b3JkIG11c3QgYmUgYXQgbGVhc3QgOCBzeW1ib2xzXCI7XG4gKiAgICAgICAgIH0gZWxzZSBpZiAoIXZhbHVlKSB7XG4gKiAgICAgICAgICAgcmV0dXJuIFwiVGhlIGl0ZW0gaXMgcmVxdWlyZWRcIjtcbiAqICAgICAgICAgfVxuICogICAgICAgfSxcbiAqICAgICB9LFxuICogICB9KTtcbiAqXG4gKiAgIHJldHVybiAoXG4gKiAgICAgPEZvcm1cbiAqICAgICAgIGFjdGlvbnM9e1xuICogICAgICAgICA8QWN0aW9uUGFuZWw+XG4gKiAgICAgICAgICAgPEFjdGlvbi5TdWJtaXRGb3JtIHRpdGxlPVwiU3VibWl0XCIgb25TdWJtaXQ9e2hhbmRsZVN1Ym1pdH0gLz5cbiAqICAgICAgICAgPC9BY3Rpb25QYW5lbD5cbiAqICAgICAgIH1cbiAqICAgICA+XG4gKiAgICAgICA8Rm9ybS5UZXh0RmllbGQgdGl0bGU9XCJOaWNrbmFtZVwiIHBsYWNlaG9sZGVyPVwiRW50ZXIgeW91ciBuaWNrbmFtZVwiIHsuLi5pdGVtUHJvcHMubmlja25hbWV9IC8+XG4gKiAgICAgICA8Rm9ybS5QYXNzd29yZEZpZWxkXG4gKiAgICAgICAgIHRpdGxlPVwiUGFzc3dvcmRcIlxuICogICAgICAgICBwbGFjZWhvbGRlcj1cIkVudGVyIHBhc3N3b3JkIGF0IGxlYXN0IDggY2hhcmFjdGVycyBsb25nXCJcbiAqICAgICAgICAgey4uLml0ZW1Qcm9wcy5wYXNzd29yZH1cbiAqICAgICAgIC8+XG4gKiAgICAgPC9Gb3JtPlxuICogICApO1xuICogfVxuICogYGBgXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB1c2VGb3JtPFQgZXh0ZW5kcyBGb3JtLlZhbHVlcz4ocHJvcHM6IHtcbiAgLyoqIENhbGxiYWNrIHRoYXQgd2lsbCBiZSBjYWxsZWQgd2hlbiB0aGUgZm9ybSBpcyBzdWJtaXR0ZWQgYW5kIGFsbCB2YWxpZGF0aW9ucyBwYXNzLiAqL1xuICBvblN1Ym1pdDogKHZhbHVlczogVCkgPT4gdm9pZCB8IGJvb2xlYW4gfCBQcm9taXNlPHZvaWQgfCBib29sZWFuPjtcbiAgLyoqIFRoZSBpbml0aWFsIHZhbHVlcyB0byBzZXQgd2hlbiB0aGUgRm9ybSBpcyBmaXJzdCByZW5kZXJlZC4gKi9cbiAgaW5pdGlhbFZhbHVlcz86IFBhcnRpYWw8VD47XG4gIC8qKiBUaGUgdmFsaWRhdGlvbiBydWxlcyBmb3IgdGhlIEZvcm0uIEEgdmFsaWRhdGlvbiBmb3IgYSBGb3JtIGl0ZW0gaXMgYSBmdW5jdGlvbiB0aGF0IHRha2VzIHRoZSBjdXJyZW50IHZhbHVlIG9mIHRoZSBpdGVtIGFzIGFuIGFyZ3VtZW50IGFuZCBtdXN0IHJldHVybiBhIHN0cmluZyB3aGVuIHRoZSB2YWxpZGF0aW9uIGlzIGZhaWxpbmcuXG4gICAqXG4gICAqIFRoZXJlIGFyZSBhbHNvIHNvbWUgc2hvcnRoYW5kcyBmb3IgY29tbW9uIGNhc2VzLCBzZWUge0BsaW5rIEZvcm1WYWxpZGF0aW9ufS5cbiAgICogKi9cbiAgdmFsaWRhdGlvbj86IFZhbGlkYXRpb248VD47XG59KTogRm9ybVByb3BzPFQ+IHtcbiAgY29uc3QgeyBvblN1Ym1pdDogX29uU3VibWl0LCB2YWxpZGF0aW9uLCBpbml0aWFsVmFsdWVzID0ge30gfSA9IHByb3BzO1xuXG4gIC8vIEB0cy1leHBlY3QtZXJyb3IgaXQncyBmaW5lIGlmIHdlIGRvbid0IHNwZWNpZnkgYWxsIHRoZSB2YWx1ZXNcbiAgY29uc3QgW3ZhbHVlcywgc2V0VmFsdWVzXSA9IHVzZVN0YXRlPFQ+KGluaXRpYWxWYWx1ZXMpO1xuICBjb25zdCBbZXJyb3JzLCBzZXRFcnJvcnNdID0gdXNlU3RhdGU8eyBbaWQgaW4ga2V5b2YgVF0/OiBWYWxpZGF0aW9uRXJyb3IgfT4oe30pO1xuICBjb25zdCByZWZzID0gdXNlUmVmPHsgW2lkIGluIGtleW9mIFRdPzogRm9ybS5JdGVtUmVmZXJlbmNlIH0+KHt9KTtcblxuICBjb25zdCBsYXRlc3RWYWxpZGF0aW9uID0gdXNlTGF0ZXN0PFZhbGlkYXRpb248VD4+KHZhbGlkYXRpb24gfHwge30pO1xuICBjb25zdCBsYXRlc3RPblN1Ym1pdCA9IHVzZUxhdGVzdChfb25TdWJtaXQpO1xuXG4gIGNvbnN0IGZvY3VzID0gdXNlQ2FsbGJhY2soXG4gICAgKGlkOiBrZXlvZiBUKSA9PiB7XG4gICAgICByZWZzLmN1cnJlbnRbaWRdPy5mb2N1cygpO1xuICAgIH0sXG4gICAgW3JlZnNdLFxuICApO1xuXG4gIGNvbnN0IGhhbmRsZVN1Ym1pdCA9IHVzZUNhbGxiYWNrKFxuICAgIGFzeW5jICh2YWx1ZXM6IFQpOiBQcm9taXNlPGJvb2xlYW4+ID0+IHtcbiAgICAgIGxldCB2YWxpZGF0aW9uRXJyb3JzOiBmYWxzZSB8IHsgW2tleSBpbiBrZXlvZiBUXT86IFZhbGlkYXRpb25FcnJvciB9ID0gZmFsc2U7XG4gICAgICBmb3IgKGNvbnN0IFtpZCwgdmFsaWRhdGlvbl0gb2YgT2JqZWN0LmVudHJpZXMobGF0ZXN0VmFsaWRhdGlvbi5jdXJyZW50KSkge1xuICAgICAgICBjb25zdCBlcnJvciA9IHZhbGlkYXRpb25FcnJvcih2YWxpZGF0aW9uLCB2YWx1ZXNbaWRdKTtcbiAgICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgICAgaWYgKCF2YWxpZGF0aW9uRXJyb3JzKSB7XG4gICAgICAgICAgICB2YWxpZGF0aW9uRXJyb3JzID0ge307XG4gICAgICAgICAgICAvLyB3ZSBmb2N1cyB0aGUgZmlyc3QgaXRlbSB0aGF0IGhhcyBhbiBlcnJvclxuICAgICAgICAgICAgZm9jdXMoaWQpO1xuICAgICAgICAgIH1cbiAgICAgICAgICB2YWxpZGF0aW9uRXJyb3JzW2lkIGFzIGtleW9mIFRdID0gZXJyb3I7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmICh2YWxpZGF0aW9uRXJyb3JzKSB7XG4gICAgICAgIHNldEVycm9ycyh2YWxpZGF0aW9uRXJyb3JzKTtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgbGF0ZXN0T25TdWJtaXQuY3VycmVudCh2YWx1ZXMpO1xuICAgICAgcmV0dXJuIHR5cGVvZiByZXN1bHQgPT09IFwiYm9vbGVhblwiID8gcmVzdWx0IDogdHJ1ZTtcbiAgICB9LFxuICAgIFtsYXRlc3RWYWxpZGF0aW9uLCBsYXRlc3RPblN1Ym1pdCwgZm9jdXNdLFxuICApO1xuXG4gIGNvbnN0IHNldFZhbGlkYXRpb25FcnJvciA9IHVzZUNhbGxiYWNrKFxuICAgIChpZDoga2V5b2YgVCwgZXJyb3I6IFZhbGlkYXRpb25FcnJvcikgPT4ge1xuICAgICAgc2V0RXJyb3JzKChlcnJvcnMpID0+ICh7IC4uLmVycm9ycywgW2lkXTogZXJyb3IgfSkpO1xuICAgIH0sXG4gICAgW3NldEVycm9yc10sXG4gICk7XG5cbiAgY29uc3Qgc2V0VmFsdWUgPSB1c2VDYWxsYmFjayhcbiAgICBmdW5jdGlvbiA8SyBleHRlbmRzIGtleW9mIFQ+KGlkOiBLLCB2YWx1ZTogU2V0U3RhdGVBY3Rpb248VFtLXT4pIHtcbiAgICAgIC8vIEB0cy1leHBlY3QtZXJyb3IgVFMgaXMgYWx3YXlzIGNvbmZ1c2VkIGFib3V0IFNldFN0YXRlQWN0aW9uLCBidXQgaXQncyBmaW5lIGhlcmVcbiAgICAgIHNldFZhbHVlcygodmFsdWVzKSA9PiAoeyAuLi52YWx1ZXMsIFtpZF06IHR5cGVvZiB2YWx1ZSA9PT0gXCJmdW5jdGlvblwiID8gdmFsdWUodmFsdWVzW2lkXSkgOiB2YWx1ZSB9KSk7XG4gICAgfSxcbiAgICBbc2V0VmFsdWVzXSxcbiAgKTtcblxuICBjb25zdCBpdGVtUHJvcHMgPSB1c2VNZW1vPHsgW2lkIGluIGtleW9mIFJlcXVpcmVkPFQ+XTogUGFydGlhbDxGb3JtLkl0ZW1Qcm9wczxUW2lkXT4+ICYgeyBpZDogc3RyaW5nIH0gfT4oKCkgPT4ge1xuICAgIC8vIHdlIGhhdmUgdG8gdXNlIGEgcHJveHkgYmVjYXVzZSB3ZSBkb24ndCBhY3R1YWxseSBoYXZlIGFueSBvYmplY3QgdG8gaXRlcmF0ZSB0aHJvdWdoXG4gICAgLy8gc28gaW5zdGVhZCB3ZSBkeW5hbWljYWxseSBjcmVhdGUgdGhlIHByb3BzIHdoZW4gcmVxdWlyZWRcbiAgICByZXR1cm4gbmV3IFByb3h5PHsgW2lkIGluIGtleW9mIFJlcXVpcmVkPFQ+XTogUGFydGlhbDxGb3JtLkl0ZW1Qcm9wczxUW2lkXT4+ICYgeyBpZDogc3RyaW5nIH0gfT4oXG4gICAgICAvLyBAdHMtZXhwZWN0LWVycm9yIHRoZSB3aG9sZSBwb2ludCBvZiBhIHByb3h5Li4uXG4gICAgICB7fSxcbiAgICAgIHtcbiAgICAgICAgZ2V0KHRhcmdldCwgaWQ6IGtleW9mIFQpIHtcbiAgICAgICAgICBjb25zdCB2YWxpZGF0aW9uID0gbGF0ZXN0VmFsaWRhdGlvbi5jdXJyZW50W2lkXTtcbiAgICAgICAgICBjb25zdCB2YWx1ZSA9IHZhbHVlc1tpZF07XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIG9uQ2hhbmdlKHZhbHVlKSB7XG4gICAgICAgICAgICAgIGlmIChlcnJvcnNbaWRdKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZXJyb3IgPSB2YWxpZGF0aW9uRXJyb3IodmFsaWRhdGlvbiwgdmFsdWUpO1xuICAgICAgICAgICAgICAgIGlmICghZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgIHNldFZhbGlkYXRpb25FcnJvcihpZCwgdW5kZWZpbmVkKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgc2V0VmFsdWUoaWQsIHZhbHVlKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBvbkJsdXIoZXZlbnQpIHtcbiAgICAgICAgICAgICAgY29uc3QgZXJyb3IgPSB2YWxpZGF0aW9uRXJyb3IodmFsaWRhdGlvbiwgZXZlbnQudGFyZ2V0LnZhbHVlKTtcbiAgICAgICAgICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgc2V0VmFsaWRhdGlvbkVycm9yKGlkLCBlcnJvcik7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBlcnJvcjogZXJyb3JzW2lkXSxcbiAgICAgICAgICAgIGlkLFxuICAgICAgICAgICAgLy8gd2Ugc2hvdWxkbid0IHJldHVybiBgdW5kZWZpbmVkYCBvdGhlcndpc2UgaXQgd2lsbCBiZSBhbiB1bmNvbnRyb2xsZWQgY29tcG9uZW50XG4gICAgICAgICAgICB2YWx1ZTogdHlwZW9mIHZhbHVlID09PSBcInVuZGVmaW5lZFwiID8gbnVsbCA6IHZhbHVlLFxuICAgICAgICAgICAgcmVmOiAoaW5zdGFuY2U6IEZvcm0uSXRlbVJlZmVyZW5jZSkgPT4ge1xuICAgICAgICAgICAgICByZWZzLmN1cnJlbnRbaWRdID0gaW5zdGFuY2U7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0gYXMgUGFydGlhbDxGb3JtLkl0ZW1Qcm9wczxUW2tleW9mIFRdPj4gJiB7IGlkOiBzdHJpbmcgfTtcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgKTtcbiAgfSwgW2Vycm9ycywgbGF0ZXN0VmFsaWRhdGlvbiwgc2V0VmFsaWRhdGlvbkVycm9yLCB2YWx1ZXMsIHJlZnMsIHNldFZhbHVlXSk7XG5cbiAgY29uc3QgcmVzZXQgPSB1c2VDYWxsYmFjayhcbiAgICAodmFsdWVzPzogUGFydGlhbDxUPikgPT4ge1xuICAgICAgc2V0RXJyb3JzKHt9KTtcbiAgICAgIE9iamVjdC5lbnRyaWVzKHJlZnMuY3VycmVudCkuZm9yRWFjaCgoW2lkLCByZWZdKSA9PiB7XG4gICAgICAgIGlmICghdmFsdWVzPy5baWRdKSB7XG4gICAgICAgICAgcmVmPy5yZXNldCgpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIGlmICh2YWx1ZXMpIHtcbiAgICAgICAgLy8gQHRzLWV4cGVjdC1lcnJvciBpdCdzIGZpbmUgaWYgd2UgZG9uJ3Qgc3BlY2lmeSBhbGwgdGhlIHZhbHVlc1xuICAgICAgICBzZXRWYWx1ZXModmFsdWVzKTtcbiAgICAgIH1cbiAgICB9LFxuICAgIFtzZXRWYWx1ZXMsIHNldEVycm9ycywgcmVmc10sXG4gICk7XG5cbiAgcmV0dXJuIHsgaGFuZGxlU3VibWl0LCBzZXRWYWxpZGF0aW9uRXJyb3IsIHNldFZhbHVlLCB2YWx1ZXMsIGl0ZW1Qcm9wcywgZm9jdXMsIHJlc2V0IH07XG59XG4iLCAiaW1wb3J0IHsgdXNlUmVmLCB1c2VTdGF0ZSB9IGZyb20gXCJyZWFjdFwiO1xuaW1wb3J0IHsgQUkgfSBmcm9tIFwiQHJheWNhc3QvYXBpXCI7XG5pbXBvcnQgeyBQcm9taXNlT3B0aW9ucywgdXNlUHJvbWlzZSB9IGZyb20gXCIuL3VzZVByb21pc2VcIjtcbmltcG9ydCB7IEZ1bmN0aW9uUmV0dXJuaW5nUHJvbWlzZSB9IGZyb20gXCIuL3R5cGVzXCI7XG5cbi8qKlxuICogU3RyZWFtIGEgcHJvbXB0IGNvbXBsZXRpb24uXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYHR5cGVzY3JpcHRcbiAqIGltcG9ydCB7IERldGFpbCwgTGF1bmNoUHJvcHMgfSBmcm9tIFwiQHJheWNhc3QvYXBpXCI7XG4gKiBpbXBvcnQgeyB1c2UgQUkgfSBmcm9tIFwiQHJheWNhc3QvdXRpbHNcIjtcbiAqXG4gKiBleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBDb21tYW5kKHByb3BzOiBMYXVuY2hQcm9wczx7IGFyZ3VtZW50czogeyBwcm9tcHQ6IHN0cmluZyB9IH0+KSB7XG4gKiAgIGNvbnN0IHsgaXNMb2FkaW5nLCBkYXRhIH0gPSB1c2VBSShwcm9wcy5hcmd1bWVudHMucHJvbXB0KTtcbiAqXG4gKiAgIHJldHVybiA8RGV0YWlsIGlzTG9hZGluZz17aXNMb2FkaW5nfSBtYXJrZG93bj17ZGF0YX0gLz47XG4gKiB9XG4gKiBgYGBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHVzZUFJKFxuICBwcm9tcHQ6IHN0cmluZyxcbiAgb3B0aW9uczoge1xuICAgIC8qKlxuICAgICAqIENvbmNyZXRlIHRhc2tzLCBzdWNoIGFzIGZpeGluZyBncmFtbWFyLCByZXF1aXJlIGxlc3MgY3JlYXRpdml0eSB3aGlsZSBvcGVuLWVuZGVkIHF1ZXN0aW9ucywgc3VjaCBhcyBnZW5lcmF0aW5nIGlkZWFzLCByZXF1aXJlIG1vcmUuXG4gICAgICogSWYgYSBudW1iZXIgaXMgcGFzc2VkLCBpdCBuZWVkcyB0byBiZSBpbiB0aGUgcmFuZ2UgMC0yLiBGb3IgbGFyZ2VyIHZhbHVlcywgMiB3aWxsIGJlIHVzZWQuIEZvciBsb3dlciB2YWx1ZXMsIDAgd2lsbCBiZSB1c2VkLlxuICAgICAqL1xuICAgIGNyZWF0aXZpdHk/OiBBSS5DcmVhdGl2aXR5O1xuICAgIC8qKlxuICAgICAqIFRoZSBBSSBtb2RlbCB0byB1c2UgdG8gYW5zd2VyIHRvIHRoZSBwcm9tcHQuXG4gICAgICovXG4gICAgbW9kZWw/OiBBSS5Nb2RlbDtcbiAgICAvKipcbiAgICAgKiBXaGV0aGVyIHRvIHN0cmVhbSB0aGUgYW5zd2VyIG9yIG9ubHkgdXBkYXRlIHRoZSBkYXRhIHdoZW4gdGhlIGVudGlyZSBhbnN3ZXIgaGFzIGJlZW4gcmVjZWl2ZWQuXG4gICAgICovXG4gICAgc3RyZWFtPzogYm9vbGVhbjtcbiAgfSAmIE9taXQ8UHJvbWlzZU9wdGlvbnM8RnVuY3Rpb25SZXR1cm5pbmdQcm9taXNlPiwgXCJhYm9ydGFibGVcIj4gPSB7fSxcbikge1xuICBjb25zdCB7IGNyZWF0aXZpdHksIHN0cmVhbSwgbW9kZWwsIC4uLnVzZVByb21pc2VPcHRpb25zIH0gPSBvcHRpb25zO1xuICBjb25zdCBbZGF0YSwgc2V0RGF0YV0gPSB1c2VTdGF0ZShcIlwiKTtcbiAgY29uc3QgYWJvcnRhYmxlID0gdXNlUmVmPEFib3J0Q29udHJvbGxlcj4obnVsbCk7XG4gIGNvbnN0IHsgaXNMb2FkaW5nLCBlcnJvciwgcmV2YWxpZGF0ZSB9ID0gdXNlUHJvbWlzZShcbiAgICBhc3luYyAocHJvbXB0OiBzdHJpbmcsIGNyZWF0aXZpdHk/OiBBSS5DcmVhdGl2aXR5LCBzaG91bGRTdHJlYW0/OiBib29sZWFuKSA9PiB7XG4gICAgICBzZXREYXRhKFwiXCIpO1xuICAgICAgY29uc3Qgc3RyZWFtID0gQUkuYXNrKHByb21wdCwgeyBjcmVhdGl2aXR5LCBtb2RlbCwgc2lnbmFsOiBhYm9ydGFibGUuY3VycmVudD8uc2lnbmFsIH0pO1xuICAgICAgaWYgKHNob3VsZFN0cmVhbSA9PT0gZmFsc2UpIHtcbiAgICAgICAgc2V0RGF0YShhd2FpdCBzdHJlYW0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc3RyZWFtLm9uKFwiZGF0YVwiLCAoZGF0YSkgPT4ge1xuICAgICAgICAgIHNldERhdGEoKHgpID0+IHggKyBkYXRhKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGF3YWl0IHN0cmVhbTtcbiAgICAgIH1cbiAgICB9LFxuICAgIFtwcm9tcHQsIGNyZWF0aXZpdHksIHN0cmVhbV0sXG4gICAgeyAuLi51c2VQcm9taXNlT3B0aW9ucywgYWJvcnRhYmxlIH0sXG4gICk7XG5cbiAgcmV0dXJuIHsgaXNMb2FkaW5nLCBkYXRhLCBlcnJvciwgcmV2YWxpZGF0ZSB9O1xufVxuIiwgImltcG9ydCB7IHVzZU1lbW8sIHVzZUNhbGxiYWNrIH0gZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgeyB1c2VMYXRlc3QgfSBmcm9tIFwiLi91c2VMYXRlc3RcIjtcbmltcG9ydCB7IHVzZUNhY2hlZFN0YXRlIH0gZnJvbSBcIi4vdXNlQ2FjaGVkU3RhdGVcIjtcblxuLy8gVGhlIGFsZ29yaXRobSBiZWxvdyBpcyBpbnNwaXJlZCBieSB0aGUgb25lIHVzZWQgYnkgRmlyZWZveDpcbi8vIGh0dHBzOi8vd2lraS5tb3ppbGxhLm9yZy9Vc2VyOkplc3NlL05ld0ZyZWNlbmN5XG5cbnR5cGUgRnJlY2VuY3kgPSB7XG4gIGxhc3RWaXNpdGVkOiBudW1iZXI7XG4gIGZyZWNlbmN5OiBudW1iZXI7XG59O1xuXG5jb25zdCBIQUxGX0xJRkVfREFZUyA9IDEwO1xuXG5jb25zdCBNU19QRVJfREFZID0gMjQgKiA2MCAqIDYwICogMTAwMDtcblxuY29uc3QgVklTSVRfVFlQRV9QT0lOVFMgPSB7XG4gIERlZmF1bHQ6IDEwMCxcbiAgRW1iZWQ6IDAsXG4gIEJvb2ttYXJrOiAxNDAsXG59O1xuXG5mdW5jdGlvbiBnZXROZXdGcmVjZW5jeShpdGVtPzogRnJlY2VuY3kpOiBGcmVjZW5jeSB7XG4gIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XG4gIGNvbnN0IGxhc3RWaXNpdGVkID0gaXRlbSA/IGl0ZW0ubGFzdFZpc2l0ZWQgOiAwO1xuICBjb25zdCBmcmVjZW5jeSA9IGl0ZW0gPyBpdGVtLmZyZWNlbmN5IDogMDtcblxuICBjb25zdCB2aXNpdEFnZUluRGF5cyA9IChub3cgLSBsYXN0VmlzaXRlZCkgLyBNU19QRVJfREFZO1xuICBjb25zdCBERUNBWV9SQVRFX0NPTlNUQU5UID0gTWF0aC5sb2coMikgLyAoSEFMRl9MSUZFX0RBWVMgKiBNU19QRVJfREFZKTtcbiAgY29uc3QgY3VycmVudFZpc2l0VmFsdWUgPSBWSVNJVF9UWVBFX1BPSU5UUy5EZWZhdWx0ICogTWF0aC5leHAoLURFQ0FZX1JBVEVfQ09OU1RBTlQgKiB2aXNpdEFnZUluRGF5cyk7XG4gIGNvbnN0IHRvdGFsVmlzaXRWYWx1ZSA9IGZyZWNlbmN5ICsgY3VycmVudFZpc2l0VmFsdWU7XG5cbiAgcmV0dXJuIHtcbiAgICBsYXN0VmlzaXRlZDogbm93LFxuICAgIGZyZWNlbmN5OiB0b3RhbFZpc2l0VmFsdWUsXG4gIH07XG59XG5cbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG5jb25zdCBkZWZhdWx0S2V5ID0gKGl0ZW06IGFueSk6IHN0cmluZyA9PiB7XG4gIGlmIChcbiAgICBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIgJiZcbiAgICAodHlwZW9mIGl0ZW0gIT09IFwib2JqZWN0XCIgfHwgIWl0ZW0gfHwgIShcImlkXCIgaW4gaXRlbSkgfHwgdHlwZW9mIGl0ZW0uaWQgIT0gXCJzdHJpbmdcIilcbiAgKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiU3BlY2lmeSBhIGtleSBmdW5jdGlvbiBvciBtYWtlIHN1cmUgeW91ciBpdGVtcyBoYXZlIGFuICdpZCcgcHJvcGVydHlcIik7XG4gIH1cbiAgcmV0dXJuIGl0ZW0uaWQ7XG59O1xuXG4vKipcbiAqIFNvcnQgYW4gYXJyYXkgYnkgaXRzIGZyZWNlbmN5IGFuZCBwcm92aWRlIG1ldGhvZHMgdG8gdXBkYXRlIHRoZSBmcmVjZW5jeSBvZiBpdHMgaXRlbXMuXG4gKiBGcmVjZW5jeSBpcyBhIG1lYXN1cmUgdGhhdCBjb21iaW5lcyBmcmVxdWVuY3kgYW5kIHJlY2VuY3kuIFRoZSBtb3JlIG9mdGVuIGFuIGl0ZW0gaXMgdmlzaXRlZC91c2VkLCBhbmQgdGhlIG1vcmUgcmVjZW50bHkgYW4gaXRlbSBpcyB2aXNpdGVkL3VzZWQsIHRoZSBoaWdoZXIgaXQgd2lsbCByYW5rLlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGBcbiAqIGltcG9ydCB7IExpc3QsIEFjdGlvblBhbmVsLCBBY3Rpb24sIEljb24gfSBmcm9tIFwiQHJheWNhc3QvYXBpXCI7XG4gKiBpbXBvcnQgeyB1c2VGZXRjaCwgdXNlRnJlY2VuY3lTb3J0aW5nIH0gZnJvbSBcIkByYXljYXN0L3V0aWxzXCI7XG4gKlxuICogZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gQ29tbWFuZCgpIHtcbiAqICAgY29uc3QgeyBpc0xvYWRpbmcsIGRhdGEgfSA9IHVzZUZldGNoKFwiaHR0cHM6Ly9hcGkuZXhhbXBsZVwiKTtcbiAqICAgY29uc3QgeyBkYXRhOiBzb3J0ZWREYXRhLCB2aXNpdEl0ZW0sIHJlc2V0UmFua2luZyB9ID0gdXNlRnJlY2VuY3lTb3J0aW5nKGRhdGEpO1xuICpcbiAqICAgcmV0dXJuIChcbiAqICAgICA8TGlzdCBpc0xvYWRpbmc9e2lzTG9hZGluZ30+XG4gKiAgICAgICB7c29ydGVkRGF0YS5tYXAoKGl0ZW0pID0+IChcbiAqICAgICAgICAgPExpc3QuSXRlbVxuICogICAgICAgICAgIGtleT17aXRlbS5pZH1cbiAqICAgICAgICAgICB0aXRsZT17aXRlbS50aXRsZX1cbiAqICAgICAgICAgICBhY3Rpb25zPXtcbiAqICAgICAgICAgICAgIDxBY3Rpb25QYW5lbD5cbiAqICAgICAgICAgICAgICAgPEFjdGlvbi5PcGVuSW5Ccm93c2VyIHVybD17aXRlbS51cmx9IG9uT3Blbj17KCkgPT4gdmlzaXRJdGVtKGl0ZW0pfSAvPlxuICogICAgICAgICAgICAgICA8QWN0aW9uLkNvcHlUb0NsaXBib2FyZCB0aXRsZT1cIkNvcHkgTGlua1wiIGNvbnRlbnQ9e2l0ZW0udXJsfSBvbkNvcHk9eygpID0+IHZpc2l0SXRlbShpdGVtKX0gLz5cbiAqICAgICAgICAgICAgICAgPEFjdGlvbiB0aXRsZT1cIlJlc2V0IFJhbmtpbmdcIiBpY29uPXtJY29uLkFycm93Q291bnRlckNsb2Nrd2lzZX0gb25BY3Rpb249eygpID0+IHJlc2V0UmFua2luZyhpdGVtKX0gLz5cbiAqICAgICAgICAgICAgIDwvQWN0aW9uUGFuZWw+XG4gKiAgICAgICAgICAgfVxuICogICAgICAgICAvPlxuICogICAgICAgKSl9XG4gKiAgICAgPC9MaXN0PlxuICogICApO1xuICogfTtcbiAqIGBgYFxuICovXG5leHBvcnQgZnVuY3Rpb24gdXNlRnJlY2VuY3lTb3J0aW5nPFQgZXh0ZW5kcyB7IGlkOiBzdHJpbmcgfT4oXG4gIGRhdGE/OiBUW10sXG4gIG9wdGlvbnM/OiB7IG5hbWVzcGFjZT86IHN0cmluZzsga2V5PzogKGl0ZW06IFQpID0+IHN0cmluZzsgc29ydFVudmlzaXRlZD86IChhOiBULCBiOiBUKSA9PiBudW1iZXIgfSxcbik6IHtcbiAgZGF0YTogVFtdO1xuICB2aXNpdEl0ZW06IChpdGVtOiBUKSA9PiBQcm9taXNlPHZvaWQ+O1xuICByZXNldFJhbmtpbmc6IChpdGVtOiBUKSA9PiBQcm9taXNlPHZvaWQ+O1xufTtcbmV4cG9ydCBmdW5jdGlvbiB1c2VGcmVjZW5jeVNvcnRpbmc8VD4oXG4gIGRhdGE6IFRbXSB8IHVuZGVmaW5lZCxcbiAgb3B0aW9uczogeyBuYW1lc3BhY2U/OiBzdHJpbmc7IGtleTogKGl0ZW06IFQpID0+IHN0cmluZzsgc29ydFVudmlzaXRlZD86IChhOiBULCBiOiBUKSA9PiBudW1iZXIgfSxcbik6IHtcbiAgZGF0YTogVFtdO1xuICB2aXNpdEl0ZW06IChpdGVtOiBUKSA9PiBQcm9taXNlPHZvaWQ+O1xuICByZXNldFJhbmtpbmc6IChpdGVtOiBUKSA9PiBQcm9taXNlPHZvaWQ+O1xufTtcbmV4cG9ydCBmdW5jdGlvbiB1c2VGcmVjZW5jeVNvcnRpbmc8VD4oXG4gIGRhdGE/OiBUW10sXG4gIG9wdGlvbnM/OiB7IG5hbWVzcGFjZT86IHN0cmluZzsga2V5PzogKGl0ZW06IFQpID0+IHN0cmluZzsgc29ydFVudmlzaXRlZD86IChhOiBULCBiOiBUKSA9PiBudW1iZXIgfSxcbik6IHtcbiAgZGF0YTogVFtdO1xuICB2aXNpdEl0ZW06IChpdGVtOiBUKSA9PiBQcm9taXNlPHZvaWQ+O1xuICByZXNldFJhbmtpbmc6IChpdGVtOiBUKSA9PiBQcm9taXNlPHZvaWQ+O1xufSB7XG4gIGNvbnN0IGtleVJlZiA9IHVzZUxhdGVzdChvcHRpb25zPy5rZXkgfHwgZGVmYXVsdEtleSk7XG4gIGNvbnN0IHNvcnRVbnZpc2l0ZWRSZWYgPSB1c2VMYXRlc3Qob3B0aW9ucz8uc29ydFVudmlzaXRlZCk7XG5cbiAgY29uc3QgW3N0b3JlZEZyZWNlbmNpZXMsIHNldFN0b3JlZEZyZWNlbmNpZXNdID0gdXNlQ2FjaGVkU3RhdGU8UmVjb3JkPHN0cmluZywgRnJlY2VuY3kgfCB1bmRlZmluZWQ+PihcbiAgICBgcmF5Y2FzdF9mcmVjZW5jeV8ke29wdGlvbnM/Lm5hbWVzcGFjZX1gLFxuICAgIHt9LFxuICApO1xuXG4gIGNvbnN0IHZpc2l0SXRlbSA9IHVzZUNhbGxiYWNrKFxuICAgIGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUZyZWNlbmN5KGl0ZW06IFQpIHtcbiAgICAgIGNvbnN0IGl0ZW1LZXkgPSBrZXlSZWYuY3VycmVudChpdGVtKTtcblxuICAgICAgc2V0U3RvcmVkRnJlY2VuY2llcygoc3RvcmVkRnJlY2VuY2llcykgPT4ge1xuICAgICAgICBjb25zdCBmcmVjZW5jeSA9IHN0b3JlZEZyZWNlbmNpZXNbaXRlbUtleV07XG4gICAgICAgIGNvbnN0IG5ld0ZyZWNlbmN5ID0gZ2V0TmV3RnJlY2VuY3koZnJlY2VuY3kpO1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgLi4uc3RvcmVkRnJlY2VuY2llcyxcbiAgICAgICAgICBbaXRlbUtleV06IG5ld0ZyZWNlbmN5LFxuICAgICAgICB9O1xuICAgICAgfSk7XG4gICAgfSxcbiAgICBba2V5UmVmLCBzZXRTdG9yZWRGcmVjZW5jaWVzXSxcbiAgKTtcblxuICBjb25zdCByZXNldFJhbmtpbmcgPSB1c2VDYWxsYmFjayhcbiAgICBhc3luYyBmdW5jdGlvbiByZW1vdmVGcmVjZW5jeShpdGVtOiBUKSB7XG4gICAgICBjb25zdCBpdGVtS2V5ID0ga2V5UmVmLmN1cnJlbnQoaXRlbSk7XG5cbiAgICAgIHNldFN0b3JlZEZyZWNlbmNpZXMoKHN0b3JlZEZyZWNlbmNpZXMpID0+IHtcbiAgICAgICAgY29uc3QgbmV3RnJlbmNlbmNpZXMgPSB7IC4uLnN0b3JlZEZyZWNlbmNpZXMgfTtcbiAgICAgICAgZGVsZXRlIG5ld0ZyZW5jZW5jaWVzW2l0ZW1LZXldO1xuXG4gICAgICAgIHJldHVybiBuZXdGcmVuY2VuY2llcztcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgW2tleVJlZiwgc2V0U3RvcmVkRnJlY2VuY2llc10sXG4gICk7XG5cbiAgY29uc3Qgc29ydGVkRGF0YSA9IHVzZU1lbW8oKCkgPT4ge1xuICAgIGlmICghZGF0YSkge1xuICAgICAgcmV0dXJuIFtdO1xuICAgIH1cblxuICAgIHJldHVybiBkYXRhLnNvcnQoKGEsIGIpID0+IHtcbiAgICAgIGNvbnN0IGZyZWNlbmN5QSA9IHN0b3JlZEZyZWNlbmNpZXNba2V5UmVmLmN1cnJlbnQoYSldO1xuICAgICAgY29uc3QgZnJlY2VuY3lCID0gc3RvcmVkRnJlY2VuY2llc1trZXlSZWYuY3VycmVudChiKV07XG5cbiAgICAgIC8vIElmIGEgaGFzIGEgZnJlY2VuY3ksIGJ1dCBiIGRvZXNuJ3QsIGEgc2hvdWxkIGNvbWUgZmlyc3RcbiAgICAgIGlmIChmcmVjZW5jeUEgJiYgIWZyZWNlbmN5Qikge1xuICAgICAgICByZXR1cm4gLTE7XG4gICAgICB9XG5cbiAgICAgIC8vIElmIGIgaGFzIGEgZnJlY2VuY3ksIGJ1dCBhIGRvZXNuJ3QsIGIgc2hvdWxkIGNvbWUgZmlyc3RcbiAgICAgIGlmICghZnJlY2VuY3lBICYmIGZyZWNlbmN5Qikge1xuICAgICAgICByZXR1cm4gMTtcbiAgICAgIH1cblxuICAgICAgLy8gSWYgYm90aCBmcmVjZW5jaWVzIGFyZSBkZWZpbmVkLHB1dCB0aGUgb25lIHdpdGggdGhlIGhpZ2hlciBmcmVjZW5jeSBmaXJzdFxuICAgICAgaWYgKGZyZWNlbmN5QSAmJiBmcmVjZW5jeUIpIHtcbiAgICAgICAgcmV0dXJuIGZyZWNlbmN5Qi5mcmVjZW5jeSAtIGZyZWNlbmN5QS5mcmVjZW5jeTtcbiAgICAgIH1cblxuICAgICAgLy8gSWYgYm90aCBmcmVjZW5jaWVzIGFyZSB1bmRlZmluZWQsIGtlZXAgdGhlIG9yaWdpbmFsIG9yZGVyXG4gICAgICByZXR1cm4gc29ydFVudmlzaXRlZFJlZi5jdXJyZW50ID8gc29ydFVudmlzaXRlZFJlZi5jdXJyZW50KGEsIGIpIDogMDtcbiAgICB9KTtcbiAgfSwgW3N0b3JlZEZyZWNlbmNpZXMsIGRhdGEsIGtleVJlZiwgc29ydFVudmlzaXRlZFJlZl0pO1xuXG4gIHJldHVybiB7IGRhdGE6IHNvcnRlZERhdGEsIHZpc2l0SXRlbSwgcmVzZXRSYW5raW5nIH07XG59XG4iLCAiaW1wb3J0IHsgTG9jYWxTdG9yYWdlIH0gZnJvbSBcIkByYXljYXN0L2FwaVwiO1xuaW1wb3J0IHsgc2hvd0ZhaWx1cmVUb2FzdCB9IGZyb20gXCIuL3Nob3dGYWlsdXJlVG9hc3RcIjtcbmltcG9ydCB7IHJlcGxhY2VyLCByZXZpdmVyIH0gZnJvbSBcIi4vaGVscGVyc1wiO1xuaW1wb3J0IHsgdXNlUHJvbWlzZSB9IGZyb20gXCIuL3VzZVByb21pc2VcIjtcblxuLyoqXG4gKiBBIGhvb2sgdG8gbWFuYWdlIGEgdmFsdWUgaW4gdGhlIGxvY2FsIHN0b3JhZ2UuXG4gKlxuICogQHJlbWFyayBUaGUgdmFsdWUgaXMgc3RvcmVkIGFzIGEgSlNPTiBzdHJpbmcgaW4gdGhlIGxvY2FsIHN0b3JhZ2UuXG4gKlxuICogQHBhcmFtIGtleSAtIFRoZSBrZXkgdG8gdXNlIGZvciB0aGUgdmFsdWUgaW4gdGhlIGxvY2FsIHN0b3JhZ2UuXG4gKiBAcGFyYW0gaW5pdGlhbFZhbHVlIC0gVGhlIGluaXRpYWwgdmFsdWUgdG8gdXNlIGlmIHRoZSBrZXkgZG9lc24ndCBleGlzdCBpbiB0aGUgbG9jYWwgc3RvcmFnZS5cbiAqIEByZXR1cm5zIEFuIG9iamVjdCB3aXRoIHRoZSBmb2xsb3dpbmcgcHJvcGVydGllczpcbiAqIC0gYHZhbHVlYDogVGhlIHZhbHVlIGZyb20gdGhlIGxvY2FsIHN0b3JhZ2Ugb3IgdGhlIGluaXRpYWwgdmFsdWUgaWYgdGhlIGtleSBkb2Vzbid0IGV4aXN0LlxuICogLSBgc2V0VmFsdWVgOiBBIGZ1bmN0aW9uIHRvIHVwZGF0ZSB0aGUgdmFsdWUgaW4gdGhlIGxvY2FsIHN0b3JhZ2UuXG4gKiAtIGByZW1vdmVWYWx1ZWA6IEEgZnVuY3Rpb24gdG8gcmVtb3ZlIHRoZSB2YWx1ZSBmcm9tIHRoZSBsb2NhbCBzdG9yYWdlLlxuICogLSBgaXNMb2FkaW5nYDogQSBib29sZWFuIGluZGljYXRpbmcgaWYgdGhlIHZhbHVlIGlzIGxvYWRpbmcuXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYFxuICogY29uc3QgeyB2YWx1ZSwgc2V0VmFsdWUgfSA9IHVzZUxvY2FsU3RvcmFnZTxzdHJpbmc+KFwibXkta2V5XCIpO1xuICogY29uc3QgeyB2YWx1ZSwgc2V0VmFsdWUgfSA9IHVzZUxvY2FsU3RvcmFnZTxzdHJpbmc+KFwibXkta2V5XCIsIFwiZGVmYXVsdCB2YWx1ZVwiKTtcbiAqIGBgYFxuICovXG5leHBvcnQgZnVuY3Rpb24gdXNlTG9jYWxTdG9yYWdlPFQ+KGtleTogc3RyaW5nLCBpbml0aWFsVmFsdWU/OiBUKSB7XG4gIGNvbnN0IHtcbiAgICBkYXRhOiB2YWx1ZSxcbiAgICBpc0xvYWRpbmcsXG4gICAgbXV0YXRlLFxuICB9ID0gdXNlUHJvbWlzZShcbiAgICBhc3luYyAoc3RvcmFnZUtleTogc3RyaW5nKSA9PiB7XG4gICAgICBjb25zdCBpdGVtID0gYXdhaXQgTG9jYWxTdG9yYWdlLmdldEl0ZW08c3RyaW5nPihzdG9yYWdlS2V5KTtcblxuICAgICAgcmV0dXJuIHR5cGVvZiBpdGVtICE9PSBcInVuZGVmaW5lZFwiID8gKEpTT04ucGFyc2UoaXRlbSwgcmV2aXZlcikgYXMgVCkgOiBpbml0aWFsVmFsdWU7XG4gICAgfSxcbiAgICBba2V5XSxcbiAgKTtcblxuICBhc3luYyBmdW5jdGlvbiBzZXRWYWx1ZSh2YWx1ZTogVCkge1xuICAgIHRyeSB7XG4gICAgICBhd2FpdCBtdXRhdGUoTG9jYWxTdG9yYWdlLnNldEl0ZW0oa2V5LCBKU09OLnN0cmluZ2lmeSh2YWx1ZSwgcmVwbGFjZXIpKSwge1xuICAgICAgICBvcHRpbWlzdGljVXBkYXRlKHZhbHVlKSB7XG4gICAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgfSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGF3YWl0IHNob3dGYWlsdXJlVG9hc3QoZXJyb3IsIHsgdGl0bGU6IFwiRmFpbGVkIHRvIHNldCB2YWx1ZSBpbiBsb2NhbCBzdG9yYWdlXCIgfSk7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgZnVuY3Rpb24gcmVtb3ZlVmFsdWUoKSB7XG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IG11dGF0ZShMb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShrZXkpLCB7XG4gICAgICAgIG9wdGltaXN0aWNVcGRhdGUoKSB7XG4gICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBhd2FpdCBzaG93RmFpbHVyZVRvYXN0KGVycm9yLCB7IHRpdGxlOiBcIkZhaWxlZCB0byByZW1vdmUgdmFsdWUgZnJvbSBsb2NhbCBzdG9yYWdlXCIgfSk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHsgdmFsdWUsIHNldFZhbHVlLCByZW1vdmVWYWx1ZSwgaXNMb2FkaW5nIH07XG59XG4iLCAiZXhwb3J0IHsgZ2V0QXZhdGFySWNvbiB9IGZyb20gXCIuL2F2YXRhclwiO1xuZXhwb3J0IHsgZ2V0RmF2aWNvbiB9IGZyb20gXCIuL2Zhdmljb25cIjtcbmV4cG9ydCB7IGdldFByb2dyZXNzSWNvbiB9IGZyb20gXCIuL3Byb2dyZXNzXCI7XG4iLCAiaW1wb3J0IHR5cGUgeyBJbWFnZSB9IGZyb20gXCJAcmF5Y2FzdC9hcGlcIjtcbmltcG9ydCB7IHNsaWdodGx5TGlnaHRlckNvbG9yLCBzbGlnaHRseURhcmtlckNvbG9yIH0gZnJvbSBcIi4vY29sb3JcIjtcblxuZnVuY3Rpb24gZ2V0V2hvbGVDaGFyQW5kSShzdHI6IHN0cmluZywgaTogbnVtYmVyKTogW3N0cmluZywgbnVtYmVyXSB7XG4gIGNvbnN0IGNvZGUgPSBzdHIuY2hhckNvZGVBdChpKTtcblxuICBpZiAoTnVtYmVyLmlzTmFOKGNvZGUpKSB7XG4gICAgcmV0dXJuIFtcIlwiLCBpXTtcbiAgfVxuICBpZiAoY29kZSA8IDB4ZDgwMCB8fCBjb2RlID4gMHhkZmZmKSB7XG4gICAgcmV0dXJuIFtzdHIuY2hhckF0KGkpLCBpXTsgLy8gTm9ybWFsIGNoYXJhY3Rlciwga2VlcGluZyAnaScgdGhlIHNhbWVcbiAgfVxuXG4gIC8vIEhpZ2ggc3Vycm9nYXRlIChjb3VsZCBjaGFuZ2UgbGFzdCBoZXggdG8gMHhEQjdGIHRvIHRyZWF0IGhpZ2ggcHJpdmF0ZVxuICAvLyBzdXJyb2dhdGVzIGFzIHNpbmdsZSBjaGFyYWN0ZXJzKVxuICBpZiAoMHhkODAwIDw9IGNvZGUgJiYgY29kZSA8PSAweGRiZmYpIHtcbiAgICBpZiAoc3RyLmxlbmd0aCA8PSBpICsgMSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSGlnaCBzdXJyb2dhdGUgd2l0aG91dCBmb2xsb3dpbmcgbG93IHN1cnJvZ2F0ZVwiKTtcbiAgICB9XG4gICAgY29uc3QgbmV4dCA9IHN0ci5jaGFyQ29kZUF0KGkgKyAxKTtcbiAgICBpZiAoMHhkYzAwID4gbmV4dCB8fCBuZXh0ID4gMHhkZmZmKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJIaWdoIHN1cnJvZ2F0ZSB3aXRob3V0IGZvbGxvd2luZyBsb3cgc3Vycm9nYXRlXCIpO1xuICAgIH1cbiAgICByZXR1cm4gW3N0ci5jaGFyQXQoaSkgKyBzdHIuY2hhckF0KGkgKyAxKSwgaSArIDFdO1xuICB9XG5cbiAgLy8gTG93IHN1cnJvZ2F0ZSAoMHhEQzAwIDw9IGNvZGUgJiYgY29kZSA8PSAweERGRkYpXG4gIGlmIChpID09PSAwKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiTG93IHN1cnJvZ2F0ZSB3aXRob3V0IHByZWNlZGluZyBoaWdoIHN1cnJvZ2F0ZVwiKTtcbiAgfVxuXG4gIGNvbnN0IHByZXYgPSBzdHIuY2hhckNvZGVBdChpIC0gMSk7XG5cbiAgLy8gKGNvdWxkIGNoYW5nZSBsYXN0IGhleCB0byAweERCN0YgdG8gdHJlYXQgaGlnaCBwcml2YXRlIHN1cnJvZ2F0ZXNcbiAgLy8gYXMgc2luZ2xlIGNoYXJhY3RlcnMpXG4gIGlmICgweGQ4MDAgPiBwcmV2IHx8IHByZXYgPiAweGRiZmYpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJMb3cgc3Vycm9nYXRlIHdpdGhvdXQgcHJlY2VkaW5nIGhpZ2ggc3Vycm9nYXRlXCIpO1xuICB9XG5cbiAgLy8gUmV0dXJuIHRoZSBuZXh0IGNoYXJhY3RlciBpbnN0ZWFkIChhbmQgaW5jcmVtZW50KVxuICByZXR1cm4gW3N0ci5jaGFyQXQoaSArIDEpLCBpICsgMV07XG59XG5cbmNvbnN0IGF2YXRhckNvbG9yU2V0ID0gW1xuICBcIiNEQzgyOUFcIiwgLy8gUGlua1xuICBcIiNENjQ4NTRcIiwgLy8gUmVkXG4gIFwiI0Q0NzYwMFwiLCAvLyBZZWxsb3dPcmFuZ2VcbiAgXCIjRDM2Q0REXCIsIC8vIE1hZ2VudGFcbiAgXCIjNTJBOUU0XCIsIC8vIEFxdWFcbiAgXCIjNzg3MUU4XCIsIC8vIEluZGlnb1xuICBcIiM3MDkyMEZcIiwgLy8gWWVsbG93R3JlZW5cbiAgXCIjNDNCOTNBXCIsIC8vIEdyZWVuXG4gIFwiI0VCNkIzRVwiLCAvLyBPcmFuZ2VcbiAgXCIjMjZCNzk1XCIsIC8vIEJsdWVHcmVlblxuICBcIiNEODVBOUJcIiwgLy8gSG90UGlua1xuICBcIiNBMDY3RENcIiwgLy8gUHVycGxlXG4gIFwiI0JEOTUwMFwiLCAvLyBZZWxsb3dcbiAgXCIjNTM4NUQ5XCIsIC8vIEJsdWVcbl07XG5cbi8qKlxuICogSWNvbiB0byByZXByZXNlbnQgYW4gYXZhdGFyIHdoZW4geW91IGRvbid0IGhhdmUgb25lLiBUaGUgZ2VuZXJhdGVkIGF2YXRhclxuICogd2lsbCBiZSBnZW5lcmF0ZWQgZnJvbSB0aGUgaW5pdGlhbHMgb2YgdGhlIG5hbWUgYW5kIGhhdmUgYSBjb2xvcmZ1bCBidXQgY29uc2lzdGVudCBiYWNrZ3JvdW5kLlxuICpcbiAqIEByZXR1cm5zIGFuIEltYWdlIHRoYXQgY2FuIGJlIHVzZWQgd2hlcmUgUmF5Y2FzdCBleHBlY3RzIHRoZW0uXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYFxuICogPExpc3QuSXRlbSBpY29uPXtnZXRBdmF0YXJJY29uKCdNYXRoaWV1IER1dG91cicpfSB0aXRsZT1cIlByb2plY3RcIiAvPlxuICogYGBgXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRBdmF0YXJJY29uKFxuICBuYW1lOiBzdHJpbmcsXG4gIG9wdGlvbnM/OiB7XG4gICAgLyoqXG4gICAgICogQ3VzdG9tIGJhY2tncm91bmQgY29sb3JcbiAgICAgKi9cbiAgICBiYWNrZ3JvdW5kPzogc3RyaW5nO1xuICAgIC8qKlxuICAgICAqIFdoZXRoZXIgdG8gdXNlIGEgZ3JhZGllbnQgZm9yIHRoZSBiYWNrZ3JvdW5kIG9yIG5vdC5cbiAgICAgKiBAZGVmYXVsdCB0cnVlXG4gICAgICovXG4gICAgZ3JhZGllbnQ/OiBib29sZWFuO1xuICB9LFxuKTogSW1hZ2UuQXNzZXQge1xuICBjb25zdCB3b3JkcyA9IG5hbWUudHJpbSgpLnNwbGl0KFwiIFwiKTtcbiAgbGV0IGluaXRpYWxzOiBzdHJpbmc7XG4gIGlmICh3b3Jkcy5sZW5ndGggPT0gMSAmJiBnZXRXaG9sZUNoYXJBbmRJKHdvcmRzWzBdLCAwKVswXSkge1xuICAgIGluaXRpYWxzID0gZ2V0V2hvbGVDaGFyQW5kSSh3b3Jkc1swXSwgMClbMF07XG4gIH0gZWxzZSBpZiAod29yZHMubGVuZ3RoID4gMSkge1xuICAgIGNvbnN0IGZpcnN0V29yZEZpcnN0TGV0dGVyID0gZ2V0V2hvbGVDaGFyQW5kSSh3b3Jkc1swXSwgMClbMF0gfHwgXCJcIjtcbiAgICBjb25zdCBsYXN0V29yZEZpcnN0TGV0dGVyID0gZ2V0V2hvbGVDaGFyQW5kSSh3b3Jkc1t3b3Jkcy5sZW5ndGggLSAxXSwgMClbMF0gPz8gXCJcIjtcbiAgICBpbml0aWFscyA9IGZpcnN0V29yZEZpcnN0TGV0dGVyICsgbGFzdFdvcmRGaXJzdExldHRlcjtcbiAgfSBlbHNlIHtcbiAgICBpbml0aWFscyA9IFwiXCI7XG4gIH1cblxuICBsZXQgYmFja2dyb3VuZENvbG9yOiBzdHJpbmc7XG5cbiAgaWYgKG9wdGlvbnM/LmJhY2tncm91bmQpIHtcbiAgICBiYWNrZ3JvdW5kQ29sb3IgPSBvcHRpb25zPy5iYWNrZ3JvdW5kO1xuICB9IGVsc2Uge1xuICAgIGxldCBpbml0aWFsc0NoYXJJbmRleCA9IDA7XG4gICAgbGV0IFtjaGFyLCBpXSA9IGdldFdob2xlQ2hhckFuZEkoaW5pdGlhbHMsIDApO1xuICAgIHdoaWxlIChjaGFyKSB7XG4gICAgICBpbml0aWFsc0NoYXJJbmRleCArPSBjaGFyLmNoYXJDb2RlQXQoMCk7XG4gICAgICBbY2hhciwgaV0gPSBnZXRXaG9sZUNoYXJBbmRJKGluaXRpYWxzLCBpICsgMSk7XG4gICAgfVxuXG4gICAgY29uc3QgY29sb3JJbmRleCA9IGluaXRpYWxzQ2hhckluZGV4ICUgYXZhdGFyQ29sb3JTZXQubGVuZ3RoO1xuICAgIGJhY2tncm91bmRDb2xvciA9IGF2YXRhckNvbG9yU2V0W2NvbG9ySW5kZXhdO1xuICB9XG5cbiAgY29uc3QgcGFkZGluZyA9IDA7XG4gIGNvbnN0IHJhZGl1cyA9IDUwIC0gcGFkZGluZztcblxuICBjb25zdCBzdmcgPSBgPHN2ZyB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgd2lkdGg9XCIxMDBweFwiIGhlaWdodD1cIjEwMHB4XCI+XG4gICR7XG4gICAgb3B0aW9ucz8uZ3JhZGllbnQgIT09IGZhbHNlXG4gICAgICA/IGA8ZGVmcz5cbiAgICAgIDxsaW5lYXJHcmFkaWVudCBpZD1cIkdyYWRpZW50XCIgeDE9XCIwLjI1XCIgeDI9XCIwLjc1XCIgeTE9XCIwXCIgeTI9XCIxXCI+XG4gICAgICAgIDxzdG9wIG9mZnNldD1cIjAlXCIgc3RvcC1jb2xvcj1cIiR7c2xpZ2h0bHlMaWdodGVyQ29sb3IoYmFja2dyb3VuZENvbG9yKX1cIi8+XG4gICAgICAgIDxzdG9wIG9mZnNldD1cIjUwJVwiIHN0b3AtY29sb3I9XCIke2JhY2tncm91bmRDb2xvcn1cIi8+XG4gICAgICAgIDxzdG9wIG9mZnNldD1cIjEwMCVcIiBzdG9wLWNvbG9yPVwiJHtzbGlnaHRseURhcmtlckNvbG9yKGJhY2tncm91bmRDb2xvcil9XCIvPlxuICAgICAgPC9saW5lYXJHcmFkaWVudD5cbiAgPC9kZWZzPmBcbiAgICAgIDogXCJcIlxuICB9XG4gICAgICA8Y2lyY2xlIGN4PVwiNTBcIiBjeT1cIjUwXCIgcj1cIiR7cmFkaXVzfVwiIGZpbGw9XCIke1xuICAgICAgICBvcHRpb25zPy5ncmFkaWVudCAhPT0gZmFsc2UgPyBcInVybCgjR3JhZGllbnQpXCIgOiBiYWNrZ3JvdW5kQ29sb3JcbiAgICAgIH1cIiAvPlxuICAgICAgJHtcbiAgICAgICAgaW5pdGlhbHNcbiAgICAgICAgICA/IGA8dGV4dCB4PVwiNTBcIiB5PVwiODBcIiBmb250LXNpemU9XCIke1xuICAgICAgICAgICAgICByYWRpdXMgLSAxXG4gICAgICAgICAgICB9XCIgZm9udC1mYW1pbHk9XCJJbnRlciwgc2Fucy1zZXJpZlwiIHRleHQtYW5jaG9yPVwibWlkZGxlXCIgZmlsbD1cIndoaXRlXCI+JHtpbml0aWFscy50b1VwcGVyQ2FzZSgpfTwvdGV4dD5gXG4gICAgICAgICAgOiBcIlwiXG4gICAgICB9XG4gICAgPC9zdmc+XG4gIGAucmVwbGFjZUFsbChcIlxcblwiLCBcIlwiKTtcbiAgcmV0dXJuIGBkYXRhOmltYWdlL3N2Zyt4bWwsJHtlbmNvZGVVUklDb21wb25lbnQoc3ZnKX1gO1xufVxuIiwgImZ1bmN0aW9uIGhleFRvUkdCKGhleDogc3RyaW5nKSB7XG4gIGxldCByID0gMDtcbiAgbGV0IGcgPSAwO1xuICBsZXQgYiA9IDA7XG5cbiAgLy8gMyBkaWdpdHNcbiAgaWYgKGhleC5sZW5ndGggPT09IDQpIHtcbiAgICByID0gcGFyc2VJbnQoYCR7aGV4WzFdfSR7aGV4WzFdfWAsIDE2KTtcbiAgICBnID0gcGFyc2VJbnQoYCR7aGV4WzJdfSR7aGV4WzJdfWAsIDE2KTtcbiAgICBiID0gcGFyc2VJbnQoYCR7aGV4WzNdfSR7aGV4WzNdfWAsIDE2KTtcblxuICAgIC8vIDYgZGlnaXRzXG4gIH0gZWxzZSBpZiAoaGV4Lmxlbmd0aCA9PT0gNykge1xuICAgIHIgPSBwYXJzZUludChgJHtoZXhbMV19JHtoZXhbMl19YCwgMTYpO1xuICAgIGcgPSBwYXJzZUludChgJHtoZXhbM119JHtoZXhbNF19YCwgMTYpO1xuICAgIGIgPSBwYXJzZUludChgJHtoZXhbNV19JHtoZXhbNl19YCwgMTYpO1xuICB9IGVsc2Uge1xuICAgIHRocm93IG5ldyBFcnJvcihgTWFsZm9ybWVkIGhleCBjb2xvcjogJHtoZXh9YCk7XG4gIH1cblxuICByZXR1cm4geyByLCBnLCBiIH07XG59XG5cbmZ1bmN0aW9uIHJnYlRvSGV4KHsgciwgZywgYiB9OiB7IHI6IG51bWJlcjsgZzogbnVtYmVyOyBiOiBudW1iZXIgfSkge1xuICBsZXQgclN0cmluZyA9IHIudG9TdHJpbmcoMTYpO1xuICBsZXQgZ1N0cmluZyA9IGcudG9TdHJpbmcoMTYpO1xuICBsZXQgYlN0cmluZyA9IGIudG9TdHJpbmcoMTYpO1xuXG4gIGlmIChyU3RyaW5nLmxlbmd0aCA9PT0gMSkge1xuICAgIHJTdHJpbmcgPSBgMCR7clN0cmluZ31gO1xuICB9XG4gIGlmIChnU3RyaW5nLmxlbmd0aCA9PT0gMSkge1xuICAgIGdTdHJpbmcgPSBgMCR7Z1N0cmluZ31gO1xuICB9XG4gIGlmIChiU3RyaW5nLmxlbmd0aCA9PT0gMSkge1xuICAgIGJTdHJpbmcgPSBgMCR7YlN0cmluZ31gO1xuICB9XG5cbiAgcmV0dXJuIGAjJHtyU3RyaW5nfSR7Z1N0cmluZ30ke2JTdHJpbmd9YDtcbn1cblxuZnVuY3Rpb24gcmdiVG9IU0woeyByLCBnLCBiIH06IHsgcjogbnVtYmVyOyBnOiBudW1iZXI7IGI6IG51bWJlciB9KSB7XG4gIC8vIE1ha2UgciwgZywgYW5kIGIgZnJhY3Rpb25zIG9mIDFcbiAgciAvPSAyNTU7XG4gIGcgLz0gMjU1O1xuICBiIC89IDI1NTtcblxuICAvLyBGaW5kIGdyZWF0ZXN0IGFuZCBzbWFsbGVzdCBjaGFubmVsIHZhbHVlc1xuICBjb25zdCBjbWluID0gTWF0aC5taW4ociwgZywgYik7XG4gIGNvbnN0IGNtYXggPSBNYXRoLm1heChyLCBnLCBiKTtcbiAgY29uc3QgZGVsdGEgPSBjbWF4IC0gY21pbjtcbiAgbGV0IGggPSAwO1xuICBsZXQgcyA9IDA7XG4gIGxldCBsID0gMDtcblxuICAvLyBDYWxjdWxhdGUgaHVlXG4gIC8vIE5vIGRpZmZlcmVuY2VcbiAgaWYgKGRlbHRhID09PSAwKSB7XG4gICAgaCA9IDA7XG4gIH1cbiAgLy8gUmVkIGlzIG1heFxuICBlbHNlIGlmIChjbWF4ID09PSByKSB7XG4gICAgaCA9ICgoZyAtIGIpIC8gZGVsdGEpICUgNjtcbiAgfVxuICAvLyBHcmVlbiBpcyBtYXhcbiAgZWxzZSBpZiAoY21heCA9PT0gZykge1xuICAgIGggPSAoYiAtIHIpIC8gZGVsdGEgKyAyO1xuICB9XG4gIC8vIEJsdWUgaXMgbWF4XG4gIGVsc2Uge1xuICAgIGggPSAociAtIGcpIC8gZGVsdGEgKyA0O1xuICB9XG5cbiAgaCA9IE1hdGgucm91bmQoaCAqIDYwKTtcblxuICAvLyBNYWtlIG5lZ2F0aXZlIGh1ZXMgcG9zaXRpdmUgYmVoaW5kIDM2MMKwXG4gIGlmIChoIDwgMCkge1xuICAgIGggKz0gMzYwO1xuICB9XG5cbiAgLy8gQ2FsY3VsYXRlIGxpZ2h0bmVzc1xuICBsID0gKGNtYXggKyBjbWluKSAvIDI7XG5cbiAgLy8gQ2FsY3VsYXRlIHNhdHVyYXRpb25cbiAgcyA9IGRlbHRhID09PSAwID8gMCA6IGRlbHRhIC8gKDEgLSBNYXRoLmFicygyICogbCAtIDEpKTtcblxuICAvLyBNdWx0aXBseSBsIGFuZCBzIGJ5IDEwMFxuICBzID0gKyhzICogMTAwKS50b0ZpeGVkKDEpO1xuICBsID0gKyhsICogMTAwKS50b0ZpeGVkKDEpO1xuXG4gIHJldHVybiB7IGgsIHMsIGwgfTtcbn1cblxuZnVuY3Rpb24gaHNsVG9SR0IoeyBoLCBzLCBsIH06IHsgaDogbnVtYmVyOyBzOiBudW1iZXI7IGw6IG51bWJlciB9KSB7XG4gIC8vIE11c3QgYmUgZnJhY3Rpb25zIG9mIDFcbiAgcyAvPSAxMDA7XG4gIGwgLz0gMTAwO1xuXG4gIGNvbnN0IGMgPSAoMSAtIE1hdGguYWJzKDIgKiBsIC0gMSkpICogcztcbiAgY29uc3QgeCA9IGMgKiAoMSAtIE1hdGguYWJzKCgoaCAvIDYwKSAlIDIpIC0gMSkpO1xuICBjb25zdCBtID0gbCAtIGMgLyAyO1xuICBsZXQgciA9IDA7XG4gIGxldCBnID0gMDtcbiAgbGV0IGIgPSAwO1xuXG4gIGlmIChoID49IDAgJiYgaCA8IDYwKSB7XG4gICAgciA9IGM7XG4gICAgZyA9IHg7XG4gICAgYiA9IDA7XG4gIH0gZWxzZSBpZiAoaCA+PSA2MCAmJiBoIDwgMTIwKSB7XG4gICAgciA9IHg7XG4gICAgZyA9IGM7XG4gICAgYiA9IDA7XG4gIH0gZWxzZSBpZiAoaCA+PSAxMjAgJiYgaCA8IDE4MCkge1xuICAgIHIgPSAwO1xuICAgIGcgPSBjO1xuICAgIGIgPSB4O1xuICB9IGVsc2UgaWYgKGggPj0gMTgwICYmIGggPCAyNDApIHtcbiAgICByID0gMDtcbiAgICBnID0geDtcbiAgICBiID0gYztcbiAgfSBlbHNlIGlmIChoID49IDI0MCAmJiBoIDwgMzAwKSB7XG4gICAgciA9IHg7XG4gICAgZyA9IDA7XG4gICAgYiA9IGM7XG4gIH0gZWxzZSBpZiAoaCA+PSAzMDAgJiYgaCA8IDM2MCkge1xuICAgIHIgPSBjO1xuICAgIGcgPSAwO1xuICAgIGIgPSB4O1xuICB9XG4gIHIgPSBNYXRoLnJvdW5kKChyICsgbSkgKiAyNTUpO1xuICBnID0gTWF0aC5yb3VuZCgoZyArIG0pICogMjU1KTtcbiAgYiA9IE1hdGgucm91bmQoKGIgKyBtKSAqIDI1NSk7XG5cbiAgcmV0dXJuIHsgciwgZywgYiB9O1xufVxuXG5mdW5jdGlvbiBoZXhUb0hTTChoZXg6IHN0cmluZykge1xuICByZXR1cm4gcmdiVG9IU0woaGV4VG9SR0IoaGV4KSk7XG59XG5cbmZ1bmN0aW9uIGhzbFRvSGV4KGhzbDogeyBoOiBudW1iZXI7IHM6IG51bWJlcjsgbDogbnVtYmVyIH0pIHtcbiAgcmV0dXJuIHJnYlRvSGV4KGhzbFRvUkdCKGhzbCkpO1xufVxuXG5mdW5jdGlvbiBjbGFtcCh2YWx1ZTogbnVtYmVyLCBtaW46IG51bWJlciwgbWF4OiBudW1iZXIpIHtcbiAgcmV0dXJuIG1pbiA8IG1heCA/ICh2YWx1ZSA8IG1pbiA/IG1pbiA6IHZhbHVlID4gbWF4ID8gbWF4IDogdmFsdWUpIDogdmFsdWUgPCBtYXggPyBtYXggOiB2YWx1ZSA+IG1pbiA/IG1pbiA6IHZhbHVlO1xufVxuXG5jb25zdCBvZmZzZXQgPSAxMjtcblxuZXhwb3J0IGZ1bmN0aW9uIHNsaWdodGx5RGFya2VyQ29sb3IoaGV4OiBzdHJpbmcpIHtcbiAgY29uc3QgaHNsID0gaGV4VG9IU0woaGV4KTtcblxuICByZXR1cm4gaHNsVG9IZXgoe1xuICAgIGg6IGhzbC5oLFxuICAgIHM6IGhzbC5zLFxuICAgIGw6IGNsYW1wKGhzbC5sIC0gb2Zmc2V0LCAwLCAxMDApLFxuICB9KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHNsaWdodGx5TGlnaHRlckNvbG9yKGhleDogc3RyaW5nKSB7XG4gIGNvbnN0IGhzbCA9IGhleFRvSFNMKGhleCk7XG5cbiAgcmV0dXJuIGhzbFRvSGV4KHtcbiAgICBoOiBoc2wuaCxcbiAgICBzOiBoc2wucyxcbiAgICBsOiBjbGFtcChoc2wubCArIG9mZnNldCwgMCwgMTAwKSxcbiAgfSk7XG59XG4iLCAiaW1wb3J0IHsgSWNvbiwgSW1hZ2UgfSBmcm9tIFwiQHJheWNhc3QvYXBpXCI7XG5pbXBvcnQgeyBVUkwgfSBmcm9tIFwibm9kZTp1cmxcIjtcblxuLyoqXG4gKiBJY29uIHNob3dpbmcgdGhlIGZhdmljb24gb2YgYSB3ZWJzaXRlLlxuICpcbiAqIEEgZmF2aWNvbiAoZmF2b3JpdGUgaWNvbikgaXMgYSB0aW55IGljb24gaW5jbHVkZWQgYWxvbmcgd2l0aCBhIHdlYnNpdGUsIHdoaWNoIGlzIGRpc3BsYXllZCBpbiBwbGFjZXMgbGlrZSB0aGUgYnJvd3NlcidzIGFkZHJlc3MgYmFyLCBwYWdlIHRhYnMsIGFuZCBib29rbWFya3MgbWVudS5cbiAqXG4gKiBAcGFyYW0gdXJsIFRoZSBVUkwgb2YgdGhlIHdlYnNpdGUgdG8gcmVwcmVzZW50LlxuICpcbiAqIEByZXR1cm5zIGFuIEltYWdlIHRoYXQgY2FuIGJlIHVzZWQgd2hlcmUgUmF5Y2FzdCBleHBlY3RzIHRoZW0uXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYFxuICogPExpc3QuSXRlbSBpY29uPXtnZXRGYXZpY29uKFwiaHR0cHM6Ly9yYXljYXN0LmNvbVwiKX0gdGl0bGU9XCJSYXljYXN0IFdlYnNpdGVcIiAvPlxuICogYGBgXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRGYXZpY29uKFxuICB1cmw6IHN0cmluZyB8IFVSTCxcbiAgb3B0aW9ucz86IHtcbiAgICAvKipcbiAgICAgKiBTaXplIG9mIHRoZSBGYXZpY29uXG4gICAgICogQGRlZmF1bHQgNjRcbiAgICAgKi9cbiAgICBzaXplPzogbnVtYmVyO1xuICAgIC8qKlxuICAgICAqIEZhbGxiYWNrIGljb24gaW4gY2FzZSB0aGUgRmF2aWNvbiBpcyBub3QgZm91bmQuXG4gICAgICogQGRlZmF1bHQgSWNvbi5MaW5rXG4gICAgICovXG4gICAgZmFsbGJhY2s/OiBJbWFnZS5GYWxsYmFjaztcbiAgICAvKipcbiAgICAgKiBBIHtAbGluayBJbWFnZS5NYXNrfSB0byBhcHBseSB0byB0aGUgRmF2aWNvbi5cbiAgICAgKi9cbiAgICBtYXNrPzogSW1hZ2UuTWFzaztcbiAgfSxcbik6IEltYWdlLkltYWdlTGlrZSB7XG4gIHRyeSB7XG4gICAgLy8gYSBmdW5jIGFkZGluZyBodHRwczovLyB0byB0aGUgVVJMXG4gICAgLy8gZm9yIGNhc2VzIHdoZXJlIHRoZSBVUkwgaXMgbm90IGEgZnVsbCBVUkxcbiAgICAvLyBlLmcuIFwicmF5Y2FzdC5jb21cIlxuICAgIGNvbnN0IHNhbml0aXplID0gKHVybDogc3RyaW5nKSA9PiB7XG4gICAgICBpZiAoIXVybC5zdGFydHNXaXRoKFwiaHR0cFwiKSkge1xuICAgICAgICByZXR1cm4gYGh0dHBzOi8vJHt1cmx9YDtcbiAgICAgIH1cbiAgICAgIHJldHVybiB1cmw7XG4gICAgfTtcblxuICAgIGNvbnN0IHVybE9iaiA9IHR5cGVvZiB1cmwgPT09IFwic3RyaW5nXCIgPyBuZXcgVVJMKHNhbml0aXplKHVybCkpIDogdXJsO1xuICAgIGNvbnN0IGhvc3RuYW1lID0gdXJsT2JqLmhvc3RuYW1lO1xuXG4gICAgY29uc3QgZmF2aWNvblByb3ZpZGVyOiBcIm5vbmVcIiB8IFwicmF5Y2FzdFwiIHwgXCJhcHBsZVwiIHwgXCJnb29nbGVcIiB8IFwiZHVja0R1Y2tHb1wiIHwgXCJkdWNrZHVja2dvXCIgfCBcImxlZ2FjeVwiID1cbiAgICAgIChwcm9jZXNzLmVudi5GQVZJQ09OX1BST1ZJREVSIGFzIGFueSkgPz8gXCJyYXljYXN0XCI7XG5cbiAgICBzd2l0Y2ggKGZhdmljb25Qcm92aWRlcikge1xuICAgICAgY2FzZSBcIm5vbmVcIjpcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBzb3VyY2U6IG9wdGlvbnM/LmZhbGxiYWNrID8/IEljb24uTGluayxcbiAgICAgICAgICBtYXNrOiBvcHRpb25zPy5tYXNrLFxuICAgICAgICB9O1xuICAgICAgY2FzZSBcImFwcGxlXCI6XG4gICAgICAgIC8vIHdlIGNhbid0IHN1cHBvcnQgYXBwbGUgZmF2aWNvbnMgYXMgaXQncyBhIG5hdGl2ZSBBUElcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBzb3VyY2U6IG9wdGlvbnM/LmZhbGxiYWNrID8/IEljb24uTGluayxcbiAgICAgICAgICBtYXNrOiBvcHRpb25zPy5tYXNrLFxuICAgICAgICB9O1xuICAgICAgY2FzZSBcImR1Y2tkdWNrZ29cIjpcbiAgICAgIGNhc2UgXCJkdWNrRHVja0dvXCI6XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgc291cmNlOiBgaHR0cHM6Ly9pY29ucy5kdWNrZHVja2dvLmNvbS9pcDMvJHtob3N0bmFtZX0uaWNvYCxcbiAgICAgICAgICBmYWxsYmFjazogb3B0aW9ucz8uZmFsbGJhY2sgPz8gSWNvbi5MaW5rLFxuICAgICAgICAgIG1hc2s6IG9wdGlvbnM/Lm1hc2ssXG4gICAgICAgIH07XG4gICAgICBjYXNlIFwiZ29vZ2xlXCI6XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgc291cmNlOiBgaHR0cHM6Ly93d3cuZ29vZ2xlLmNvbS9zMi9mYXZpY29ucz9zej0ke29wdGlvbnM/LnNpemUgPz8gNjR9JmRvbWFpbj0ke2hvc3RuYW1lfWAsXG4gICAgICAgICAgZmFsbGJhY2s6IG9wdGlvbnM/LmZhbGxiYWNrID8/IEljb24uTGluayxcbiAgICAgICAgICBtYXNrOiBvcHRpb25zPy5tYXNrLFxuICAgICAgICB9O1xuICAgICAgY2FzZSBcImxlZ2FjeVwiOlxuICAgICAgY2FzZSBcInJheWNhc3RcIjpcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgc291cmNlOiBgaHR0cHM6Ly9hcGkucmF5LnNvL2Zhdmljb24/dXJsPSR7aG9zdG5hbWV9JnNpemU9JHtvcHRpb25zPy5zaXplID8/IDY0fWAsXG4gICAgICAgICAgZmFsbGJhY2s6IG9wdGlvbnM/LmZhbGxiYWNrID8/IEljb24uTGluayxcbiAgICAgICAgICBtYXNrOiBvcHRpb25zPy5tYXNrLFxuICAgICAgICB9O1xuICAgIH1cbiAgfSBjYXRjaCAoZSkge1xuICAgIGNvbnNvbGUuZXJyb3IoZSk7XG4gICAgcmV0dXJuIEljb24uTGluaztcbiAgfVxufVxuIiwgImltcG9ydCB7IGVudmlyb25tZW50LCBDb2xvciB9IGZyb20gXCJAcmF5Y2FzdC9hcGlcIjtcbmltcG9ydCB0eXBlIHsgSW1hZ2UgfSBmcm9tIFwiQHJheWNhc3QvYXBpXCI7XG5cbmZ1bmN0aW9uIHBvbGFyVG9DYXJ0ZXNpYW4oY2VudGVyWDogbnVtYmVyLCBjZW50ZXJZOiBudW1iZXIsIHJhZGl1czogbnVtYmVyLCBhbmdsZUluRGVncmVlczogbnVtYmVyKSB7XG4gIGNvbnN0IGFuZ2xlSW5SYWRpYW5zID0gKChhbmdsZUluRGVncmVlcyAtIDkwKSAqIE1hdGguUEkpIC8gMTgwLjA7XG5cbiAgcmV0dXJuIHtcbiAgICB4OiBjZW50ZXJYICsgcmFkaXVzICogTWF0aC5jb3MoYW5nbGVJblJhZGlhbnMpLFxuICAgIHk6IGNlbnRlclkgKyByYWRpdXMgKiBNYXRoLnNpbihhbmdsZUluUmFkaWFucyksXG4gIH07XG59XG5cbmZ1bmN0aW9uIGRlc2NyaWJlQXJjKHg6IG51bWJlciwgeTogbnVtYmVyLCByYWRpdXM6IG51bWJlciwgc3RhcnRBbmdsZTogbnVtYmVyLCBlbmRBbmdsZTogbnVtYmVyKSB7XG4gIGNvbnN0IHN0YXJ0ID0gcG9sYXJUb0NhcnRlc2lhbih4LCB5LCByYWRpdXMsIGVuZEFuZ2xlKTtcbiAgY29uc3QgZW5kID0gcG9sYXJUb0NhcnRlc2lhbih4LCB5LCByYWRpdXMsIHN0YXJ0QW5nbGUpO1xuXG4gIGNvbnN0IGxhcmdlQXJjRmxhZyA9IGVuZEFuZ2xlIC0gc3RhcnRBbmdsZSA8PSAxODAgPyBcIjBcIiA6IFwiMVwiO1xuXG4gIGNvbnN0IGQgPSBbXCJNXCIsIHN0YXJ0LngsIHN0YXJ0LnksIFwiQVwiLCByYWRpdXMsIHJhZGl1cywgMCwgbGFyZ2VBcmNGbGFnLCAwLCBlbmQueCwgZW5kLnldLmpvaW4oXCIgXCIpO1xuXG4gIHJldHVybiBkO1xufVxuXG4vKipcbiAqIEljb24gdG8gcmVwcmVzZW50IHRoZSBwcm9ncmVzcyBvZiBfc29tZXRoaW5nXy5cbiAqXG4gKiBAcGFyYW0gcHJvZ3Jlc3MgTnVtYmVyIGJldHdlZW4gMCBhbmQgMS5cbiAqIEBwYXJhbSBjb2xvciBIZXggY29sb3IgKGRlZmF1bHQgYFwiI0ZGNjM2M1wiYCkgb3IgQ29sb3IuXG4gKlxuICogQHJldHVybnMgYW4gSW1hZ2UgdGhhdCBjYW4gYmUgdXNlZCB3aGVyZSBSYXljYXN0IGV4cGVjdHMgdGhlbS5cbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgXG4gKiA8TGlzdC5JdGVtIGljb249e2dldFByb2dyZXNzSWNvbigwLjEpfSB0aXRsZT1cIlByb2plY3RcIiAvPlxuICogYGBgXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRQcm9ncmVzc0ljb24oXG4gIHByb2dyZXNzOiBudW1iZXIsXG4gIGNvbG9yOiBDb2xvciB8IHN0cmluZyA9IENvbG9yLlJlZCxcbiAgb3B0aW9ucz86IHsgYmFja2dyb3VuZD86IENvbG9yIHwgc3RyaW5nOyBiYWNrZ3JvdW5kT3BhY2l0eT86IG51bWJlciB9LFxuKTogSW1hZ2UuQXNzZXQge1xuICBjb25zdCBiYWNrZ3JvdW5kID0gb3B0aW9ucz8uYmFja2dyb3VuZCB8fCAoZW52aXJvbm1lbnQuYXBwZWFyYW5jZSA9PT0gXCJsaWdodFwiID8gXCJibGFja1wiIDogXCJ3aGl0ZVwiKTtcbiAgY29uc3QgYmFja2dyb3VuZE9wYWNpdHkgPSBvcHRpb25zPy5iYWNrZ3JvdW5kT3BhY2l0eSB8fCAwLjE7XG5cbiAgY29uc3Qgc3Ryb2tlID0gMTA7XG4gIGNvbnN0IHBhZGRpbmcgPSA1O1xuICBjb25zdCByYWRpdXMgPSA1MCAtIHBhZGRpbmcgLSBzdHJva2UgLyAyO1xuXG4gIGNvbnN0IHN2ZyA9IGA8c3ZnIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiB3aWR0aD1cIjEwMHB4XCIgaGVpZ2h0PVwiMTAwcHhcIj5cbiAgICAgIDxjaXJjbGUgY3g9XCI1MFwiIGN5PVwiNTBcIiByPVwiJHtyYWRpdXN9XCIgc3Ryb2tlLXdpZHRoPVwiJHtzdHJva2V9XCIgc3Ryb2tlPVwiJHtcbiAgICAgICAgcHJvZ3Jlc3MgPCAxID8gYmFja2dyb3VuZCA6IGNvbG9yXG4gICAgICB9XCIgb3BhY2l0eT1cIiR7cHJvZ3Jlc3MgPCAxID8gYmFja2dyb3VuZE9wYWNpdHkgOiBcIjFcIn1cIiBmaWxsPVwibm9uZVwiIC8+XG4gICAgICAke1xuICAgICAgICBwcm9ncmVzcyA+IDAgJiYgcHJvZ3Jlc3MgPCAxXG4gICAgICAgICAgPyBgPHBhdGggZD1cIiR7ZGVzY3JpYmVBcmMoXG4gICAgICAgICAgICAgIDUwLFxuICAgICAgICAgICAgICA1MCxcbiAgICAgICAgICAgICAgcmFkaXVzLFxuICAgICAgICAgICAgICAwLFxuICAgICAgICAgICAgICBwcm9ncmVzcyAqIDM2MCxcbiAgICAgICAgICAgICl9XCIgc3Ryb2tlPVwiJHtjb2xvcn1cIiBzdHJva2Utd2lkdGg9XCIke3N0cm9rZX1cIiBmaWxsPVwibm9uZVwiIC8+YFxuICAgICAgICAgIDogXCJcIlxuICAgICAgfVxuICAgIDwvc3ZnPlxuICBgLnJlcGxhY2VBbGwoXCJcXG5cIiwgXCJcIik7XG4gIHJldHVybiBgZGF0YTppbWFnZS9zdmcreG1sLCR7ZW5jb2RlVVJJQ29tcG9uZW50KHN2Zyl9YDtcbn1cbiIsICJleHBvcnQgeyBPQXV0aFNlcnZpY2UgfSBmcm9tIFwiLi9PQXV0aFNlcnZpY2VcIjtcbmV4cG9ydCB7IHdpdGhBY2Nlc3NUb2tlbiwgZ2V0QWNjZXNzVG9rZW4gfSBmcm9tIFwiLi93aXRoQWNjZXNzVG9rZW5cIjtcblxuZXhwb3J0IHR5cGUgeyBXaXRoQWNjZXNzVG9rZW5Db21wb25lbnRPckZuIH0gZnJvbSBcIi4vd2l0aEFjY2Vzc1Rva2VuXCI7XG5leHBvcnQgdHlwZSB7XG4gIE9uQXV0aG9yaXplUGFyYW1zLFxuICBPQXV0aFNlcnZpY2VPcHRpb25zLFxuICBQcm92aWRlcldpdGhEZWZhdWx0Q2xpZW50T3B0aW9ucyxcbiAgUHJvdmlkZXJPcHRpb25zLFxufSBmcm9tIFwiLi90eXBlc1wiO1xuIiwgImltcG9ydCB7IENvbG9yLCBPQXV0aCB9IGZyb20gXCJAcmF5Y2FzdC9hcGlcIjtcbmltcG9ydCB7IFBST1ZJREVSX0NMSUVOVF9JRFMgfSBmcm9tIFwiLi9wcm92aWRlcnNcIjtcbmltcG9ydCB0eXBlIHtcbiAgT0F1dGhTZXJ2aWNlT3B0aW9ucyxcbiAgT25BdXRob3JpemVQYXJhbXMsXG4gIFByb3ZpZGVyT3B0aW9ucyxcbiAgUHJvdmlkZXJXaXRoRGVmYXVsdENsaWVudE9wdGlvbnMsXG59IGZyb20gXCIuL3R5cGVzXCI7XG5cbi8qKlxuICogQ2xhc3MgYWxsb3dpbmcgdG8gY3JlYXRlIGFuIE9BdXRoIHNlcnZpY2UgdXNpbmcgdGhlIHRoZSBQS0NFIChQcm9vZiBLZXkgZm9yIENvZGUgRXhjaGFuZ2UpIGZsb3cuXG4gKlxuICogVGhpcyBzZXJ2aWNlIGlzIGNhcGFibGUgb2Ygc3RhcnRpbmcgdGhlIGF1dGhvcml6YXRpb24gcHJvY2VzcywgZmV0Y2hpbmcgYW5kIHJlZnJlc2hpbmcgdG9rZW5zLFxuICogYXMgd2VsbCBhcyBtYW5hZ2luZyB0aGUgYXV0aGVudGljYXRpb24gc3RhdGUuXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYHR5cGVzY3JpcHRcbiAqIGNvbnN0IG9hdXRoQ2xpZW50ID0gbmV3IE9BdXRoLlBLQ0VDbGllbnQoeyAuLi4gfSk7XG4gKiBjb25zdCBvYXV0aFNlcnZpY2UgPSBuZXcgT0F1dGhTZXJ2aWNlKHtcbiAqICAgY2xpZW50OiBvYXV0aENsaWVudCxcbiAqICAgY2xpZW50SWQ6ICd5b3VyLWNsaWVudC1pZCcsXG4gKiAgIHNjb3BlOiAncmVxdWlyZWQgc2NvcGVzJyxcbiAqICAgYXV0aG9yaXplVXJsOiAnaHR0cHM6Ly9wcm92aWRlci5jb20vb2F1dGgvYXV0aG9yaXplJyxcbiAqICAgdG9rZW5Vcmw6ICdodHRwczovL3Byb3ZpZGVyLmNvbS9vYXV0aC90b2tlbicsXG4gKiAgIHJlZnJlc2hUb2tlblVybDogJ2h0dHBzOi8vcHJvdmlkZXIuY29tL29hdXRoL3Rva2VuJyxcbiAqICAgZXh0cmFQYXJhbWV0ZXJzOiB7ICdhZGRpdGlvbmFsX3BhcmFtJzogJ3ZhbHVlJyB9XG4gKiB9KTtcbiAqIGBgYFxuICovXG5leHBvcnQgY2xhc3MgT0F1dGhTZXJ2aWNlIGltcGxlbWVudHMgT0F1dGhTZXJ2aWNlT3B0aW9ucyB7XG4gIHB1YmxpYyBjbGllbnRJZDogc3RyaW5nO1xuICBwdWJsaWMgc2NvcGU6IHN0cmluZztcbiAgcHVibGljIGNsaWVudDogT0F1dGguUEtDRUNsaWVudDtcbiAgcHVibGljIGV4dHJhUGFyYW1ldGVycz86IFJlY29yZDxzdHJpbmcsIHN0cmluZz47XG4gIHB1YmxpYyBhdXRob3JpemVVcmw6IHN0cmluZztcbiAgcHVibGljIHRva2VuVXJsOiBzdHJpbmc7XG4gIHB1YmxpYyByZWZyZXNoVG9rZW5Vcmw/OiBzdHJpbmc7XG4gIHB1YmxpYyBib2R5RW5jb2Rpbmc/OiBcImpzb25cIiB8IFwidXJsLWVuY29kZWRcIjtcbiAgcHVibGljIHBlcnNvbmFsQWNjZXNzVG9rZW4/OiBzdHJpbmc7XG4gIG9uQXV0aG9yaXplPzogKHBhcmFtczogT25BdXRob3JpemVQYXJhbXMpID0+IHZvaWQ7XG4gIHRva2VuUmVzcG9uc2VQYXJzZXI6IChyZXNwb25zZTogdW5rbm93bikgPT4gT0F1dGguVG9rZW5SZXNwb25zZTtcbiAgdG9rZW5SZWZyZXNoUmVzcG9uc2VQYXJzZXI6IChyZXNwb25zZTogdW5rbm93bikgPT4gT0F1dGguVG9rZW5SZXNwb25zZTtcblxuICBjb25zdHJ1Y3RvcihvcHRpb25zOiBPQXV0aFNlcnZpY2VPcHRpb25zKSB7XG4gICAgdGhpcy5jbGllbnRJZCA9IG9wdGlvbnMuY2xpZW50SWQ7XG4gICAgdGhpcy5zY29wZSA9IEFycmF5LmlzQXJyYXkob3B0aW9ucy5zY29wZSkgPyBvcHRpb25zLnNjb3BlLmpvaW4oXCIgXCIpIDogb3B0aW9ucy5zY29wZTtcbiAgICB0aGlzLnBlcnNvbmFsQWNjZXNzVG9rZW4gPSBvcHRpb25zLnBlcnNvbmFsQWNjZXNzVG9rZW47XG4gICAgdGhpcy5ib2R5RW5jb2RpbmcgPSBvcHRpb25zLmJvZHlFbmNvZGluZztcbiAgICB0aGlzLmNsaWVudCA9IG9wdGlvbnMuY2xpZW50O1xuICAgIHRoaXMuZXh0cmFQYXJhbWV0ZXJzID0gb3B0aW9ucy5leHRyYVBhcmFtZXRlcnM7XG4gICAgdGhpcy5hdXRob3JpemVVcmwgPSBvcHRpb25zLmF1dGhvcml6ZVVybDtcbiAgICB0aGlzLnRva2VuVXJsID0gb3B0aW9ucy50b2tlblVybDtcbiAgICB0aGlzLnJlZnJlc2hUb2tlblVybCA9IG9wdGlvbnMucmVmcmVzaFRva2VuVXJsO1xuICAgIHRoaXMub25BdXRob3JpemUgPSBvcHRpb25zLm9uQXV0aG9yaXplO1xuICAgIHRoaXMudG9rZW5SZXNwb25zZVBhcnNlciA9IG9wdGlvbnMudG9rZW5SZXNwb25zZVBhcnNlciA/PyAoKHgpID0+IHggYXMgT0F1dGguVG9rZW5SZXNwb25zZSk7XG4gICAgdGhpcy50b2tlblJlZnJlc2hSZXNwb25zZVBhcnNlciA9IG9wdGlvbnMudG9rZW5SZWZyZXNoUmVzcG9uc2VQYXJzZXIgPz8gKCh4KSA9PiB4IGFzIE9BdXRoLlRva2VuUmVzcG9uc2UpO1xuICAgIHRoaXMuYXV0aG9yaXplID0gdGhpcy5hdXRob3JpemUuYmluZCh0aGlzKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBc2FuYSBPQXV0aCBzZXJ2aWNlIHByb3ZpZGVkIG91dCBvZiB0aGUgYm94LlxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiBgYGB0eXBlc2NyaXB0XG4gICAqIGNvbnN0IGFzYW5hID0gT0F1dGhTZXJ2aWNlLmFzYW5hKHsgc2NvcGU6ICdkZWZhdWx0JyB9KVxuICAgKiBgYGBcbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgYXNhbmEob3B0aW9uczogUHJvdmlkZXJXaXRoRGVmYXVsdENsaWVudE9wdGlvbnMpIHtcbiAgICByZXR1cm4gbmV3IE9BdXRoU2VydmljZSh7XG4gICAgICBjbGllbnQ6IG5ldyBPQXV0aC5QS0NFQ2xpZW50KHtcbiAgICAgICAgcmVkaXJlY3RNZXRob2Q6IE9BdXRoLlJlZGlyZWN0TWV0aG9kLldlYixcbiAgICAgICAgcHJvdmlkZXJOYW1lOiBcIkFzYW5hXCIsXG4gICAgICAgIHByb3ZpZGVySWNvbjogYGRhdGE6aW1hZ2Uvc3ZnK3htbCwke2VuY29kZVVSSUNvbXBvbmVudChcbiAgICAgICAgICBgPHN2ZyB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgd2lkdGg9XCIyNTFcIiBoZWlnaHQ9XCIyMzJcIiBmaWxsPVwibm9uZVwiPjxwYXRoIGZpbGw9XCIjRjA2QTZBXCIgZD1cIk0xNzkuMzgzIDU0LjM3M2MwIDMwLjAxNy0yNC4zMzcgNTQuMzc0LTU0LjM1NCA1NC4zNzQtMzAuMDM1IDAtNTQuMzczLTI0LjMzOC01NC4zNzMtNTQuMzc0QzcwLjY1NiAyNC4zMzggOTQuOTkzIDAgMTI1LjAyOSAwYzMwLjAxNyAwIDU0LjM1NCAyNC4zMzggNTQuMzU0IDU0LjM3M1pNNTQuMzkzIDEyMi4zM0MyNC4zNzYgMTIyLjMzLjAyIDE0Ni42NjguMDIgMTc2LjY4NWMwIDMwLjAxNyAyNC4zMzcgNTQuMzczIDU0LjM3MyA1NC4zNzMgMzAuMDM1IDAgNTQuMzczLTI0LjMzOCA1NC4zNzMtNTQuMzczIDAtMzAuMDE3LTI0LjMzOC01NC4zNTUtNTQuMzczLTU0LjM1NVptMTQxLjI1MyAwYy0zMC4wMzUgMC01NC4zNzMgMjQuMzM4LTU0LjM3MyA1NC4zNzQgMCAzMC4wMzUgMjQuMzM4IDU0LjM3MyA1NC4zNzMgNTQuMzczIDMwLjAxNyAwIDU0LjM3NC0yNC4zMzggNTQuMzc0LTU0LjM3MyAwLTMwLjAzNi0yNC4zMzgtNTQuMzc0LTU0LjM3NC01NC4zNzRaXCIvPjwvc3ZnPmAsXG4gICAgICAgICl9YCxcbiAgICAgICAgcHJvdmlkZXJJZDogXCJhc2FuYVwiLFxuICAgICAgICBkZXNjcmlwdGlvbjogXCJDb25uZWN0IHlvdXIgQXNhbmEgYWNjb3VudFwiLFxuICAgICAgfSksXG4gICAgICBjbGllbnRJZDogb3B0aW9ucy5jbGllbnRJZCA/PyBQUk9WSURFUl9DTElFTlRfSURTLmFzYW5hLFxuICAgICAgYXV0aG9yaXplVXJsOiBvcHRpb25zLmF1dGhvcml6ZVVybCA/PyBcImh0dHBzOi8vYXNhbmEub2F1dGgucmF5Y2FzdC5jb20vYXV0aG9yaXplXCIsXG4gICAgICB0b2tlblVybDogb3B0aW9ucy50b2tlblVybCA/PyBcImh0dHBzOi8vYXNhbmEub2F1dGgucmF5Y2FzdC5jb20vdG9rZW5cIixcbiAgICAgIHJlZnJlc2hUb2tlblVybDogb3B0aW9ucy5yZWZyZXNoVG9rZW5VcmwgPz8gXCJodHRwczovL2FzYW5hLm9hdXRoLnJheWNhc3QuY29tL3JlZnJlc2gtdG9rZW5cIixcbiAgICAgIHNjb3BlOiBvcHRpb25zLnNjb3BlLFxuICAgICAgcGVyc29uYWxBY2Nlc3NUb2tlbjogb3B0aW9ucy5wZXJzb25hbEFjY2Vzc1Rva2VuLFxuICAgICAgb25BdXRob3JpemU6IG9wdGlvbnMub25BdXRob3JpemUsXG4gICAgICBib2R5RW5jb2Rpbmc6IG9wdGlvbnMuYm9keUVuY29kaW5nLFxuICAgICAgdG9rZW5SZWZyZXNoUmVzcG9uc2VQYXJzZXI6IG9wdGlvbnMudG9rZW5SZWZyZXNoUmVzcG9uc2VQYXJzZXIsXG4gICAgICB0b2tlblJlc3BvbnNlUGFyc2VyOiBvcHRpb25zLnRva2VuUmVzcG9uc2VQYXJzZXIsXG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogR2l0SHViIE9BdXRoIHNlcnZpY2UgcHJvdmlkZWQgb3V0IG9mIHRoZSBib3guXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqIGBgYHR5cGVzY3JpcHRcbiAgICogY29uc3QgZ2l0aHViID0gT0F1dGhTZXJ2aWNlLmdpdGh1Yih7IHNjb3BlOiAncmVwbyB1c2VyJyB9KVxuICAgKiBgYGBcbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgZ2l0aHViKG9wdGlvbnM6IFByb3ZpZGVyV2l0aERlZmF1bHRDbGllbnRPcHRpb25zKSB7XG4gICAgcmV0dXJuIG5ldyBPQXV0aFNlcnZpY2Uoe1xuICAgICAgY2xpZW50OiBuZXcgT0F1dGguUEtDRUNsaWVudCh7XG4gICAgICAgIHJlZGlyZWN0TWV0aG9kOiBPQXV0aC5SZWRpcmVjdE1ldGhvZC5XZWIsXG4gICAgICAgIHByb3ZpZGVyTmFtZTogXCJHaXRIdWJcIixcbiAgICAgICAgcHJvdmlkZXJJY29uOiB7XG4gICAgICAgICAgc291cmNlOiBgZGF0YTppbWFnZS9zdmcreG1sLCR7ZW5jb2RlVVJJQ29tcG9uZW50KFxuICAgICAgICAgICAgYDxzdmcgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHdpZHRoPVwiNjRcIiBoZWlnaHQ9XCI2NFwiIHZpZXdCb3g9XCIwIDAgMTYgMTZcIj48cGF0aCBmaWxsLXJ1bGU9XCJldmVub2RkXCIgZD1cIk04IDBDMy41OCAwIDAgMy41OCAwIDhjMCAzLjU0IDIuMjkgNi41MyA1LjQ3IDcuNTkuNC4wNy41NS0uMTcuNTUtLjM4IDAtLjE5LS4wMS0uODItLjAxLTEuNDktMi4wMS4zNy0yLjUzLS40OS0yLjY5LS45NC0uMDktLjIzLS40OC0uOTQtLjgyLTEuMTMtLjI4LS4xNS0uNjgtLjUyLS4wMS0uNTMuNjMtLjAxIDEuMDguNTggMS4yMy44Mi43MiAxLjIxIDEuODcuODcgMi4zMy42Ni4wNy0uNTIuMjgtLjg3LjUxLTEuMDctMS43OC0uMi0zLjY0LS44OS0zLjY0LTMuOTUgMC0uODcuMzEtMS41OS44Mi0yLjE1LS4wOC0uMi0uMzYtMS4wMi4wOC0yLjEyIDAgMCAuNjctLjIxIDIuMi44Mi42NC0uMTggMS4zMi0uMjcgMi0uMjcuNjggMCAxLjM2LjA5IDIgLjI3IDEuNTMtMS4wNCAyLjItLjgyIDIuMi0uODIuNDQgMS4xLjE2IDEuOTIuMDggMi4xMi41MS41Ni44MiAxLjI3LjgyIDIuMTUgMCAzLjA3LTEuODcgMy43NS0zLjY1IDMuOTUuMjkuMjUuNTQuNzMuNTQgMS40OCAwIDEuMDctLjAxIDEuOTMtLjAxIDIuMiAwIC4yMS4xNS40Ni41NS4zOEE4LjAxMyA4LjAxMyAwIDAgMCAxNiA4YzAtNC40Mi0zLjU4LTgtOC04elwiLz48L3N2Zz5gLFxuICAgICAgICAgICl9YCxcblxuICAgICAgICAgIHRpbnRDb2xvcjogQ29sb3IuUHJpbWFyeVRleHQsXG4gICAgICAgIH0sXG4gICAgICAgIHByb3ZpZGVySWQ6IFwiZ2l0aHViXCIsXG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIkNvbm5lY3QgeW91ciBHaXRIdWIgYWNjb3VudFwiLFxuICAgICAgfSksXG4gICAgICBjbGllbnRJZDogb3B0aW9ucy5jbGllbnRJZCA/PyBQUk9WSURFUl9DTElFTlRfSURTLmdpdGh1YixcbiAgICAgIGF1dGhvcml6ZVVybDogb3B0aW9ucy5hdXRob3JpemVVcmwgPz8gXCJodHRwczovL2dpdGh1Yi5vYXV0aC5yYXljYXN0LmNvbS9hdXRob3JpemVcIixcbiAgICAgIHRva2VuVXJsOiBvcHRpb25zLnRva2VuVXJsID8/IFwiaHR0cHM6Ly9naXRodWIub2F1dGgucmF5Y2FzdC5jb20vdG9rZW5cIixcbiAgICAgIHJlZnJlc2hUb2tlblVybDogb3B0aW9ucy5yZWZyZXNoVG9rZW5VcmwgPz8gXCJodHRwczovL2dpdGh1Yi5vYXV0aC5yYXljYXN0LmNvbS9yZWZyZXNoLXRva2VuXCIsXG4gICAgICBzY29wZTogb3B0aW9ucy5zY29wZSxcbiAgICAgIHBlcnNvbmFsQWNjZXNzVG9rZW46IG9wdGlvbnMucGVyc29uYWxBY2Nlc3NUb2tlbixcbiAgICAgIG9uQXV0aG9yaXplOiBvcHRpb25zLm9uQXV0aG9yaXplLFxuICAgICAgYm9keUVuY29kaW5nOiBvcHRpb25zLmJvZHlFbmNvZGluZyxcbiAgICAgIHRva2VuUmVmcmVzaFJlc3BvbnNlUGFyc2VyOiBvcHRpb25zLnRva2VuUmVmcmVzaFJlc3BvbnNlUGFyc2VyLFxuICAgICAgdG9rZW5SZXNwb25zZVBhcnNlcjogb3B0aW9ucy50b2tlblJlc3BvbnNlUGFyc2VyLFxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIEdvb2dsZSBPQXV0aCBzZXJ2aWNlIHByb3ZpZGVkIG91dCBvZiB0aGUgYm94LlxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiBgYGB0eXBlc2NyaXB0XG4gICAqIGNvbnN0IGdvb2dsZSA9IE9BdXRoU2VydmljZS5nb29nbGUoe1xuICAgKiAgIGNsaWVudElkOiAnY3VzdG9tLWNsaWVudC1pZCcsXG4gICAqICAgYXV0aG9yaXplVXJsOiAnaHR0cHM6Ly9hY2NvdW50cy5nb29nbGUuY29tL28vb2F1dGgyL3YyL2F1dGgnLFxuICAgKiAgIHRva2VuVXJsOiAnaHR0cHM6Ly9vYXV0aDIuZ29vZ2xlYXBpcy5jb20vdG9rZW4nLFxuICAgKiAgIHNjb3BlOiAnaHR0cHM6Ly93d3cuZ29vZ2xlYXBpcy5jb20vYXV0aC9kcml2ZS5yZWFkb25seScsXG4gICAqIH0pO1xuICAgKiBgYGBcbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgZ29vZ2xlKG9wdGlvbnM6IFByb3ZpZGVyT3B0aW9ucykge1xuICAgIHJldHVybiBuZXcgT0F1dGhTZXJ2aWNlKHtcbiAgICAgIGNsaWVudDogbmV3IE9BdXRoLlBLQ0VDbGllbnQoe1xuICAgICAgICByZWRpcmVjdE1ldGhvZDogT0F1dGguUmVkaXJlY3RNZXRob2QuQXBwVVJJLFxuICAgICAgICBwcm92aWRlck5hbWU6IFwiR29vZ2xlXCIsXG4gICAgICAgIHByb3ZpZGVySWNvbjogYGRhdGE6aW1hZ2Uvc3ZnK3htbCwke2VuY29kZVVSSUNvbXBvbmVudChcbiAgICAgICAgICBgPHN2ZyB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgc3R5bGU9XCJkaXNwbGF5OmJsb2NrXCIgdmlld0JveD1cIjAgMCA0OCA0OFwiPjxwYXRoIGZpbGw9XCIjRUE0MzM1XCIgZD1cIk0yNCA5LjVjMy41NCAwIDYuNzEgMS4yMiA5LjIxIDMuNmw2Ljg1LTYuODVDMzUuOSAyLjM4IDMwLjQ3IDAgMjQgMCAxNC42MiAwIDYuNTEgNS4zOCAyLjU2IDEzLjIybDcuOTggNi4xOUMxMi40MyAxMy43MiAxNy43NCA5LjUgMjQgOS41elwiLz48cGF0aCBmaWxsPVwiIzQyODVGNFwiIGQ9XCJNNDYuOTggMjQuNTVjMC0xLjU3LS4xNS0zLjA5LS4zOC00LjU1SDI0djkuMDJoMTIuOTRjLS41OCAyLjk2LTIuMjYgNS40OC00Ljc4IDcuMThsNy43MyA2YzQuNTEtNC4xOCA3LjA5LTEwLjM2IDcuMDktMTcuNjV6XCIvPjxwYXRoIGZpbGw9XCIjRkJCQzA1XCIgZD1cIk0xMC41MyAyOC41OWMtLjQ4LTEuNDUtLjc2LTIuOTktLjc2LTQuNTlzLjI3LTMuMTQuNzYtNC41OWwtNy45OC02LjE5Qy45MiAxNi40NiAwIDIwLjEyIDAgMjRjMCAzLjg4LjkyIDcuNTQgMi41NiAxMC43OGw3Ljk3LTYuMTl6XCIvPjxwYXRoIGZpbGw9XCIjMzRBODUzXCIgZD1cIk0yNCA0OGM2LjQ4IDAgMTEuOTMtMi4xMyAxNS44OS01LjgxbC03LjczLTZjLTIuMTUgMS40NS00LjkyIDIuMy04LjE2IDIuMy02LjI2IDAtMTEuNTctNC4yMi0xMy40Ny05LjkxbC03Ljk4IDYuMTlDNi41MSA0Mi42MiAxNC42MiA0OCAyNCA0OHpcIi8+PHBhdGggZmlsbD1cIm5vbmVcIiBkPVwiTTAgMGg0OHY0OEgwelwiLz48L3N2Zz5gLFxuICAgICAgICApfWAsXG4gICAgICAgIHByb3ZpZGVySWQ6IFwiZ29vZ2xlXCIsXG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIkNvbm5lY3QgeW91ciBHb29nbGUgYWNjb3VudFwiLFxuICAgICAgfSksXG4gICAgICBjbGllbnRJZDogb3B0aW9ucy5jbGllbnRJZCxcbiAgICAgIGF1dGhvcml6ZVVybDogb3B0aW9ucy5hdXRob3JpemVVcmwgPz8gXCJodHRwczovL2FjY291bnRzLmdvb2dsZS5jb20vby9vYXV0aDIvdjIvYXV0aFwiLFxuICAgICAgdG9rZW5Vcmw6IG9wdGlvbnMudG9rZW5VcmwgPz8gXCJodHRwczovL29hdXRoMi5nb29nbGVhcGlzLmNvbS90b2tlblwiLFxuICAgICAgcmVmcmVzaFRva2VuVXJsOiBvcHRpb25zLnRva2VuVXJsLFxuICAgICAgc2NvcGU6IG9wdGlvbnMuc2NvcGUsXG4gICAgICBwZXJzb25hbEFjY2Vzc1Rva2VuOiBvcHRpb25zLnBlcnNvbmFsQWNjZXNzVG9rZW4sXG4gICAgICBib2R5RW5jb2Rpbmc6IG9wdGlvbnMuYm9keUVuY29kaW5nID8/IFwidXJsLWVuY29kZWRcIixcbiAgICAgIG9uQXV0aG9yaXplOiBvcHRpb25zLm9uQXV0aG9yaXplLFxuICAgICAgdG9rZW5SZWZyZXNoUmVzcG9uc2VQYXJzZXI6IG9wdGlvbnMudG9rZW5SZWZyZXNoUmVzcG9uc2VQYXJzZXIsXG4gICAgICB0b2tlblJlc3BvbnNlUGFyc2VyOiBvcHRpb25zLnRva2VuUmVzcG9uc2VQYXJzZXIsXG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogSmlyYSBPQXV0aCBzZXJ2aWNlIHByb3ZpZGVkIG91dCBvZiB0aGUgYm94LlxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiBgYGB0eXBlc2NyaXB0XG4gICAqIGNvbnN0IGppcmEgPSBPQXV0aFNlcnZpY2UuamlyYSh7XG4gICAqICAgY2xpZW50SWQ6ICdjdXN0b20tY2xpZW50LWlkJyxcbiAgICogICBhdXRob3JpemVVcmw6ICdodHRwczovL2F1dGguYXRsYXNzaWFuLmNvbS9hdXRob3JpemUnLFxuICAgKiAgIHRva2VuVXJsOiAnaHR0cHM6Ly9hcGkuYXRsYXNzaWFuLmNvbS9vYXV0aC90b2tlbicsXG4gICAqICAgc2NvcGU6ICdyZWFkOmppcmEtdXNlciByZWFkOmppcmEtd29yayBvZmZsaW5lX2FjY2VzcydcbiAgICogfSk7XG4gICAqIGBgYFxuICAgKi9cbiAgcHVibGljIHN0YXRpYyBqaXJhKG9wdGlvbnM6IFByb3ZpZGVyT3B0aW9ucykge1xuICAgIHJldHVybiBuZXcgT0F1dGhTZXJ2aWNlKHtcbiAgICAgIGNsaWVudDogbmV3IE9BdXRoLlBLQ0VDbGllbnQoe1xuICAgICAgICByZWRpcmVjdE1ldGhvZDogT0F1dGguUmVkaXJlY3RNZXRob2QuV2ViLFxuICAgICAgICBwcm92aWRlck5hbWU6IFwiSmlyYVwiLFxuICAgICAgICBwcm92aWRlckljb246IGBkYXRhOmltYWdlL3N2Zyt4bWwsJHtlbmNvZGVVUklDb21wb25lbnQoXG4gICAgICAgICAgYDxzdmcgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHhtbG5zOnhsaW5rPVwiaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGlua1wiIHdpZHRoPVwiMjM2MVwiIGhlaWdodD1cIjI1MDBcIiB2aWV3Qm94PVwiMi41OSAwIDIxNC4wOTEgMjI0XCI+PGxpbmVhckdyYWRpZW50IGlkPVwiYVwiIHgxPVwiMTAyLjRcIiB4Mj1cIjU2LjE1XCIgeTE9XCIyMTguNjNcIiB5Mj1cIjE3Mi4zOVwiIGdyYWRpZW50VHJhbnNmb3JtPVwibWF0cml4KDEgMCAwIC0xIDAgMjY0KVwiIGdyYWRpZW50VW5pdHM9XCJ1c2VyU3BhY2VPblVzZVwiPjxzdG9wIG9mZnNldD1cIi4xOFwiIHN0b3AtY29sb3I9XCIjMDA1MmNjXCIvPjxzdG9wIG9mZnNldD1cIjFcIiBzdG9wLWNvbG9yPVwiIzI2ODRmZlwiLz48L2xpbmVhckdyYWRpZW50PjxsaW5lYXJHcmFkaWVudCB4bGluazpocmVmPVwiI2FcIiBpZD1cImJcIiB4MT1cIjExNC42NVwiIHgyPVwiMTYwLjgxXCIgeTE9XCI4NS43N1wiIHkyPVwiMTMxLjkyXCIvPjxwYXRoIGZpbGw9XCIjMjY4NGZmXCIgZD1cIk0yMTQuMDYgMTA1LjczIDExNy42NyA5LjM0IDEwOC4zMyAwIDM1Ljc3IDcyLjU2IDIuNTkgMTA1LjczYTguODkgOC44OSAwIDAgMCAwIDEyLjU0bDY2LjI5IDY2LjI5TDEwOC4zMyAyMjRsNzIuNTUtNzIuNTYgMS4xMy0xLjEyIDMyLjA1LTMyYTguODcgOC44NyAwIDAgMCAwLTEyLjU5em0tMTA1LjczIDM5LjM5TDc1LjIxIDExMmwzMy4xMi0zMy4xMkwxNDEuNDQgMTEyelwiLz48cGF0aCBmaWxsPVwidXJsKCNhKVwiIGQ9XCJNMTA4LjMzIDc4Ljg4YTU1Ljc1IDU1Ljc1IDAgMCAxLS4yNC03OC42MUwzNS42MiA3Mi43MWwzOS40NCAzOS40NHpcIi8+PHBhdGggZmlsbD1cInVybCgjYilcIiBkPVwibTE0MS41MyAxMTEuOTEtMzMuMiAzMy4yMWE1NS43NyA1NS43NyAwIDAgMSAwIDc4Ljg2TDE4MSAxNTEuMzV6XCIvPjwvc3ZnPmAsXG4gICAgICAgICl9YCxcbiAgICAgICAgcHJvdmlkZXJJZDogXCJqaXJhXCIsXG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIkNvbm5lY3QgeW91ciBKaXJhIGFjY291bnRcIixcbiAgICAgIH0pLFxuICAgICAgY2xpZW50SWQ6IG9wdGlvbnMuY2xpZW50SWQsXG4gICAgICBhdXRob3JpemVVcmw6IG9wdGlvbnMuYXV0aG9yaXplVXJsID8/IFwiaHR0cHM6Ly9hdXRoLmF0bGFzc2lhbi5jb20vYXV0aG9yaXplXCIsXG4gICAgICB0b2tlblVybDogb3B0aW9ucy50b2tlblVybCA/PyBcImh0dHBzOi8vYXV0aC5hdGxhc3NpYW4uY29tL29hdXRoL3Rva2VuXCIsXG4gICAgICByZWZyZXNoVG9rZW5Vcmw6IG9wdGlvbnMucmVmcmVzaFRva2VuVXJsLFxuICAgICAgc2NvcGU6IG9wdGlvbnMuc2NvcGUsXG4gICAgICBwZXJzb25hbEFjY2Vzc1Rva2VuOiBvcHRpb25zLnBlcnNvbmFsQWNjZXNzVG9rZW4sXG4gICAgICBvbkF1dGhvcml6ZTogb3B0aW9ucy5vbkF1dGhvcml6ZSxcbiAgICAgIGJvZHlFbmNvZGluZzogb3B0aW9ucy5ib2R5RW5jb2RpbmcsXG4gICAgICB0b2tlblJlZnJlc2hSZXNwb25zZVBhcnNlcjogb3B0aW9ucy50b2tlblJlZnJlc2hSZXNwb25zZVBhcnNlcixcbiAgICAgIHRva2VuUmVzcG9uc2VQYXJzZXI6IG9wdGlvbnMudG9rZW5SZXNwb25zZVBhcnNlcixcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBMaW5lYXIgT0F1dGggc2VydmljZSBwcm92aWRlZCBvdXQgb2YgdGhlIGJveC5cbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogYGBgdHlwZXNjcmlwdFxuICAgKiBjb25zdCBsaW5lYXIgPSBPQXV0aFNlcnZpY2UubGluZWFyKHsgc2NvcGU6ICdyZWFkIHdyaXRlJyB9KVxuICAgKiBgYGBcbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgbGluZWFyKG9wdGlvbnM6IFByb3ZpZGVyV2l0aERlZmF1bHRDbGllbnRPcHRpb25zKSB7XG4gICAgcmV0dXJuIG5ldyBPQXV0aFNlcnZpY2Uoe1xuICAgICAgY2xpZW50OiBuZXcgT0F1dGguUEtDRUNsaWVudCh7XG4gICAgICAgIHJlZGlyZWN0TWV0aG9kOiBPQXV0aC5SZWRpcmVjdE1ldGhvZC5XZWIsXG4gICAgICAgIHByb3ZpZGVyTmFtZTogXCJMaW5lYXJcIixcbiAgICAgICAgcHJvdmlkZXJJY29uOiB7XG4gICAgICAgICAgc291cmNlOiB7XG4gICAgICAgICAgICBsaWdodDogYGRhdGE6aW1hZ2Uvc3ZnK3htbCwke2VuY29kZVVSSUNvbXBvbmVudChcbiAgICAgICAgICAgICAgYDxzdmcgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIGZpbGw9XCIjMjIyMzI2XCIgd2lkdGg9XCIyMDBcIiBoZWlnaHQ9XCIyMDBcIiB2aWV3Qm94PVwiMCAwIDEwMCAxMDBcIj48cGF0aCBkPVwiTTEuMjI1NDEgNjEuNTIyOGMtLjIyMjUtLjk0ODUuOTA3NDgtMS41NDU5IDEuNTk2MzgtLjg1N0wzOS4zMzQyIDk3LjE3ODJjLjY4ODkuNjg4OS4wOTE1IDEuODE4OS0uODU3IDEuNTk2NEMyMC4wNTE1IDk0LjQ1MjIgNS41NDc3OSA3OS45NDg1IDEuMjI1NDEgNjEuNTIyOFpNLjAwMTg5MTM1IDQ2Ljg4OTFjLS4wMTc2NDM3NS4yODMzLjA4ODg3MjE1LjU1OTkuMjg5NTcxNjUuNzYwNkw1Mi4zNTAzIDk5LjcwODVjLjIwMDcuMjAwNy40NzczLjMwNzUuNzYwNi4yODk2IDIuMzY5Mi0uMTQ3NiA0LjY5MzgtLjQ2IDYuOTYyNC0uOTI1OS43NjQ1LS4xNTcgMS4wMzAxLTEuMDk2My40NzgyLTEuNjQ4MUwyLjU3NTk1IDM5LjQ0ODVjLS41NTE4Ni0uNTUxOS0xLjQ5MTE3LS4yODYzLTEuNjQ4MTc0LjQ3ODItLjQ2NTkxNSAyLjI2ODYtLjc3ODMyIDQuNTkzMi0uOTI1ODg0NjUgNi45NjI0Wk00LjIxMDkzIDI5LjcwNTRjLS4xNjY0OS4zNzM4LS4wODE2OS44MTA2LjIwNzY1IDEuMWw2NC43NzYwMiA2NC43NzZjLjI4OTQuMjg5NC43MjYyLjM3NDIgMS4xLjIwNzcgMS43ODYxLS43OTU2IDMuNTE3MS0xLjY5MjcgNS4xODU1LTIuNjg0LjU1MjEtLjMyOC42MzczLTEuMDg2Ny4xODMyLTEuNTQwN0w4LjQzNTY2IDI0LjMzNjdjLS40NTQwOS0uNDU0MS0xLjIxMjcxLS4zNjg5LTEuNTQwNzQuMTgzMi0uOTkxMzIgMS42Njg0LTEuODg4NDMgMy4zOTk0LTIuNjgzOTkgNS4xODU1Wk0xMi42NTg3IDE4LjA3NGMtLjM3MDEtLjM3MDEtLjM5My0uOTYzNy0uMDQ0My0xLjM1NDFDMjEuNzc5NSA2LjQ1OTMxIDM1LjExMTQgMCA0OS45NTE5IDAgNzcuNTkyNyAwIDEwMCAyMi40MDczIDEwMCA1MC4wNDgxYzAgMTQuODQwNS02LjQ1OTMgMjguMTcyNC0xNi43MTk5IDM3LjMzNzUtLjM5MDMuMzQ4Ny0uOTg0LjMyNTgtMS4zNTQyLS4wNDQzTDEyLjY1ODcgMTguMDc0WlwiLz48L3N2Zz5gLFxuICAgICAgICAgICAgKX1gLFxuICAgICAgICAgICAgZGFyazogYGRhdGE6aW1hZ2Uvc3ZnK3htbCwke2VuY29kZVVSSUNvbXBvbmVudChcbiAgICAgICAgICAgICAgYDxzdmcgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIGZpbGw9XCIjZmZmXCIgd2lkdGg9XCIyMDBcIiBoZWlnaHQ9XCIyMDBcIiB2aWV3Qm94PVwiMCAwIDEwMCAxMDBcIj48cGF0aCBkPVwiTTEuMjI1NDEgNjEuNTIyOGMtLjIyMjUtLjk0ODUuOTA3NDgtMS41NDU5IDEuNTk2MzgtLjg1N0wzOS4zMzQyIDk3LjE3ODJjLjY4ODkuNjg4OS4wOTE1IDEuODE4OS0uODU3IDEuNTk2NEMyMC4wNTE1IDk0LjQ1MjIgNS41NDc3OSA3OS45NDg1IDEuMjI1NDEgNjEuNTIyOFpNLjAwMTg5MTM1IDQ2Ljg4OTFjLS4wMTc2NDM3NS4yODMzLjA4ODg3MjE1LjU1OTkuMjg5NTcxNjUuNzYwNkw1Mi4zNTAzIDk5LjcwODVjLjIwMDcuMjAwNy40NzczLjMwNzUuNzYwNi4yODk2IDIuMzY5Mi0uMTQ3NiA0LjY5MzgtLjQ2IDYuOTYyNC0uOTI1OS43NjQ1LS4xNTcgMS4wMzAxLTEuMDk2My40NzgyLTEuNjQ4MUwyLjU3NTk1IDM5LjQ0ODVjLS41NTE4Ni0uNTUxOS0xLjQ5MTE3LS4yODYzLTEuNjQ4MTc0LjQ3ODItLjQ2NTkxNSAyLjI2ODYtLjc3ODMyIDQuNTkzMi0uOTI1ODg0NjUgNi45NjI0Wk00LjIxMDkzIDI5LjcwNTRjLS4xNjY0OS4zNzM4LS4wODE2OS44MTA2LjIwNzY1IDEuMWw2NC43NzYwMiA2NC43NzZjLjI4OTQuMjg5NC43MjYyLjM3NDIgMS4xLjIwNzcgMS43ODYxLS43OTU2IDMuNTE3MS0xLjY5MjcgNS4xODU1LTIuNjg0LjU1MjEtLjMyOC42MzczLTEuMDg2Ny4xODMyLTEuNTQwN0w4LjQzNTY2IDI0LjMzNjdjLS40NTQwOS0uNDU0MS0xLjIxMjcxLS4zNjg5LTEuNTQwNzQuMTgzMi0uOTkxMzIgMS42Njg0LTEuODg4NDMgMy4zOTk0LTIuNjgzOTkgNS4xODU1Wk0xMi42NTg3IDE4LjA3NGMtLjM3MDEtLjM3MDEtLjM5My0uOTYzNy0uMDQ0My0xLjM1NDFDMjEuNzc5NSA2LjQ1OTMxIDM1LjExMTQgMCA0OS45NTE5IDAgNzcuNTkyNyAwIDEwMCAyMi40MDczIDEwMCA1MC4wNDgxYzAgMTQuODQwNS02LjQ1OTMgMjguMTcyNC0xNi43MTk5IDM3LjMzNzUtLjM5MDMuMzQ4Ny0uOTg0LjMyNTgtMS4zNTQyLS4wNDQzTDEyLjY1ODcgMTguMDc0WlwiIC8+PC9zdmc+YCxcbiAgICAgICAgICAgICl9YCxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICBwcm92aWRlcklkOiBcImxpbmVhclwiLFxuICAgICAgICBkZXNjcmlwdGlvbjogXCJDb25uZWN0IHlvdXIgTGluZWFyIGFjY291bnRcIixcbiAgICAgIH0pLFxuICAgICAgY2xpZW50SWQ6IG9wdGlvbnMuY2xpZW50SWQgPz8gUFJPVklERVJfQ0xJRU5UX0lEUy5saW5lYXIsXG4gICAgICBhdXRob3JpemVVcmw6IG9wdGlvbnMuYXV0aG9yaXplVXJsID8/IFwiaHR0cHM6Ly9saW5lYXIub2F1dGgucmF5Y2FzdC5jb20vYXV0aG9yaXplXCIsXG4gICAgICB0b2tlblVybDogb3B0aW9ucy50b2tlblVybCA/PyBcImh0dHBzOi8vbGluZWFyLm9hdXRoLnJheWNhc3QuY29tL3Rva2VuXCIsXG4gICAgICByZWZyZXNoVG9rZW5Vcmw6IG9wdGlvbnMucmVmcmVzaFRva2VuVXJsID8/IFwiaHR0cHM6Ly9saW5lYXIub2F1dGgucmF5Y2FzdC5jb20vcmVmcmVzaC10b2tlblwiLFxuICAgICAgc2NvcGU6IG9wdGlvbnMuc2NvcGUsXG4gICAgICBleHRyYVBhcmFtZXRlcnM6IHtcbiAgICAgICAgYWN0b3I6IFwidXNlclwiLFxuICAgICAgfSxcbiAgICAgIG9uQXV0aG9yaXplOiBvcHRpb25zLm9uQXV0aG9yaXplLFxuICAgICAgYm9keUVuY29kaW5nOiBvcHRpb25zLmJvZHlFbmNvZGluZyxcbiAgICAgIHRva2VuUmVmcmVzaFJlc3BvbnNlUGFyc2VyOiBvcHRpb25zLnRva2VuUmVmcmVzaFJlc3BvbnNlUGFyc2VyLFxuICAgICAgdG9rZW5SZXNwb25zZVBhcnNlcjogb3B0aW9ucy50b2tlblJlc3BvbnNlUGFyc2VyLFxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFNsYWNrIE9BdXRoIHNlcnZpY2UgcHJvdmlkZWQgb3V0IG9mIHRoZSBib3guXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqIGBgYHR5cGVzY3JpcHRcbiAgICogY29uc3Qgc2xhY2sgPSBPQXV0aFNlcnZpY2Uuc2xhY2soeyBzY29wZTogJ2Vtb2ppOnJlYWQnIH0pXG4gICAqIGBgYFxuICAgKi9cbiAgcHVibGljIHN0YXRpYyBzbGFjayhvcHRpb25zOiBQcm92aWRlcldpdGhEZWZhdWx0Q2xpZW50T3B0aW9ucykge1xuICAgIHJldHVybiBuZXcgT0F1dGhTZXJ2aWNlKHtcbiAgICAgIGNsaWVudDogbmV3IE9BdXRoLlBLQ0VDbGllbnQoe1xuICAgICAgICByZWRpcmVjdE1ldGhvZDogT0F1dGguUmVkaXJlY3RNZXRob2QuV2ViLFxuICAgICAgICBwcm92aWRlck5hbWU6IFwiU2xhY2tcIixcbiAgICAgICAgcHJvdmlkZXJJY29uOiBgZGF0YTppbWFnZS9zdmcreG1sLCR7ZW5jb2RlVVJJQ29tcG9uZW50KFxuICAgICAgICAgIGA8c3ZnIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiB2aWV3Qm94PVwiNzMgNzMgMTI0IDEyNFwiPjxzdHlsZT4uc3Qwe2ZpbGw6I2UwMWU1YX0uc3Qxe2ZpbGw6IzM2YzVmMH0uc3Qye2ZpbGw6IzJlYjY3ZH0uc3Qze2ZpbGw6I2VjYjIyZX08L3N0eWxlPjxwYXRoIGQ9XCJNOTkuNCAxNTEuMmMwIDcuMS01LjggMTIuOS0xMi45IDEyLjktNy4xIDAtMTIuOS01LjgtMTIuOS0xMi45IDAtNy4xIDUuOC0xMi45IDEyLjktMTIuOWgxMi45djEyLjl6TTEwNS45IDE1MS4yYzAtNy4xIDUuOC0xMi45IDEyLjktMTIuOXMxMi45IDUuOCAxMi45IDEyLjl2MzIuM2MwIDcuMS01LjggMTIuOS0xMi45IDEyLjlzLTEyLjktNS44LTEyLjktMTIuOXYtMzIuM3pcIiBjbGFzcz1cInN0MFwiLz48cGF0aCBkPVwiTTExOC44IDk5LjRjLTcuMSAwLTEyLjktNS44LTEyLjktMTIuOSAwLTcuMSA1LjgtMTIuOSAxMi45LTEyLjlzMTIuOSA1LjggMTIuOSAxMi45djEyLjloLTEyLjl6TTExOC44IDEwNS45YzcuMSAwIDEyLjkgNS44IDEyLjkgMTIuOXMtNS44IDEyLjktMTIuOSAxMi45SDg2LjVjLTcuMSAwLTEyLjktNS44LTEyLjktMTIuOXM1LjgtMTIuOSAxMi45LTEyLjloMzIuM3pcIiBjbGFzcz1cInN0MVwiLz48cGF0aCBkPVwiTTE3MC42IDExOC44YzAtNy4xIDUuOC0xMi45IDEyLjktMTIuOSA3LjEgMCAxMi45IDUuOCAxMi45IDEyLjlzLTUuOCAxMi45LTEyLjkgMTIuOWgtMTIuOXYtMTIuOXpNMTY0LjEgMTE4LjhjMCA3LjEtNS44IDEyLjktMTIuOSAxMi45LTcuMSAwLTEyLjktNS44LTEyLjktMTIuOVY4Ni41YzAtNy4xIDUuOC0xMi45IDEyLjktMTIuOSA3LjEgMCAxMi45IDUuOCAxMi45IDEyLjl2MzIuM3pcIiBjbGFzcz1cInN0MlwiLz48cGF0aCBkPVwiTTE1MS4yIDE3MC42YzcuMSAwIDEyLjkgNS44IDEyLjkgMTIuOSAwIDcuMS01LjggMTIuOS0xMi45IDEyLjktNy4xIDAtMTIuOS01LjgtMTIuOS0xMi45di0xMi45aDEyLjl6TTE1MS4yIDE2NC4xYy03LjEgMC0xMi45LTUuOC0xMi45LTEyLjkgMC03LjEgNS44LTEyLjkgMTIuOS0xMi45aDMyLjNjNy4xIDAgMTIuOSA1LjggMTIuOSAxMi45IDAgNy4xLTUuOCAxMi45LTEyLjkgMTIuOWgtMzIuM3pcIiBjbGFzcz1cInN0M1wiLz48L3N2Zz5gLFxuICAgICAgICApfWAsXG4gICAgICAgIHByb3ZpZGVySWQ6IFwic2xhY2tcIixcbiAgICAgICAgZGVzY3JpcHRpb246IFwiQ29ubmVjdCB5b3VyIFNsYWNrIGFjY291bnRcIixcbiAgICAgIH0pLFxuICAgICAgY2xpZW50SWQ6IG9wdGlvbnMuY2xpZW50SWQgPz8gUFJPVklERVJfQ0xJRU5UX0lEUy5zbGFjayxcbiAgICAgIGF1dGhvcml6ZVVybDogb3B0aW9ucy5hdXRob3JpemVVcmwgPz8gXCJodHRwczovL3NsYWNrLm9hdXRoLnJheWNhc3QuY29tL2F1dGhvcml6ZVwiLFxuICAgICAgdG9rZW5Vcmw6IG9wdGlvbnMudG9rZW5VcmwgPz8gXCJodHRwczovL3NsYWNrLm9hdXRoLnJheWNhc3QuY29tL3Rva2VuXCIsXG4gICAgICByZWZyZXNoVG9rZW5Vcmw6IG9wdGlvbnMudG9rZW5VcmwgPz8gXCJodHRwczovL3NsYWNrLm9hdXRoLnJheWNhc3QuY29tL3JlZnJlc2gtdG9rZW5cIixcbiAgICAgIHNjb3BlOiBcIlwiLFxuICAgICAgZXh0cmFQYXJhbWV0ZXJzOiB7XG4gICAgICAgIHVzZXJfc2NvcGU6IG9wdGlvbnMuc2NvcGUsXG4gICAgICB9LFxuICAgICAgcGVyc29uYWxBY2Nlc3NUb2tlbjogb3B0aW9ucy5wZXJzb25hbEFjY2Vzc1Rva2VuLFxuICAgICAgYm9keUVuY29kaW5nOiBvcHRpb25zLnRva2VuVXJsID8gb3B0aW9ucy5ib2R5RW5jb2RpbmcgPz8gXCJ1cmwtZW5jb2RlZFwiIDogXCJqc29uXCIsXG4gICAgICBvbkF1dGhvcml6ZTogb3B0aW9ucy5vbkF1dGhvcml6ZSxcbiAgICAgIHRva2VuUmVmcmVzaFJlc3BvbnNlUGFyc2VyOiBvcHRpb25zLnRva2VuUmVmcmVzaFJlc3BvbnNlUGFyc2VyLFxuICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICAgIHRva2VuUmVzcG9uc2VQYXJzZXI6XG4gICAgICAgIG9wdGlvbnMudG9rZW5SZXNwb25zZVBhcnNlciA/P1xuICAgICAgICAoKHJlc3BvbnNlOiBhbnkpID0+IHtcbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgYWNjZXNzX3Rva2VuOiByZXNwb25zZS5hdXRoZWRfdXNlci5hY2Nlc3NfdG9rZW4sXG4gICAgICAgICAgICBzY29wZTogcmVzcG9uc2UuYXV0aGVkX3VzZXIuc2NvcGUsXG4gICAgICAgICAgfTtcbiAgICAgICAgfSksXG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogWm9vbSBPQXV0aCBzZXJ2aWNlIHByb3ZpZGVkIG91dCBvZiB0aGUgYm94LlxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiBgYGB0eXBlc2NyaXB0XG4gICAqIGNvbnN0IHpvb20gPSBPQXV0aFNlcnZpY2Uuem9vbSh7XG4gICAqICAgY2xpZW50SWQ6ICdjdXN0b20tY2xpZW50LWlkJyxcbiAgICogICBhdXRob3JpemVVcmw6ICdodHRwczovL3pvb20udXMvb2F1dGgvYXV0aG9yaXplJyxcbiAgICogICB0b2tlblVybDogJ2h0dHBzOi8vem9vbS51cy9vYXV0aC90b2tlbicsXG4gICAqICAgc2NvcGU6ICdtZWV0aW5nOndyaXRlJyxcbiAgICogICBwZXJzb25hbEFjY2Vzc1Rva2VuOiAncGVyc29uYWwtYWNjZXNzLXRva2VuJyxcbiAgICogfSk7XG4gICAqIGBgYFxuICAgKi9cbiAgcHVibGljIHN0YXRpYyB6b29tKG9wdGlvbnM6IFByb3ZpZGVyT3B0aW9ucykge1xuICAgIHJldHVybiBuZXcgT0F1dGhTZXJ2aWNlKHtcbiAgICAgIGNsaWVudDogbmV3IE9BdXRoLlBLQ0VDbGllbnQoe1xuICAgICAgICByZWRpcmVjdE1ldGhvZDogT0F1dGguUmVkaXJlY3RNZXRob2QuV2ViLFxuICAgICAgICBwcm92aWRlck5hbWU6IFwiWm9vbVwiLFxuICAgICAgICBwcm92aWRlckljb246IGBkYXRhOmltYWdlL3N2Zyt4bWwsJHtlbmNvZGVVUklDb21wb25lbnQoXG4gICAgICAgICAgYDxzdmcgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHZpZXdCb3g9XCIwIDAgMzUxLjg0NSA4MFwiPjxwYXRoIGQ9XCJNNzMuNzg2IDc4LjgzNUgxMC44OEExMC44NDIgMTAuODQyIDAgMCAxIC44MzMgNzIuMTIyYTEwLjg0MSAxMC44NDEgMCAwIDEgMi4zNTctMTEuODVMNDYuNzY0IDE2LjdoLTMxLjIzQzYuOTU0IDE2LjY5OSAwIDkuNzQ0IDAgMS4xNjVoNTguMDE0YzQuNDE0IDAgOC4zNTcgMi42MzQgMTAuMDQ2IDYuNzEyYTEwLjg0MyAxMC44NDMgMCAwIDEtMi4zNTYgMTEuODVMMjIuMTMgNjMuMzAyaDM2LjEyMmM4LjU4IDAgMTUuNTM0IDYuOTU1IDE1LjUzNCAxNS41MzRabTI3OC4wNTktNDguNTQ0QzM1MS44NDUgMTMuNTg4IDMzOC4yNTYgMCAzMjEuNTUzIDBjLTguOTM0IDAtMTYuOTc1IDMuODktMjIuNTI0IDEwLjA2M0MyOTMuNDggMy44OSAyODUuNDQgMCAyNzYuNTA1IDBjLTE2LjcwMyAwLTMwLjI5MSAxMy41ODgtMzAuMjkxIDMwLjI5MXY0OC41NDRjOC41NzkgMCAxNS41MzQtNi45NTUgMTUuNTM0LTE1LjUzNHYtMzMuMDFjMC04LjEzNyA2LjYyLTE0Ljc1NyAxNC43NTctMTQuNzU3czE0Ljc1NyA2LjYyIDE0Ljc1NyAxNC43NTd2MzMuMDFjMCA4LjU4IDYuOTU1IDE1LjUzNCAxNS41MzQgMTUuNTM0VjMwLjI5MWMwLTguMTM3IDYuNjItMTQuNzU3IDE0Ljc1Ny0xNC43NTdzMTQuNzU4IDYuNjIgMTQuNzU4IDE0Ljc1N3YzMy4wMWMwIDguNTggNi45NTQgMTUuNTM0IDE1LjUzNCAxNS41MzRWMzAuMjkxWk0yMzguNDQ3IDQwYzAgMjIuMDkxLTE3LjkwOSA0MC00MCA0MHMtNDAtMTcuOTA5LTQwLTQwIDE3LjkwOC00MCA0MC00MCA0MCAxNy45MDkgNDAgNDBabS0xNS41MzQgMGMwLTEzLjUxMi0xMC45NTQtMjQuNDY2LTI0LjQ2Ni0yNC40NjZTMTczLjk4IDI2LjQ4OCAxNzMuOTggNDBzMTAuOTUzIDI0LjQ2NiAyNC40NjYgMjQuNDY2UzIyMi45MTMgNTMuNTEyIDIyMi45MTMgNDBabS03MC42OCAwYzAgMjIuMDkxLTE3LjkwOSA0MC00MCA0MHMtNDAtMTcuOTA5LTQwLTQwIDE3LjkwOS00MCA0MC00MCA0MCAxNy45MDkgNDAgNDBabS0xNS41MzQgMGMwLTEzLjUxMi0xMC45NTQtMjQuNDY2LTI0LjQ2Ni0yNC40NjZTODcuNzY3IDI2LjQ4OCA4Ny43NjcgNDBzMTAuOTU0IDI0LjQ2NiAyNC40NjYgMjQuNDY2UzEzNi42OTkgNTMuNTEyIDEzNi42OTkgNDBaXCIgc3R5bGU9XCJmaWxsOiMwYjVjZmZcIi8+PC9zdmc+YCxcbiAgICAgICAgKX1gLFxuICAgICAgICBwcm92aWRlcklkOiBcInpvb21cIixcbiAgICAgICAgZGVzY3JpcHRpb246IFwiQ29ubmVjdCB5b3VyIFpvb20gYWNjb3VudFwiLFxuICAgICAgfSksXG4gICAgICBjbGllbnRJZDogb3B0aW9ucy5jbGllbnRJZCxcbiAgICAgIGF1dGhvcml6ZVVybDogb3B0aW9ucy5hdXRob3JpemVVcmwgPz8gXCJodHRwczovL3pvb20udXMvb2F1dGgvYXV0aG9yaXplXCIsXG4gICAgICB0b2tlblVybDogb3B0aW9ucy50b2tlblVybCA/PyBcImh0dHBzOi8vem9vbS51cy9vYXV0aC90b2tlblwiLFxuICAgICAgcmVmcmVzaFRva2VuVXJsOiBvcHRpb25zLnJlZnJlc2hUb2tlblVybCxcbiAgICAgIHNjb3BlOiBvcHRpb25zLnNjb3BlLFxuICAgICAgcGVyc29uYWxBY2Nlc3NUb2tlbjogb3B0aW9ucy5wZXJzb25hbEFjY2Vzc1Rva2VuLFxuICAgICAgYm9keUVuY29kaW5nOiBvcHRpb25zLmJvZHlFbmNvZGluZyA/PyBcInVybC1lbmNvZGVkXCIsXG4gICAgICBvbkF1dGhvcml6ZTogb3B0aW9ucy5vbkF1dGhvcml6ZSxcbiAgICAgIHRva2VuUmVmcmVzaFJlc3BvbnNlUGFyc2VyOiBvcHRpb25zLnRva2VuUmVmcmVzaFJlc3BvbnNlUGFyc2VyLFxuICAgICAgdG9rZW5SZXNwb25zZVBhcnNlcjogb3B0aW9ucy50b2tlblJlc3BvbnNlUGFyc2VyLFxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIEluaXRpYXRlcyB0aGUgT0F1dGggYXV0aG9yaXphdGlvbiBwcm9jZXNzIG9yIHJlZnJlc2hlcyBleGlzdGluZyB0b2tlbnMgaWYgbmVjZXNzYXJ5LlxuICAgKiBJZiB0aGUgY3VycmVudCB0b2tlbiBzZXQgaGFzIGEgcmVmcmVzaCB0b2tlbiBhbmQgaXQgaXMgZXhwaXJlZCwgdGhlbiB0aGUgZnVuY3Rpb24gd2lsbCByZWZyZXNoIHRoZSB0b2tlbnMuXG4gICAqIElmIG5vIHRva2VucyBleGlzdCwgaXQgd2lsbCBpbml0aWF0ZSB0aGUgT0F1dGggYXV0aG9yaXphdGlvbiBwcm9jZXNzIGFuZCBmZXRjaCB0aGUgdG9rZW5zLlxuICAgKlxuICAgKiBAcmV0dXJucyB7UHJvbWlzZTxzdHJpbmc+fSBBIHByb21pc2UgdGhhdCByZXNvbHZlcyB3aXRoIHRoZSBhY2Nlc3MgdG9rZW4gb2J0YWluZWQgZnJvbSB0aGUgYXV0aG9yaXphdGlvbiBmbG93LCBvciBudWxsIGlmIHRoZSB0b2tlbiBjb3VsZCBub3QgYmUgb2J0YWluZWQuXG4gICAqL1xuICBhc3luYyBhdXRob3JpemUoKSB7XG4gICAgY29uc3QgY3VycmVudFRva2VuU2V0ID0gYXdhaXQgdGhpcy5jbGllbnQuZ2V0VG9rZW5zKCk7XG4gICAgaWYgKGN1cnJlbnRUb2tlblNldD8uYWNjZXNzVG9rZW4pIHtcbiAgICAgIGlmIChjdXJyZW50VG9rZW5TZXQucmVmcmVzaFRva2VuICYmIGN1cnJlbnRUb2tlblNldC5pc0V4cGlyZWQoKSkge1xuICAgICAgICBjb25zdCB0b2tlbnMgPSBhd2FpdCB0aGlzLnJlZnJlc2hUb2tlbnMoe1xuICAgICAgICAgIHRva2VuOiBjdXJyZW50VG9rZW5TZXQucmVmcmVzaFRva2VuLFxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBJbiB0aGUgY2FzZSB3aGVyZSB0aGUgcmVmcmVzaCB0b2tlbiBmbG93cyBmYWlscywgbm90aGluZyBpcyByZXR1cm5lZCBhbmQgdGhlIGF1dGhvcml6ZSBmdW5jdGlvbiBpcyBjYWxsZWQgYWdhaW4uXG4gICAgICAgIGlmICh0b2tlbnMpIHtcbiAgICAgICAgICBhd2FpdCB0aGlzLmNsaWVudC5zZXRUb2tlbnModG9rZW5zKTtcbiAgICAgICAgICByZXR1cm4gdG9rZW5zLmFjY2Vzc190b2tlbjtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIGN1cnJlbnRUb2tlblNldC5hY2Nlc3NUb2tlbjtcbiAgICB9XG5cbiAgICBjb25zdCBhdXRoUmVxdWVzdCA9IGF3YWl0IHRoaXMuY2xpZW50LmF1dGhvcml6YXRpb25SZXF1ZXN0KHtcbiAgICAgIGVuZHBvaW50OiB0aGlzLmF1dGhvcml6ZVVybCxcbiAgICAgIGNsaWVudElkOiB0aGlzLmNsaWVudElkLFxuICAgICAgc2NvcGU6IHRoaXMuc2NvcGUsXG4gICAgICBleHRyYVBhcmFtZXRlcnM6IHRoaXMuZXh0cmFQYXJhbWV0ZXJzLFxuICAgIH0pO1xuXG4gICAgY29uc3QgeyBhdXRob3JpemF0aW9uQ29kZSB9ID0gYXdhaXQgdGhpcy5jbGllbnQuYXV0aG9yaXplKGF1dGhSZXF1ZXN0KTtcbiAgICBjb25zdCB0b2tlbnMgPSBhd2FpdCB0aGlzLmZldGNoVG9rZW5zKHtcbiAgICAgIGF1dGhSZXF1ZXN0LFxuICAgICAgYXV0aG9yaXphdGlvbkNvZGUsXG4gICAgfSk7XG5cbiAgICBhd2FpdCB0aGlzLmNsaWVudC5zZXRUb2tlbnModG9rZW5zKTtcblxuICAgIHJldHVybiB0b2tlbnMuYWNjZXNzX3Rva2VuO1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBmZXRjaFRva2Vucyh7XG4gICAgYXV0aFJlcXVlc3QsXG4gICAgYXV0aG9yaXphdGlvbkNvZGUsXG4gIH06IHtcbiAgICBhdXRoUmVxdWVzdDogT0F1dGguQXV0aG9yaXphdGlvblJlcXVlc3Q7XG4gICAgYXV0aG9yaXphdGlvbkNvZGU6IHN0cmluZztcbiAgfSkge1xuICAgIGxldCBvcHRpb25zO1xuICAgIGlmICh0aGlzLmJvZHlFbmNvZGluZyA9PT0gXCJ1cmwtZW5jb2RlZFwiKSB7XG4gICAgICBjb25zdCBwYXJhbXMgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKCk7XG4gICAgICBwYXJhbXMuYXBwZW5kKFwiY2xpZW50X2lkXCIsIHRoaXMuY2xpZW50SWQpO1xuICAgICAgcGFyYW1zLmFwcGVuZChcImNvZGVcIiwgYXV0aG9yaXphdGlvbkNvZGUpO1xuICAgICAgcGFyYW1zLmFwcGVuZChcImNvZGVfdmVyaWZpZXJcIiwgYXV0aFJlcXVlc3QuY29kZVZlcmlmaWVyKTtcbiAgICAgIHBhcmFtcy5hcHBlbmQoXCJncmFudF90eXBlXCIsIFwiYXV0aG9yaXphdGlvbl9jb2RlXCIpO1xuICAgICAgcGFyYW1zLmFwcGVuZChcInJlZGlyZWN0X3VyaVwiLCBhdXRoUmVxdWVzdC5yZWRpcmVjdFVSSSk7XG5cbiAgICAgIG9wdGlvbnMgPSB7IGJvZHk6IHBhcmFtcyB9O1xuICAgIH0gZWxzZSB7XG4gICAgICBvcHRpb25zID0ge1xuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgY2xpZW50X2lkOiB0aGlzLmNsaWVudElkLFxuICAgICAgICAgIGNvZGU6IGF1dGhvcml6YXRpb25Db2RlLFxuICAgICAgICAgIGNvZGVfdmVyaWZpZXI6IGF1dGhSZXF1ZXN0LmNvZGVWZXJpZmllcixcbiAgICAgICAgICBncmFudF90eXBlOiBcImF1dGhvcml6YXRpb25fY29kZVwiLFxuICAgICAgICAgIHJlZGlyZWN0X3VyaTogYXV0aFJlcXVlc3QucmVkaXJlY3RVUkksXG4gICAgICAgIH0pLFxuICAgICAgICBoZWFkZXJzOiB7IFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiIH0sXG4gICAgICB9O1xuICAgIH1cblxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godGhpcy50b2tlblVybCwgeyBtZXRob2Q6IFwiUE9TVFwiLCAuLi5vcHRpb25zIH0pO1xuICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgIGNvbnN0IHJlc3BvbnNlVGV4dCA9IGF3YWl0IHJlc3BvbnNlLnRleHQoKTtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJmZXRjaCB0b2tlbnMgZXJyb3I6XCIsIHJlc3BvbnNlVGV4dCk7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEVycm9yIHdoaWxlIGZldGNoaW5nIHRva2VuczogJHtyZXNwb25zZS5zdGF0dXN9ICgke3Jlc3BvbnNlLnN0YXR1c1RleHR9KVxcbiR7cmVzcG9uc2VUZXh0fWApO1xuICAgIH1cbiAgICBjb25zdCB0b2tlbnMgPSB0aGlzLnRva2VuUmVzcG9uc2VQYXJzZXIoYXdhaXQgcmVzcG9uc2UuanNvbigpKTtcblxuICAgIC8vIFNvbWUgY2xpZW50cyBzdWNoIGFzIExpbmVhciBjYW4gcmV0dXJuIGEgc2NvcGUgYXJyYXkgaW5zdGVhZCBvZiBhIHN0cmluZ1xuICAgIHJldHVybiBBcnJheS5pc0FycmF5KHRva2Vucy5zY29wZSkgPyB7IC4uLnRva2Vucywgc2NvcGU6IHRva2Vucy5zY29wZS5qb2luKFwiIFwiKSB9IDogdG9rZW5zO1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyByZWZyZXNoVG9rZW5zKHsgdG9rZW4gfTogeyB0b2tlbjogc3RyaW5nIH0pIHtcbiAgICBsZXQgb3B0aW9ucztcbiAgICBpZiAodGhpcy5ib2R5RW5jb2RpbmcgPT09IFwidXJsLWVuY29kZWRcIikge1xuICAgICAgY29uc3QgcGFyYW1zID0gbmV3IFVSTFNlYXJjaFBhcmFtcygpO1xuICAgICAgcGFyYW1zLmFwcGVuZChcImNsaWVudF9pZFwiLCB0aGlzLmNsaWVudElkKTtcbiAgICAgIHBhcmFtcy5hcHBlbmQoXCJyZWZyZXNoX3Rva2VuXCIsIHRva2VuKTtcbiAgICAgIHBhcmFtcy5hcHBlbmQoXCJncmFudF90eXBlXCIsIFwicmVmcmVzaF90b2tlblwiKTtcblxuICAgICAgb3B0aW9ucyA9IHsgYm9keTogcGFyYW1zIH07XG4gICAgfSBlbHNlIHtcbiAgICAgIG9wdGlvbnMgPSB7XG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICBjbGllbnRfaWQ6IHRoaXMuY2xpZW50SWQsXG4gICAgICAgICAgcmVmcmVzaF90b2tlbjogdG9rZW4sXG4gICAgICAgICAgZ3JhbnRfdHlwZTogXCJyZWZyZXNoX3Rva2VuXCIsXG4gICAgICAgIH0pLFxuICAgICAgICBoZWFkZXJzOiB7IFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiIH0sXG4gICAgICB9O1xuICAgIH1cblxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godGhpcy5yZWZyZXNoVG9rZW5VcmwgPz8gdGhpcy50b2tlblVybCwgeyBtZXRob2Q6IFwiUE9TVFwiLCAuLi5vcHRpb25zIH0pO1xuICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgIGNvbnN0IHJlc3BvbnNlVGV4dCA9IGF3YWl0IHJlc3BvbnNlLnRleHQoKTtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJyZWZyZXNoIHRva2VucyBlcnJvcjpcIiwgcmVzcG9uc2VUZXh0KTtcbiAgICAgIC8vIElmIHRoZSByZWZyZXNoIHRva2VuIGlzIGludmFsaWQsIHN0b3AgdGhlIGZsb3cgaGVyZSwgbG9nIG91dCB0aGUgdXNlciBhbmQgcHJvbXB0IHRoZW0gdG8gcmUtYXV0aG9yaXplLlxuICAgICAgdGhpcy5jbGllbnQuZGVzY3JpcHRpb24gPSBgJHt0aGlzLmNsaWVudC5wcm92aWRlck5hbWV9IG5lZWRzIHlvdSB0byBzaWduLWluIGFnYWluLiBQcmVzcyDij44gb3IgY2xpY2sgdGhlIGJ1dHRvbiBiZWxvdyB0byBjb250aW51ZS5gO1xuICAgICAgYXdhaXQgdGhpcy5jbGllbnQucmVtb3ZlVG9rZW5zKCk7XG4gICAgICBhd2FpdCB0aGlzLmF1dGhvcml6ZSgpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCB0b2tlblJlc3BvbnNlID0gdGhpcy50b2tlblJlZnJlc2hSZXNwb25zZVBhcnNlcihhd2FpdCByZXNwb25zZS5qc29uKCkpO1xuICAgICAgdG9rZW5SZXNwb25zZS5yZWZyZXNoX3Rva2VuID0gdG9rZW5SZXNwb25zZS5yZWZyZXNoX3Rva2VuID8/IHRva2VuO1xuICAgICAgcmV0dXJuIHRva2VuUmVzcG9uc2U7XG4gICAgfVxuICB9XG59XG4iLCAiZXhwb3J0IGNvbnN0IFBST1ZJREVSX0NMSUVOVF9JRFMgPSB7XG4gIGFzYW5hOiBcIjExOTEyMDE3NDU2ODQzMTJcIixcbiAgZ2l0aHViOiBcIjcyMzVmZThkNDIxNTdmMWYzOGMwXCIsXG4gIGxpbmVhcjogXCJjOGZmMzdiOTIyNWMzYzlhZWZkN2Q2NmVhMGU1YjZmMVwiLFxuICBzbGFjazogXCI4NTE3NTY4ODQ2OTIuNTU0NjkyNzI5MDIxMlwiLFxufTtcbiIsICJpbXBvcnQgUmVhY3QgZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgeyBlbnZpcm9ubWVudCwgT0F1dGggfSBmcm9tIFwiQHJheWNhc3QvYXBpXCI7XG5pbXBvcnQgdHlwZSB7IE9BdXRoVHlwZSwgT25BdXRob3JpemVQYXJhbXMgfSBmcm9tIFwiLi90eXBlc1wiO1xuXG5sZXQgdG9rZW46IHN0cmluZyB8IG51bGwgPSBudWxsO1xubGV0IHR5cGU6IE9BdXRoVHlwZSB8IG51bGwgPSBudWxsO1xubGV0IGF1dGhvcml6ZTogUHJvbWlzZTxzdHJpbmc+IHwgbnVsbCA9IG51bGw7XG5sZXQgZ2V0SWRUb2tlbjogUHJvbWlzZTxzdHJpbmcgfCB1bmRlZmluZWQ+IHwgbnVsbCA9IG51bGw7XG5sZXQgb25BdXRob3JpemU6IFByb21pc2U8dm9pZD4gfCBudWxsID0gbnVsbDtcblxudHlwZSBXaXRoQWNjZXNzVG9rZW5QYXJhbWV0ZXJzID0ge1xuICAvKipcbiAgICogQW4gb3B0aW9uYWwgaW5zdGFuY2Ugb2YgYSBQS0NFIENsaWVudCB0aGF0IHlvdSBjYW4gY3JlYXRlIHVzaW5nIFJheWNhc3QgQVBJLlxuICAgKiBUaGlzIGNsaWVudCBpcyB1c2VkIHRvIHJldHVybiB0aGUgYGlkVG9rZW5gIGFzIHBhcnQgb2YgdGhlIGBvbkF1dGhvcml6ZWAgY2FsbGJhY2suXG4gICAqL1xuICBjbGllbnQ/OiBPQXV0aC5QS0NFQ2xpZW50O1xuICAvKipcbiAgICogQSBmdW5jdGlvbiB0aGF0IGluaXRpYXRlcyB0aGUgT0F1dGggdG9rZW4gcmV0cmlldmFsIHByb2Nlc3NcbiAgICogQHJldHVybnMgYSBwcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG8gYW4gYWNjZXNzIHRva2VuLlxuICAgKi9cbiAgYXV0aG9yaXplOiAoKSA9PiBQcm9taXNlPHN0cmluZz47XG4gIC8qKlxuICAgKiBBbiBvcHRpb25hbCBzdHJpbmcgdGhhdCByZXByZXNlbnRzIGFuIGFscmVhZHkgb2J0YWluZWQgcGVyc29uYWwgYWNjZXNzIHRva2VuXG4gICAqL1xuICBwZXJzb25hbEFjY2Vzc1Rva2VuPzogc3RyaW5nO1xuICAvKipcbiAgICogQW4gb3B0aW9uYWwgY2FsbGJhY2sgZnVuY3Rpb24gdGhhdCBpcyBjYWxsZWQgb25jZSB0aGUgdXNlciBoYXMgYmVlbiBwcm9wZXJseSBsb2dnZWQgaW4gdGhyb3VnaCBPQXV0aC5cbiAgICogQHBhcmFtIHtvYmplY3R9IHBhcmFtcyAtIFBhcmFtZXRlcnMgb2YgdGhlIGNhbGxiYWNrXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBvcHRpb25zLnRva2VuIC0gVGhlIHJldHJpZXZlZCBhY2Nlc3MgdG9rZW5cbiAgICogQHBhcmFtIHtzdHJpbmd9IG9wdGlvbnMudHlwZSAtIFRoZSBhY2Nlc3MgdG9rZW4ncyB0eXBlIChlaXRoZXIgYG9hdXRoYCBvciBgcGVyc29uYWxgKVxuICAgKiBAcGFyYW0ge3N0cmluZ30gb3B0aW9ucy5pZFRva2VuIC0gVGhlIG9wdGlvbmFsIGlkIHRva2VuLiBUaGUgYGlkVG9rZW5gIGlzIHJldHVybmVkIGlmIGBvcHRpb25zLmNsaWVudGAgaXMgcHJvdmlkZWQgYW5kIGlmIGl0J3MgcmV0dXJuZWQgaW4gdGhlIGluaXRpYWwgdG9rZW4gc2V0LlxuICAgKi9cbiAgb25BdXRob3JpemU/OiAocGFyYW1zOiBPbkF1dGhvcml6ZVBhcmFtcykgPT4gdm9pZDtcbn07XG5cbi8qKlxuICogVGhlIGNvbXBvbmVudCAoZm9yIGEgdmlldy9tZW51LWJhciBjb21tYW5kcykgb3IgZnVuY3Rpb24gKGZvciBhIG5vLXZpZXcgY29tbWFuZCkgdGhhdCBpcyBwYXNzZWQgdG8gd2l0aEFjY2Vzc1Rva2VuLlxuICovXG5leHBvcnQgdHlwZSBXaXRoQWNjZXNzVG9rZW5Db21wb25lbnRPckZuPFQgPSBhbnksIFUgPSBhbnk+ID0gKChwYXJhbXM6IFQpID0+IFByb21pc2U8VT4gfCBVKSB8IFJlYWN0LkNvbXBvbmVudFR5cGU8VD47XG5cbi8qKlxuICogSGlnaGVyLW9yZGVyIGNvbXBvbmVudCB0byB3cmFwIGEgZ2l2ZW4gY29tcG9uZW50IG9yIGZ1bmN0aW9uIGFuZCBzZXQgYW4gYWNjZXNzIHRva2VuIGluIGEgc2hhcmVkIGdsb2JhbCB2YXJpYWJsZS5cbiAqXG4gKiBUaGUgZnVuY3Rpb24gaW50ZXJjZXB0cyB0aGUgY29tcG9uZW50IHJlbmRlcmluZyBwcm9jZXNzIHRvIGVpdGhlciBmZXRjaCBhbiBPQXV0aCB0b2tlbiBhc3luY2hyb25vdXNseVxuICogb3IgdXNlIGEgcHJvdmlkZWQgcGVyc29uYWwgYWNjZXNzIHRva2VuLiBBIGdsb2JhbCB2YXJpYWJsZSB3aWxsIGJlIHRoZW4gc2V0IHdpdGggdGhlIHJlY2VpdmVkIHRva2VuXG4gKiB0aGF0IHlvdSBjYW4gZ2V0IHdpdGggdGhlIGBnZXRBY2Nlc3NUb2tlbmAgZnVuY3Rpb24uXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYHR5cGVzY3JpcHRcbiAqIGltcG9ydCB7IERldGFpbCB9IGZyb20gXCJAcmF5Y2FzdC9hcGlcIjtcbiAqIGltcG9ydCB7IE9BdXRoU2VydmljZSwgZ2V0QWNjZXNzVG9rZW4sIHdpdGhBY2Nlc3NUb2tlbiB9IGZyb20gXCJAcmF5Y2FzdC91dGlsc1wiO1xuICpcbiAqIGNvbnN0IGdpdGh1YiA9IE9BdXRoU2VydmljZS5naXRodWIoeyBzY29wZTogXCJub3RpZmljYXRpb25zIHJlcG8gcmVhZDpvcmcgcmVhZDp1c2VyIHJlYWQ6cHJvamVjdFwiIH0pO1xuICpcbiAqIGZ1bmN0aW9uIEF1dGhvcml6ZWRDb21wb25lbnQoKSB7XG4gKiAgY29uc3QgeyB0b2tlbiB9ID0gZ2V0QWNjZXNzVG9rZW4oKTtcbiAqICAuLi5cbiAqIH1cbiAqXG4gKiBleHBvcnQgZGVmYXVsdCB3aXRoQWNjZXNzVG9rZW4oZ2l0aHViKShBdXRob3JpemVkQ29tcG9uZW50KTtcbiAqIGBgYFxuICpcbiAqIEByZXR1cm5zIHtSZWFjdC5Db21wb25lbnRUeXBlPFQ+fSBUaGUgd3JhcHBlZCBjb21wb25lbnQuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB3aXRoQWNjZXNzVG9rZW48VCA9IGFueSwgVSA9IGFueT4oXG4gIG9wdGlvbnM6IFdpdGhBY2Nlc3NUb2tlblBhcmFtZXRlcnMsXG4pOiA8ViBleHRlbmRzIFdpdGhBY2Nlc3NUb2tlbkNvbXBvbmVudE9yRm48VCwgVT4+KFxuICBmbk9yQ29tcG9uZW50OiBWLFxuKSA9PiBWIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50VHlwZTxUPiA/IFJlYWN0LkZ1bmN0aW9uQ29tcG9uZW50PFQ+IDogKHByb3BzOiBUKSA9PiBQcm9taXNlPFU+O1xuZXhwb3J0IGZ1bmN0aW9uIHdpdGhBY2Nlc3NUb2tlbjxUPihvcHRpb25zOiBXaXRoQWNjZXNzVG9rZW5QYXJhbWV0ZXJzKSB7XG4gIGlmIChlbnZpcm9ubWVudC5jb21tYW5kTW9kZSA9PT0gXCJuby12aWV3XCIpIHtcbiAgICByZXR1cm4gKGZuOiAocHJvcHM6IFQpID0+IFByb21pc2U8dm9pZD4gfCAoKCkgPT4gdm9pZCkpID0+IHtcbiAgICAgIGNvbnN0IG5vVmlld0ZuID0gYXN5bmMgKHByb3BzOiBUKSA9PiB7XG4gICAgICAgIGlmICghdG9rZW4pIHtcbiAgICAgICAgICB0b2tlbiA9IG9wdGlvbnMucGVyc29uYWxBY2Nlc3NUb2tlbiA/PyAoYXdhaXQgb3B0aW9ucy5hdXRob3JpemUoKSk7XG4gICAgICAgICAgdHlwZSA9IG9wdGlvbnMucGVyc29uYWxBY2Nlc3NUb2tlbiA/IFwicGVyc29uYWxcIiA6IFwib2F1dGhcIjtcbiAgICAgICAgICBjb25zdCBpZFRva2VuID0gKGF3YWl0IG9wdGlvbnMuY2xpZW50Py5nZXRUb2tlbnMoKSk/LmlkVG9rZW47XG5cbiAgICAgICAgICBpZiAob3B0aW9ucy5vbkF1dGhvcml6ZSkge1xuICAgICAgICAgICAgYXdhaXQgUHJvbWlzZS5yZXNvbHZlKG9wdGlvbnMub25BdXRob3JpemUoeyB0b2tlbiwgdHlwZSwgaWRUb2tlbiB9KSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGZuKHByb3BzKTtcbiAgICAgIH07XG5cbiAgICAgIHJldHVybiBub1ZpZXdGbjtcbiAgICB9O1xuICB9XG5cbiAgcmV0dXJuIChDb21wb25lbnQ6IFJlYWN0LkNvbXBvbmVudFR5cGU8VD4pID0+IHtcbiAgICBjb25zdCBXcmFwcGVkQ29tcG9uZW50OiBSZWFjdC5Db21wb25lbnRUeXBlPFQ+ID0gKHByb3BzKSA9PiB7XG4gICAgICBpZiAob3B0aW9ucy5wZXJzb25hbEFjY2Vzc1Rva2VuKSB7XG4gICAgICAgIHRva2VuID0gb3B0aW9ucy5wZXJzb25hbEFjY2Vzc1Rva2VuO1xuICAgICAgICB0eXBlID0gXCJwZXJzb25hbFwiO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKCFhdXRob3JpemUpIHtcbiAgICAgICAgICBhdXRob3JpemUgPSBvcHRpb25zLmF1dGhvcml6ZSgpO1xuICAgICAgICB9XG4gICAgICAgIHRva2VuID0gUmVhY3QudXNlKGF1dGhvcml6ZSk7XG4gICAgICAgIHR5cGUgPSBcIm9hdXRoXCI7XG4gICAgICB9XG5cbiAgICAgIGxldCBpZFRva2VuOiBzdHJpbmcgfCB1bmRlZmluZWQ7XG4gICAgICBpZiAob3B0aW9ucy5jbGllbnQpIHtcbiAgICAgICAgaWYgKCFnZXRJZFRva2VuKSB7XG4gICAgICAgICAgZ2V0SWRUb2tlbiA9IG9wdGlvbnMuY2xpZW50Py5nZXRUb2tlbnMoKS50aGVuKCh0b2tlbnMpID0+IHRva2Vucz8uaWRUb2tlbik7XG4gICAgICAgIH1cbiAgICAgICAgaWRUb2tlbiA9IFJlYWN0LnVzZShnZXRJZFRva2VuKTtcbiAgICAgIH1cblxuICAgICAgaWYgKG9wdGlvbnMub25BdXRob3JpemUpIHtcbiAgICAgICAgaWYgKCFvbkF1dGhvcml6ZSkge1xuICAgICAgICAgIG9uQXV0aG9yaXplID0gUHJvbWlzZS5yZXNvbHZlKG9wdGlvbnMub25BdXRob3JpemUoeyB0b2tlbjogdG9rZW4hLCB0eXBlLCBpZFRva2VuIH0pKTtcbiAgICAgICAgfVxuICAgICAgICBSZWFjdC51c2Uob25BdXRob3JpemUpO1xuICAgICAgfVxuXG4gICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L2Jhbi10cy1jb21tZW50XG4gICAgICAvLyBAdHMtaWdub3JlIHRvbyBjb21wbGljYXRlZCBmb3IgVFNcbiAgICAgIHJldHVybiA8Q29tcG9uZW50IHsuLi5wcm9wc30gLz47XG4gICAgfTtcblxuICAgIFdyYXBwZWRDb21wb25lbnQuZGlzcGxheU5hbWUgPSBgd2l0aEFjY2Vzc1Rva2VuKCR7Q29tcG9uZW50LmRpc3BsYXlOYW1lIHx8IENvbXBvbmVudC5uYW1lfSlgO1xuXG4gICAgcmV0dXJuIFdyYXBwZWRDb21wb25lbnQ7XG4gIH07XG59XG5cbi8qKlxuICogUmV0dXJucyB0aGUgYWNjZXNzIHRva2VuIGFuZCBpdHMgdHlwZS4gTm90ZSB0aGF0IHRoaXMgZnVuY3Rpb24gbXVzdCBiZSBjYWxsZWQgaW4gYSBjb21wb25lbnQgd3JhcHBlZCB3aXRoIGB3aXRoQWNjZXNzVG9rZW5gLlxuICpcbiAqIFdpbGwgdGhyb3cgYW4gRXJyb3IgaWYgY2FsbGVkIG91dHNpZGUgb2YgYSBmdW5jdGlvbiBvciBjb21wb25lbnQgd3JhcHBlZCB3aXRoIGB3aXRoQWNjZXNzVG9rZW5gXG4gKlxuICogQHJldHVybnMge3sgdG9rZW46IHN0cmluZywgdHlwZTogXCJvYXV0aFwiIHwgXCJwZXJzb25hbFwiIH19IEFuIG9iamVjdCBjb250YWluaW5nIHRoZSBgdG9rZW5gXG4gKiBhbmQgaXRzIGB0eXBlYCwgd2hlcmUgdHlwZSBjYW4gYmUgZWl0aGVyICdvYXV0aCcgZm9yIE9BdXRoIHRva2VucyBvciAncGVyc29uYWwnIGZvciBhXG4gKiBwZXJzb25hbCBhY2Nlc3MgdG9rZW4uXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRBY2Nlc3NUb2tlbigpOiB7XG4gIHRva2VuOiBzdHJpbmc7XG4gIC8qKiBgb2F1dGhgIGZvciBPQXV0aCB0b2tlbnMgb3IgYHBlcnNvbmFsYCBmb3IgcGVyc29uYWwgYWNjZXNzIHRva2VuICovXG4gIHR5cGU6IFwib2F1dGhcIiB8IFwicGVyc29uYWxcIjtcbn0ge1xuICBpZiAoIXRva2VuIHx8ICF0eXBlKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiZ2V0QWNjZXNzVG9rZW4gbXVzdCBiZSB1c2VkIHdoZW4gYXV0aGVudGljYXRlZCAoZWcuIHVzZWQgaW5zaWRlIGB3aXRoQWNjZXNzVG9rZW5gKVwiKTtcbiAgfVxuXG4gIHJldHVybiB7IHRva2VuLCB0eXBlIH07XG59XG4iLCAiaW1wb3J0IHsgZW52aXJvbm1lbnQsIExhdW5jaFByb3BzLCBMYXVuY2hUeXBlIH0gZnJvbSBcIkByYXljYXN0L2FwaVwiO1xuaW1wb3J0IGZzIGZyb20gXCJub2RlOmZzXCI7XG5pbXBvcnQgcGF0aCBmcm9tIFwibm9kZTpwYXRoXCI7XG5cbmV4cG9ydCBlbnVtIERlZXBsaW5rVHlwZSB7XG4gIC8qKiBBIHNjcmlwdCBjb21tYW5kICovXG4gIFNjcmlwdENvbW1hbmQgPSBcInNjcmlwdC1jb21tYW5kXCIsXG4gIC8qKiBBbiBleHRlbnNpb24gY29tbWFuZCAqL1xuICBFeHRlbnNpb24gPSBcImV4dGVuc2lvblwiLFxufVxuXG4vKipcbiAqIE9wdGlvbnMgZm9yIGNyZWF0aW5nIGEgZGVlcGxpbmsgdG8gYSBzY3JpcHQgY29tbWFuZC5cbiAqL1xuZXhwb3J0IHR5cGUgQ3JlYXRlU2NyaXB0Q29tbWFuZERlZXBsaW5rT3B0aW9ucyA9IHtcbiAgLyoqXG4gICAqIFRoZSB0eXBlIG9mIGRlZXBsaW5rLCB3aGljaCBzaG91bGQgYmUgXCJzY3JpcHQtY29tbWFuZFwiLlxuICAgKi9cbiAgdHlwZTogRGVlcGxpbmtUeXBlLlNjcmlwdENvbW1hbmQ7XG4gIC8qKlxuICAgKiBUaGUgbmFtZSBvZiB0aGUgY29tbWFuZC5cbiAgICovXG4gIGNvbW1hbmQ6IHN0cmluZztcbiAgLyoqXG4gICAqIElmIHRoZSBjb21tYW5kIGFjY2VwdHMgYXJndW1lbnRzLCB0aGV5IGNhbiBiZSBwYXNzZWQgdXNpbmcgdGhpcyBxdWVyeSBwYXJhbWV0ZXIuXG4gICAqL1xuICBhcmd1bWVudHM/OiBzdHJpbmdbXTtcbn07XG5cbi8qKlxuICogQmFzZSBvcHRpb25zIGZvciBjcmVhdGluZyBhIGRlZXBsaW5rIHRvIGFuIGV4dGVuc2lvbi5cbiAqL1xuZXhwb3J0IHR5cGUgQ3JlYXRlRXh0ZW5zaW9uRGVlcGxpbmtCYXNlT3B0aW9ucyA9IHtcbiAgLyoqXG4gICAqIFRoZSB0eXBlIG9mIGRlZXBsaW5rLCB3aGljaCBzaG91bGQgYmUgXCJleHRlbnNpb25cIi5cbiAgICovXG4gIHR5cGU/OiBEZWVwbGlua1R5cGUuRXh0ZW5zaW9uO1xuICAvKipcbiAgICogVGhlIGNvbW1hbmQgYXNzb2NpYXRlZCB3aXRoIHRoZSBleHRlbnNpb24uXG4gICAqL1xuICBjb21tYW5kOiBzdHJpbmc7XG4gIC8qKlxuICAgKiBFaXRoZXIgXCJ1c2VySW5pdGlhdGVkXCIsIHdoaWNoIHJ1bnMgdGhlIGNvbW1hbmQgaW4gdGhlIGZvcmVncm91bmQsIG9yIFwiYmFja2dyb3VuZFwiLCB3aGljaCBza2lwcyBicmluZ2luZyBSYXljYXN0IHRvIHRoZSBmcm9udC5cbiAgICovXG4gIGxhdW5jaFR5cGU/OiBMYXVuY2hUeXBlO1xuICAvKipcbiAgICogSWYgdGhlIGNvbW1hbmQgYWNjZXB0cyBhcmd1bWVudHMsIHRoZXkgY2FuIGJlIHBhc3NlZCB1c2luZyB0aGlzIHF1ZXJ5IHBhcmFtZXRlci5cbiAgICovXG4gIGFyZ3VtZW50cz86IExhdW5jaFByb3BzW1wiYXJndW1lbnRzXCJdO1xuICAvKipcbiAgICogSWYgdGhlIGNvbW1hbmQgbWFrZSB1c2Ugb2YgTGF1bmNoQ29udGV4dCwgaXQgY2FuIGJlIHBhc3NlZCB1c2luZyB0aGlzIHF1ZXJ5IHBhcmFtZXRlci5cbiAgICovXG4gIGNvbnRleHQ/OiBMYXVuY2hQcm9wc1tcImxhdW5jaENvbnRleHRcIl07XG4gIC8qKlxuICAgKiBTb21lIHRleHQgdG8gcHJlZmlsbCB0aGUgc2VhcmNoIGJhciBvciBmaXJzdCB0ZXh0IGlucHV0IG9mIHRoZSBjb21tYW5kXG4gICAqL1xuICBmYWxsYmFja1RleHQ/OiBzdHJpbmc7XG59O1xuXG4vKipcbiAqIE9wdGlvbnMgZm9yIGNyZWF0aW5nIGEgZGVlcGxpbmsgdG8gYW4gZXh0ZW5zaW9uIGZyb20gYW5vdGhlciBleHRlbnNpb24uXG4gKiBSZXF1aXJlcyBib3RoIHRoZSBvd25lck9yQXV0aG9yTmFtZSBhbmQgZXh0ZW5zaW9uTmFtZS5cbiAqL1xuZXhwb3J0IHR5cGUgQ3JlYXRlSW50ZXJFeHRlbnNpb25EZWVwbGlua09wdGlvbnMgPSBDcmVhdGVFeHRlbnNpb25EZWVwbGlua0Jhc2VPcHRpb25zICYge1xuICAvKipcbiAgICogVGhlIG5hbWUgb2YgdGhlIG93bmVyIG9yIGF1dGhvciBvZiB0aGUgZXh0ZW5zaW9uLlxuICAgKi9cbiAgb3duZXJPckF1dGhvck5hbWU6IHN0cmluZztcbiAgLyoqXG4gICAqIFRoZSBuYW1lIG9mIHRoZSBleHRlbnNpb24uXG4gICAqL1xuICBleHRlbnNpb25OYW1lOiBzdHJpbmc7XG59O1xuXG4vKipcbiAqIE9wdGlvbnMgZm9yIGNyZWF0aW5nIGEgZGVlcGxpbmsgdG8gYW4gZXh0ZW5zaW9uLlxuICovXG5leHBvcnQgdHlwZSBDcmVhdGVFeHRlbnNpb25EZWVwbGlua09wdGlvbnMgPSBDcmVhdGVJbnRlckV4dGVuc2lvbkRlZXBsaW5rT3B0aW9ucyB8IENyZWF0ZUV4dGVuc2lvbkRlZXBsaW5rQmFzZU9wdGlvbnM7XG5cbi8qKlxuICogT3B0aW9ucyBmb3IgY3JlYXRpbmcgYSBkZWVwbGluay5cbiAqL1xuZXhwb3J0IHR5cGUgQ3JlYXRlRGVlcGxpbmtPcHRpb25zID0gQ3JlYXRlU2NyaXB0Q29tbWFuZERlZXBsaW5rT3B0aW9ucyB8IENyZWF0ZUV4dGVuc2lvbkRlZXBsaW5rT3B0aW9ucztcblxuZnVuY3Rpb24gZ2V0UHJvdG9jb2woKSB7XG4gIHJldHVybiBlbnZpcm9ubWVudC5yYXljYXN0VmVyc2lvbi5pbmNsdWRlcyhcImFscGhhXCIpID8gXCJyYXljYXN0aW50ZXJuYWw6Ly9cIiA6IFwicmF5Y2FzdDovL1wiO1xufVxuXG5mdW5jdGlvbiBnZXRPd25lck9yQXV0aG9yTmFtZSgpIHtcbiAgY29uc3QgcGFja2FnZUpTT04gPSBKU09OLnBhcnNlKGZzLnJlYWRGaWxlU3luYyhwYXRoLmpvaW4oZW52aXJvbm1lbnQuYXNzZXRzUGF0aCwgXCIuLlwiLCBcInBhY2thZ2UuanNvblwiKSwgXCJ1dGY4XCIpKTtcbiAgcmV0dXJuIHBhY2thZ2VKU09OLm93bmVyIHx8IHBhY2thZ2VKU09OLmF1dGhvcjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVNjcmlwdENvbW1hbmREZWVwbGluayhvcHRpb25zOiBDcmVhdGVTY3JpcHRDb21tYW5kRGVlcGxpbmtPcHRpb25zKTogc3RyaW5nIHtcbiAgbGV0IHVybCA9IGAke2dldFByb3RvY29sKCl9c2NyaXB0LWNvbW1hbmRzLyR7b3B0aW9ucy5jb21tYW5kfWA7XG5cbiAgaWYgKG9wdGlvbnMuYXJndW1lbnRzKSB7XG4gICAgbGV0IHBhcmFtcyA9IFwiXCI7XG4gICAgZm9yIChjb25zdCBhcmcgb2Ygb3B0aW9ucy5hcmd1bWVudHMpIHtcbiAgICAgIHBhcmFtcyArPSBcIiZhcmd1bWVudHM9XCIgKyBlbmNvZGVVUklDb21wb25lbnQoYXJnKTtcbiAgICB9XG4gICAgdXJsICs9IFwiP1wiICsgcGFyYW1zLnN1YnN0cmluZygxKTtcbiAgfVxuXG4gIHJldHVybiB1cmw7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVFeHRlbnNpb25EZWVwbGluayhvcHRpb25zOiBDcmVhdGVFeHRlbnNpb25EZWVwbGlua09wdGlvbnMpOiBzdHJpbmcge1xuICBsZXQgb3duZXJPckF1dGhvck5hbWUgPSBnZXRPd25lck9yQXV0aG9yTmFtZSgpO1xuICBsZXQgZXh0ZW5zaW9uTmFtZSA9IGVudmlyb25tZW50LmV4dGVuc2lvbk5hbWU7XG5cbiAgaWYgKFwib3duZXJPckF1dGhvck5hbWVcIiBpbiBvcHRpb25zICYmIFwiZXh0ZW5zaW9uTmFtZVwiIGluIG9wdGlvbnMpIHtcbiAgICBvd25lck9yQXV0aG9yTmFtZSA9IG9wdGlvbnMub3duZXJPckF1dGhvck5hbWU7XG4gICAgZXh0ZW5zaW9uTmFtZSA9IG9wdGlvbnMuZXh0ZW5zaW9uTmFtZTtcbiAgfVxuXG4gIGxldCB1cmwgPSBgJHtnZXRQcm90b2NvbCgpfWV4dGVuc2lvbnMvJHtvd25lck9yQXV0aG9yTmFtZX0vJHtleHRlbnNpb25OYW1lfS8ke29wdGlvbnMuY29tbWFuZH1gO1xuXG4gIGxldCBwYXJhbXMgPSBcIlwiO1xuICBpZiAob3B0aW9ucy5sYXVuY2hUeXBlKSB7XG4gICAgcGFyYW1zICs9IFwiJmxhdW5jaFR5cGU9XCIgKyBlbmNvZGVVUklDb21wb25lbnQob3B0aW9ucy5sYXVuY2hUeXBlKTtcbiAgfVxuXG4gIGlmIChvcHRpb25zLmFyZ3VtZW50cykge1xuICAgIHBhcmFtcyArPSBcIiZhcmd1bWVudHM9XCIgKyBlbmNvZGVVUklDb21wb25lbnQoSlNPTi5zdHJpbmdpZnkob3B0aW9ucy5hcmd1bWVudHMpKTtcbiAgfVxuXG4gIGlmIChvcHRpb25zLmNvbnRleHQpIHtcbiAgICBwYXJhbXMgKz0gXCImY29udGV4dD1cIiArIGVuY29kZVVSSUNvbXBvbmVudChKU09OLnN0cmluZ2lmeShvcHRpb25zLmNvbnRleHQpKTtcbiAgfVxuXG4gIGlmIChvcHRpb25zLmZhbGxiYWNrVGV4dCkge1xuICAgIHBhcmFtcyArPSBcIiZmYWxsYmFja1RleHQ9XCIgKyBlbmNvZGVVUklDb21wb25lbnQob3B0aW9ucy5mYWxsYmFja1RleHQpO1xuICB9XG5cbiAgaWYgKHBhcmFtcykge1xuICAgIHVybCArPSBcIj9cIiArIHBhcmFtcy5zdWJzdHJpbmcoMSk7XG4gIH1cblxuICByZXR1cm4gdXJsO1xufVxuXG4vKipcbiAqIENyZWF0ZXMgYSBkZWVwbGluayB0byBhIHNjcmlwdCBjb21tYW5kIG9yIGV4dGVuc2lvbi5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZURlZXBsaW5rKG9wdGlvbnM6IENyZWF0ZURlZXBsaW5rT3B0aW9ucyk6IHN0cmluZyB7XG4gIGlmIChvcHRpb25zLnR5cGUgPT09IERlZXBsaW5rVHlwZS5TY3JpcHRDb21tYW5kKSB7XG4gICAgcmV0dXJuIGNyZWF0ZVNjcmlwdENvbW1hbmREZWVwbGluayhvcHRpb25zKTtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gY3JlYXRlRXh0ZW5zaW9uRGVlcGxpbmsob3B0aW9ucyk7XG4gIH1cbn1cbiIsICJpbXBvcnQgeyBiYXNlRXhlY3V0ZVNRTCB9IGZyb20gXCIuL3NxbC11dGlsc1wiO1xuXG4vKipcbiAqIEV4ZWN1dGVzIGEgU1FMIHF1ZXJ5IG9uIGEgbG9jYWwgU1FMaXRlIGRhdGFiYXNlIGFuZCByZXR1cm5zIHRoZSBxdWVyeSByZXN1bHQgaW4gSlNPTiBmb3JtYXQuXG4gKlxuICogQHBhcmFtIGRhdGFiYXNlUGF0aCAtIFRoZSBwYXRoIHRvIHRoZSBTUUxpdGUgZGF0YWJhc2UgZmlsZS5cbiAqIEBwYXJhbSBxdWVyeSAtIFRoZSBTUUwgcXVlcnkgdG8gZXhlY3V0ZS5cbiAqIEByZXR1cm5zIEEgUHJvbWlzZSB0aGF0IHJlc29sdmVzIHRvIGFuIGFycmF5IG9mIG9iamVjdHMgcmVwcmVzZW50aW5nIHRoZSBxdWVyeSByZXN1bHRzLlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGB0eXBlc2NyaXB0XG4gKiBpbXBvcnQgeyBjbG9zZU1haW5XaW5kb3csIENsaXBib2FyZCB9IGZyb20gXCJAcmF5Y2FzdC9hcGlcIjtcbiAqIGltcG9ydCB7IGV4ZWN1dGVTUUwgfSBmcm9tIFwiQHJheWNhc3QvdXRpbHNcIjtcbiAqXG4gKiB0eXBlIE1lc3NhZ2UgPSB7IGJvZHk6IHN0cmluZzsgY29kZTogc3RyaW5nIH07XG4gKlxuICogY29uc3QgREJfUEFUSCA9IFwiL3BhdGgvdG8vY2hhdC5kYlwiO1xuICpcbiAqIGV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uIENvbW1hbmQoKSB7XG4gKiAgIGNvbnN0IHF1ZXJ5ID0gYFNFTEVDVCBib2R5LCBjb2RlIEZST00gLi4uYFxuICpcbiAqICAgY29uc3QgbWVzc2FnZXMgPSBhd2FpdCBleGVjdXRlU1FMPE1lc3NhZ2U+KERCX1BBVEgsIHF1ZXJ5KTtcbiAqXG4gKiAgIGlmIChtZXNzYWdlcy5sZW5ndGggPiAwKSB7XG4gKiAgICAgY29uc3QgbGF0ZXN0Q29kZSA9IG1lc3NhZ2VzWzBdLmNvZGU7XG4gKiAgICAgYXdhaXQgQ2xpcGJvYXJkLnBhc3RlKGxhdGVzdENvZGUpO1xuICogICAgIGF3YWl0IGNsb3NlTWFpbldpbmRvdygpO1xuICogICB9XG4gKiB9XG4gKiBgYGBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGV4ZWN1dGVTUUw8VCA9IHVua25vd24+KGRhdGFiYXNlUGF0aDogc3RyaW5nLCBxdWVyeTogc3RyaW5nKSB7XG4gIHJldHVybiBiYXNlRXhlY3V0ZVNRTDxUPihkYXRhYmFzZVBhdGgsIHF1ZXJ5KTtcbn1cbiIsICJpbXBvcnQgY2hpbGRQcm9jZXNzIGZyb20gXCJub2RlOmNoaWxkX3Byb2Nlc3NcIjtcbmltcG9ydCB7XG4gIGRlZmF1bHRQYXJzaW5nLFxuICBnZXRTcGF3bmVkUHJvbWlzZSxcbiAgZ2V0U3Bhd25lZFJlc3VsdCxcbiAgaGFuZGxlT3V0cHV0LFxuICBQYXJzZUV4ZWNPdXRwdXRIYW5kbGVyLFxufSBmcm9tIFwiLi9leGVjLXV0aWxzXCI7XG5cbnR5cGUgQXBwbGVTY3JpcHRPcHRpb25zID0ge1xuICAvKipcbiAgICogQnkgZGVmYXVsdCwgYHJ1bkFwcGxlU2NyaXB0YCByZXR1cm5zIGl0cyByZXN1bHRzIGluIGh1bWFuLXJlYWRhYmxlIGZvcm06IHN0cmluZ3MgZG8gbm90IGhhdmUgcXVvdGVzIGFyb3VuZCB0aGVtLCBjaGFyYWN0ZXJzIGFyZSBub3QgZXNjYXBlZCwgYnJhY2VzIGZvciBsaXN0cyBhbmQgcmVjb3JkcyBhcmUgb21pdHRlZCwgZXRjLiBUaGlzIGlzIGdlbmVyYWxseSBtb3JlIHVzZWZ1bCwgYnV0IGNhbiBpbnRyb2R1Y2UgYW1iaWd1aXRpZXMuIEZvciBleGFtcGxlLCB0aGUgbGlzdHMgYHtcImZvb1wiLCBcImJhclwifWAgYW5kIGB7e1wiZm9vXCIsIHtcImJhclwifX19YCB3b3VsZCBib3RoIGJlIGRpc3BsYXllZCBhcyDigJhmb28sIGJhcuKAmS4gVG8gc2VlIHRoZSByZXN1bHRzIGluIGFuIHVuYW1iaWd1b3VzIGZvcm0gdGhhdCBjb3VsZCBiZSByZWNvbXBpbGVkIGludG8gdGhlIHNhbWUgdmFsdWUsIHNldCBgaHVtYW5SZWFkYWJsZU91dHB1dGAgdG8gYGZhbHNlYC5cbiAgICpcbiAgICogQGRlZmF1bHQgdHJ1ZVxuICAgKi9cbiAgaHVtYW5SZWFkYWJsZU91dHB1dD86IGJvb2xlYW47XG4gIC8qKlxuICAgKiBXaGV0aGVyIHRoZSBzY3JpcHQgaXMgdXNpbmcgW2BBcHBsZVNjcmlwdGBdKGh0dHBzOi8vZGV2ZWxvcGVyLmFwcGxlLmNvbS9saWJyYXJ5L2FyY2hpdmUvZG9jdW1lbnRhdGlvbi9BcHBsZVNjcmlwdC9Db25jZXB0dWFsL0FwcGxlU2NyaXB0TGFuZ0d1aWRlL2ludHJvZHVjdGlvbi9BU0xSX2ludHJvLmh0bWwjLy9hcHBsZV9yZWYvZG9jL3VpZC9UUDQwMDAwOTgzKSBvciBbYEphdmFTY3JpcHRgXShodHRwczovL2RldmVsb3Blci5hcHBsZS5jb20vbGlicmFyeS9hcmNoaXZlL3JlbGVhc2Vub3Rlcy9JbnRlcmFwcGxpY2F0aW9uQ29tbXVuaWNhdGlvbi9STi1KYXZhU2NyaXB0Rm9yQXV0b21hdGlvbi9BcnRpY2xlcy9JbnRyb2R1Y3Rpb24uaHRtbCMvL2FwcGxlX3JlZi9kb2MvdWlkL1RQNDAwMTQ1MDgtQ0gxMTEtU1cxKS5cbiAgICpcbiAgICogQGRlZmF1bHQgXCJBcHBsZVNjcmlwdFwiXG4gICAqL1xuICBsYW5ndWFnZT86IFwiQXBwbGVTY3JpcHRcIiB8IFwiSmF2YVNjcmlwdFwiO1xuICAvKipcbiAgICogQSBTaWduYWwgb2JqZWN0IHRoYXQgYWxsb3dzIHlvdSB0byBhYm9ydCB0aGUgcmVxdWVzdCBpZiByZXF1aXJlZCB2aWEgYW4gQWJvcnRDb250cm9sbGVyIG9iamVjdC5cbiAgICovXG4gIHNpZ25hbD86IEFib3J0U2lnbmFsO1xuICAvKiogSWYgdGltZW91dCBpcyBncmVhdGVyIHRoYW4gYDBgLCB0aGUgcGFyZW50IHdpbGwgc2VuZCB0aGUgc2lnbmFsIGBTSUdURVJNYCBpZiB0aGUgY2hpbGQgcnVucyBsb25nZXIgdGhhbiB0aW1lb3V0IG1pbGxpc2Vjb25kcy5cbiAgICpcbiAgICogQGRlZmF1bHQgMTAwMDBcbiAgICovXG4gIHRpbWVvdXQ/OiBudW1iZXI7XG59O1xuXG4vKipcbiAqIEV4ZWN1dGVzIGFuIEFwcGxlU2NyaXB0IHNjcmlwdC5cbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgdHlwZXNjcmlwdFxuICogaW1wb3J0IHsgc2hvd0hVRCB9IGZyb20gXCJAcmF5Y2FzdC9hcGlcIjtcbiAqIGltcG9ydCB7IHJ1bkFwcGxlU2NyaXB0LCBzaG93RmFpbHVyZVRvYXN0IH0gZnJvbSBcIkByYXljYXN0L3V0aWxzXCI7XG4gKlxuICogZXhwb3J0IGRlZmF1bHQgYXN5bmMgZnVuY3Rpb24gKCkge1xuICogICB0cnkge1xuICogICAgIGNvbnN0IHJlcyA9IGF3YWl0IHJ1bkFwcGxlU2NyaXB0KFxuICogICAgICAgYFxuICogICAgICAgb24gcnVuIGFyZ3ZcbiAqICAgICAgICAgcmV0dXJuIFwiaGVsbG8sIFwiICYgaXRlbSAxIG9mIGFyZ3YgJiBcIi5cIlxuICogICAgICAgZW5kIHJ1blxuICogICAgICAgYCxcbiAqICAgICAgIFtcIndvcmxkXCJdXG4gKiAgICAgKTtcbiAqICAgICBhd2FpdCBzaG93SFVEKHJlcyk7XG4gKiAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gKiAgICAgc2hvd0ZhaWx1cmVUb2FzdChlcnJvciwgeyB0aXRsZTogXCJDb3VsZCBub3QgcnVuIEFwcGxlU2NyaXB0XCIgfSk7XG4gKiAgIH1cbiAqIH1cbiAqIGBgYFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcnVuQXBwbGVTY3JpcHQ8VCA9IHN0cmluZz4oXG4gIHNjcmlwdDogc3RyaW5nLFxuICBvcHRpb25zPzogQXBwbGVTY3JpcHRPcHRpb25zICYge1xuICAgIHBhcnNlT3V0cHV0PzogUGFyc2VFeGVjT3V0cHV0SGFuZGxlcjxULCBzdHJpbmcsIEFwcGxlU2NyaXB0T3B0aW9ucz47XG4gIH0sXG4pOiBQcm9taXNlPHN0cmluZz47XG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcnVuQXBwbGVTY3JpcHQ8VCA9IHN0cmluZz4oXG4gIHNjcmlwdDogc3RyaW5nLFxuICAvKipcbiAgICogVGhlIGFyZ3VtZW50cyB0byBwYXNzIHRvIHRoZSBzY3JpcHQuXG4gICAqL1xuICBhcmdzOiBzdHJpbmdbXSxcbiAgb3B0aW9ucz86IEFwcGxlU2NyaXB0T3B0aW9ucyAmIHtcbiAgICBwYXJzZU91dHB1dD86IFBhcnNlRXhlY091dHB1dEhhbmRsZXI8VCwgc3RyaW5nLCBBcHBsZVNjcmlwdE9wdGlvbnM+O1xuICB9LFxuKTogUHJvbWlzZTxzdHJpbmc+O1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJ1bkFwcGxlU2NyaXB0PFQgPSBzdHJpbmc+KFxuICBzY3JpcHQ6IHN0cmluZyxcbiAgb3B0aW9uc09yQXJncz86XG4gICAgfCBzdHJpbmdbXVxuICAgIHwgKEFwcGxlU2NyaXB0T3B0aW9ucyAmIHtcbiAgICAgICAgcGFyc2VPdXRwdXQ/OiBQYXJzZUV4ZWNPdXRwdXRIYW5kbGVyPFQsIHN0cmluZywgQXBwbGVTY3JpcHRPcHRpb25zPjtcbiAgICAgIH0pLFxuICBvcHRpb25zPzogQXBwbGVTY3JpcHRPcHRpb25zICYge1xuICAgIHBhcnNlT3V0cHV0PzogUGFyc2VFeGVjT3V0cHV0SGFuZGxlcjxULCBzdHJpbmcsIEFwcGxlU2NyaXB0T3B0aW9ucz47XG4gIH0sXG4pOiBQcm9taXNlPHN0cmluZz4ge1xuICBpZiAocHJvY2Vzcy5wbGF0Zm9ybSAhPT0gXCJkYXJ3aW5cIikge1xuICAgIHRocm93IG5ldyBFcnJvcihcIkFwcGxlU2NyaXB0IGlzIG9ubHkgc3VwcG9ydGVkIG9uIG1hY09TXCIpO1xuICB9XG5cbiAgY29uc3QgeyBodW1hblJlYWRhYmxlT3V0cHV0LCBsYW5ndWFnZSwgdGltZW91dCwgLi4uZXhlY09wdGlvbnMgfSA9IEFycmF5LmlzQXJyYXkob3B0aW9uc09yQXJncylcbiAgICA/IG9wdGlvbnMgfHwge31cbiAgICA6IG9wdGlvbnNPckFyZ3MgfHwge307XG5cbiAgY29uc3Qgb3V0cHV0QXJndW1lbnRzID0gaHVtYW5SZWFkYWJsZU91dHB1dCAhPT0gZmFsc2UgPyBbXSA6IFtcIi1zc1wiXTtcbiAgaWYgKGxhbmd1YWdlID09PSBcIkphdmFTY3JpcHRcIikge1xuICAgIG91dHB1dEFyZ3VtZW50cy5wdXNoKFwiLWxcIiwgXCJKYXZhU2NyaXB0XCIpO1xuICB9XG4gIGlmIChBcnJheS5pc0FycmF5KG9wdGlvbnNPckFyZ3MpKSB7XG4gICAgb3V0cHV0QXJndW1lbnRzLnB1c2goXCItXCIsIC4uLm9wdGlvbnNPckFyZ3MpO1xuICB9XG5cbiAgY29uc3Qgc3Bhd25lZCA9IGNoaWxkUHJvY2Vzcy5zcGF3bihcIm9zYXNjcmlwdFwiLCBvdXRwdXRBcmd1bWVudHMsIHtcbiAgICAuLi5leGVjT3B0aW9ucyxcbiAgICBlbnY6IHsgUEFUSDogXCIvdXNyL2xvY2FsL2JpbjovdXNyL2JpbjovYmluOi91c3Ivc2Jpbjovc2JpblwiIH0sXG4gIH0pO1xuICBjb25zdCBzcGF3bmVkUHJvbWlzZSA9IGdldFNwYXduZWRQcm9taXNlKHNwYXduZWQsIHsgdGltZW91dDogdGltZW91dCA/PyAxMDAwMCB9KTtcblxuICBzcGF3bmVkLnN0ZGluLmVuZChzY3JpcHQpO1xuXG4gIGNvbnN0IFt7IGVycm9yLCBleGl0Q29kZSwgc2lnbmFsLCB0aW1lZE91dCB9LCBzdGRvdXRSZXN1bHQsIHN0ZGVyclJlc3VsdF0gPSBhd2FpdCBnZXRTcGF3bmVkUmVzdWx0PHN0cmluZz4oXG4gICAgc3Bhd25lZCxcbiAgICB7IGVuY29kaW5nOiBcInV0ZjhcIiB9LFxuICAgIHNwYXduZWRQcm9taXNlLFxuICApO1xuICBjb25zdCBzdGRvdXQgPSBoYW5kbGVPdXRwdXQoeyBzdHJpcEZpbmFsTmV3bGluZTogdHJ1ZSB9LCBzdGRvdXRSZXN1bHQpO1xuICBjb25zdCBzdGRlcnIgPSBoYW5kbGVPdXRwdXQoeyBzdHJpcEZpbmFsTmV3bGluZTogdHJ1ZSB9LCBzdGRlcnJSZXN1bHQpO1xuXG4gIHJldHVybiBkZWZhdWx0UGFyc2luZyh7XG4gICAgc3Rkb3V0LFxuICAgIHN0ZGVycixcbiAgICBlcnJvcixcbiAgICBleGl0Q29kZSxcbiAgICBzaWduYWwsXG4gICAgdGltZWRPdXQsXG4gICAgY29tbWFuZDogXCJvc2FzY3JpcHRcIixcbiAgICBvcHRpb25zLFxuICAgIHBhcmVudEVycm9yOiBuZXcgRXJyb3IoKSxcbiAgfSk7XG59XG4iLCAiaW1wb3J0IGNoaWxkUHJvY2VzcyBmcm9tIFwibm9kZTpjaGlsZF9wcm9jZXNzXCI7XG5pbXBvcnQge1xuICBkZWZhdWx0UGFyc2luZyxcbiAgZ2V0U3Bhd25lZFByb21pc2UsXG4gIGdldFNwYXduZWRSZXN1bHQsXG4gIGhhbmRsZU91dHB1dCxcbiAgUGFyc2VFeGVjT3V0cHV0SGFuZGxlcixcbn0gZnJvbSBcIi4vZXhlYy11dGlsc1wiO1xuXG50eXBlIFBvd2VyU2hlbGxTY3JpcHRPcHRpb25zID0ge1xuICAvKipcbiAgICogQSBTaWduYWwgb2JqZWN0IHRoYXQgYWxsb3dzIHlvdSB0byBhYm9ydCB0aGUgcmVxdWVzdCBpZiByZXF1aXJlZCB2aWEgYW4gQWJvcnRDb250cm9sbGVyIG9iamVjdC5cbiAgICovXG4gIHNpZ25hbD86IEFib3J0U2lnbmFsO1xuICAvKiogSWYgdGltZW91dCBpcyBncmVhdGVyIHRoYW4gYDBgLCB0aGUgcGFyZW50IHdpbGwgc2VuZCB0aGUgc2lnbmFsIGBTSUdURVJNYCBpZiB0aGUgY2hpbGQgcnVucyBsb25nZXIgdGhhbiB0aW1lb3V0IG1pbGxpc2Vjb25kcy5cbiAgICpcbiAgICogQGRlZmF1bHQgMTAwMDBcbiAgICovXG4gIHRpbWVvdXQ/OiBudW1iZXI7XG59O1xuXG4vKipcbiAqIEV4ZWN1dGVzIGEgUG93ZXJTaGVsbCBzY3JpcHQuXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYHR5cGVzY3JpcHRcbiAqIGltcG9ydCB7IHNob3dIVUQgfSBmcm9tIFwiQHJheWNhc3QvYXBpXCI7XG4gKiBpbXBvcnQgeyBydW5Qb3dlclNoZWxsU2NyaXB0LCBzaG93RmFpbHVyZVRvYXN0IH0gZnJvbSBcIkByYXljYXN0L3V0aWxzXCI7XG4gKlxuICogZXhwb3J0IGRlZmF1bHQgYXN5bmMgZnVuY3Rpb24gKCkge1xuICogICB0cnkge1xuICogICAgIGNvbnN0IHJlcyA9IGF3YWl0IHJ1blBvd2VyU2hlbGxTY3JpcHQoXG4gKiAgICAgICBgXG4gKiAgICAgICBXcml0ZS1Ib3N0IFwiaGVsbG8sIHdvcmxkLlwiXG4gKiAgICAgICBgLFxuICogICAgICk7XG4gKiAgICAgYXdhaXQgc2hvd0hVRChyZXMpO1xuICogICB9IGNhdGNoIChlcnJvcikge1xuICogICAgIHNob3dGYWlsdXJlVG9hc3QoZXJyb3IsIHsgdGl0bGU6IFwiQ291bGQgbm90IHJ1biBQb3dlclNoZWxsXCIgfSk7XG4gKiAgIH1cbiAqIH1cbiAqIGBgYFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcnVuUG93ZXJTaGVsbFNjcmlwdDxUID0gc3RyaW5nPihcbiAgc2NyaXB0OiBzdHJpbmcsXG4gIG9wdGlvbnM/OiBQb3dlclNoZWxsU2NyaXB0T3B0aW9ucyAmIHtcbiAgICBwYXJzZU91dHB1dD86IFBhcnNlRXhlY091dHB1dEhhbmRsZXI8VCwgc3RyaW5nLCBQb3dlclNoZWxsU2NyaXB0T3B0aW9ucz47XG4gIH0sXG4pOiBQcm9taXNlPHN0cmluZz4ge1xuICBpZiAocHJvY2Vzcy5wbGF0Zm9ybSAhPT0gXCJ3aW4zMlwiKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiUG93ZXJTaGVsbCBpcyBvbmx5IHN1cHBvcnRlZCBvbiBXaW5kb3dzXCIpO1xuICB9XG5cbiAgY29uc3QgeyB0aW1lb3V0LCAuLi5leGVjT3B0aW9ucyB9ID0gb3B0aW9ucyB8fCB7fTtcblxuICBjb25zdCBvdXRwdXRBcmd1bWVudHMgPSBbXCItTm9Mb2dvXCIsIFwiLU5vUHJvZmlsZVwiLCBcIi1Ob25JbnRlcmFjdGl2ZVwiLCBcIi1Db21tYW5kXCIsIFwiLVwiXTtcblxuICBjb25zdCBzcGF3bmVkID0gY2hpbGRQcm9jZXNzLnNwYXduKFwicG93ZXJzaGVsbC5leGVcIiwgb3V0cHV0QXJndW1lbnRzLCB7XG4gICAgLi4uZXhlY09wdGlvbnMsXG4gIH0pO1xuICBjb25zdCBzcGF3bmVkUHJvbWlzZSA9IGdldFNwYXduZWRQcm9taXNlKHNwYXduZWQsIHsgdGltZW91dDogdGltZW91dCA/PyAxMDAwMCB9KTtcblxuICBzcGF3bmVkLnN0ZGluLmVuZChzY3JpcHQpO1xuXG4gIGNvbnN0IFt7IGVycm9yLCBleGl0Q29kZSwgc2lnbmFsLCB0aW1lZE91dCB9LCBzdGRvdXRSZXN1bHQsIHN0ZGVyclJlc3VsdF0gPSBhd2FpdCBnZXRTcGF3bmVkUmVzdWx0PHN0cmluZz4oXG4gICAgc3Bhd25lZCxcbiAgICB7IGVuY29kaW5nOiBcInV0ZjhcIiB9LFxuICAgIHNwYXduZWRQcm9taXNlLFxuICApO1xuICBjb25zdCBzdGRvdXQgPSBoYW5kbGVPdXRwdXQoeyBzdHJpcEZpbmFsTmV3bGluZTogdHJ1ZSB9LCBzdGRvdXRSZXN1bHQpO1xuICBjb25zdCBzdGRlcnIgPSBoYW5kbGVPdXRwdXQoeyBzdHJpcEZpbmFsTmV3bGluZTogdHJ1ZSB9LCBzdGRlcnJSZXN1bHQpO1xuXG4gIHJldHVybiBkZWZhdWx0UGFyc2luZyh7XG4gICAgc3Rkb3V0LFxuICAgIHN0ZGVycixcbiAgICBlcnJvcixcbiAgICBleGl0Q29kZSxcbiAgICBzaWduYWwsXG4gICAgdGltZWRPdXQsXG4gICAgY29tbWFuZDogXCJwb3dlcnNoZWxsLmV4ZVwiLFxuICAgIG9wdGlvbnMsXG4gICAgcGFyZW50RXJyb3I6IG5ldyBFcnJvcigpLFxuICB9KTtcbn1cbiIsICJpbXBvcnQgeyBDYWNoZSB9IGZyb20gXCJAcmF5Y2FzdC9hcGlcIjtcbmltcG9ydCB7IGhhc2gsIHJlcGxhY2VyLCByZXZpdmVyIH0gZnJvbSBcIi4vaGVscGVyc1wiO1xuXG4vKipcbiAqIFdyYXBzIGEgZnVuY3Rpb24gd2l0aCBjYWNoaW5nIGZ1bmN0aW9uYWxpdHkgdXNpbmcgUmF5Y2FzdCdzIENhY2hlIEFQSS5cbiAqIEFsbG93cyBmb3IgY2FjaGluZyBvZiBleHBlbnNpdmUgZnVuY3Rpb25zIGxpa2UgcGFnaW5hdGVkIEFQSSBjYWxscyB0aGF0IHJhcmVseSBjaGFuZ2UuXG4gKlxuICogQHBhcmFtIGZuIC0gVGhlIGFzeW5jIGZ1bmN0aW9uIHRvIGNhY2hlIHJlc3VsdHMgZnJvbVxuICogQHBhcmFtIG9wdGlvbnMgLSBPcHRpb25hbCBjb25maWd1cmF0aW9uIGZvciB0aGUgY2FjaGUgYmVoYXZpb3JcbiAqIEBwYXJhbSBvcHRpb25zLnZhbGlkYXRlIC0gT3B0aW9uYWwgdmFsaWRhdGlvbiBmdW5jdGlvbiBmb3IgY2FjaGVkIGRhdGFcbiAqIEBwYXJhbSBvcHRpb25zLm1heEFnZSAtIE1heGltdW0gYWdlIG9mIGNhY2hlZCBkYXRhIGluIG1pbGxpc2Vjb25kc1xuICogQHJldHVybnMgQW4gYXN5bmMgZnVuY3Rpb24gdGhhdCByZXR1cm5zIHRoZSByZXN1bHQgb2YgdGhlIGZ1bmN0aW9uLCBlaXRoZXIgZnJvbSBjYWNoZSBvciBmcmVzaCBleGVjdXRpb25cbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgdHNcbiAqIGNvbnN0IGNhY2hlZEZ1bmN0aW9uID0gd2l0aENhY2hlKGZldGNoRXhwZW5zaXZlRGF0YSwge1xuICogICBtYXhBZ2U6IDUgKiA2MCAqIDEwMDAgLy8gQ2FjaGUgZm9yIDUgbWludXRlc1xuICogfSk7XG4gKlxuICogY29uc3QgcmVzdWx0ID0gYXdhaXQgY2FjaGVkRnVuY3Rpb24ocXVlcnkpO1xuICogYGBgXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB3aXRoQ2FjaGU8Rm4gZXh0ZW5kcyAoLi4uYXJnczogYW55KSA9PiBQcm9taXNlPGFueT4+KFxuICBmbjogRm4sXG4gIG9wdGlvbnM/OiB7XG4gICAgLyoqIGZ1bmN0aW9uIHRoYXQgcmVjZWl2ZXMgdGhlIGNhY2hlZCBkYXRhIGFuZCByZXR1cm5zIGEgYm9vbGVhbiBkZXBlbmRpbmcgb24gd2hldGhlciB0aGUgZGF0YSBpcyBzdGlsbCB2YWxpZCBvciBub3QuICovXG4gICAgdmFsaWRhdGU/OiAoZGF0YTogQXdhaXRlZDxSZXR1cm5UeXBlPEZuPj4pID0+IGJvb2xlYW47XG4gICAgLyoqIE1heGltdW0gYWdlIG9mIGNhY2hlZCBkYXRhIGluIG1pbGxpc2Vjb25kcyBhZnRlciB3aGljaCB0aGUgZGF0YSB3aWxsIGJlIGNvbnNpZGVyZWQgaW52YWxpZCAqL1xuICAgIG1heEFnZT86IG51bWJlcjtcbiAgfSxcbik6IEZuICYgeyBjbGVhckNhY2hlOiAoKSA9PiB2b2lkIH0ge1xuICBjb25zdCBjYWNoZSA9IG5ldyBDYWNoZSh7IG5hbWVzcGFjZTogaGFzaChmbikgfSk7XG5cbiAgY29uc3Qgd3JhcHBlZEZuID0gYXN5bmMgKC4uLmFyZ3M6IFBhcmFtZXRlcnM8Rm4+KSA9PiB7XG4gICAgY29uc3Qga2V5ID1cbiAgICAgIGhhc2goYXJncyB8fCBbXSkgKyAob3B0aW9ucyBhcyB1bmtub3duIGFzIHsgaW50ZXJuYWxfY2FjaGVLZXlTdWZmaXg/OiBzdHJpbmcgfSk/LmludGVybmFsX2NhY2hlS2V5U3VmZml4O1xuICAgIGNvbnN0IGNhY2hlZCA9IGNhY2hlLmdldChrZXkpO1xuICAgIGlmIChjYWNoZWQpIHtcbiAgICAgIGNvbnN0IHsgZGF0YSwgdGltZXN0YW1wIH0gPSBKU09OLnBhcnNlKGNhY2hlZCwgcmV2aXZlcik7XG4gICAgICBjb25zdCBpc0V4cGlyZWQgPSBvcHRpb25zPy5tYXhBZ2UgJiYgRGF0ZS5ub3coKSAtIHRpbWVzdGFtcCA+IG9wdGlvbnMubWF4QWdlO1xuICAgICAgaWYgKCFpc0V4cGlyZWQgJiYgKCFvcHRpb25zPy52YWxpZGF0ZSB8fCBvcHRpb25zLnZhbGlkYXRlKGRhdGEpKSkge1xuICAgICAgICByZXR1cm4gZGF0YTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L2Jhbi10cy1jb21tZW50XG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGZuKC4uLmFyZ3MpO1xuICAgIGNhY2hlLnNldChcbiAgICAgIGtleSxcbiAgICAgIEpTT04uc3RyaW5naWZ5KFxuICAgICAgICB7XG4gICAgICAgICAgZGF0YTogcmVzdWx0LFxuICAgICAgICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKSxcbiAgICAgICAgfSxcbiAgICAgICAgcmVwbGFjZXIsXG4gICAgICApLFxuICAgICk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfTtcblxuICB3cmFwcGVkRm4uY2xlYXJDYWNoZSA9ICgpID0+IHtcbiAgICBjYWNoZS5jbGVhcigpO1xuICB9O1xuXG4gIC8vIEB0cy1leHBlY3QtZXJyb3IgdG9vIGNvbXBsZXggZm9yIFRTXG4gIHJldHVybiB3cmFwcGVkRm47XG59XG4iLCAiaW1wb3J0IHsgdXNlU3RhdGUgfSBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCB7IEFjdGlvblBhbmVsLCBEZXRhaWwsIHNob3dUb2FzdCwgVG9hc3QgfSBmcm9tIFwiQHJheWNhc3QvYXBpXCI7XG5pbXBvcnQgeyBleGVjU3luYyB9IGZyb20gXCJjaGlsZF9wcm9jZXNzXCI7XG5pbXBvcnQgeyBERUZBVUxUX0VSUk9SX1RJVExFLCBEb3dubG9hZFRleHQgfSBmcm9tIFwiLi4vLi4vY29uc3RhbnRzXCI7XG5pbXBvcnQgeyBjcHVzIH0gZnJvbSBcIm9zXCI7XG5pbXBvcnQgeyBqb2luIH0gZnJvbSBcInBhdGhcIjtcbmltcG9ydCB7IEV4ZWNFcnJvciB9IGZyb20gXCIuLi8uLi9pbnRlcmZhY2VzXCI7XG5cbmV4cG9ydCBjb25zdCBicmV3UHJlZml4OiBzdHJpbmcgPSAoKCkgPT4ge1xuICB0cnkge1xuICAgIHJldHVybiBleGVjU3luYyhcImJyZXcgLS1wcmVmaXhcIiwgeyBlbmNvZGluZzogXCJ1dGY4XCIgfSkudHJpbSgpO1xuICB9IGNhdGNoIHtcbiAgICByZXR1cm4gY3B1cygpWzBdLm1vZGVsLmluY2x1ZGVzKFwiQXBwbGVcIikgPyBcIi9vcHQvaG9tZWJyZXdcIiA6IFwiL3Vzci9sb2NhbFwiO1xuICB9XG59KSgpO1xuXG5leHBvcnQgZnVuY3Rpb24gYnJld0V4ZWN1dGFibGUoKTogc3RyaW5nIHtcbiAgcmV0dXJuIGpvaW4oYnJld1ByZWZpeCwgXCJiaW4vYnJld1wiKTtcbn1cblxuZnVuY3Rpb24gZXhlY0JyZXcoY2Fzazogc3RyaW5nKSB7XG4gIHRyeSB7XG4gICAgcmV0dXJuIGV4ZWNTeW5jKGAke2JyZXdFeGVjdXRhYmxlKCl9IGluc3RhbGwgLS1jYXNrICR7Y2Fza31gLCB7IG1heEJ1ZmZlcjogMTAgKiAxMDI0ICogMTAyNCB9KTtcbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgY29uc3QgZXhlY0VyciA9IGVyciBhcyBFeGVjRXJyb3I7XG4gICAgaWYgKGV4ZWNFcnIgJiYgZXhlY0Vyci5jb2RlID09PSAxMjcpIHtcbiAgICAgIGV4ZWNFcnIuc3RkZXJyID0gYEJyZXcgZXhlY3V0YWJsZSBub3QgZm91bmQgYXQgJHticmV3RXhlY3V0YWJsZSgpfWA7XG4gICAgICB0aHJvdyBleGVjRXJyO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aHJvdyBlcnI7XG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBOb3RJbnN0YWxsZWRFcnJvcigpIHtcbiAgY29uc3QgW2lzTG9hZGluZywgc2V0SXNMb2FkaW5nXSA9IHVzZVN0YXRlKHRydWUpO1xuICByZXR1cm4gKFxuICAgIDxEZXRhaWxcbiAgICAgIGFjdGlvbnM9e1xuICAgICAgICA8QWN0aW9uUGFuZWw+XG4gICAgICAgICAge2lzTG9hZGluZyAmJiAoXG4gICAgICAgICAgICA8QWN0aW9uUGFuZWwuSXRlbVxuICAgICAgICAgICAgICB0aXRsZT1cIkluc3RhbGwgd2l0aCBIb21lYnJld1wiXG4gICAgICAgICAgICAgIG9uQWN0aW9uPXthc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKCFpc0xvYWRpbmcpIHJldHVybjtcbiAgICAgICAgICAgICAgICBjb25zdCB0b2FzdCA9IG5ldyBUb2FzdCh7IHN0eWxlOiBUb2FzdC5TdHlsZS5BbmltYXRlZCwgdGl0bGU6IFwiSW5zdGFsbGluZy4uLlwiIH0pO1xuICAgICAgICAgICAgICAgIGF3YWl0IHRvYXN0LnNob3coKTtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgZXhlY0JyZXcoXCJicmF2ZS1icm93c2VyXCIpO1xuICAgICAgICAgICAgICAgICAgYXdhaXQgdG9hc3QuaGlkZSgpO1xuICAgICAgICAgICAgICAgIH0gY2F0Y2gge1xuICAgICAgICAgICAgICAgICAgYXdhaXQgdG9hc3QuaGlkZSgpO1xuICAgICAgICAgICAgICAgICAgYXdhaXQgc2hvd1RvYXN0KFxuICAgICAgICAgICAgICAgICAgICBUb2FzdC5TdHlsZS5GYWlsdXJlLFxuICAgICAgICAgICAgICAgICAgICBERUZBVUxUX0VSUk9SX1RJVExFLFxuICAgICAgICAgICAgICAgICAgICBcIkFuIHVua25vd24gZXJyb3Igb2NjdXJyZWQgd2hpbGUgdHJ5aW5nIHRvIGluc3RhbGxcIixcbiAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRvYXN0LnRpdGxlID0gXCJJbnN0YWxsZWQhIFBsZWFzZSBnbyBiYWNrIGFuZCB0cnkgYWdhaW4uXCI7XG4gICAgICAgICAgICAgICAgdG9hc3Quc3R5bGUgPSBUb2FzdC5TdHlsZS5TdWNjZXNzO1xuICAgICAgICAgICAgICAgIGF3YWl0IHRvYXN0LnNob3coKTtcbiAgICAgICAgICAgICAgICBzZXRJc0xvYWRpbmcoZmFsc2UpO1xuICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgLz5cbiAgICAgICAgICApfVxuICAgICAgICA8L0FjdGlvblBhbmVsPlxuICAgICAgfVxuICAgICAgbWFya2Rvd249e0Rvd25sb2FkVGV4dH1cbiAgICAvPlxuICApO1xufVxuIiwgImltcG9ydCB7IERldGFpbCwgc2hvd1RvYXN0LCBUb2FzdCB9IGZyb20gXCJAcmF5Y2FzdC9hcGlcIjtcbmltcG9ydCB7IERFRkFVTFRfRVJST1JfVElUTEUsIFVua25vd25FcnJvclRleHQgfSBmcm9tIFwiLi4vLi4vY29uc3RhbnRzXCI7XG5cbmV4cG9ydCBmdW5jdGlvbiBVbmtub3duRXJyb3IoKSB7XG4gIHNob3dUb2FzdChUb2FzdC5TdHlsZS5GYWlsdXJlLCBERUZBVUxUX0VSUk9SX1RJVExFLCBcIlNvbWV0aGluZyBoYXBwZW5lZCB3aGlsZSB0cnlpbmcgdG8gcnVuIHlvdXIgY29tbWFuZFwiKTtcblxuICByZXR1cm4gPERldGFpbCBtYXJrZG93bj17VW5rbm93bkVycm9yVGV4dH0gLz47XG59XG4iLCAiaW1wb3J0IHsgUmVhY3RFbGVtZW50IH0gZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgeyBBY3Rpb24sIEFjdGlvblBhbmVsLCBjbG9zZU1haW5XaW5kb3csIGdldFByZWZlcmVuY2VWYWx1ZXMsIEljb24gfSBmcm9tIFwiQHJheWNhc3QvYXBpXCI7XG5pbXBvcnQgeyBjbG9zZVRhYiwgZXhlY3V0ZUphdmFzY3JpcHQsIG9wZW5OZXdUYWIsIHNldEFjdGl2ZVRhYiwgb3BlbkFsbEJvb2ttYXJrc0luRm9sZGVyIH0gZnJvbSBcIi4uL2FjdGlvbnNcIjtcbmltcG9ydCB7IFNldHRpbmdzUHJvZmlsZU9wZW5CZWhhdmlvdXIsIFRhYiB9IGZyb20gXCIuLi9pbnRlcmZhY2VzXCI7XG5pbXBvcnQgeyB1c2VDYWNoZWRTdGF0ZSwgc2hvd0ZhaWx1cmVUb2FzdCB9IGZyb20gXCJAcmF5Y2FzdC91dGlsc1wiO1xuaW1wb3J0IHsgQlJBVkVfUFJPRklMRV9LRVksIERFRkFVTFRfQlJBVkVfUFJPRklMRV9JRCB9IGZyb20gXCIuLi9jb25zdGFudHNcIjtcblxuZXhwb3J0IGNsYXNzIEJyYXZlQWN0aW9ucyB7XG4gIHB1YmxpYyBzdGF0aWMgTmV3VGFiID0gTmV3VGFiQWN0aW9ucztcbiAgcHVibGljIHN0YXRpYyBUYWJMaXN0ID0gVGFiTGlzdEl0ZW1BY3Rpb25zO1xuICBwdWJsaWMgc3RhdGljIFRhYkhpc3RvcnkgPSBIaXN0b3J5SXRlbUFjdGlvbnM7XG4gIHB1YmxpYyBzdGF0aWMgT3BlbkFsbEJvb2ttYXJrc0luRm9sZGVyID0gT3BlbkFsbEJvb2ttYXJrc0luRm9sZGVyQWN0aW9uO1xufVxuXG5mdW5jdGlvbiBPcGVuQWxsQm9va21hcmtzSW5Gb2xkZXJBY3Rpb24ocHJvcHM6IHsgdXJsczogc3RyaW5nW107IHByb2ZpbGU6IHN0cmluZyB9KSB7XG4gIGNvbnN0IHsgb3BlblRhYkluUHJvZmlsZSB9ID0gZ2V0UHJlZmVyZW5jZVZhbHVlczxQcmVmZXJlbmNlcz4oKTtcbiAgY29uc3QgW3Byb2ZpbGVDdXJyZW50XSA9IHVzZUNhY2hlZFN0YXRlKEJSQVZFX1BST0ZJTEVfS0VZLCBERUZBVUxUX0JSQVZFX1BST0ZJTEVfSUQpO1xuXG4gIHJldHVybiAoXG4gICAgPEFjdGlvblBhbmVsIHRpdGxlPVwiT3BlbiBBbGwgQm9va21hcmtzIEluIEZvbGRlclwiPlxuICAgICAgPEFjdGlvblxuICAgICAgICB0aXRsZT1cIk9wZW4gQWxsIEJvb2ttYXJrcyBpbiBGb2xkZXJcIlxuICAgICAgICBvbkFjdGlvbj17KCkgPT5cbiAgICAgICAgICBvcGVuQWxsQm9va21hcmtzSW5Gb2xkZXIoe1xuICAgICAgICAgICAgdXJsczogcHJvcHMudXJscyxcbiAgICAgICAgICAgIHByb2ZpbGVDdXJyZW50OiBwcm9maWxlQ3VycmVudCxcbiAgICAgICAgICAgIG9wZW5UYWJJblByb2ZpbGU6IG9wZW5UYWJJblByb2ZpbGUsXG4gICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgICAgLz5cbiAgICA8L0FjdGlvblBhbmVsPlxuICApO1xufVxuXG5mdW5jdGlvbiBOZXdUYWJBY3Rpb25zKHsgcXVlcnksIGluY29nbml0byB9OiB7IHF1ZXJ5Pzogc3RyaW5nOyBpbmNvZ25pdG8/OiBib29sZWFuIH0pOiBSZWFjdEVsZW1lbnQge1xuICBjb25zdCB7IG9wZW5UYWJJblByb2ZpbGUgfSA9IGdldFByZWZlcmVuY2VWYWx1ZXM8UHJlZmVyZW5jZXM+KCk7XG4gIGNvbnN0IFtwcm9maWxlQ3VycmVudF0gPSB1c2VDYWNoZWRTdGF0ZShCUkFWRV9QUk9GSUxFX0tFWSwgREVGQVVMVF9CUkFWRV9QUk9GSUxFX0lEKTtcblxuICByZXR1cm4gKFxuICAgIDxBY3Rpb25QYW5lbCB0aXRsZT1cIk5ldyBUYWJcIj5cbiAgICAgIDxBY3Rpb25cbiAgICAgICAgb25BY3Rpb249eygpID0+IG9wZW5OZXdUYWIoeyBxdWVyeSwgcHJvZmlsZUN1cnJlbnQsIG9wZW5UYWJJblByb2ZpbGUsIGluY29nbml0byB9KX1cbiAgICAgICAgdGl0bGU9e3F1ZXJ5ID8gYFNlYXJjaCBcIiR7cXVlcnl9XCJgIDogXCJPcGVuIE5ldyBUYWJcIn1cbiAgICAgICAgaWNvbj17SWNvbi5HbG9iZX1cbiAgICAgIC8+XG4gICAgPC9BY3Rpb25QYW5lbD5cbiAgKTtcbn1cblxuZnVuY3Rpb24gVGFiTGlzdEl0ZW1BY3Rpb25zKHsgdGFiIH06IHsgdGFiOiBUYWIgfSkge1xuICBjb25zdCB7IG9wZW5UYWJJblByb2ZpbGUgfSA9IGdldFByZWZlcmVuY2VWYWx1ZXM8UHJlZmVyZW5jZXM+KCk7XG4gIGNvbnN0IFtwcm9maWxlQ3VycmVudF0gPSB1c2VDYWNoZWRTdGF0ZShCUkFWRV9QUk9GSUxFX0tFWSwgREVGQVVMVF9CUkFWRV9QUk9GSUxFX0lEKTtcblxuICByZXR1cm4gKFxuICAgIDxBY3Rpb25QYW5lbCB0aXRsZT17dGFiLnRpdGxlfT5cbiAgICAgIDxHb1RvVGFiIHRhYj17dGFifSAvPlxuICAgICAgPEFjdGlvblxuICAgICAgICB0aXRsZT1cIk1vdmUgdG8gTmV3IFdpbmRvd1wiXG4gICAgICAgIGljb249e0ljb24uV2luZG93fVxuICAgICAgICBvbkFjdGlvbj17YXN5bmMgKCkgPT4ge1xuICAgICAgICAgIGF3YWl0IGNsb3NlVGFiKHRhYi50YWJJbmRleCk7XG4gICAgICAgICAgYXdhaXQgb3Blbk5ld1RhYih7IHVybDogdGFiLnVybCwgcHJvZmlsZUN1cnJlbnQsIG9wZW5UYWJJblByb2ZpbGUsIG5ld1dpbmRvdzogdHJ1ZSB9KTtcbiAgICAgICAgfX1cbiAgICAgIC8+XG4gICAgICA8QWN0aW9uXG4gICAgICAgIHRpdGxlPVwiTW92ZSB0byBJbmNvZ25pdG8gV2luZG93XCJcbiAgICAgICAgaWNvbj17SWNvbi5FeWVEaXNhYmxlZH1cbiAgICAgICAgb25BY3Rpb249e2FzeW5jICgpID0+IHtcbiAgICAgICAgICBhd2FpdCBjbG9zZVRhYih0YWIudGFiSW5kZXgpO1xuICAgICAgICAgIGF3YWl0IG9wZW5OZXdUYWIoeyB1cmw6IHRhYi51cmwsIHByb2ZpbGVDdXJyZW50LCBvcGVuVGFiSW5Qcm9maWxlLCBpbmNvZ25pdG86IHRydWUgfSk7XG4gICAgICAgIH19XG4gICAgICAvPlxuICAgICAgPEFjdGlvbi5Db3B5VG9DbGlwYm9hcmQgdGl0bGU9XCJDb3B5IFVSTFwiIGNvbnRlbnQ9e3RhYi51cmx9IC8+XG4gICAgPC9BY3Rpb25QYW5lbD5cbiAgKTtcbn1cblxuZnVuY3Rpb24gSGlzdG9yeUl0ZW1BY3Rpb25zKHtcbiAgdGl0bGUsXG4gIHVybCxcbiAgcHJvZmlsZTogcHJvZmlsZU9yaWdpbmFsLFxufToge1xuICB0aXRsZTogc3RyaW5nO1xuICB1cmw6IHN0cmluZztcbiAgcHJvZmlsZTogc3RyaW5nO1xufSk6IFJlYWN0RWxlbWVudCB7XG4gIGNvbnN0IHsgb3BlblRhYkluUHJvZmlsZSB9ID0gZ2V0UHJlZmVyZW5jZVZhbHVlczxQcmVmZXJlbmNlcz4oKTtcbiAgY29uc3QgW3Byb2ZpbGVDdXJyZW50XSA9IHVzZUNhY2hlZFN0YXRlKEJSQVZFX1BST0ZJTEVfS0VZLCBERUZBVUxUX0JSQVZFX1BST0ZJTEVfSUQpO1xuXG4gIGlmICh1cmwuc3RhcnRzV2l0aChcImphdmFzY3JpcHQ6XCIpKSB7XG4gICAgY29uc3QgY29kZSA9IHVybC5zdWJzdHJpbmcoXCJqYXZhc2NyaXB0OlwiLmxlbmd0aCk7XG4gICAgcmV0dXJuIChcbiAgICAgIDxBY3Rpb25QYW5lbCB0aXRsZT17dGl0bGV9PlxuICAgICAgICA8QWN0aW9uIG9uQWN0aW9uPXsoKSA9PiBleGVjdXRlSmF2YXNjcmlwdChjb2RlKX0gaWNvbj17SWNvbi5QbGF5fSB0aXRsZT1cIlJ1biBCb29rbWFya2xldFwiIC8+XG4gICAgICAgIDxBY3Rpb24uQ29weVRvQ2xpcGJvYXJkIHRpdGxlPVwiQ29weSBDb2RlXCIgY29udGVudD17Y29kZX0gc2hvcnRjdXQ9e3sgbW9kaWZpZXJzOiBbXCJjbWRcIl0sIGtleTogXCJjXCIgfX0gLz5cbiAgICAgIDwvQWN0aW9uUGFuZWw+XG4gICAgKTtcbiAgfVxuXG4gIHJldHVybiAoXG4gICAgPEFjdGlvblBhbmVsIHRpdGxlPXt0aXRsZX0+XG4gICAgICA8QWN0aW9uXG4gICAgICAgIG9uQWN0aW9uPXthc3luYyAoKSA9PiBhd2FpdCBvcGVuTmV3VGFiKHsgdXJsLCBwcm9maWxlT3JpZ2luYWwsIHByb2ZpbGVDdXJyZW50LCBvcGVuVGFiSW5Qcm9maWxlIH0pfVxuICAgICAgICBpY29uPXtJY29uLkV5ZX1cbiAgICAgICAgdGl0bGU9XCJPcGVuXCJcbiAgICAgIC8+XG4gICAgICA8QWN0aW9uXG4gICAgICAgIHRpdGxlPVwiT3BlbiBpbiBOZXcgV2luZG93XCJcbiAgICAgICAgaWNvbj17SWNvbi5XaW5kb3d9XG4gICAgICAgIG9uQWN0aW9uPXthc3luYyAoKSA9PlxuICAgICAgICAgIGF3YWl0IG9wZW5OZXdUYWIoeyB1cmwsIHByb2ZpbGVPcmlnaW5hbCwgcHJvZmlsZUN1cnJlbnQsIG9wZW5UYWJJblByb2ZpbGUsIG5ld1dpbmRvdzogdHJ1ZSB9KVxuICAgICAgICB9XG4gICAgICAvPlxuICAgICAgPEFjdGlvblxuICAgICAgICB0aXRsZT1cIk9wZW4gaW4gSW5jb2duaXRvIFdpbmRvd1wiXG4gICAgICAgIGljb249e0ljb24uRXllRGlzYWJsZWR9XG4gICAgICAgIG9uQWN0aW9uPXthc3luYyAoKSA9PlxuICAgICAgICAgIGF3YWl0IG9wZW5OZXdUYWIoeyB1cmwsIHByb2ZpbGVPcmlnaW5hbCwgcHJvZmlsZUN1cnJlbnQsIG9wZW5UYWJJblByb2ZpbGUsIGluY29nbml0bzogdHJ1ZSB9KVxuICAgICAgICB9XG4gICAgICAvPlxuICAgICAgPEFjdGlvblBhbmVsLlNlY3Rpb24gdGl0bGU9e1wiT3BlbiBpbiBwcm9maWxlXCJ9PlxuICAgICAgICA8QWN0aW9uXG4gICAgICAgICAgb25BY3Rpb249eygpID0+XG4gICAgICAgICAgICBvcGVuTmV3VGFiKHtcbiAgICAgICAgICAgICAgdXJsLFxuICAgICAgICAgICAgICBwcm9maWxlT3JpZ2luYWwsXG4gICAgICAgICAgICAgIHByb2ZpbGVDdXJyZW50LFxuICAgICAgICAgICAgICBvcGVuVGFiSW5Qcm9maWxlOiBTZXR0aW5nc1Byb2ZpbGVPcGVuQmVoYXZpb3VyLlByb2ZpbGVDdXJyZW50LFxuICAgICAgICAgICAgfSlcbiAgICAgICAgICB9XG4gICAgICAgICAgdGl0bGU9e1wiT3BlbiBpbiBDdXJyZW50IFByb2ZpbGVcIn1cbiAgICAgICAgLz5cbiAgICAgICAgPEFjdGlvblxuICAgICAgICAgIG9uQWN0aW9uPXsoKSA9PlxuICAgICAgICAgICAgb3Blbk5ld1RhYih7XG4gICAgICAgICAgICAgIHVybCxcbiAgICAgICAgICAgICAgcHJvZmlsZU9yaWdpbmFsLFxuICAgICAgICAgICAgICBwcm9maWxlQ3VycmVudCxcbiAgICAgICAgICAgICAgb3BlblRhYkluUHJvZmlsZTogU2V0dGluZ3NQcm9maWxlT3BlbkJlaGF2aW91ci5Qcm9maWxlT3JpZ2luYWwsXG4gICAgICAgICAgICB9KVxuICAgICAgICAgIH1cbiAgICAgICAgICB0aXRsZT17XCJPcGVuIGluIE9yaWdpbmFsIFByb2ZpbGVcIn1cbiAgICAgICAgLz5cbiAgICAgIDwvQWN0aW9uUGFuZWwuU2VjdGlvbj5cbiAgICAgIDxBY3Rpb24uQ29weVRvQ2xpcGJvYXJkIHRpdGxlPVwiQ29weSBVUkxcIiBjb250ZW50PXt1cmx9IHNob3J0Y3V0PXt7IG1vZGlmaWVyczogW1wiY21kXCJdLCBrZXk6IFwiY1wiIH19IC8+XG4gICAgPC9BY3Rpb25QYW5lbD5cbiAgKTtcbn1cblxuZnVuY3Rpb24gR29Ub1RhYihwcm9wczogeyB0YWI6IFRhYiB9KSB7XG4gIGFzeW5jIGZ1bmN0aW9uIGhhbmRsZUFjdGlvbigpIHtcbiAgICB0cnkge1xuICAgICAgYXdhaXQgc2V0QWN0aXZlVGFiKHByb3BzLnRhYik7XG4gICAgICBhd2FpdCBjbG9zZU1haW5XaW5kb3coKTtcbiAgICB9IGNhdGNoIHtcbiAgICAgIGF3YWl0IHNob3dGYWlsdXJlVG9hc3QoXCJUYWIgbm8gbG9uZ2VyIGV4aXN0c1wiLCB7XG4gICAgICAgIG1lc3NhZ2U6IFwiVGhlIHRhYiBtYXkgaGF2ZSBiZWVuIGNsb3NlZC4gVHJ5IHNlYXJjaGluZyBhZ2Fpbi5cIixcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiA8QWN0aW9uUGFuZWwuSXRlbSB0aXRsZT1cIk9wZW4gVGFiXCIgaWNvbj17eyBzb3VyY2U6IEljb24uRXllIH19IG9uQWN0aW9uPXtoYW5kbGVBY3Rpb259IC8+O1xufVxuIiwgImltcG9ydCB7IHJ1bkFwcGxlU2NyaXB0LCBzaG93RmFpbHVyZVRvYXN0IH0gZnJvbSBcIkByYXljYXN0L3V0aWxzXCI7XG5pbXBvcnQgeyBjbG9zZU1haW5XaW5kb3csIGdldFByZWZlcmVuY2VWYWx1ZXMsIHBvcFRvUm9vdCB9IGZyb20gXCJAcmF5Y2FzdC9hcGlcIjtcbmltcG9ydCB7IFNldHRpbmdzUHJvZmlsZU9wZW5CZWhhdmlvdXIsIFRhYiB9IGZyb20gXCIuLi9pbnRlcmZhY2VzXCI7XG5pbXBvcnQgeyBOT1RfSU5TVEFMTEVEX01FU1NBR0UgfSBmcm9tIFwiLi4vY29uc3RhbnRzXCI7XG5pbXBvcnQgeyBleGVjIH0gZnJvbSBcImNoaWxkX3Byb2Nlc3NcIjtcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldE9wZW5UYWJzKHVzZU9yaWdpbmFsRmF2aWNvbjogYm9vbGVhbik6IFByb21pc2U8VGFiW10+IHtcbiAgY29uc3QgZmF2aWNvbkZvcm11bGEgPSB1c2VPcmlnaW5hbEZhdmljb25cbiAgICA/IGBleGVjdXRlIG9mIHRhYiBfdGFiX2luZGV4IG9mIHdpbmRvdyBfd2luZG93X2luZGV4IGphdmFzY3JpcHQgXHUwMEFDXG4gICAgICAgICAgICAgICAgICAgIFwiZG9jdW1lbnQuaGVhZC5xdWVyeVNlbGVjdG9yKCdsaW5rW3JlbH49aWNvbl0nKS5ocmVmO1wiYFxuICAgIDogJ1wiXCInO1xuXG4gIGF3YWl0IGNoZWNrQXBwSW5zdGFsbGVkKCk7XG5cbiAgY29uc3QgeyBicm93c2VyT3B0aW9uIH0gPSBnZXRQcmVmZXJlbmNlVmFsdWVzPFByZWZlcmVuY2VzPigpO1xuXG4gIGNvbnN0IG9wZW5UYWJzID0gYXdhaXQgcnVuQXBwbGVTY3JpcHQoYFxuICAgICAgc2V0IF9vdXRwdXQgdG8gXCJcIlxuICAgICAgdGVsbCBhcHBsaWNhdGlvbiBcIiR7YnJvd3Nlck9wdGlvbn1cIlxuICAgICAgICBzZXQgX3dpbmRvd19pbmRleCB0byAxXG4gICAgICAgIHJlcGVhdCB3aXRoIHcgaW4gd2luZG93c1xuICAgICAgICAgIHNldCBfdGFiX2luZGV4IHRvIDFcbiAgICAgICAgICByZXBlYXQgd2l0aCB0IGluIHRhYnMgb2Ygd1xuICAgICAgICAgICAgc2V0IF90aXRsZSB0byBnZXQgdGl0bGUgb2YgdFxuICAgICAgICAgICAgc2V0IF91cmwgdG8gZ2V0IFVSTCBvZiB0XG4gICAgICAgICAgICBzZXQgX2Zhdmljb24gdG8gJHtmYXZpY29uRm9ybXVsYX1cbiAgICAgICAgICAgIHNldCBfb3V0cHV0IHRvIChfb3V0cHV0ICYgX3RpdGxlICYgXCIke1RhYi5UQUJfQ09OVEVOVFNfU0VQQVJBVE9SfVwiICYgX3VybCAmIFwiJHtUYWIuVEFCX0NPTlRFTlRTX1NFUEFSQVRPUn1cIiAmIF9mYXZpY29uICYgXCIke1RhYi5UQUJfQ09OVEVOVFNfU0VQQVJBVE9SfVwiICYgX3dpbmRvd19pbmRleCAmIFwiJHtUYWIuVEFCX0NPTlRFTlRTX1NFUEFSQVRPUn1cIiAmIF90YWJfaW5kZXggJiBcIlxcXFxuXCIpXG4gICAgICAgICAgICBzZXQgX3RhYl9pbmRleCB0byBfdGFiX2luZGV4ICsgMVxuICAgICAgICAgIGVuZCByZXBlYXRcbiAgICAgICAgICBzZXQgX3dpbmRvd19pbmRleCB0byBfd2luZG93X2luZGV4ICsgMVxuICAgICAgICAgIGlmIF93aW5kb3dfaW5kZXggPiBjb3VudCB3aW5kb3dzIHRoZW4gZXhpdCByZXBlYXRcbiAgICAgICAgZW5kIHJlcGVhdFxuICAgICAgZW5kIHRlbGxcbiAgICAgIHJldHVybiBfb3V0cHV0XG4gIGApO1xuXG4gIHJldHVybiBvcGVuVGFic1xuICAgIC5zcGxpdChcIlxcblwiKVxuICAgIC5maWx0ZXIoKGxpbmUpID0+IGxpbmUubGVuZ3RoICE9PSAwKVxuICAgIC5tYXAoKGxpbmUpID0+IFRhYi5wYXJzZShsaW5lKSk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBvcGVuQWxsQm9va21hcmtzSW5Gb2xkZXIoe1xuICB1cmxzLFxuICBwcm9maWxlQ3VycmVudCxcbiAgb3BlblRhYkluUHJvZmlsZSxcbn06IHtcbiAgdXJsczogc3RyaW5nW107XG4gIHByb2ZpbGVDdXJyZW50OiBzdHJpbmc7XG4gIG9wZW5UYWJJblByb2ZpbGU6IFByZWZlcmVuY2VzW1wib3BlblRhYkluUHJvZmlsZVwiXTtcbn0pOiBQcm9taXNlPHZvaWQ+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCB7IGJyb3dzZXJPcHRpb24gfSA9IGdldFByZWZlcmVuY2VWYWx1ZXM8UHJlZmVyZW5jZXM+KCk7XG5cbiAgICBjb25zdCBidWlsZEFyZ3MgPSAocHJvZmlsZT86IHN0cmluZyk6IHN0cmluZ1tdID0+IHtcbiAgICAgIGNvbnN0IGFyZ3M6IHN0cmluZ1tdID0gW107XG4gICAgICBpZiAocHJvZmlsZSkge1xuICAgICAgICBhcmdzLnB1c2goYC0tcHJvZmlsZS1kaXJlY3Rvcnk9JHtwcm9maWxlfWApO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGFyZ3M7XG4gICAgfTtcblxuICAgIGxldCBhcmdzOiBzdHJpbmdbXSA9IFtdO1xuICAgIHN3aXRjaCAob3BlblRhYkluUHJvZmlsZSkge1xuICAgICAgY2FzZSBTZXR0aW5nc1Byb2ZpbGVPcGVuQmVoYXZpb3VyLkRlZmF1bHQ6XG4gICAgICAgIGFyZ3MgPSBidWlsZEFyZ3MoKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIFNldHRpbmdzUHJvZmlsZU9wZW5CZWhhdmlvdXIuUHJvZmlsZUN1cnJlbnQ6XG4gICAgICAgIGFyZ3MgPSBidWlsZEFyZ3MocHJvZmlsZUN1cnJlbnQpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgU2V0dGluZ3NQcm9maWxlT3BlbkJlaGF2aW91ci5Qcm9maWxlT3JpZ2luYWw6XG4gICAgICAgIC8vIFRoaXMgaXMgbm90IHN1cHBvcnRlZCB3aGVuIG9wZW5pbmcgbXVsdGlwbGUgdXJscywgc28gd2UgZmFsbGJhY2sgdG8gdGhlIGN1cnJlbnQgcHJvZmlsZVxuICAgICAgICBhcmdzID0gYnVpbGRBcmdzKHByb2ZpbGVDdXJyZW50KTtcbiAgICAgICAgYnJlYWs7XG4gICAgfVxuXG4gICAgY29uc3QgdXJsc1N0cmluZyA9IHVybHMubWFwKCh1cmwpID0+IGBcIiR7dXJsfVwiYCkuam9pbihcIiBcIik7XG4gICAgY29uc3QgYXJnc1N0cmluZyA9IGFyZ3MubWFwKChhcmcpID0+IGBcIiR7YXJnfVwiYCkuam9pbihcIiBcIik7XG4gICAgY29uc3QgY29tbWFuZCA9IGBvcGVuIC1uYSBcIiR7YnJvd3Nlck9wdGlvbn1cIiAtLWFyZ3MgJHthcmdzU3RyaW5nfSAke3VybHNTdHJpbmd9YDtcblxuICAgIGF3YWl0IG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIGV4ZWMoY29tbWFuZCwgKGVycm9yKSA9PiB7XG4gICAgICAgIGlmIChlcnJvcikge1xuICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY2xvc2VNYWluV2luZG93KHsgY2xlYXJSb290U2VhcmNoOiB0cnVlIH0pO1xuICAgICAgICAgIHJlc29sdmUodHJ1ZSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0pO1xuICB9IGNhdGNoIChlKSB7XG4gICAgY29uc29sZS5lcnJvcihlKTtcbiAgICBhd2FpdCBzaG93RmFpbHVyZVRvYXN0KFwiQ291bGQgbm90IG9wZW4gYWxsIGJvb2ttYXJrc1wiLCB7XG4gICAgICBtZXNzYWdlOiBlIGluc3RhbmNlb2YgRXJyb3IgPyBlLm1lc3NhZ2UgOiBTdHJpbmcoZSksXG4gICAgfSk7XG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIG9wZW5OZXdUYWIoe1xuICB1cmwsXG4gIHF1ZXJ5LFxuICBwcm9maWxlQ3VycmVudCxcbiAgcHJvZmlsZU9yaWdpbmFsLFxuICBvcGVuVGFiSW5Qcm9maWxlLFxuICBuZXdXaW5kb3csXG4gIGluY29nbml0byxcbn06IHtcbiAgdXJsPzogc3RyaW5nO1xuICBxdWVyeT86IHN0cmluZztcbiAgcHJvZmlsZUN1cnJlbnQ6IHN0cmluZztcbiAgcHJvZmlsZU9yaWdpbmFsPzogc3RyaW5nO1xuICBvcGVuVGFiSW5Qcm9maWxlOiBQcmVmZXJlbmNlc1tcIm9wZW5UYWJJblByb2ZpbGVcIl07XG4gIG5ld1dpbmRvdz86IGJvb2xlYW47XG4gIGluY29nbml0bz86IGJvb2xlYW47XG59KTogUHJvbWlzZTxib29sZWFuIHwgc3RyaW5nPiB7XG4gIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgIHBvcFRvUm9vdCh7IGNsZWFyU2VhcmNoQmFyOiB0cnVlIH0pO1xuICB9LCAzMDAwKTtcbiAgY29uc3QgaW5zdGFsbGVkID0gYXdhaXQgY2hlY2tBcHBJbnN0YWxsZWQoKTtcbiAgaWYgKGluc3RhbGxlZCkge1xuICAgIGNsb3NlTWFpbldpbmRvdyh7IGNsZWFyUm9vdFNlYXJjaDogdHJ1ZSB9KTtcbiAgfVxuXG4gIGNvbnN0IHsgYnJvd3Nlck9wdGlvbiB9ID0gZ2V0UHJlZmVyZW5jZVZhbHVlczxQcmVmZXJlbmNlcz4oKTtcbiAgY29uc3QgdGFyZ2V0VXJsID0gdXJsID8gdXJsIDogcXVlcnkgPyBgaHR0cHM6Ly93d3cuZ29vZ2xlLmNvbS9zZWFyY2g/cT0ke2VuY29kZVVSSUNvbXBvbmVudChxdWVyeSl9YCA6IFwiXCI7XG5cbiAgLy8gSGVscGVyIHRvIHJ1biBzaGVsbCBjb21tYW5kXG4gIGNvbnN0IHJ1blNoZWxsQ29tbWFuZCA9IChjb21tYW5kOiBzdHJpbmcpOiBQcm9taXNlPGJvb2xlYW4gfCBzdHJpbmc+ID0+IHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgZXhlYyhjb21tYW5kLCAoZXJyb3IpID0+IHtcbiAgICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXNvbHZlKHRydWUpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfTtcblxuICAvLyBCdWlsZCBjb21tYW5kIGFyZ3VtZW50cyBiYXNlZCBvbiBvcHRpb25zXG4gIGNvbnN0IGJ1aWxkQXJncyA9IChwcm9maWxlPzogc3RyaW5nKTogc3RyaW5nW10gPT4ge1xuICAgIGNvbnN0IGFyZ3M6IHN0cmluZ1tdID0gW107XG4gICAgaWYgKHByb2ZpbGUpIHtcbiAgICAgIGFyZ3MucHVzaChgLS1wcm9maWxlLWRpcmVjdG9yeT0ke3Byb2ZpbGV9YCk7XG4gICAgfVxuICAgIGlmIChuZXdXaW5kb3cpIHtcbiAgICAgIGFyZ3MucHVzaChcIi0tbmV3LXdpbmRvd1wiKTtcbiAgICB9XG4gICAgaWYgKGluY29nbml0bykge1xuICAgICAgYXJncy5wdXNoKFwiLS1pbmNvZ25pdG9cIik7XG4gICAgfVxuICAgIGlmICh0YXJnZXRVcmwpIHtcbiAgICAgIGFyZ3MucHVzaCh0YXJnZXRVcmwpO1xuICAgIH1cbiAgICByZXR1cm4gYXJncztcbiAgfTtcblxuICBsZXQgYXJnczogc3RyaW5nW10gPSBbXTtcblxuICBzd2l0Y2ggKG9wZW5UYWJJblByb2ZpbGUpIHtcbiAgICBjYXNlIFNldHRpbmdzUHJvZmlsZU9wZW5CZWhhdmlvdXIuRGVmYXVsdDpcbiAgICAgIGFyZ3MgPSBidWlsZEFyZ3MoKTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgU2V0dGluZ3NQcm9maWxlT3BlbkJlaGF2aW91ci5Qcm9maWxlQ3VycmVudDpcbiAgICAgIGFyZ3MgPSBidWlsZEFyZ3MocHJvZmlsZUN1cnJlbnQpO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSBTZXR0aW5nc1Byb2ZpbGVPcGVuQmVoYXZpb3VyLlByb2ZpbGVPcmlnaW5hbDpcbiAgICAgIGFyZ3MgPSBidWlsZEFyZ3MocHJvZmlsZU9yaWdpbmFsKTtcbiAgICAgIGJyZWFrO1xuICB9XG5cbiAgY29uc3QgYXJnc1N0cmluZyA9IGFyZ3MubWFwKChhcmcpID0+IGBcIiR7YXJnfVwiYCkuam9pbihcIiBcIik7XG4gIGNvbnN0IGNvbW1hbmQgPSBgb3BlbiAtbmEgXCIke2Jyb3dzZXJPcHRpb259XCIgLS1hcmdzICR7YXJnc1N0cmluZ31gO1xuXG4gIHJldHVybiBydW5TaGVsbENvbW1hbmQoY29tbWFuZCk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjbG9zZVRhYih0YWJJbmRleDogbnVtYmVyKTogUHJvbWlzZTx2b2lkPiB7XG4gIGNvbnN0IHsgYnJvd3Nlck9wdGlvbiB9ID0gZ2V0UHJlZmVyZW5jZVZhbHVlczxQcmVmZXJlbmNlcz4oKTtcbiAgYXdhaXQgcnVuQXBwbGVTY3JpcHQoYHRlbGwgYXBwbGljYXRpb24gXCIke2Jyb3dzZXJPcHRpb259fVwiXG4gICAgdGVsbCB3aW5kb3cgMVxuICAgICAgZGVsZXRlIHRhYiAke3RhYkluZGV4fVxuICAgIGVuZCB0ZWxsXG4gIGVuZCB0ZWxsYCk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzZXRBY3RpdmVUYWIodGFiOiBUYWIpOiBQcm9taXNlPHZvaWQ+IHtcbiAgY29uc3QgeyBicm93c2VyT3B0aW9uIH0gPSBnZXRQcmVmZXJlbmNlVmFsdWVzPFByZWZlcmVuY2VzPigpO1xuICBhd2FpdCBydW5BcHBsZVNjcmlwdChgXG4gICAgdGVsbCBhcHBsaWNhdGlvbiBcIiR7YnJvd3Nlck9wdGlvbn1cIlxuICAgICAgYWN0aXZhdGVcbiAgICAgIHNldCBpbmRleCBvZiB3aW5kb3cgKCR7dGFiLndpbmRvd3NJbmRleH0gYXMgbnVtYmVyKSB0byAoJHt0YWIud2luZG93c0luZGV4fSBhcyBudW1iZXIpXG4gICAgICBzZXQgYWN0aXZlIHRhYiBpbmRleCBvZiB3aW5kb3cgKCR7dGFiLndpbmRvd3NJbmRleH0gYXMgbnVtYmVyKSB0byAoJHt0YWIudGFiSW5kZXh9IGFzIG51bWJlcilcbiAgICBlbmQgdGVsbFxuICAgIHJldHVybiB0cnVlXG4gIGApO1xufVxuXG5jb25zdCBjaGVja0FwcEluc3RhbGxlZCA9IGFzeW5jICgpOiBQcm9taXNlPGJvb2xlYW4+ID0+IHtcbiAgY29uc3QgeyBicm93c2VyT3B0aW9uIH0gPSBnZXRQcmVmZXJlbmNlVmFsdWVzPFByZWZlcmVuY2VzPigpO1xuXG4gIGNvbnN0IGFwcEluc3RhbGxlZCA9IGF3YWl0IHJ1bkFwcGxlU2NyaXB0KGBcbnNldCBpc0luc3RhbGxlZCB0byBmYWxzZVxudHJ5XG4gICAgZG8gc2hlbGwgc2NyaXB0IFwib3Nhc2NyaXB0IC1lICdleGlzdHMgYXBwbGljYXRpb24gXFxcXFwiJHticm93c2VyT3B0aW9ufVxcXFxcIidcIlxuICAgIHNldCBpc0luc3RhbGxlZCB0byB0cnVlXG5lbmQgdHJ5XG5cbnJldHVybiBpc0luc3RhbGxlZGApO1xuICBpZiAoYXBwSW5zdGFsbGVkID09PSBcImZhbHNlXCIpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoTk9UX0lOU1RBTExFRF9NRVNTQUdFKTtcbiAgfVxuICByZXR1cm4gdHJ1ZTtcbn07XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBleGVjdXRlSmF2YXNjcmlwdChjb2RlOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgY29uc3QgeyBicm93c2VyT3B0aW9uIH0gPSBnZXRQcmVmZXJlbmNlVmFsdWVzPFByZWZlcmVuY2VzPigpO1xuXG4gIHRyeSB7XG4gICAgY29uc3QgZGVjb2RlZENvZGUgPSBkZWNvZGVVUklDb21wb25lbnQoY29kZSk7XG5cbiAgICAvLyBXZSBtYW51YWxseSBlc2NhcGUgdGhlIGNoYXJhY3RlcnMgdGhhdCBicmVhayBBcHBsZVNjcmlwdCBzdHJpbmdzLlxuICAgIC8vIFRoaXMgaXMgc2FmZXIgdGhhbiBKU09OLnN0cmluZ2lmeSBiZWNhdXNlIHdlIGNvbnRyb2wgdGhlIGV4YWN0IG91dHB1dCBmb3JtYXQuXG4gICAgY29uc3QgZXNjYXBlZENvZGUgPSBkZWNvZGVkQ29kZVxuICAgICAgLnJlcGxhY2UoL1xcXFwvZywgXCJcXFxcXFxcXFwiKSAvLyBFc2NhcGUgYmFja3NsYXNoZXMgZmlyc3QhXG4gICAgICAucmVwbGFjZSgvXCIvZywgJ1xcXFxcIicpIC8vIEVzY2FwZSBkb3VibGUgcXVvdGVzXG4gICAgICAucmVwbGFjZSgvXFxyL2csIFwiXFxcXHJcIikgLy8gRXNjYXBlIENhcnJpYWdlIFJldHVyblxuICAgICAgLnJlcGxhY2UoL1xcbi9nLCBcIlxcXFxuXCIpIC8vIEVzY2FwZSBOZXcgTGluZVxuICAgICAgLnJlcGxhY2UoL1xcdC9nLCBcIlxcXFx0XCIpIC8vIEVzY2FwZSBUYWJcbiAgICAgIC5yZXBsYWNlKC9bXFxiXS9nLCBcIlxcXFxiXCIpIC8vIEVzY2FwZSBCYWNrc3BhY2VcbiAgICAgIC5yZXBsYWNlKC9cXGYvZywgXCJcXFxcZlwiKTsgLy8gRXNjYXBlIEZvcm0gRmVlZFxuXG4gICAgY29uc3Qgc2NyaXB0ID0gYFxuICAgICAgdGVsbCBhcHBsaWNhdGlvbiBcIiR7YnJvd3Nlck9wdGlvbn1cIlxuICAgICAgICBhY3RpdmF0ZVxuICAgICAgICB0ZWxsIGFjdGl2ZSB0YWIgb2YgZnJvbnQgd2luZG93XG4gICAgICAgICAgZXhlY3V0ZSBqYXZhc2NyaXB0IFwiJHtlc2NhcGVkQ29kZX1cIlxuICAgICAgICBlbmQgdGVsbFxuICAgICAgZW5kIHRlbGxcbiAgICBgO1xuICAgIGF3YWl0IHJ1bkFwcGxlU2NyaXB0KHNjcmlwdCk7XG4gICAgYXdhaXQgY2xvc2VNYWluV2luZG93KCk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBjb25zb2xlLmVycm9yKGUpO1xuICAgIGlmIChlIGluc3RhbmNlb2YgRXJyb3IgJiYgZS5tZXNzYWdlLmluY2x1ZGVzKFwiQWxsb3cgSmF2YVNjcmlwdCBmcm9tIEFwcGxlIEV2ZW50c1wiKSkge1xuICAgICAgYXdhaXQgc2hvd0ZhaWx1cmVUb2FzdChcIkVuYWJsZSAnVmlldyA+IERldmVsb3BlciA+IEFsbG93IEphdmFTY3JpcHQgZnJvbSBBcHBsZSBFdmVudHMnIGluIEJyYXZlLlwiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgYXdhaXQgc2hvd0ZhaWx1cmVUb2FzdChcIkNvdWxkIG5vdCBydW4gYm9va21hcmtsZXRcIiwge1xuICAgICAgICBtZXNzYWdlOiBlIGluc3RhbmNlb2YgRXJyb3IgPyBlLm1lc3NhZ2UgOiBTdHJpbmcoZSksXG4gICAgICB9KTtcbiAgICB9XG4gIH1cbn1cbiIsICJpbXBvcnQgeyBCb29rbWFya0ZvbGRlciwgSGlzdG9yeUVudHJ5LCBUYWIgfSBmcm9tIFwiLi4vaW50ZXJmYWNlc1wiO1xuaW1wb3J0IHsgUmVhY3RFbGVtZW50IH0gZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgeyBnZXRGYXZpY29uIH0gZnJvbSBcIkByYXljYXN0L3V0aWxzXCI7XG5pbXBvcnQgeyBJY29uLCBMaXN0IH0gZnJvbSBcIkByYXljYXN0L2FwaVwiO1xuaW1wb3J0IHsgQnJhdmVBY3Rpb25zIH0gZnJvbSBcIi5cIjtcblxuZXhwb3J0IGNsYXNzIEJyYXZlTGlzdEl0ZW1zIHtcbiAgcHVibGljIHN0YXRpYyBUYWJMaXN0ID0gVGFiTGlzdEl0ZW07XG4gIHB1YmxpYyBzdGF0aWMgVGFiSGlzdG9yeSA9IEhpc3RvcnlJdGVtO1xuICBwdWJsaWMgc3RhdGljIEJvb2ttYXJrRm9sZGVyID0gQm9va21hcmtGb2xkZXJJdGVtO1xufVxuXG5mdW5jdGlvbiBpc1ZhbGlkSHR0cFVybCh1cmw6IHN0cmluZyk6IGJvb2xlYW4ge1xuICB0cnkge1xuICAgIGNvbnN0IHBhcnNlZCA9IG5ldyBVUkwodXJsKTtcbiAgICByZXR1cm4gcGFyc2VkLnByb3RvY29sID09PSBcImh0dHA6XCIgfHwgcGFyc2VkLnByb3RvY29sID09PSBcImh0dHBzOlwiO1xuICB9IGNhdGNoIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbn1cblxuZnVuY3Rpb24gZ2V0VXJsS2V5d29yZHModXJsOiBzdHJpbmcpOiBzdHJpbmdbXSB7XG4gIHRyeSB7XG4gICAgY29uc3QgcGFyc2VkID0gbmV3IFVSTCh1cmwpO1xuICAgIC8vIEluY2x1ZGUgaG9zdG5hbWUgcGFydHMgYW5kIHBhdGhuYW1lIHBhcnRzIGFzIGtleXdvcmRzXG4gICAgY29uc3QgaG9zdFBhcnRzID0gcGFyc2VkLmhvc3RuYW1lLnJlcGxhY2UoXCJ3d3cuXCIsIFwiXCIpLnNwbGl0KFwiLlwiKTtcbiAgICBjb25zdCBwYXRoUGFydHMgPSBwYXJzZWQucGF0aG5hbWUuc3BsaXQoXCIvXCIpLmZpbHRlcigocCkgPT4gcC5sZW5ndGggPiAwKTtcbiAgICByZXR1cm4gWy4uLmhvc3RQYXJ0cywgLi4ucGF0aFBhcnRzLCBwYXJzZWQuaG9zdG5hbWUsIHVybF07XG4gIH0gY2F0Y2gge1xuICAgIHJldHVybiBbdXJsXTtcbiAgfVxufVxuZnVuY3Rpb24gQm9va21hcmtGb2xkZXJJdGVtKHtcbiAgcHJvZmlsZSxcbiAgZW50cnk6IHsgbmFtZSwgY2hpbGRyZW4sIGlkIH0sXG59OiB7XG4gIGVudHJ5OiBCb29rbWFya0ZvbGRlcjtcbiAgcHJvZmlsZTogc3RyaW5nO1xufSk6IFJlYWN0RWxlbWVudCB7XG4gIGNvbnN0IHVybHMgPSBjaGlsZHJlbi5maWx0ZXIoKGMpID0+IGMudHlwZSA9PT0gXCJ1cmxcIikubWFwKChjKSA9PiBjLnVybCk7XG4gIHJldHVybiAoXG4gICAgPExpc3QuSXRlbVxuICAgICAgaWQ9e2Ake3Byb2ZpbGV9LSR7aWR9YH1cbiAgICAgIHRpdGxlPXtuYW1lfVxuICAgICAgc3VidGl0bGU9e2Ake3VybHMubGVuZ3RofSBib29rbWFya3NgfVxuICAgICAgaWNvbj17SWNvbi5Gb2xkZXJ9XG4gICAgICBhY3Rpb25zPXs8QnJhdmVBY3Rpb25zLk9wZW5BbGxCb29rbWFya3NJbkZvbGRlciB1cmxzPXt1cmxzIGFzIHN0cmluZ1tdfSBwcm9maWxlPXtwcm9maWxlfSAvPn1cbiAgICAvPlxuICApO1xufVxuXG5mdW5jdGlvbiBIaXN0b3J5SXRlbSh7IHByb2ZpbGUsIGVudHJ5OiB7IHVybCwgdGl0bGUsIGlkIH0gfTogeyBlbnRyeTogSGlzdG9yeUVudHJ5OyBwcm9maWxlOiBzdHJpbmcgfSk6IFJlYWN0RWxlbWVudCB7XG4gIHJldHVybiAoXG4gICAgPExpc3QuSXRlbVxuICAgICAgaWQ9e2Ake3Byb2ZpbGV9LSR7aWR9YH1cbiAgICAgIHRpdGxlPXt0aXRsZX1cbiAgICAgIHN1YnRpdGxlPXt1cmx9XG4gICAgICBrZXl3b3Jkcz17Z2V0VXJsS2V5d29yZHModXJsKX1cbiAgICAgIGljb249e2lzVmFsaWRIdHRwVXJsKHVybCkgPyBnZXRGYXZpY29uKHVybCkgOiBJY29uLkdsb2JlfVxuICAgICAgYWN0aW9ucz17PEJyYXZlQWN0aW9ucy5UYWJIaXN0b3J5IHRpdGxlPXt0aXRsZX0gdXJsPXt1cmx9IHByb2ZpbGU9e3Byb2ZpbGV9IC8+fVxuICAgIC8+XG4gICk7XG59XG5cbmZ1bmN0aW9uIFRhYkxpc3RJdGVtKHByb3BzOiB7IHRhYjogVGFiOyB1c2VPcmlnaW5hbEZhdmljb246IGJvb2xlYW4gfSkge1xuICByZXR1cm4gKFxuICAgIDxMaXN0Lkl0ZW1cbiAgICAgIHRpdGxlPXtwcm9wcy50YWIudGl0bGV9XG4gICAgICBzdWJ0aXRsZT17cHJvcHMudGFiLnVybFdpdGhvdXRTY2hlbWUoKX1cbiAgICAgIGtleXdvcmRzPXtnZXRVcmxLZXl3b3Jkcyhwcm9wcy50YWIudXJsKX1cbiAgICAgIGFjdGlvbnM9ezxCcmF2ZUFjdGlvbnMuVGFiTGlzdCB0YWI9e3Byb3BzLnRhYn0gLz59XG4gICAgICBpY29uPXtwcm9wcy51c2VPcmlnaW5hbEZhdmljb24gPyBwcm9wcy50YWIuZmF2aWNvbiA6IHByb3BzLnRhYi5nb29nbGVGYXZpY29uKCl9XG4gICAgLz5cbiAgKTtcbn1cbiIsICJpbXBvcnQgeyBMaXN0IH0gZnJvbSBcIkByYXljYXN0L2FwaVwiO1xuaW1wb3J0IHsgdXNlRWZmZWN0IH0gZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgeyB1c2VDYWNoZWRQcm9taXNlLCB1c2VDYWNoZWRTdGF0ZSB9IGZyb20gXCJAcmF5Y2FzdC91dGlsc1wiO1xuaW1wb3J0IHsgZXhpc3RzU3luYywgcHJvbWlzZXMgfSBmcm9tIFwiZnNcIjtcbmltcG9ydCB7IGdldExvY2FsU3RhdGVQYXRoIH0gZnJvbSBcIi4uL3V0aWxcIjtcbmltcG9ydCB7IEJyYXZlUHJvZmlsZSB9IGZyb20gXCIuLi9pbnRlcmZhY2VzXCI7XG5pbXBvcnQgeyBERUZBVUxUX0JSQVZFX1BST0ZJTEVfSUQsIEJSQVZFX1BST0ZJTEVfS0VZLCBCUkFWRV9QUk9GSUxFU19LRVkgfSBmcm9tIFwiLi4vY29uc3RhbnRzXCI7XG5cbmludGVyZmFjZSBQcm9wcyB7XG4gIG9uUHJvZmlsZVNlbGVjdGVkPzogKHByb2ZpbGU6IHN0cmluZykgPT4gdm9pZDtcbn1cblxuYXN5bmMgZnVuY3Rpb24gbG9hZEJyYXZlUHJvZmlsZXMoKTogUHJvbWlzZTxCcmF2ZVByb2ZpbGVbXT4ge1xuICBjb25zdCBwYXRoID0gZ2V0TG9jYWxTdGF0ZVBhdGgoKTtcbiAgaWYgKCFleGlzdHNTeW5jKHBhdGgpKSB7XG4gICAgcmV0dXJuIFt7IG5hbWU6IFwiRGVmYXVsdFwiLCBpZDogXCJEZWZhdWx0XCIgfV07XG4gIH1cblxuICBjb25zdCBicmF2ZVN0YXRlID0gYXdhaXQgcHJvbWlzZXMucmVhZEZpbGUocGF0aCwgXCJ1dGYtOFwiKTtcbiAgY29uc3QgcHJvZmlsZXMgPSBKU09OLnBhcnNlKGJyYXZlU3RhdGUpLnByb2ZpbGUuaW5mb19jYWNoZTtcbiAgcmV0dXJuIE9iamVjdC5lbnRyaWVzPHsgbmFtZTogc3RyaW5nIH0+KHByb2ZpbGVzKS5tYXAoKFtrZXksIHZhbF0pID0+ICh7XG4gICAgbmFtZTogdmFsLm5hbWUsXG4gICAgaWQ6IGtleSxcbiAgfSkpO1xufVxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBCcmF2ZVByb2ZpbGVEcm9wRG93bih7IG9uUHJvZmlsZVNlbGVjdGVkIH06IFByb3BzKSB7XG4gIGNvbnN0IFtzZWxlY3RlZFByb2ZpbGUsIHNldFNlbGVjdGVkUHJvZmlsZV0gPSB1c2VDYWNoZWRTdGF0ZTxzdHJpbmc+KEJSQVZFX1BST0ZJTEVfS0VZLCBERUZBVUxUX0JSQVZFX1BST0ZJTEVfSUQpO1xuICBjb25zdCBbcHJvZmlsZXMsIHNldFByb2ZpbGVzXSA9IHVzZUNhY2hlZFN0YXRlPEJyYXZlUHJvZmlsZVtdPihCUkFWRV9QUk9GSUxFU19LRVksIFtcbiAgICB7IG5hbWU6IFwiRGVmYXVsdFwiLCBpZDogREVGQVVMVF9CUkFWRV9QUk9GSUxFX0lEIH0sXG4gIF0pO1xuICBjb25zdCB7IGRhdGE6IGxvYWRlZFByb2ZpbGVzIH0gPSB1c2VDYWNoZWRQcm9taXNlKGxvYWRCcmF2ZVByb2ZpbGVzKTtcblxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmIChsb2FkZWRQcm9maWxlcykge1xuICAgICAgc2V0UHJvZmlsZXMobG9hZGVkUHJvZmlsZXMpO1xuICAgICAgaWYgKCFzZWxlY3RlZFByb2ZpbGUpIHtcbiAgICAgICAgc2V0U2VsZWN0ZWRQcm9maWxlKHByb2ZpbGVzWzBdLmlkKTtcbiAgICAgIH1cbiAgICB9XG4gIH0sIFtsb2FkZWRQcm9maWxlc10pO1xuXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgaWYgKHNlbGVjdGVkUHJvZmlsZSkge1xuICAgICAgb25Qcm9maWxlU2VsZWN0ZWQ/LihzZWxlY3RlZFByb2ZpbGUpO1xuICAgIH1cbiAgfSwgW3NlbGVjdGVkUHJvZmlsZV0pO1xuXG4gIGlmICghcHJvZmlsZXMgfHwgcHJvZmlsZXMubGVuZ3RoIDwgMikge1xuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgcmV0dXJuIChcbiAgICA8TGlzdC5Ecm9wZG93biB0b29sdGlwPVwiU2VsZWN0IEJyYXZlIFByb2ZpbGVcIiB2YWx1ZT17c2VsZWN0ZWRQcm9maWxlfSBvbkNoYW5nZT17c2V0U2VsZWN0ZWRQcm9maWxlfT5cbiAgICAgIHtwcm9maWxlcy5tYXAoKHByb2ZpbGUpID0+IChcbiAgICAgICAgPExpc3QuRHJvcGRvd24uSXRlbSBrZXk9e3Byb2ZpbGUuaWR9IHZhbHVlPXtwcm9maWxlLmlkfSB0aXRsZT17cHJvZmlsZS5uYW1lfSAvPlxuICAgICAgKSl9XG4gICAgPC9MaXN0LkRyb3Bkb3duPlxuICApO1xufVxuIl0sCiAgIm1hcHBpbmdzIjogIjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLElBQUFBLGNBQXFCO0FBQ3JCLElBQUFDLGdCQUFrRDs7O0FDRGxELGdCQUEyQjs7O0FDQTNCLGtCQUFpQjs7O0FDQVYsSUFBTSwwQkFBMEIsQ0FBQyx1QkFBdUIsaUJBQWlCLGVBQWU7QUFDeEYsSUFBTSw4QkFBOEIsQ0FBQyx1QkFBdUIsaUJBQWlCLG9CQUFvQjtBQUNqRyxJQUFNLGlDQUFpQyxDQUFDLHVCQUF1QixpQkFBaUIsdUJBQXVCO0FBQ3ZHLElBQU0sd0JBQXdCLENBQUMsdUJBQXVCLGlCQUFpQixpQkFBaUIsYUFBYTtBQUNyRyxJQUFNLDJCQUEyQjtBQUNqQyxJQUFNLG9CQUFvQjtBQUMxQixJQUFNLHFCQUFxQjtBQXVCM0IsSUFBTSx3QkFBd0I7OztBRHJCckMsaUJBQW9DO0FBRXBDLElBQU0sRUFBRSxjQUFjLFFBQUksZ0NBQWlDO0FBRTNELElBQUk7QUFFSixRQUFRLGVBQWU7QUFBQSxFQUNyQixLQUFLO0FBQ0gsa0JBQWM7QUFDZDtBQUFBLEVBQ0YsS0FBSztBQUNILGtCQUFjO0FBQ2Q7QUFBQSxFQUNGO0FBQ0Usa0JBQWM7QUFDbEI7QUFFQSxJQUFNLDJCQUEyQixNQUFNO0FBQ3JDLE1BQUksQ0FBQyxRQUFRLElBQUksTUFBTTtBQUNyQixVQUFNLElBQUksTUFBTSx3Q0FBd0M7QUFBQSxFQUMxRDtBQUVBLFNBQU8sWUFBQUMsUUFBSyxLQUFLLFFBQVEsSUFBSSxNQUFNLFNBQVM7QUFDOUM7QUFFTyxJQUFNLG1CQUFtQixDQUFDLFlBQy9CLFlBQUFBLFFBQUssS0FBSyx5QkFBeUIsR0FBRyxHQUFHLGFBQWEsV0FBVywwQkFBMEIsU0FBUztBQUUvRixJQUFNLG9CQUFvQixNQUFNLFlBQUFBLFFBQUssS0FBSyx5QkFBeUIsR0FBRyxHQUFHLHFCQUFxQjs7O0FEakNyRyxJQUFBQyxnQkFBb0M7QTs7Ozs7O0FHSHBDLElBQUksTUFBTSxPQUFPLFVBQVU7QUFFcEIsU0FBUyxPQUFPLEtBQUssS0FBSztBQUNoQyxNQUFJLE1BQU07QUFDVixNQUFJLFFBQVEsSUFBSyxRQUFPO0FBRXhCLE1BQUksT0FBTyxRQUFRLE9BQUssSUFBSSxpQkFBaUIsSUFBSSxhQUFhO0FBQzdELFFBQUksU0FBUyxLQUFNLFFBQU8sSUFBSSxRQUFRLE1BQU0sSUFBSSxRQUFRO0FBQ3hELFFBQUksU0FBUyxPQUFRLFFBQU8sSUFBSSxTQUFTLE1BQU0sSUFBSSxTQUFTO0FBRTVELFFBQUksU0FBUyxPQUFPO0FBQ25CLFdBQUssTUFBSSxJQUFJLFlBQVksSUFBSSxRQUFRO0FBQ3BDLGVBQU8sU0FBUyxPQUFPLElBQUksR0FBRyxHQUFHLElBQUksR0FBRyxDQUFDLEVBQUU7QUFBQSxNQUM1QztBQUNBLGFBQU8sUUFBUTtBQUFBLElBQ2hCO0FBRUEsUUFBSSxDQUFDLFFBQVEsT0FBTyxRQUFRLFVBQVU7QUFDckMsWUFBTTtBQUNOLFdBQUssUUFBUSxLQUFLO0FBQ2pCLFlBQUksSUFBSSxLQUFLLEtBQUssSUFBSSxLQUFLLEVBQUUsT0FBTyxDQUFDLElBQUksS0FBSyxLQUFLLElBQUksRUFBRyxRQUFPO0FBQ2pFLFlBQUksRUFBRSxRQUFRLFFBQVEsQ0FBQyxPQUFPLElBQUksSUFBSSxHQUFHLElBQUksSUFBSSxDQUFDLEVBQUcsUUFBTztBQUFBLE1BQzdEO0FBQ0EsYUFBTyxPQUFPLEtBQUssR0FBRyxFQUFFLFdBQVc7QUFBQSxJQUNwQztBQUFBLEVBQ0Q7QUFFQSxTQUFPLFFBQVEsT0FBTyxRQUFRO0FBQy9CO0E7Ozs7Ozs7Ozs7Ozs7O0FHckJPLFNBQVMsMENBQWUsT0FBUTtBQUNyQyxRQUFNLE9BQU0sR0FBQSxhQUFBQyxRQUFVLEtBQUE7QUFDdEIsUUFBTSxhQUFZLEdBQUEsYUFBQUEsUUFBZSxDQUFBO0FBRWpDLE1BQUksRUFBQyxHQUFBLFFBQU8sT0FBTyxJQUFJLE9BQU8sR0FBRztBQUMvQixRQUFJLFVBQVU7QUFDZCxjQUFVLFdBQVc7RUFDdkI7QUFHQSxVQUFPLEdBQUEsYUFBQUMsU0FBUSxNQUFNLElBQUksU0FBUztJQUFDLFVBQVU7R0FBUTtBQUN2RDtBQ1hPLFNBQVMsMENBQWEsT0FBUTtBQUNuQyxRQUFNLE9BQU0sR0FBQSxhQUFBRCxRQUFPLEtBQUE7QUFDbkIsTUFBSSxVQUFVO0FBQ2QsU0FBTztBQUNUO0FDa0JPLFNBQVMsMENBQ2QsT0FDQSxTQUE2RTtBQUU3RSxRQUFNLFVBQVUsaUJBQWlCLFFBQVEsTUFBTSxVQUFVLE9BQU8sS0FBQTtBQUNoRSxVQUFPLEdBQUEsWUFBQUUsV0FBVTtJQUNmLFFBQU8sR0FBQSxZQUFBQyxPQUFNLE1BQU07SUFDbkIsT0FBTyxTQUFTLFNBQVM7SUFDekIsU0FBUyxTQUFTLFdBQVc7SUFDN0IsZUFBZSxTQUFTLGlCQUFpQiw2Q0FBdUIsS0FBQTtJQUNoRSxpQkFBaUIsU0FBUyxnQkFBZ0IsNkNBQXVCLEtBQUEsSUFBUztFQUM1RSxDQUFBO0FBQ0Y7QUFFQSxJQUFNLCtDQUF5QixDQUFDLFVBQUE7QUFDOUIsTUFBSSxtQkFBbUI7QUFDdkIsTUFBSSxRQUFRO0FBQ1osTUFBSSxlQUFlO0FBQ25CLE1BQUk7QUFDRixVQUFNLGNBQWMsS0FBSyxVQUFNLGVBQUFDLGtCQUFnQixpQkFBQUMsT0FBVSxHQUFBLFlBQUFDLGFBQVksWUFBWSxNQUFNLGNBQUEsR0FBaUIsTUFBQSxDQUFBO0FBQ3hHLFlBQVEsSUFBSSxZQUFZLEtBQUs7QUFDN0IsbUJBQWUsdUJBQXVCLFlBQVksU0FBUyxZQUFZLE1BQU0sSUFBSSxZQUFZLElBQUk7QUFDakcsUUFBSSxDQUFDLFlBQVksU0FBUyxZQUFZLFdBQVcsU0FDL0Msb0JBQW1CO0VBRXZCLFNBQVMsS0FBSztFQUVkO0FBSUEsUUFBTSxZQUFXLEdBQUEsWUFBQUEsYUFBWSxpQkFBaUI7QUFFOUMsUUFBTSxRQUFRLGlCQUFpQixRQUFRLE9BQU8sU0FBUyxPQUFPLFdBQVcsS0FBSyxPQUFPLEtBQUE7QUFFckYsU0FBTztJQUNMLE9BQU8sV0FBVyxjQUFjO0lBQ2hDLFNBQVMsT0FBSztBQUNaLFlBQU0sS0FBSTtBQUNWLFVBQUksU0FDRixFQUFBLEdBQUEsWUFBQUMsV0FBVSxLQUFLLEtBQUE7VUFFZixFQUFBLEdBQUEsWUFBQUMsTUFDRSxvSEFBb0gsbUJBQ2xILEtBQUEsQ0FBQSxrQkFDaUIsVUFBVSxZQUFBLENBQUEsZ0JBQTZCLG1CQUN4RDs7RUFFVixLQUFBOztDQUVELENBQUEsRUFDWTtJQUdUO0VBQ0Y7QUFDRjtBSHdETyxTQUFTLDBDQUNkLElBQ0EsTUFDQSxTQUEyQjtBQUUzQixRQUFNLGNBQWEsR0FBQSxhQUFBUixRQUFPLENBQUE7QUFDMUIsUUFBTSxDQUFDLE9BQU8sR0FBQSxLQUFPLEdBQUEsYUFBQVMsVUFBc0M7SUFBRSxXQUFXO0VBQUssQ0FBQTtBQUU3RSxRQUFNLFNBQVEsR0FBQSwyQ0FBVSxFQUFBO0FBQ3hCLFFBQU0sbUJBQWtCLEdBQUEsMkNBQVUsU0FBUyxTQUFBO0FBQzNDLFFBQU0sY0FBYSxHQUFBLDJDQUFVLFFBQVEsQ0FBQSxDQUFFO0FBQ3ZDLFFBQU0saUJBQWdCLEdBQUEsMkNBQVUsU0FBUyxPQUFBO0FBQ3pDLFFBQU0sZ0JBQWUsR0FBQSwyQ0FBVSxTQUFTLE1BQUE7QUFDeEMsUUFBTSx1QkFBc0IsR0FBQSwyQ0FBVSxTQUFTLGFBQUE7QUFDL0MsUUFBTSxzQkFBcUIsR0FBQSwyQ0FBVSxTQUFTLG1CQUFBO0FBQzlDLFFBQU0sZUFBYyxHQUFBLDJDQUFVLE1BQU0sSUFBSTtBQUN4QyxRQUFNLGtCQUFpQixHQUFBLGFBQUFULFFBQTZELElBQUE7QUFFcEYsUUFBTSxxQkFBb0IsR0FBQSxhQUFBQSxRQUEwQjtJQUFFLE1BQU07RUFBRSxDQUFBO0FBQzlELFFBQU0sb0JBQW1CLEdBQUEsYUFBQUEsUUFBTyxLQUFBO0FBQ2hDLFFBQU0sY0FBYSxHQUFBLGFBQUFBLFFBQU8sSUFBQTtBQUMxQixRQUFNLGVBQWMsR0FBQSxhQUFBQSxRQUFPLEVBQUE7QUFFM0IsUUFBTSxTQUFRLEdBQUEsYUFBQVUsYUFBWSxNQUFBO0FBQ3hCLFFBQUksZ0JBQWdCLFNBQVM7QUFDM0Isc0JBQWdCLFFBQVEsU0FBUyxNQUFBO0FBQ2pDLHNCQUFnQixRQUFRLFVBQVUsSUFBSSxnQkFBQTtJQUN4QztBQUNBLFdBQU8sRUFBRSxXQUFXO0VBQ3RCLEdBQUc7SUFBQztHQUFnQjtBQUVwQixRQUFNLFlBQVcsR0FBQSxhQUFBQSxhQUNmLElBQUlDLFVBQUE7QUFDRixVQUFNLFNBQVMsTUFBQTtBQUVmLHdCQUFvQixVQUFVQSxLQUFBO0FBRTlCLFFBQUksQ0FBQyxlQUFlO01BQUUsR0FBRztNQUFXLFdBQVc7SUFBSyxFQUFBO0FBRXBELFVBQU0sNEJBQTRCLDBDQUFvQixNQUFNLE9BQU8sRUFBQSxHQUFLQSxLQUFBO0FBRXhFLGFBQVMsWUFBWSxPQUFVO0FBQzdCLFVBQUksTUFBTSxRQUFRLGFBQ2hCLFFBQU87QUFHVCxVQUFJLFdBQVcsV0FBVyxTQUFTO0FBRWpDLFlBQUksY0FBYyxRQUNoQixlQUFjLFFBQVEsS0FBQTtrQkFFbEIsR0FBQSxZQUFBTCxhQUFZLGdCQUFlLEdBQUEsWUFBQU0sWUFBVyxXQUN4QyxFQUFBLEdBQUEsMkNBQWlCLE9BQU87VUFDdEIsT0FBTztVQUNQLGVBQWU7WUFDYixPQUFPO1lBQ1AsU0FBUyxPQUFLO0FBQ1osb0JBQU0sS0FBSTtBQUNWLDZCQUFlLFVBQU8sR0FBUSxXQUFXLFdBQVcsQ0FBQSxDQUFFO1lBQ3hEO1VBQ0Y7VUFDQSxHQUFHLG1CQUFtQjtRQUN4QixDQUFBO0FBR0osWUFBSTs7VUFBUyxXQUFXO1FBQU0sQ0FBQTtNQUNoQztBQUVBLGFBQU87SUFDVDtBQUVBLFFBQUksT0FBTyw4QkFBOEIsWUFBWTtBQUNuRCx1QkFBaUIsVUFBVTtBQUMzQixhQUFPLDBCQUEwQixrQkFBa0IsT0FBTyxFQUFFOztRQUUxRCxDQUFDLEVBQUEsTUFBTSxTQUFTLE9BQVEsTUFBNkQ7QUFDbkYsY0FBSSxXQUFXLFdBQVcsU0FBUztBQUNqQyxnQkFBSSxrQkFBa0IsU0FBUztBQUM3QixnQ0FBa0IsUUFBUSxTQUFTO0FBQ25DLGdDQUFrQixRQUFRLFdBQVcsT0FBTyxLQUFLLFNBQVMsQ0FBQTtZQUM1RDtBQUVBLGdCQUFJLGFBQWEsUUFDZixjQUFhLFFBQVEsTUFBTSxrQkFBa0IsT0FBTztBQUd0RCxnQkFBSSxRQUNGLGFBQVksVUFBVSxLQUFLO0FBRTdCLHVCQUFXLFVBQVU7QUFFckIsZ0JBQUksQ0FBQyxpQkFBQTtBQUNILGtCQUFJLGtCQUFrQixRQUFRLFNBQVMsRUFDckMsUUFBTzs7Z0JBQVEsV0FBVztjQUFNO0FBR2xDLHFCQUFPO2dCQUFFLE9BQU8sYUFBYSxRQUFRLENBQUEsSUFBSyxPQUFPLElBQUE7Z0JBQU8sV0FBVztjQUFNO1lBQzNFLENBQUE7VUFDRjtBQUVBLGlCQUFPO1FBQ1Q7UUFDQSxDQUFDLFVBQUE7QUFDQyxxQkFBVyxVQUFVO0FBQ3JCLGlCQUFPLFlBQVksS0FBQTtRQUNyQjtNQUFBO0lBRUo7QUFFQSxxQkFBaUIsVUFBVTtBQUMzQixXQUFPLDBCQUEwQixLQUFLLENBQUMsU0FBQTtBQUNyQyxVQUFJLFdBQVcsV0FBVyxTQUFTO0FBQ2pDLFlBQUksYUFBYSxRQUNmLGNBQWEsUUFBUSxJQUFBO0FBRXZCLFlBQUk7O1VBQVEsV0FBVztRQUFNLENBQUE7TUFDL0I7QUFFQSxhQUFPO0lBQ1QsR0FBRyxXQUFBO0VBQ0wsR0FDQTtJQUNFO0lBQ0E7SUFDQTtJQUNBO0lBQ0E7SUFDQTtJQUNBO0lBQ0E7SUFDQTtJQUNBO0dBQ0Q7QUFHSCxpQkFBZSxVQUFVO0FBRXpCLFFBQU0sY0FBYSxHQUFBLGFBQUFGLGFBQVksTUFBQTtBQUU3QixzQkFBa0IsVUFBVTtNQUFFLE1BQU07SUFBRTtBQUV0QyxVQUFNQyxRQUFRLFdBQVcsV0FBVyxDQUFBO0FBQ3BDLFdBQU8sU0FBQSxHQUFZQSxLQUFBO0VBQ3JCLEdBQUc7SUFBQztJQUFVO0dBQVc7QUFFekIsUUFBTSxVQUFTLEdBQUEsYUFBQUQsYUFDYixPQUFPLGFBQWFHLGFBQUE7QUFDbEIsUUFBSTtBQUNKLFFBQUk7QUFDRixVQUFJQSxVQUFTLGtCQUFrQjtBQUU3QixjQUFBO0FBRUEsWUFBSSxPQUFPQSxVQUFTLG9CQUFvQixjQUFjQSxVQUFTLG9CQUFvQjtBQUdqRix1Q0FBNkIsZ0JBQWdCLFlBQVksU0FBUyxLQUFBO0FBRXBFLGNBQU0sU0FBU0EsU0FBUTtBQUN2QixZQUFJLENBQUMsZUFBZTtVQUFFLEdBQUc7VUFBVyxNQUFNLE9BQU8sVUFBVSxJQUFJO1FBQUUsRUFBQTtNQUNuRTtBQUNBLGFBQU8sTUFBTTtJQUNmLFNBQVMsS0FBSztBQUNaLFVBQUksT0FBT0EsVUFBUyxvQkFBb0IsWUFBWTtBQUNsRCxjQUFNLFNBQVNBLFNBQVE7QUFDdkIsWUFBSSxDQUFDLGVBQWU7VUFBRSxHQUFHO1VBQVcsTUFBTSxPQUFPLFVBQVUsSUFBSTtRQUFFLEVBQUE7TUFDbkUsV0FBV0EsVUFBUyxvQkFBb0JBLFVBQVMsb0JBQW9CLE1BQ25FLEtBQUksQ0FBQyxlQUFlO1FBQUUsR0FBRztRQUFXLE1BQU07TUFBMkIsRUFBQTtBQUV2RSxZQUFNO0lBQ1IsVUFBQTtBQUNFLFVBQUlBLFVBQVMsMEJBQTBCLE9BQUE7QUFDckMsYUFBSSxHQUFBLFlBQUFQLGFBQVksZ0JBQWUsR0FBQSxZQUFBTSxZQUFXLGVBQWMsR0FBQSxZQUFBTixhQUFZLGdCQUFnQjtBQUdsRixnQkFBTSxXQUFBO1lBRU4sWUFBQTs7SUFHTjtFQUNGLEdBQ0E7SUFBQztJQUFZO0lBQWE7SUFBSztHQUFNO0FBR3ZDLFFBQU0sY0FBYSxHQUFBLGFBQUFJLGFBQVksTUFBQTtBQUM3QixzQkFBa0IsUUFBUSxRQUFRO0FBQ2xDLFVBQU1DLFFBQVEsV0FBVyxXQUFXLENBQUE7QUFDcEMsYUFBQSxHQUFZQSxLQUFBO0VBQ2QsR0FBRztJQUFDO0lBQW1CO0lBQVk7R0FBUztBQUc1QyxHQUFBLEdBQUEsYUFBQUcsV0FBVSxNQUFBO0FBRVIsc0JBQWtCLFVBQVU7TUFBRSxNQUFNO0lBQUU7QUFFdEMsUUFBSSxTQUFTLFlBQVksTUFDdkIsVUFBQSxHQUFjLFFBQVEsQ0FBQSxDQUFFOztBQUd4QixZQUFBO0VBR0osR0FBRztLQUFDLEdBQUEsMkNBQVk7TUFBQztNQUFNLFNBQVM7TUFBUztLQUFTO0lBQUc7SUFBaUI7R0FBa0I7QUFHeEYsR0FBQSxHQUFBLGFBQUFBLFdBQVUsTUFBQTtBQUNSLFdBQU8sTUFBQTtBQUNMLFlBQUE7SUFDRjtFQUNGLEdBQUc7SUFBQztHQUFNO0FBR1YsUUFBTSxZQUFZLFNBQVMsWUFBWSxRQUFRLE1BQU0sWUFBWTtBQUdqRSxRQUFNLHdCQUE0RDtJQUFFLEdBQUc7O0VBQWlCO0FBRXhGLFFBQU0sYUFBYSxpQkFBaUIsVUFDaEM7SUFDRSxVQUFVLFlBQVk7SUFDdEIsU0FBUyxXQUFXOztFQUV0QixJQUNBO0FBRUosU0FBTztJQUFFLEdBQUc7Ozs7RUFBc0Q7QUFDcEU7QUFHQSxTQUFTLDBDQUF1QixJQUFLO0FBQ25DLE1BQUksT0FBUSxRQUFRO0FBRWxCLFdBQU8sR0FBRyxLQUFLLE9BQUE7QUFFakIsTUFBSSxPQUFRLFFBQVE7QUFFbEIsV0FBTyxHQUFHLEtBQUssT0FBQTtBQUVqQixNQUFJLE9BQVEsUUFBUTtBQUVsQixXQUFPLEdBQUcsS0FBSyxPQUFBO0FBRWpCLE1BQUksT0FBUSxRQUFRO0FBRWxCLFdBQU8sR0FBRyxLQUFLLE9BQUE7QUFFakIsU0FBTztBQUNUO0FNL1hBLFNBQVMsdUNBQWlCLEdBQU07QUFDOUIsTUFBSSxPQUFPLE1BQU0sV0FDZixRQUFPO0FBRVQsUUFBTSxNQUFNO0FBQ1osU0FBTyxJQUFJLEtBQUssU0FBUyxVQUFVLFNBQVMsS0FBSyxDQUFBLENBQUEsTUFBUTtBQUMzRDtBQUVBLFNBQVMsbUNBQWEsT0FBVTtBQUM5QixNQUFJLGlCQUFpQixnQkFDbkIsUUFBTyxNQUFNLFNBQVE7QUFFdkIsU0FBTztBQUNUO0FBRU8sU0FBUywwQ0FDZCxTQVFBLFVBQWlCLENBQUEsR0FBRTtBQUVuQixXQUFTLE1BQU0sS0FBVztBQUN4QixRQUFJLFlBQVksUUFDZCxRQUFPLFFBQVEsT0FBTyxLQUFLLE1BQUE7UUFFM0IsUUFBTyxRQUFRLE1BQU0sR0FBQTtFQUV6QjtBQUVBLFNBQU87SUFDTCxVQUFVLFNBQVUsT0FBVTtBQUM1QixjQUFRLG1DQUFhLEtBQUE7QUFFckIsWUFBTSxPQUFPLE9BQU87QUFDcEIsVUFBSSxVQUFVLEtBQ1osTUFBSyxPQUFBLEVBQVE7O0FBR2IsYUFBSyxNQUFNLElBQUEsRUFBTSxLQUFBO0lBRXJCO0lBQ0EsU0FBUyxTQUFVLFFBQVc7QUFDNUIsWUFBTSxVQUFVO0FBQ2hCLFlBQU0sWUFBWSxPQUFPLFVBQVUsU0FBUyxLQUFLLE1BQUE7QUFDakQsVUFBSSxVQUFVLFFBQVEsS0FBSyxTQUFBLElBQWEsQ0FBQSxLQUFNLGNBQWMsWUFBWTtBQUN4RSxnQkFBVSxRQUFRLFlBQVc7QUFFN0IsVUFBSSxlQUFlO0FBRW5CLFdBQUssZUFBZSxRQUFRLFFBQVEsTUFBQSxNQUFZLEdBQUc7QUFDakQsYUFBSyxTQUFTLGVBQWUsZUFBZSxHQUFBO0FBQzVDO01BQ0YsTUFDRSxTQUFRLEtBQUssTUFBQTtBQUdmLFVBQUksT0FBTyxTQUFTLE1BQUEsR0FBUztBQUMzQixjQUFNLFNBQUE7QUFDTixlQUFPLE1BQU0sT0FBTyxTQUFTLE1BQUEsQ0FBQTtNQUMvQjtBQUVBLFVBQUksWUFBWSxZQUFZLFlBQVksY0FBYyxZQUFZLGlCQUFpQjtBQUVqRixZQUFJLEtBQUssTUFBTSxPQUFBO0FBRWIsZUFBSyxNQUFNLE9BQUEsRUFBUyxNQUFBO1lBRXBCLE9BQU0sSUFBSSxNQUFNLDBCQUEwQixVQUFVLEdBQUE7TUFFeEQsT0FBTztBQUNMLFlBQUksT0FBTyxPQUFPLEtBQUssTUFBQTtBQUN2QixlQUFPLEtBQUssS0FBSTtBQVFoQixZQUFJLENBQUMsdUNBQWlCLE1BQUEsRUFDcEIsTUFBSyxPQUFPLEdBQUcsR0FBRyxhQUFhLGFBQWEsYUFBQTtBQUc5QyxjQUFNLFlBQVksS0FBSyxTQUFTLEdBQUE7QUFDaEMsY0FBTSxPQUFPO0FBQ2IsZUFBTyxLQUFLLFFBQVEsU0FBVSxLQUFHO0FBQy9CLGVBQUssU0FBUyxHQUFBO0FBQ2QsZ0JBQU0sR0FBQTtBQUNOLGVBQUssU0FBUyxPQUFPLEdBQUEsQ0FBSTtBQUN6QixnQkFBTSxHQUFBO1FBQ1IsQ0FBQTtNQUNGO0lBQ0Y7SUFDQSxRQUFRLFNBQVUsS0FBWSxXQUFrQjtBQUM5QyxrQkFBWSxPQUFPLGNBQWMsY0FBYyxZQUFZO0FBRTNELFlBQU0sT0FBTztBQUNiLFlBQU0sV0FBVyxJQUFJLFNBQVMsR0FBQTtBQUM5QixVQUFJLENBQUMsYUFBYSxJQUFJLFVBQVUsR0FBRztBQUNqQyxZQUFJLFFBQVEsU0FBVSxPQUFVO0FBQzlCLGVBQUssU0FBUyxLQUFBO1FBQ2hCLENBQUE7QUFDQTtNQUNGO0FBV0EsVUFBSSxtQkFBMEIsQ0FBQTtBQUM5QixZQUFNLFVBQVUsSUFBSSxJQUFJLFNBQVUsT0FBVTtBQUMxQyxjQUFNLE9BQU8sa0NBQUE7QUFDYixjQUFNLGVBQWUsUUFBUSxNQUFLO0FBQ2xDLGNBQU0sU0FBUywwQ0FBVyxNQUFNLFlBQUE7QUFDaEMsZUFBTyxTQUFTLEtBQUE7QUFFaEIsMkJBQW1CLGlCQUFpQixPQUFPLGFBQWEsTUFBTSxRQUFRLE1BQU0sQ0FBQTtBQUM1RSxlQUFPLEtBQUssS0FBSSxFQUFHLFNBQVE7TUFDN0IsQ0FBQTtBQUNBLGdCQUFVLFFBQVEsT0FBTyxnQkFBQTtBQUN6QixjQUFRLEtBQUk7QUFDWixXQUFLLE9BQU8sU0FBUyxLQUFBO0lBQ3ZCO0lBQ0EsT0FBTyxTQUFVLE1BQVU7QUFDekIsWUFBTSxVQUFVLEtBQUssT0FBTSxDQUFBO0lBQzdCO0lBQ0EsU0FBUyxTQUFVLEtBQVc7QUFDNUIsWUFBTSxZQUFZLElBQUksU0FBUSxDQUFBO0lBQ2hDO0lBQ0EsUUFBUSxTQUFVLEtBQVU7QUFDMUIsWUFBTSxXQUFXLElBQUksU0FBUSxDQUFBO0lBQy9CO0lBQ0EsVUFBVSxTQUFVLE1BQWE7QUFDL0IsWUFBTSxVQUFVLEtBQUssU0FBUSxDQUFBO0lBQy9CO0lBQ0EsU0FBUyxTQUFVLFFBQWM7QUFDL0IsWUFBTSxZQUFZLE9BQU8sU0FBUyxHQUFBO0FBQ2xDLFlBQU0sT0FBTyxTQUFRLENBQUE7SUFDdkI7SUFDQSxXQUFXLFNBQVUsSUFBTztBQUMxQixZQUFNLEtBQUE7QUFDTixVQUFJLHVDQUFpQixFQUFBLEVBQ25CLE1BQUssU0FBUyxVQUFBO1VBRWQsTUFBSyxTQUFTLEdBQUcsU0FBUSxDQUFBO0FBTTNCLFdBQUssU0FBUyxtQkFBbUIsT0FBTyxHQUFHLElBQUksQ0FBQTtBQUUvQyxXQUFLLFFBQVEsRUFBQTtJQUNmO0lBQ0EsU0FBUyxTQUFVLFFBQWM7QUFDL0IsWUFBTSxZQUFZLE9BQU8sU0FBUSxDQUFBO0lBQ25DO0lBQ0EsTUFBTSxTQUFVLEtBQVE7QUFDdEIsWUFBTSxTQUFTLElBQUksU0FBUSxDQUFBO0lBQzdCO0lBQ0EsT0FBTyxXQUFBO0FBQ0wsWUFBTSxNQUFBO0lBQ1I7SUFDQSxZQUFZLFdBQUE7QUFDVixZQUFNLFdBQUE7SUFDUjtJQUNBLFNBQVMsU0FBVSxPQUFhO0FBQzlCLFlBQU0sV0FBVyxNQUFNLFNBQVEsQ0FBQTtJQUNqQztJQUNBLGFBQWEsU0FBVSxLQUFlO0FBQ3BDLFlBQU0sYUFBQTtBQUNOLFdBQUssU0FBUyxNQUFNLFVBQVUsTUFBTSxLQUFLLEdBQUEsQ0FBQTtJQUMzQztJQUNBLG9CQUFvQixTQUFVLEtBQXNCO0FBQ2xELFlBQU0sb0JBQUE7QUFDTixXQUFLLFNBQVMsTUFBTSxVQUFVLE1BQU0sS0FBSyxHQUFBLENBQUE7SUFDM0M7SUFDQSxZQUFZLFNBQVUsS0FBYztBQUNsQyxZQUFNLFlBQUE7QUFDTixXQUFLLFNBQVMsTUFBTSxVQUFVLE1BQU0sS0FBSyxHQUFBLENBQUE7SUFDM0M7SUFDQSxjQUFjLFNBQVUsS0FBZ0I7QUFDdEMsWUFBTSxjQUFBO0FBQ04sV0FBSyxTQUFTLE1BQU0sVUFBVSxNQUFNLEtBQUssR0FBQSxDQUFBO0lBQzNDO0lBQ0EsYUFBYSxTQUFVLEtBQWU7QUFDcEMsWUFBTSxhQUFBO0FBQ04sV0FBSyxTQUFTLE1BQU0sVUFBVSxNQUFNLEtBQUssR0FBQSxDQUFBO0lBQzNDO0lBQ0EsY0FBYyxTQUFVLEtBQWdCO0FBQ3RDLFlBQU0sY0FBQTtBQUNOLFdBQUssU0FBUyxNQUFNLFVBQVUsTUFBTSxLQUFLLEdBQUEsQ0FBQTtJQUMzQztJQUNBLGFBQWEsU0FBVSxLQUFlO0FBQ3BDLFlBQU0sYUFBQTtBQUNOLFdBQUssU0FBUyxNQUFNLFVBQVUsTUFBTSxLQUFLLEdBQUEsQ0FBQTtJQUMzQztJQUNBLGVBQWUsU0FBVSxLQUFpQjtBQUN4QyxZQUFNLGVBQUE7QUFDTixXQUFLLFNBQVMsTUFBTSxVQUFVLE1BQU0sS0FBSyxHQUFBLENBQUE7SUFDM0M7SUFDQSxlQUFlLFNBQVUsS0FBaUI7QUFDeEMsWUFBTSxlQUFBO0FBQ04sV0FBSyxTQUFTLE1BQU0sVUFBVSxNQUFNLEtBQUssR0FBQSxDQUFBO0lBQzNDO0lBQ0EsY0FBYyxTQUFVLEtBQWdCO0FBQ3RDLFlBQU0sY0FBQTtBQUNOLFdBQUssU0FBUyxJQUFJLFdBQVcsR0FBQSxDQUFBO0lBQy9CO0lBQ0EsTUFBTSxTQUFVLEtBQVE7QUFDdEIsWUFBTSxTQUFTLElBQUksU0FBUSxDQUFBO0lBQzdCO0lBQ0EsTUFBTSxTQUFVLEtBQWtCO0FBQ2hDLFlBQU0sTUFBQTtBQUNOLFlBQU0sTUFBTSxNQUFNLEtBQUssR0FBQTtBQUN2QixXQUFLLE9BQU8sS0FBSyxJQUFBO0lBQ25CO0lBQ0EsTUFBTSxTQUFVLEtBQWE7QUFDM0IsWUFBTSxNQUFBO0FBQ04sWUFBTSxNQUFNLE1BQU0sS0FBSyxHQUFBO0FBQ3ZCLFdBQUssT0FBTyxLQUFLLElBQUE7SUFDbkI7SUFDQSxPQUFPLFNBQVUsTUFBUztBQUN4QixZQUFNLE9BQUE7QUFDTixXQUFLLFNBQVM7UUFBQyxLQUFLO1FBQU0sS0FBSztRQUFNLEtBQUs7UUFBTSxLQUFLO09BQWE7SUFDcEU7SUFDQSxPQUFPLFdBQUE7QUFDTCxZQUFNLE1BQ0osNkpBQUE7SUFJSjtJQUNBLFlBQVksV0FBQTtBQUNWLFlBQU0sV0FBQTtJQUNSO0lBQ0EsU0FBUyxTQUFVLFFBQWM7QUFDL0IsWUFBTSxZQUFZLE9BQU8sU0FBUSxDQUFBO0lBQ25DOztJQUVBLFVBQVUsV0FBQTtBQUNSLFlBQU0sU0FBQTtJQUNSO0lBQ0EsUUFBUSxXQUFBO0FBQ04sWUFBTSxPQUFBO0lBQ1I7SUFDQSxPQUFPLFdBQUE7QUFDTCxZQUFNLE1BQUE7SUFDUjtJQUNBLE1BQU0sV0FBQTtBQUNKLFlBQU0sS0FBQTtJQUNSO0lBQ0EsTUFBTSxXQUFBO0FBQ0osWUFBTSxLQUFBO0lBQ1I7SUFDQSxNQUFNLFdBQUE7QUFDSixZQUFNLEtBQUE7SUFDUjtJQUNBLGNBQWMsV0FBQTtBQUNaLFlBQU0sYUFBQTtJQUNSO0lBQ0EsZ0JBQWdCLFdBQUE7QUFDZCxZQUFNLGVBQUE7SUFDUjtJQUNBLGFBQWEsV0FBQTtBQUNYLFlBQU0sWUFBQTtJQUNSO0lBQ0EsT0FBTyxXQUFBO0FBQ0wsWUFBTSxNQUFBO0lBQ1I7SUFDQSxVQUFVLFdBQUE7QUFDUixZQUFNLFNBQUE7SUFDUjtJQUNBLGFBQWEsV0FBQTtBQUNYLFlBQU0sWUFBQTtJQUNSO0lBQ0EsYUFBYSxXQUFBO0FBQ1gsWUFBTSxZQUFBO0lBQ1I7SUFDQSxXQUFXLFdBQUE7QUFDVCxZQUFNLFVBQUE7SUFDUjtJQUNBLFNBQVMsV0FBQTtBQUNQLFlBQU0sUUFBQTtJQUNSO0lBQ0EsVUFBVSxXQUFBO0FBQ1IsWUFBTSxTQUFBO0lBQ1I7SUFDQSxVQUFVLFdBQUE7QUFDUixZQUFNLFNBQUE7SUFDUjtFQUNGO0FBQ0Y7QUFNQSxTQUFTLG9DQUFBO0FBQ1AsU0FBTztJQUNMLEtBQUs7SUFFTCxPQUFPLFNBQVUsR0FBUztBQUN4QixXQUFLLE9BQU87SUFDZDtJQUVBLEtBQUssU0FBVSxHQUFTO0FBQ3RCLFdBQUssT0FBTztJQUNkO0lBRUEsTUFBTSxXQUFBO0FBQ0osYUFBTyxLQUFLO0lBQ2Q7RUFDRjtBQUNGO0FEdFVPLFNBQVMsMENBQW9CLEtBQWEsUUFBZTtBQUM5RCxRQUFNLFFBQVEsS0FBSyxHQUFBO0FBQ25CLE1BQUksaUJBQWlCLEtBQ25CLFFBQU8sMEJBQTBCLE1BQU0sWUFBVyxDQUFBO0FBRXBELE1BQUksT0FBTyxTQUFTLEtBQUEsRUFDbEIsUUFBTyw0QkFBNEIsTUFBTSxTQUFTLFFBQUEsQ0FBQTtBQUVwRCxTQUFPO0FBQ1Q7QUFFTyxTQUFTLDBDQUFRLE1BQWMsT0FBYztBQUNsRCxNQUFJLE9BQU8sVUFBVSxZQUFZLE1BQU0sV0FBVyx5QkFBQSxFQUNoRCxRQUFPLElBQUksS0FBSyxNQUFNLFFBQVEsMkJBQTJCLEVBQUEsQ0FBQTtBQUUzRCxNQUFJLE9BQU8sVUFBVSxZQUFZLE1BQU0sV0FBVywyQkFBQSxFQUNoRCxRQUFPLE9BQU8sS0FBSyxNQUFNLFFBQVEsNkJBQTZCLEVBQUEsR0FBSyxRQUFBO0FBRXJFLFNBQU87QUFDVDtBQUVPLFNBQVMsMENBQUssUUFBVztBQUM5QixRQUFNLGlCQUFnQixHQUFBLG1CQUFBQyxTQUFPLFdBQVcsTUFBQTtBQUN4QyxRQUFNLFVBQVMsR0FBQSwyQ0FBVyxhQUFBO0FBQzFCLFNBQU8sU0FBUyxNQUFBO0FBRWhCLFNBQU8sY0FBYyxPQUFPLEtBQUE7QUFDOUI7QUQxQkEsSUFBTSxrQ0FBNEIsdUJBQU8seUJBQUE7QUFDekMsSUFBTSxpQ0FBMkIsb0JBQUksSUFBQTtBQWdCOUIsU0FBUywwQ0FDZCxLQUNBLGNBQ0EsUUFBb0M7QUFFcEMsUUFBTSxXQUFXLFFBQVEsa0JBQWtCO0FBQzNDLFFBQU0sUUFDSiwrQkFBUyxJQUFJLFFBQUEsS0FBYSwrQkFBUyxJQUFJLFVBQVUsS0FBSSxHQUFBLFlBQUFDLE9BQU07SUFBRSxXQUFXLFFBQVE7RUFBZSxDQUFBLENBQUEsRUFBSSxJQUFJLFFBQUE7QUFFekcsTUFBSSxDQUFDLE1BQ0gsT0FBTSxJQUFJLE1BQU0sZUFBQTtBQUdsQixRQUFNLFVBQVMsR0FBQSwyQ0FBVSxHQUFBO0FBQ3pCLFFBQU0sbUJBQWtCLEdBQUEsMkNBQVUsWUFBQTtBQUVsQyxRQUFNLGVBQWMsR0FBQSxhQUFBQyxzQkFBcUIsTUFBTSxXQUFXLE1BQUE7QUFDeEQsUUFBSTtBQUNGLGFBQU8sTUFBTSxJQUFJLE9BQU8sT0FBTztJQUNqQyxTQUFTLE9BQU87QUFDZCxjQUFRLE1BQU0sNkJBQTZCLEtBQUE7QUFDM0MsYUFBTztJQUNUO0VBQ0YsQ0FBQTtBQUVBLFFBQU0sU0FBUSxHQUFBLGFBQUFoQixTQUFRLE1BQUE7QUFDcEIsUUFBSSxPQUFPLGdCQUFnQixhQUFhO0FBQ3RDLFVBQUksZ0JBQWdCLFlBQ2xCLFFBQU87QUFFVCxVQUFJO0FBQ0YsZUFBTyxLQUFLLE1BQU0sY0FBYSxHQUFBLDBDQUFNO01BQ3ZDLFNBQVMsS0FBSztBQUVaLGdCQUFRLEtBQUssZ0NBQWdDLEdBQUE7QUFDN0MsZUFBTyxnQkFBZ0I7TUFDekI7SUFDRixNQUNFLFFBQU8sZ0JBQWdCO0VBRTNCLEdBQUc7SUFBQztJQUFhO0dBQWdCO0FBRWpDLFFBQU0sWUFBVyxHQUFBLDJDQUFVLEtBQUE7QUFFM0IsUUFBTSxvQkFBbUIsR0FBQSxhQUFBUyxhQUN2QixDQUFDLFlBQUE7QUFFQyxVQUFNLFdBQVcsT0FBTyxZQUFZLGFBQWEsUUFBUSxTQUFTLE9BQU8sSUFBSTtBQUM3RSxRQUFJLE9BQU8sYUFBYSxZQUN0QixPQUFNLElBQUksT0FBTyxTQUFTLFdBQUE7U0FDckI7QUFDTCxZQUFNLG1CQUFtQixLQUFLLFVBQVUsV0FBVSxHQUFBLDBDQUFPO0FBQ3pELFlBQU0sSUFBSSxPQUFPLFNBQVMsZ0JBQUE7SUFDNUI7QUFDQSxXQUFPO0VBQ1QsR0FDQTtJQUFDO0lBQU87SUFBUTtHQUFTO0FBRzNCLFNBQU87SUFBQztJQUFPOztBQUNqQjtBR25FQSxJQUFNLG1DQUE2Qix1QkFBQTtBQW1INUIsU0FBUywwQ0FJZCxJQUFPLE1BQXNCLFNBQW9DO0FBUWpFLFFBQU0sRUFBQSxhQUNPLGtCQUNLLHlCQUVoQixHQUFHLGtCQUFBLElBQ2tFLFdBQVcsQ0FBQztBQUNuRixRQUFNLGtCQUFpQixHQUFBLGFBQUFWLFFBQTRCLElBQUE7QUFFbkQsUUFBTSxDQUFDLFlBQVksV0FBQSxLQUFlLEdBQUEsNENBQ2hDLEdBQUEsMkNBQUssUUFBUSxDQUFBLENBQUUsSUFBSSx5QkFDbkIsa0NBQ0E7SUFDRSxpQkFBZ0IsR0FBQSwyQ0FBSyxFQUFBO0VBQ3ZCLENBQUE7QUFJRixRQUFNLGdCQUFlLEdBQUEsYUFBQUEsUUFBbUMsZUFBZSxtQ0FBYSxhQUFjLFdBQUE7QUFDbEcsUUFBTSxxQkFBb0IsR0FBQSxhQUFBQSxRQUEyRCxNQUFBO0FBRXJGLFFBQU0sRUFDSixRQUFRLFNBQU8sWUFFZixHQUFHLE1BQUEsS0FHRCxHQUFBLDJDQUFXLElBQUksUUFBUyxDQUFBLEdBQTZCO0lBQ3ZELEdBQUc7SUFDSCxPQUFPLE1BQU1rQixhQUFVO0FBQ3JCLHdCQUFrQixVQUFVQTtBQUM1QixVQUFJLGtCQUFrQixPQUNwQixtQkFBa0IsT0FBTyxNQUFNQSxXQUFBO0FBRWpDLFVBQUlBLGVBQWNBLFlBQVcsT0FBTztBQUVsQztBQUVGLHFCQUFlLFVBQVU7QUFDekIsbUJBQWEsVUFBVTtBQUN2QixrQkFBWSxJQUFBO0lBQ2Q7RUFDRixDQUFBO0FBRUEsTUFBSTtBQUNKLFFBQU0sYUFBYSxNQUFNO0FBR3pCLE1BQUksa0JBQWtCLFdBQVcsa0JBQWtCLFFBQVEsT0FBTyxLQUFLLE1BQU0sS0FDM0UsZ0JBQWUsTUFBTTtXQUVaLGVBQWUsWUFBWSxVQUNwQyxnQkFBZSxhQUFhO1dBQ25CLG9CQUFvQixlQUFlLGtDQUFZO0FBRXhELG1CQUFlO0FBQ2YsUUFBSSxZQUFZO0FBQ2QsaUJBQVcsVUFBVTtBQUNyQixpQkFBVyxXQUFXLFdBQVc7SUFDbkM7RUFDRixXQUFXLG9CQUFvQixlQUFlO0FBRTVDLG1CQUFlLGFBQWE7V0FFbkIsZUFBZSxrQ0FBWTtBQUNwQyxtQkFBZTtBQUNmLFFBQUksWUFBWTtBQUNkLGlCQUFXLFVBQVU7QUFDckIsaUJBQVcsV0FBVyxXQUFXO0lBQ25DO0VBQ0YsTUFDRSxnQkFBZTtBQUdqQixRQUFNLGNBQWEsR0FBQSwyQ0FBVSxZQUFBO0FBRzdCLFFBQU0sVUFBUyxHQUFBLGFBQUFSLGFBQ2IsT0FBTyxhQUFhRyxhQUFBO0FBQ2xCLFFBQUk7QUFDSixRQUFJO0FBQ0YsVUFBSUEsVUFBUyxrQkFBa0I7QUFDN0IsWUFBSSxPQUFPQSxVQUFTLG9CQUFvQixjQUFjQSxVQUFTLG9CQUFvQjtBQUdqRix1Q0FBNkIsZ0JBQWdCLFdBQVcsT0FBTztBQUVqRSxjQUFNLE9BQU9BLFNBQVEsaUJBQWlCLFdBQVcsT0FBTztBQUN4RCx1QkFBZSxVQUFVO0FBQ3pCLHFCQUFhLFVBQVU7QUFDdkIsb0JBQVksSUFBQTtNQUNkO0FBQ0EsYUFBTyxNQUFNLFFBQVEsYUFBYTtRQUFFLHVCQUF1QkEsVUFBUztNQUFzQixDQUFBO0lBQzVGLFNBQVMsS0FBSztBQUNaLFVBQUksT0FBT0EsVUFBUyxvQkFBb0IsWUFBWTtBQUNsRCxjQUFNLE9BQU9BLFNBQVEsZ0JBQWdCLFdBQVcsT0FBTztBQUN2RCx1QkFBZSxVQUFVO0FBQ3pCLHFCQUFhLFVBQVU7QUFDdkIsb0JBQVksSUFBQTtNQUNkLFdBQVdBLFVBQVMsb0JBQW9CQSxVQUFTLG9CQUFvQixPQUFPO0FBQzFFLHVCQUFlLFVBQVU7QUFFekIscUJBQWEsVUFBVTtBQUV2QixvQkFBWSwwQkFBQTtNQUNkO0FBQ0EsWUFBTTtJQUNSO0VBQ0YsR0FDQTtJQUFDO0lBQWE7SUFBUztJQUFZO0lBQWM7R0FBZTtBQUdsRSxHQUFBLEdBQUEsYUFBQUMsV0FBVSxNQUFBO0FBQ1IsUUFBSSxlQUFlLGtDQUFZO0FBQzdCLHFCQUFlLFVBQVU7QUFDekIsbUJBQWEsVUFBVTtJQUN6QjtFQUNGLEdBQUc7SUFBQztHQUFXO0FBRWYsU0FBTztJQUNMLE1BQU07SUFDTixXQUFXLE1BQU07SUFDakIsT0FBTyxNQUFNO0lBQ2IsUUFBUSxrQkFBa0IsV0FBVyxrQkFBa0IsUUFBUSxPQUFPLElBQUksVUFBVTs7O0VBR3RGO0FBQ0Y7QUtyUUEsSUFBTSxrQ0FBWSxDQUFDLGFBQ2pCLENBQUMsQ0FBQyxZQUNGLE9BQU8sYUFBWSxZQUNuQixPQUFPLFNBQVEsbUJBQW1CLGNBQ2xDLE9BQU8sU0FBUSxTQUFTLGNBQ3hCLE9BQU8sU0FBUSxlQUFlLGNBQzlCLE9BQU8sU0FBUSxjQUFjLGNBQzdCLE9BQU8sU0FBUSxTQUFTLGNBQ3hCLE9BQU8sU0FBUSxRQUFRLFlBQ3ZCLE9BQU8sU0FBUSxPQUFPO0FBQ3hCLElBQU0scUNBQStCLHVCQUFPLElBQUkscUJBQUE7QUFFaEQsSUFBTSxnQ0FBTixNQUFNO0VBV0osY0FBYztTQVZkLFVBQVU7TUFDUixXQUFXO01BQ1gsTUFBTTtJQUNSO1NBQ0EsWUFBWTtNQUNWLFdBQVcsQ0FBQTtNQUNYLE1BQU0sQ0FBQTtJQUNSO1NBQ0EsUUFBUTtTQUNSLEtBQUssS0FBSyxPQUFNO0FBR2QsUUFBSSxlQUFPLGtDQUFBO0FBRVQsYUFBTyxlQUFPLGtDQUFBO0FBRWhCLFdBQU8sZUFBZSxnQkFBUSxvQ0FBYztNQUMxQyxPQUFPO01BQ1AsVUFBVTtNQUNWLFlBQVk7TUFDWixjQUFjO0lBQ2hCLENBQUE7RUFDRjtFQUNBLEdBQUcsSUFBUyxJQUFTO0FBRW5CLFNBQUssVUFBVSxFQUFBLEVBQUksS0FBSyxFQUFBO0VBQzFCO0VBQ0EsZUFBZSxJQUFTLElBQVM7QUFFL0IsVUFBTSxPQUFPLEtBQUssVUFBVSxFQUFBO0FBQzVCLFVBQU0sSUFBSSxLQUFLLFFBQVEsRUFBQTtBQUV2QixRQUFJLE1BQU0sR0FDUjtBQUdGLFFBQUksTUFBTSxLQUFLLEtBQUssV0FBVyxFQUM3QixNQUFLLFNBQVM7UUFFZCxNQUFLLE9BQU8sR0FBRyxDQUFBO0VBRW5CO0VBQ0EsS0FBSyxJQUFTLE1BQVcsUUFBa0I7QUFFekMsUUFBSSxLQUFLLFFBQVEsRUFBQSxFQUNmLFFBQU87QUFHVCxTQUFLLFFBQVEsRUFBQSxJQUFNO0FBQ25CLFFBQUksTUFBTTtBQUVWLGVBQVcsTUFBTSxLQUFLLFVBQVUsRUFBQSxFQUM5QixPQUFNLEdBQUcsTUFBTSxNQUFBLE1BQVksUUFBUTtBQUVyQyxRQUFJLE9BQU8sT0FDVCxPQUFNLEtBQUssS0FBSyxhQUFhLE1BQU0sTUFBQSxLQUFXO0FBRWhELFdBQU87RUFDVDtBQUNGO0FBRUEsSUFBTSwyQ0FBTixNQUFNO0VBQ0osU0FBUztBQUNQLFdBQU8sTUFBQTtJQUFPO0VBQ2hCO0VBQ0EsT0FBTztFQUFDO0VBQ1IsU0FBUztFQUFDO0FBQ1o7QUFDQSxJQUFNLG1DQUFOLE1BQU07Ozs7O0VBS0o7O0VBRUE7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQSxZQUFZLFVBQWM7U0FUMUIsVUFBVSxRQUFRLGFBQWEsVUFBVSxXQUFXO1NBRXBELFdBQVcsSUFBSSw4QkFBQTtTQUlmLGdCQUFnQixDQUFDO1NBQ2pCLFVBQVU7U0FDVixXQUFxQixDQUFBO0FBNEJuQixTQUFLLFNBQVMsS0FBSyxVQUFVLFVBQVUsU0FBQTtBQUN2QyxRQUFJLFdBQVcsUUFBUSxhQUFhLFFBQ2xDLE1BQUssU0FBUyxLQUNaLFdBQ0EsV0FDQSxhQUNBLFdBQ0EsV0FDQSxXQUNBLFdBQ0EsVUFDQSxXQUNBLFFBQUE7QUFNSixRQUFJLFdBQVcsUUFBUSxhQUFhLFFBQ2xDLE1BQUssU0FBUyxLQUFLLFNBQVMsV0FBVyxVQUFVLFdBQUE7QUFFbkQsU0FBSyxXQUFXO0FBRWhCLFNBQUssZ0JBQWdCLENBQUM7QUFDdEIsZUFBVyxPQUFPLEtBQUs7QUFFckIsV0FBSyxjQUFjLEdBQUEsSUFBTyxNQUFBO0FBS3hCLGNBQU0sWUFBWSxLQUFLLFNBQVMsVUFBVSxHQUFBO0FBQzFDLFlBQUksRUFBQSxNQUFPLElBQUssS0FBSztBQVFyQixjQUFNLElBQUk7QUFDVixZQUFJLE9BQU8sRUFBRSw0QkFBNEIsWUFBWSxPQUFPLEVBQUUsd0JBQXdCLFVBQVUsU0FDOUYsVUFBUyxFQUFFLHdCQUF3QjtBQUdyQyxZQUFJLFVBQVUsV0FBVyxPQUFPO0FBQzlCLGVBQUssT0FBTTtBQUNYLGdCQUFNLE1BQU0sS0FBSyxTQUFTLEtBQUssUUFBUSxNQUFNLEdBQUE7QUFFN0MsZ0JBQU0sSUFBSSxRQUFRLFdBQVcsS0FBSyxVQUFVO0FBQzVDLGNBQUksQ0FBQyxJQUFLLFVBQVEsS0FBSyxTQUFRLEtBQUssQ0FBQTtRQUV0QztNQUNGO0FBRUYsU0FBSyw2QkFBNkIsU0FBUTtBQUMxQyxTQUFLLHVCQUF1QixTQUFRO0VBQ3RDO0VBQ0EsT0FBTyxJQUFTLE1BQVc7QUFFekIsUUFBSSxDQUFDLGdDQUFVLEtBQUssUUFBUSxFQUMxQixRQUFPLE1BQUE7SUFBTztBQUdoQixRQUFJLEtBQUssWUFBWSxNQUNuQixNQUFLLEtBQUk7QUFFWCxVQUFNLEtBQUssTUFBTSxhQUFhLGNBQWM7QUFDNUMsU0FBSyxTQUFTLEdBQUcsSUFBSSxFQUFBO0FBQ3JCLFdBQU8sTUFBQTtBQUNMLFdBQUssU0FBUyxlQUFlLElBQUksRUFBQTtBQUNqQyxVQUFJLEtBQUssU0FBUyxVQUFVLE1BQUEsRUFBUSxXQUFXLEtBQUssS0FBSyxTQUFTLFVBQVUsV0FBQSxFQUFhLFdBQVcsRUFDbEcsTUFBSyxPQUFNO0lBRWY7RUFDRjtFQUNBLE9BQU87QUFDTCxRQUFJLEtBQUssUUFDUDtBQUVGLFNBQUssVUFBVTtBQUtmLFNBQUssU0FBUyxTQUFTO0FBQ3ZCLGVBQVcsT0FBTyxLQUFLLFNBQ3JCLEtBQUk7QUFFRixZQUFNLEtBQUssS0FBSyxjQUFjLEdBQUE7QUFDOUIsVUFBSSxHQUFJLE1BQUssU0FBUyxHQUFHLEtBQUssRUFBQTtJQUNoQyxTQUFTLEdBQUc7SUFFWjtBQUVGLFNBQUssU0FBUyxPQUFPLENBQUMsT0FBWSxNQUFBO0FBQ2hDLGFBQU8sS0FBSyxhQUFhLElBQUEsR0FBTyxDQUFBO0lBQ2xDO0FBQ0EsU0FBSyxTQUFTLGFBQWEsQ0FBQyxTQUFBO0FBQzFCLGFBQU8sS0FBSyxtQkFBbUIsSUFBQTtJQUNqQztFQUNGO0VBQ0EsU0FBUztBQUNQLFFBQUksQ0FBQyxLQUFLLFFBQ1I7QUFFRixTQUFLLFVBQVU7QUFDZixTQUFLLFNBQVMsUUFBUSxDQUFDLFFBQUE7QUFFckIsWUFBTSxXQUFXLEtBQUssY0FBYyxHQUFBO0FBRXBDLFVBQUksQ0FBQyxTQUNILE9BQU0sSUFBSSxNQUFNLHNDQUFzQyxHQUFBO0FBR3hELFVBQUk7QUFDRixhQUFLLFNBQVMsZUFBZSxLQUFLLFFBQUE7TUFFcEMsU0FBUyxHQUFHO01BRVo7SUFFRixDQUFBO0FBQ0EsU0FBSyxTQUFTLE9BQU8sS0FBSztBQUMxQixTQUFLLFNBQVMsYUFBYSxLQUFLO0FBQ2hDLFNBQUssU0FBUyxTQUFTO0VBQ3pCO0VBQ0EsbUJBQW1CLE1BQVM7QUFFMUIsUUFBSSxDQUFDLGdDQUFVLEtBQUssUUFBUSxFQUMxQixRQUFPO0FBRVQsU0FBSyxTQUFTLFdBQVcsUUFBUTtBQUVqQyxTQUFLLFNBQVMsS0FBSyxRQUFRLEtBQUssU0FBUyxVQUFVLElBQUE7QUFDbkQsV0FBTyxLQUFLLDJCQUEyQixLQUFLLEtBQUssVUFBVSxLQUFLLFNBQVMsUUFBUTtFQUNuRjtFQUNBLGFBQWEsT0FBWSxNQUFTO0FBQ2hDLFVBQU0sS0FBSyxLQUFLO0FBQ2hCLFFBQUksT0FBTyxVQUFVLGdDQUFVLEtBQUssUUFBUSxHQUFHO0FBQzdDLFVBQUksT0FBTyxLQUFLLENBQUEsTUFBTyxTQUNyQixNQUFLLFNBQVMsV0FBVyxLQUFLLENBQUE7QUFJaEMsWUFBTSxNQUFNLEdBQUcsS0FBSyxLQUFLLFVBQVUsSUFBQSxHQUFPLElBQUE7QUFFMUMsV0FBSyxTQUFTLEtBQUssUUFBUSxLQUFLLFNBQVMsVUFBVSxJQUFBO0FBRW5ELGFBQU87SUFDVCxNQUNFLFFBQU8sR0FBRyxLQUFLLEtBQUssVUFBVSxJQUFBLEdBQU8sSUFBQTtFQUV6QztBQUNGO0FBRUEsSUFBSSxtQ0FBcUQ7QUFFbEQsSUFBTSw0Q0FBUyxDQUNwQixJQUNBLFNBQUE7QUFJQSxNQUFJLENBQUMsaUNBQ0gsb0NBQWEsZ0NBQVUsT0FBQSxJQUFXLElBQUksaUNBQVcsT0FBQSxJQUFXLElBQUkseUNBQUE7QUFFbEUsU0FBTyxpQ0FBVyxPQUFPLElBQUksSUFBQTtBQUMvQjtBRDVSTyxTQUFTLDBDQUNkLFNBQ0EsRUFBQSxRQUFTLElBQTJCLENBQUMsR0FBQztBQUV0QyxRQUFNLGlCQUFpQyxJQUFJLFFBQVEsQ0FBQyxTQUFTLFdBQUE7QUFDM0QsWUFBUSxHQUFHLFFBQVEsQ0FBQyxVQUFVLFdBQUE7QUFDNUIsY0FBUTs7O1FBQW9CLFVBQVU7TUFBTSxDQUFBO0lBQzlDLENBQUE7QUFFQSxZQUFRLEdBQUcsU0FBUyxDQUFDLFVBQUE7QUFDbkIsYUFBTyxLQUFBO0lBQ1QsQ0FBQTtBQUVBLFFBQUksUUFBUSxNQUNWLFNBQVEsTUFBTSxHQUFHLFNBQVMsQ0FBQyxVQUFBO0FBQ3pCLGFBQU8sS0FBQTtJQUNULENBQUE7RUFFSixDQUFBO0FBRUEsUUFBTSxxQkFBb0IsR0FBQSwyQ0FBTyxNQUFBO0FBQy9CLFlBQVEsS0FBSTtFQUNkLENBQUE7QUFFQSxNQUFJLFlBQVksS0FBSyxZQUFZLE9BQy9CLFFBQU8sZUFBZSxRQUFRLE1BQU0sa0JBQUEsQ0FBQTtBQUd0QyxNQUFJO0FBQ0osUUFBTSxpQkFBaUMsSUFBSSxRQUFRLENBQUMsVUFBVSxXQUFBO0FBQzVELGdCQUFZLFdBQVcsTUFBQTtBQUNyQixjQUFRLEtBQUssU0FBQTtBQUNiLGFBQU8sT0FBTyxPQUFPLElBQUksTUFBTSxXQUFBLEdBQWM7UUFBRSxVQUFVO1FBQU0sUUFBUTtNQUFVLENBQUEsQ0FBQTtJQUNuRixHQUFHLE9BQUE7RUFDTCxDQUFBO0FBRUEsUUFBTSxxQkFBcUIsZUFBZSxRQUFRLE1BQUE7QUFDaEQsaUJBQWEsU0FBQTtFQUNmLENBQUE7QUFFQSxTQUFPLFFBQVEsS0FBSztJQUFDO0lBQWdCO0dBQW1CLEVBQUUsUUFBUSxNQUFNLGtCQUFBLENBQUE7QUFDMUU7QUFFQSxJQUFNLHVDQUFOLGNBQTZCLE1BQUE7RUFDM0IsY0FBYztBQUNaLFVBQU0sdUJBQUE7QUFDTixTQUFLLE9BQU87RUFDZDtBQUNGO0FBRUEsU0FBUyxtQ0FBd0MsU0FBZ0Q7QUFDL0YsUUFBTSxFQUFBLFNBQVUsSUFBSztBQUNyQixRQUFNLFdBQVcsYUFBYTtBQUc5QixRQUFNLFNBQ0osS0FBSSxHQUFBLG1CQUFBSyxTQUFPLFlBQVk7SUFBRSxZQUFZO0VBQU0sQ0FBQTtBQUU3QyxNQUFJLFlBQVksYUFBYSxTQUMzQixRQUFPLFlBQVksUUFBQTtBQUdyQixNQUFJLFNBQVM7QUFDYixRQUFNLFNBQWdCLENBQUE7QUFFdEIsU0FBTyxHQUFHLFFBQVEsQ0FBQyxVQUFBO0FBQ2pCLFdBQU8sS0FBSyxLQUFBO0FBRVosY0FBVSxNQUFNO0VBQ2xCLENBQUE7QUFFQSxTQUFPLG1CQUFtQixNQUFBO0FBQ3hCLFdBQVEsV0FBVyxPQUFPLE9BQU8sUUFBUSxNQUFBLElBQVUsT0FBTyxLQUFLLEVBQUE7RUFDakU7QUFFQSxTQUFPLG9CQUFvQixNQUFNO0FBRWpDLFNBQU87QUFDVDtBQUVBLGVBQWUsZ0NBQ2IsYUFDQSxTQUFnRDtBQUVoRCxRQUFNLFNBQVMsbUNBQWdCLE9BQUE7QUFFL0IsUUFBTSxJQUFJLFFBQWMsQ0FBQyxTQUFTLFdBQUE7QUFDaEMsVUFBTSxnQkFBZ0IsQ0FBQyxVQUFBO0FBRXJCLFVBQUksU0FBUyxPQUFPLGtCQUFpQixNQUFNLEdBQUEsbUJBQUFDLFdBQWdCLFdBQ3pELE9BQU0sZUFBZSxPQUFPLGlCQUFnQjtBQUc5QyxhQUFPLEtBQUE7SUFDVDtBQUVDLEtBQUEsWUFBQTtBQUNDLFVBQUk7QUFDRixlQUFNLEdBQUEsaUJBQUFDLFlBQVUsR0FBQSxtQkFBQUYsU0FBTyxRQUFRLEVBQUUsYUFBYSxNQUFBO0FBQzlDLGdCQUFBO01BQ0YsU0FBUyxPQUFPO0FBQ2Qsc0JBQWMsS0FBQTtNQUNoQjtJQUNGLEdBQUE7QUFFQSxXQUFPLEdBQUcsUUFBUSxNQUFBO0FBRWhCLFVBQUksT0FBTyxrQkFBaUIsSUFBSyxJQUMvQixlQUFjLElBQUkscUNBQUEsQ0FBQTtJQUV0QixDQUFBO0VBQ0YsQ0FBQTtBQUVBLFNBQU8sT0FBTyxpQkFBZ0I7QUFDaEM7QUFHQSxlQUFlLHNDQUEyQyxRQUF5QixlQUF5QjtBQUMxRyxTQUFPLFFBQU87QUFFZCxNQUFJO0FBQ0YsV0FBTyxNQUFNO0VBQ2YsU0FBUyxPQUFPO0FBQ2QsV0FBUSxNQUFxQztFQUMvQztBQUNGO0FBRU8sZUFBZSwwQ0FDcEIsRUFBQSxRQUFRLE9BQVEsR0FDaEIsRUFBQSxTQUFVLEdBQ1YsYUFBMkI7QUFFM0IsUUFBTSxnQkFBZ0IsZ0NBQWEsUUFBUTs7RUFBVyxDQUFBO0FBQ3RELFFBQU0sZ0JBQWdCLGdDQUFhLFFBQVE7O0VBQVcsQ0FBQTtBQUV0RCxNQUFJO0FBQ0YsV0FBTyxNQUFNLFFBQVEsSUFBSTtNQUFDO01BQWE7TUFBZTtLQUFjO0VBQ3RFLFNBQVMsT0FBWTtBQUNuQixXQUFPLFFBQVEsSUFBSTtNQUNqQjtRQUNFO1FBQ0EsVUFBVTtRQUNWLFFBQVEsTUFBTTtRQUNkLFVBQVcsTUFBTSxZQUF3QjtNQUMzQztNQUNBLHNDQUFnQixRQUFRLGFBQUE7TUFDeEIsc0NBQWdCLFFBQVEsYUFBQTtLQUN6QjtFQUNIO0FBQ0Y7QUFFQSxTQUFTLHdDQUE2QyxPQUFRO0FBQzVELFFBQU0sS0FBSyxPQUFPLFVBQVUsV0FBVyxPQUFPLEtBQUssV0FBVyxDQUFBO0FBQzlELFFBQU0sS0FBSyxPQUFPLFVBQVUsV0FBVyxPQUFPLEtBQUssV0FBVyxDQUFBO0FBRTlELE1BQUksTUFBTSxNQUFNLFNBQVMsQ0FBQSxNQUFPO0FBRTlCLFlBQVEsTUFBTSxNQUFNLEdBQUcsRUFBQTtBQUd6QixNQUFJLE1BQU0sTUFBTSxTQUFTLENBQUEsTUFBTztBQUU5QixZQUFRLE1BQU0sTUFBTSxHQUFHLEVBQUE7QUFHekIsU0FBTztBQUNUO0FBRU8sU0FBUyx5Q0FBd0MsU0FBMEMsT0FBUTtBQUN4RyxNQUFJLFFBQVEsa0JBQ1YsUUFBTyx3Q0FBa0IsS0FBQTtBQUczQixTQUFPO0FBQ1Q7QUFFQSxTQUFTLHFDQUFlLEVBQUEsVUFDZCxTQUNELFFBQ0QsU0FDRSxHQU1UO0FBQ0MsTUFBSSxTQUNGLFFBQU8sbUJBQW1CLE9BQUE7QUFHNUIsTUFBSSxXQUFXLFVBQWEsV0FBVyxLQUNyQyxRQUFPLG1CQUFtQixNQUFBO0FBRzVCLE1BQUksYUFBYSxVQUFhLGFBQWEsS0FDekMsUUFBTyx5QkFBeUIsUUFBQTtBQUdsQyxTQUFPO0FBQ1Q7QUFFQSxTQUFTLGdDQUFVLEVBQUEsUUFDWCxRQUNBLE9BQ0QsUUFDQyxVQUNFLFNBQ0QsVUFDQyxTQUNELFlBQ0ksR0FXWjtBQUNDLFFBQU0sU0FBUyxxQ0FBZTs7SUFBWSxTQUFTLFNBQVM7OztFQUEwQixDQUFBO0FBQ3RGLFFBQU0sZUFBZSxXQUFXLE1BQUEsS0FBVyxPQUFBO0FBQzNDLFFBQU0sZUFBZSxRQUFRLEdBQUcsWUFBQTtFQUFpQixNQUFNLE9BQU8sS0FBSztBQUNuRSxRQUFNLFVBQVU7SUFBQztJQUFjO0lBQVE7SUFBUSxPQUFPLE9BQUEsRUFBUyxLQUFLLElBQUE7QUFFcEUsTUFBSTtBQUVGLFVBQU0sa0JBQWtCLE1BQU07TUFFOUIsU0FBUTtBQUdWLFFBQU0sVUFBVTtBQUdoQixRQUFNLGVBQWU7QUFFckIsUUFBTSxVQUFVO0FBRWhCLFFBQU0sV0FBVztBQUVqQixRQUFNLFNBQVM7QUFFZixRQUFNLFNBQVM7QUFFZixRQUFNLFNBQVM7QUFFZixNQUFJLGtCQUFrQixNQUNwQixRQUFPLE1BQU0sY0FBQTtBQUdmLFNBQU87QUFDVDtBQTJCTyxTQUFTLDBDQUEwQyxFQUFBLFFBQ2xELFFBQ0EsT0FDRCxVQUNHLFFBQ0YsVUFDRSxTQUNELFNBQ0EsWUFDSSxHQVdaO0FBQ0MsTUFBSSxTQUFTLGFBQWEsS0FBSyxXQUFXLE1BQU07QUFDOUMsVUFBTSxnQkFBZ0IsZ0NBQVU7Ozs7Ozs7Ozs7SUFVaEMsQ0FBQTtBQUVBLFVBQU07RUFDUjtBQUVBLFNBQU87QUFDVDtBTXJVTyxJQUFNLDRDQUFOLGNBQThCLE1BQUE7RUFDbkMsWUFBWSxTQUFpQjtBQUMzQixVQUFNLE9BQUE7QUFDTixTQUFLLE9BQU87RUFDZDtBQUNGO0FBRU8sU0FBUywwQ0FBa0IsT0FBYztBQUM5QyxTQUFPLGlCQUFpQixTQUFTLE1BQU0sU0FBUztBQUNsRDtBQUVPLGVBQWUsMENBQ3BCLGNBQ0EsT0FDQSxTQUVDO0FBRUQsTUFBSSxFQUFDLEdBQUEsZUFBQUcsWUFBVyxZQUFBLEVBQ2QsT0FBTSxJQUFJLE1BQU0sNkJBQUE7QUFHbEIsTUFBSTtBQUNKLE1BQUk7QUFFRixVQUFNLGdCQUFnQixDQUFDQyxZQUFtQixPQUFPQTtBQUNqRCxjQUFVLE1BQU0sY0FBYyxhQUFBO0VBQ2hDLFNBQVMsT0FBTztBQUVkLFdBQU8scUNBQWtCLGNBQWMsT0FBTyxPQUFBO0VBQ2hEO0FBRUEsTUFBSSxLQUFLLElBQUksUUFBUSxhQUFhLGNBQWM7SUFBRSxNQUFNO0lBQU8sVUFBVTtFQUFLLENBQUE7QUFFOUUsUUFBTSxjQUFjLFNBQVM7QUFFN0IsTUFBSTtBQUNGLE9BQUcsS0FBSTtFQUNULFNBQVMsT0FBWTtBQUNuQixZQUFRLElBQUksS0FBQTtBQUNaLFFBQUksTUFBTSxRQUFRLE1BQU0sS0FBQSxLQUFVLE1BQU0sUUFBUSxNQUFNLE1BQUEsR0FBUztBQUs3RCxVQUFJO0FBQ0osVUFBSSxDQUFDLG9CQUFvQjtBQUN2QixjQUFNLGNBQWEsR0FBQSxpQkFBQUMsU0FBSyxNQUFLLEdBQUEsZUFBQUMsU0FBRyxPQUFNLEdBQUksV0FBVSxHQUFBLDJDQUFLLFlBQUEsQ0FBQTtBQUN6RCxlQUFNLEdBQUEsZ0JBQUFDLE9BQU0sWUFBWTtVQUFFLFdBQVc7UUFBSyxDQUFBO0FBQzFDLDJDQUFhLFdBQUE7QUFFYiw4QkFBcUIsR0FBQSxpQkFBQUYsU0FBSyxLQUFLLFlBQVksT0FBQTtBQUMzQyxlQUFNLEdBQUEsZ0JBQUFHLFVBQVMsY0FBYyxrQkFBQTtBQUU3QixlQUFNLEdBQUEsZ0JBQUFDLFdBQVUscUJBQXFCLFFBQVEsRUFBQTtBQUM3QyxlQUFNLEdBQUEsZ0JBQUFBLFdBQVUscUJBQXFCLFFBQVEsRUFBQTtBQUU3QywyQ0FBYSxXQUFBO01BQ2Y7QUFFQSxXQUFLLElBQUksUUFBUSxhQUFhLG9CQUFvQjtRQUFFLE1BQU07UUFBTyxVQUFVO01BQUssQ0FBQTtBQUNoRixTQUFHLEtBQUk7QUFDUCx5Q0FBYSxXQUFBO0lBQ2Y7RUFDRjtBQUVBLFFBQU0sWUFBWSxHQUFHLFFBQVEsS0FBQTtBQUM3QixxQ0FBYSxXQUFBO0FBRWIsUUFBTSxTQUFTLFVBQVUsSUFBRztBQUU1QixLQUFHLE1BQUs7QUFFUixTQUFPO0FBQ1Q7QUFFQSxlQUFlLHFDQUNiLGNBQ0EsT0FDQSxTQUVDO0FBRUQsUUFBTSxjQUFjLFNBQVM7QUFFN0IsTUFBSSxXQUFVLEdBQUEsMEJBQUFDLFNBQWEsTUFBTSxXQUFXO0lBQUM7SUFBVTtJQUFjO0lBQWM7S0FBUTtJQUFFLFFBQVE7RUFBWSxDQUFBO0FBQ2pILE1BQUksa0JBQWlCLEdBQUEsMkNBQWtCLE9BQUE7QUFDdkMsTUFBSSxDQUFDLEVBQUEsT0FBTyxVQUFVLE9BQVEsR0FBSSxjQUFjLFlBQUEsSUFBZ0IsT0FBTSxHQUFBLDJDQUNwRSxTQUNBO0lBQUUsVUFBVTtFQUFRLEdBQ3BCLGNBQUE7QUFFRixxQ0FBYSxXQUFBO0FBRWIsTUFBSSxhQUFhLE1BQU0sS0FBQSxLQUFVLGFBQWEsTUFBTSxNQUFBLEdBQVM7QUFLM0QsUUFBSTtBQUNKLFFBQUksQ0FBQyxvQkFBb0I7QUFDdkIsWUFBTSxjQUFhLEdBQUEsaUJBQUFMLFNBQUssTUFBSyxHQUFBLGVBQUFDLFNBQUcsT0FBTSxHQUFJLFdBQVUsR0FBQSwyQ0FBSyxZQUFBLENBQUE7QUFDekQsYUFBTSxHQUFBLGdCQUFBQyxPQUFNLFlBQVk7UUFBRSxXQUFXO01BQUssQ0FBQTtBQUMxQyx5Q0FBYSxXQUFBO0FBRWIsNEJBQXFCLEdBQUEsaUJBQUFGLFNBQUssS0FBSyxZQUFZLE9BQUE7QUFDM0MsYUFBTSxHQUFBLGdCQUFBRyxVQUFTLGNBQWMsa0JBQUE7QUFFN0IsYUFBTSxHQUFBLGdCQUFBQyxXQUFVLHFCQUFxQixRQUFRLEVBQUE7QUFDN0MsYUFBTSxHQUFBLGdCQUFBQSxXQUFVLHFCQUFxQixRQUFRLEVBQUE7QUFFN0MseUNBQWEsV0FBQTtJQUNmO0FBRUEsZUFBVSxHQUFBLDBCQUFBQyxTQUFhLE1BQU0sV0FBVztNQUFDO01BQVU7TUFBYztNQUFTO01BQWE7TUFBb0I7T0FBUTtNQUNqSCxRQUFRO0lBQ1YsQ0FBQTtBQUNBLHNCQUFpQixHQUFBLDJDQUFrQixPQUFBO0FBQ25DLEtBQUMsRUFBQSxPQUFPLFVBQVUsT0FBUSxHQUFJLGNBQWMsWUFBQSxJQUFnQixPQUFNLEdBQUEsMkNBQ2hFLFNBQ0E7TUFBRSxVQUFVO0lBQVEsR0FDcEIsY0FBQTtBQUVGLHVDQUFhLFdBQUE7RUFDZjtBQUVBLE1BQUksU0FBUyxhQUFhLEtBQUssV0FBVyxNQUFNO0FBQzlDLFFBQUksYUFBYSxTQUFTLHNCQUFBLEVBQ3hCLE9BQU0sSUFBSSwwQ0FBZ0Isb0RBQUE7UUFFMUIsT0FBTSxJQUFJLE1BQU0sZ0JBQWdCLGVBQUE7RUFFcEM7QUFFQSxTQUFPLEtBQUssTUFBTSxhQUFhLEtBQUksS0FBTSxJQUFBO0FBQzNDO0FBRUEsU0FBUyxtQ0FBYSxRQUFvQjtBQUN4QyxNQUFJLFFBQVEsU0FBUztBQUNuQixVQUFNLFFBQVEsSUFBSSxNQUFNLFNBQUE7QUFDeEIsVUFBTSxPQUFPO0FBQ2IsVUFBTTtFQUNSO0FBQ0Y7QUQ3R08sU0FBUywwQ0FDZCxjQUNBLE9BQ0EsU0FHd0Y7QUFHeEYsUUFBTSxFQUFBLG1CQUFxQixHQUFHLGtCQUFBLElBQXNCLFdBQVcsQ0FBQztBQUVoRSxRQUFNLENBQUMsZ0JBQWdCLGlCQUFBLEtBQXFCLEdBQUEsYUFBQUMsVUFBbUMsSUFBQTtBQUMvRSxRQUFNLGlCQUFnQixHQUFBLDJDQUFVLFdBQVcsQ0FBQyxDQUFBO0FBQzVDLFFBQU0sYUFBWSxHQUFBLGFBQUFDLFFBQXdCLElBQUE7QUFFMUMsUUFBTSxlQUFjLEdBQUEsYUFBQUMsYUFDbEIsQ0FBQyxXQUFBO0FBQ0MsWUFBUSxNQUFNLE1BQUE7QUFDZCxVQUFNLFFBQ0osa0JBQWtCLFNBQVMsT0FBTyxRQUFRLFNBQVMsc0JBQUEsSUFDL0MsS0FBSSxHQUFBLDJDQUFnQixvREFBQSxJQUNuQjtBQUVQLFNBQUksR0FBQSwyQ0FBa0IsS0FBQSxFQUNwQixtQkFBa0Isb0JBQUEsbUJBQUFDLEtBQUMsNkNBQUE7TUFBc0IsU0FBUyxjQUFjLFFBQVE7O1NBQ25FO0FBQ0wsVUFBSSxjQUFjLFFBQVEsUUFDeEIsZUFBYyxRQUFRLFFBQVEsS0FBQTtnQkFFMUIsR0FBQSxZQUFBQyxhQUFZLGdCQUFlLEdBQUEsWUFBQUMsWUFBVyxXQUN4QyxFQUFBLEdBQUEsMkNBQWlCLE9BQU87UUFDdEIsT0FBTztNQUNULENBQUE7SUFHTjtFQUNGLEdBQ0E7SUFBQztHQUFjO0FBR2pCLFFBQU0sTUFBSyxHQUFBLGFBQUFDLFNBQVEsTUFBQTtBQUNqQixRQUFJLEVBQUMsR0FBQSxlQUFBZCxZQUFXLFlBQUEsRUFDZCxPQUFNLElBQUksTUFBTSw2QkFBQTtBQUdsQixXQUFPLE9BQU9lLGVBQXNCQyxXQUFBO0FBQ2xDLFlBQU0sY0FBYyxVQUFVLFNBQVM7QUFDdkMsY0FBTyxHQUFBLDJDQUFrQkQsZUFBY0MsUUFBTztRQUFFLFFBQVE7TUFBWSxDQUFBO0lBQ3RFO0VBQ0YsR0FBRztJQUFDO0dBQWE7QUFFakIsU0FBTztJQUNMLElBQUcsR0FBQSwyQ0FBVyxJQUFJO01BQUM7TUFBYztPQUFRO01BQUUsR0FBRztNQUFtQixTQUFTO0lBQVksQ0FBQTs7RUFFeEY7QUFDRjtBQUVBLFNBQVMsNENBQXNCLE9BQTJCO0FBQ3hELFFBQU0sdUJBQXVCLFVBQVMsR0FBQSxlQUFBYixTQUFHLFFBQU8sRUFBRyxNQUFNLEdBQUEsRUFBSyxDQUFBLENBQUUsS0FBSztBQUNyRSxRQUFNLG9CQUFvQix1QkFBdUIsYUFBYTtBQUU5RCxRQUFNLFNBQVMsdUJBQ1g7SUFDRSxPQUFPO0lBQ1AsUUFBUTtFQUNWLElBQ0E7SUFDRSxPQUFPO0lBQ1AsUUFBUTtFQUNWO0FBRUosT0FBSSxHQUFBLFlBQUFTLGFBQVksZ0JBQWdCLFdBQzlCLFFBQ0Usb0JBQUEsbUJBQUFLLE9BQUMsR0FBQSxZQUFBQyxlQUFXO0lBQUUsT0FBTSxHQUFBLFlBQUFDLE1BQUs7SUFBUyxRQUFPLEdBQUEsWUFBQVAsYUFBWTs7TUFDbkQsb0JBQUEsbUJBQUFELE1BQUMsR0FBQSxZQUFBTyxjQUFhLE1BQUk7UUFDaEIsT0FBTTtRQUNOLFNBQVMsaUNBQWlDLGlCQUFBOztNQUUzQyxNQUFNLFVBQ0wsb0JBQUEsbUJBQUFQLE1BQUMsR0FBQSxZQUFBTyxjQUFhLE1BQUk7UUFDaEIsT0FBTyxNQUFNO1FBQ2IsU0FBUyxpQ0FBaUMsaUJBQUE7V0FFMUM7TUFDSixvQkFBQSxtQkFBQVAsTUFBQyxHQUFBLFlBQUFPLGNBQWEsV0FBUyxDQUFBLENBQUE7TUFDdkIsb0JBQUEsbUJBQUFQLE1BQUMsR0FBQSxZQUFBTyxjQUFhLE1BQUk7UUFBQyxPQUFPLE9BQU87UUFBTyxVQUFVLE9BQU0sR0FBQSxZQUFBRSxNQUFLLE9BQU8sTUFBTTs7OztBQUtoRixTQUNFLG9CQUFBLG1CQUFBVCxNQUFDLEdBQUEsWUFBQVUsT0FBRztjQUNGLG9CQUFBLG1CQUFBVixNQUFDLEdBQUEsWUFBQVUsTUFBSyxXQUFTO01BQ2IsTUFBTTtRQUNKLFFBQVE7VUFDTixPQUFPO1VBQ1AsTUFBTTtRQUNSO01BQ0Y7TUFDQSxPQUFNO01BQ04sYUFBYSxHQUNYLE1BQU0sVUFBVSxNQUFNLFVBQVUsT0FBTyxFQUFBLGlDQUNSLGlCQUFBO01BQ2pDLFNBQ0Usb0JBQUEsbUJBQUFWLE1BQUMsR0FBQSxZQUFBVyxjQUFVO2tCQUNULG9CQUFBLG1CQUFBWCxNQUFDLEdBQUEsWUFBQVksUUFBTyxNQUFJO1VBQUUsR0FBRzs7Ozs7QUFNN0I7QVN4SU8sU0FBUywwQ0FDZCxLQUNBLFNBZUM7QUFFRCxNQUFJO0FBSUYsVUFBTSxXQUFXLENBQUNDLFNBQUE7QUFDaEIsVUFBSSxDQUFDQSxLQUFJLFdBQVcsTUFBQSxFQUNsQixRQUFPLFdBQVdBLElBQUE7QUFFcEIsYUFBT0E7SUFDVDtBQUVBLFVBQU0sU0FBUyxPQUFPLFFBQVEsV0FBVyxLQUFJLEdBQUEsZ0JBQUFDLEtBQUksU0FBUyxHQUFBLENBQUEsSUFBUTtBQUNsRSxVQUFNLFdBQVcsT0FBTztBQUV4QixVQUFNLGtCQUNILFFBQVEsSUFBSSxvQkFBNEI7QUFFM0MsWUFBUSxpQkFBQTtNQUNOLEtBQUs7QUFDSCxlQUFPO1VBQ0wsUUFBUSxTQUFTLGFBQVksR0FBQSxZQUFBQyxNQUFLO1VBQ2xDLE1BQU0sU0FBUztRQUNqQjtNQUNGLEtBQUs7QUFFSCxlQUFPO1VBQ0wsUUFBUSxTQUFTLGFBQVksR0FBQSxZQUFBQSxNQUFLO1VBQ2xDLE1BQU0sU0FBUztRQUNqQjtNQUNGLEtBQUs7TUFDTCxLQUFLO0FBQ0gsZUFBTztVQUNMLFFBQVEsb0NBQW9DLFFBQUE7VUFDNUMsVUFBVSxTQUFTLGFBQVksR0FBQSxZQUFBQSxNQUFLO1VBQ3BDLE1BQU0sU0FBUztRQUNqQjtNQUNGLEtBQUs7QUFDSCxlQUFPO1VBQ0wsUUFBUSx5Q0FBeUMsU0FBUyxRQUFRLEVBQUEsV0FBYSxRQUFBO1VBQy9FLFVBQVUsU0FBUyxhQUFZLEdBQUEsWUFBQUEsTUFBSztVQUNwQyxNQUFNLFNBQVM7UUFDakI7TUFDRixLQUFLO01BQ0wsS0FBSztNQUNMO0FBQ0UsZUFBTztVQUNMLFFBQVEsa0NBQWtDLFFBQUEsU0FBaUIsU0FBUyxRQUFRLEVBQUE7VUFDNUUsVUFBVSxTQUFTLGFBQVksR0FBQSxZQUFBQSxNQUFLO1VBQ3BDLE1BQU0sU0FBUztRQUNqQjtJQUNKO0VBQ0YsU0FBUyxHQUFHO0FBQ1YsWUFBUSxNQUFNLENBQUE7QUFDZCxZQUFPLEdBQUEsWUFBQUEsTUFBSztFQUNkO0FBQ0Y7QVFqQk8sZUFBZSwwQ0FDcEIsUUFDQSxlQUtBLFNBRUM7QUFFRCxNQUFJLFFBQVEsYUFBYSxTQUN2QixPQUFNLElBQUksTUFBTSx3Q0FBQTtBQUdsQixRQUFNLEVBQUEscUJBQXFCLFVBQVUsU0FBVyxHQUFHLFlBQUEsSUFBZ0IsTUFBTSxRQUFRLGFBQUEsSUFDN0UsV0FBVyxDQUFDLElBQ1osaUJBQWlCLENBQUM7QUFFdEIsUUFBTSxrQkFBa0Isd0JBQXdCLFFBQVEsQ0FBQSxJQUFLO0lBQUM7O0FBQzlELE1BQUksYUFBYSxhQUNmLGlCQUFnQixLQUFLLE1BQU0sWUFBQTtBQUU3QixNQUFJLE1BQU0sUUFBUSxhQUFBLEVBQ2hCLGlCQUFnQixLQUFLLEtBQUEsR0FBUSxhQUFBO0FBRy9CLFFBQU0sV0FBVSxHQUFBLDBCQUFBQyxTQUFhLE1BQU0sYUFBYSxpQkFBaUI7SUFDL0QsR0FBRztJQUNILEtBQUs7TUFBRSxNQUFNO0lBQStDO0VBQzlELENBQUE7QUFDQSxRQUFNLGtCQUFpQixHQUFBLDJDQUFrQixTQUFTO0lBQUUsU0FBUyxXQUFXO0VBQU0sQ0FBQTtBQUU5RSxVQUFRLE1BQU0sSUFBSSxNQUFBO0FBRWxCLFFBQU0sQ0FBQyxFQUFBLE9BQU8sVUFBVSxRQUFRLFNBQVUsR0FBSSxjQUFjLFlBQUEsSUFBZ0IsT0FBTSxHQUFBLDJDQUNoRixTQUNBO0lBQUUsVUFBVTtFQUFPLEdBQ25CLGNBQUE7QUFFRixRQUFNLFVBQVMsR0FBQSwwQ0FBYTtJQUFFLG1CQUFtQjtFQUFLLEdBQUcsWUFBQTtBQUN6RCxRQUFNLFVBQVMsR0FBQSwwQ0FBYTtJQUFFLG1CQUFtQjtFQUFLLEdBQUcsWUFBQTtBQUV6RCxVQUFPLEdBQUEsMkNBQWU7Ozs7Ozs7SUFPcEIsU0FBUzs7SUFFVCxhQUFhLElBQUksTUFBQTtFQUNuQixDQUFBO0FBQ0Y7OztBdEMxSEEsSUFBTSxlQUFlLENBQUMsWUFBb0IsVUFBb0I7QUFDNUQsU0FBTyxNQUFNLElBQUksQ0FBQyxNQUFNLElBQUksVUFBVSxpQkFBaUIsQ0FBQyxTQUFTLFVBQVUsZUFBZSxDQUFDLEtBQUssRUFBRSxLQUFLLE9BQU87QUFDaEg7QUFFQSxJQUFNLGtCQUFrQixDQUFDLE9BQWUsWUFBb0IsVUFDMUQ7QUFBQTtBQUFBO0FBQUEsd0JBR3NCLFVBQVU7QUFBQSxhQUNyQixLQUFLO0FBQUEsY0FDSixhQUFhLE9BQU8sS0FBSyxDQUFDO0FBQUEsaUJBQ3ZCLFVBQVU7QUFFcEIsU0FBUyxpQkFBaUIsVUFBMEIsT0FBOEM7QUFDdkcsUUFBTSxDQUFDLGtCQUFrQixtQkFBbUIsUUFBSSx3QkFBdUQsQ0FBQyxDQUFDO0FBQ3pHLFFBQU0sQ0FBQyxxQkFBcUIsc0JBQXNCLFFBQUksd0JBQWlCLENBQUM7QUFDeEUsUUFBTSxDQUFDLFFBQVEsU0FBUyxRQUFJLHdCQUFpQixpQkFBaUIsU0FBUyxDQUFDLEVBQUUsRUFBRSxDQUFDO0FBRTdFLFFBQU0sUUFBUSxRQUFRLE1BQU0sS0FBSyxFQUFFLE1BQU0sR0FBRyxJQUFJLENBQUMsRUFBRTtBQUNuRCxRQUFNLGVBQWUsZ0JBQWdCLFFBQVEsbUJBQW1CLEtBQUs7QUFFckUsUUFBTSxFQUFFLE1BQU0sV0FBVyxnQkFBZ0IsV0FBVyxJQUFJLDBDQUFxQixRQUFRLFlBQVk7QUFFakcsK0JBQVUsTUFBTTtBQUNkLFFBQUksUUFBUSxVQUFhLENBQUMsV0FBVztBQUNuQyxZQUFNLGVBQWUsRUFBRSxHQUFHLGlCQUFpQjtBQUMzQyxtQkFBYSxTQUFTLG1CQUFtQixFQUFFLEVBQUUsSUFBSTtBQUFBLFFBQy9DO0FBQUEsUUFDQTtBQUFBLFFBQ0EsV0FBVztBQUFBLFFBQ1g7QUFBQSxRQUNBLFNBQVMsU0FBUyxtQkFBbUI7QUFBQSxNQUN2QztBQUNBLDBCQUFvQixZQUFZO0FBRWhDLFVBQ0Usc0JBQXNCLFNBQVMsU0FBUyxTQUN4QyxzQkFBVyxpQkFBaUIsU0FBUyxzQkFBc0IsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxHQUNqRTtBQUNBLGtCQUFVLGlCQUFpQixTQUFTLHNCQUFzQixDQUFDLEVBQUUsRUFBRSxDQUFDO0FBQ2hFLCtCQUF1QixzQkFBc0IsQ0FBQztBQUFBLE1BQ2hEO0FBQUEsSUFDRjtBQUFBLEVBQ0YsR0FBRyxDQUFDLE1BQU0sUUFBUSxTQUFTLENBQUM7QUFFNUIsK0JBQVUsTUFBTTtBQUNkLGVBQVc7QUFBQSxFQUNiLEdBQUcsQ0FBQyxtQkFBbUIsQ0FBQztBQUV4QixTQUFPLE9BQU8sT0FBTyxnQkFBZ0I7QUFDdkM7OztBeUN4REEsSUFBQUMsZ0JBQXlCO0FBQ3pCLElBQUFDLGNBQXNEO0FBQ3RELDJCQUF5QjtBQUV6QixnQkFBcUI7QUFxQ1QsSUFBQUMsc0JBQUE7QUFqQ0wsSUFBTSxjQUFzQixNQUFNO0FBQ3ZDLE1BQUk7QUFDRixlQUFPLCtCQUFTLGlCQUFpQixFQUFFLFVBQVUsT0FBTyxDQUFDLEVBQUUsS0FBSztBQUFBLEVBQzlELFFBQVE7QUFDTixlQUFPLGdCQUFLLEVBQUUsQ0FBQyxFQUFFLE1BQU0sU0FBUyxPQUFPLElBQUksa0JBQWtCO0FBQUEsRUFDL0Q7QUFDRixHQUFHOzs7QUNkSCxJQUFBQyxjQUF5QztBQU1oQyxJQUFBQyxzQkFBQTs7O0FDTFQsSUFBQUMsY0FBZ0Y7OztBQ0FoRixJQUFBQyxjQUFnRTtBQUdoRSxJQUFBQyx3QkFBcUI7QUFzQ3JCLGVBQXNCLHlCQUF5QjtBQUFBLEVBQzdDO0FBQUEsRUFDQTtBQUFBLEVBQ0E7QUFDRixHQUlrQjtBQUNoQixNQUFJO0FBQ0YsVUFBTSxFQUFFLGVBQUFDLGVBQWMsUUFBSSxpQ0FBaUM7QUFFM0QsVUFBTSxZQUFZLENBQUMsWUFBK0I7QUFDaEQsWUFBTUMsUUFBaUIsQ0FBQztBQUN4QixVQUFJLFNBQVM7QUFDWCxRQUFBQSxNQUFLLEtBQUssdUJBQXVCLE9BQU8sRUFBRTtBQUFBLE1BQzVDO0FBQ0EsYUFBT0E7QUFBQSxJQUNUO0FBRUEsUUFBSSxPQUFpQixDQUFDO0FBQ3RCLFlBQVEsa0JBQWtCO0FBQUEsTUFDeEI7QUFDRSxlQUFPLFVBQVU7QUFDakI7QUFBQSxNQUNGO0FBQ0UsZUFBTyxVQUFVLGNBQWM7QUFDL0I7QUFBQSxNQUNGO0FBRUUsZUFBTyxVQUFVLGNBQWM7QUFDL0I7QUFBQSxJQUNKO0FBRUEsVUFBTSxhQUFhLEtBQUssSUFBSSxDQUFDLFFBQVEsSUFBSSxHQUFHLEdBQUcsRUFBRSxLQUFLLEdBQUc7QUFDekQsVUFBTSxhQUFhLEtBQUssSUFBSSxDQUFDLFFBQVEsSUFBSSxHQUFHLEdBQUcsRUFBRSxLQUFLLEdBQUc7QUFDekQsVUFBTSxVQUFVLGFBQWFELGNBQWEsWUFBWSxVQUFVLElBQUksVUFBVTtBQUU5RSxVQUFNLElBQUksUUFBUSxDQUFDLFNBQVMsV0FBVztBQUNyQyxzQ0FBSyxTQUFTLENBQUMsVUFBVTtBQUN2QixZQUFJLE9BQU87QUFDVCxpQkFBTyxLQUFLO0FBQUEsUUFDZCxPQUFPO0FBQ0wsMkNBQWdCLEVBQUUsaUJBQWlCLEtBQUssQ0FBQztBQUN6QyxrQkFBUSxJQUFJO0FBQUEsUUFDZDtBQUFBLE1BQ0YsQ0FBQztBQUFBLElBQ0gsQ0FBQztBQUFBLEVBQ0gsU0FBUyxHQUFHO0FBQ1YsWUFBUSxNQUFNLENBQUM7QUFDZixVQUFNLDBDQUFpQixnQ0FBZ0M7QUFBQSxNQUNyRCxTQUFTLGFBQWEsUUFBUSxFQUFFLFVBQVUsT0FBTyxDQUFDO0FBQUEsSUFDcEQsQ0FBQztBQUFBLEVBQ0g7QUFDRjtBQUVBLGVBQXNCLFdBQVc7QUFBQSxFQUMvQjtBQUFBLEVBQ0E7QUFBQSxFQUNBO0FBQUEsRUFDQTtBQUFBLEVBQ0E7QUFBQSxFQUNBO0FBQUEsRUFDQTtBQUNGLEdBUThCO0FBQzVCLGFBQVcsTUFBTTtBQUNmLCtCQUFVLEVBQUUsZ0JBQWdCLEtBQUssQ0FBQztBQUFBLEVBQ3BDLEdBQUcsR0FBSTtBQUNQLFFBQU0sWUFBWSxNQUFNLGtCQUFrQjtBQUMxQyxNQUFJLFdBQVc7QUFDYixxQ0FBZ0IsRUFBRSxpQkFBaUIsS0FBSyxDQUFDO0FBQUEsRUFDM0M7QUFFQSxRQUFNLEVBQUUsZUFBQUEsZUFBYyxRQUFJLGlDQUFpQztBQUMzRCxRQUFNLFlBQVksTUFBTSxNQUFNLFFBQVEsbUNBQW1DLG1CQUFtQixLQUFLLENBQUMsS0FBSztBQUd2RyxRQUFNLGtCQUFrQixDQUFDRSxhQUErQztBQUN0RSxXQUFPLElBQUksUUFBUSxDQUFDLFNBQVMsV0FBVztBQUN0QyxzQ0FBS0EsVUFBUyxDQUFDLFVBQVU7QUFDdkIsWUFBSSxPQUFPO0FBQ1QsaUJBQU8sS0FBSztBQUFBLFFBQ2QsT0FBTztBQUNMLGtCQUFRLElBQUk7QUFBQSxRQUNkO0FBQUEsTUFDRixDQUFDO0FBQUEsSUFDSCxDQUFDO0FBQUEsRUFDSDtBQUdBLFFBQU0sWUFBWSxDQUFDLFlBQStCO0FBQ2hELFVBQU1ELFFBQWlCLENBQUM7QUFDeEIsUUFBSSxTQUFTO0FBQ1gsTUFBQUEsTUFBSyxLQUFLLHVCQUF1QixPQUFPLEVBQUU7QUFBQSxJQUM1QztBQUNBLFFBQUksV0FBVztBQUNiLE1BQUFBLE1BQUssS0FBSyxjQUFjO0FBQUEsSUFDMUI7QUFDQSxRQUFJLFdBQVc7QUFDYixNQUFBQSxNQUFLLEtBQUssYUFBYTtBQUFBLElBQ3pCO0FBQ0EsUUFBSSxXQUFXO0FBQ2IsTUFBQUEsTUFBSyxLQUFLLFNBQVM7QUFBQSxJQUNyQjtBQUNBLFdBQU9BO0FBQUEsRUFDVDtBQUVBLE1BQUksT0FBaUIsQ0FBQztBQUV0QixVQUFRLGtCQUFrQjtBQUFBLElBQ3hCO0FBQ0UsYUFBTyxVQUFVO0FBQ2pCO0FBQUEsSUFDRjtBQUNFLGFBQU8sVUFBVSxjQUFjO0FBQy9CO0FBQUEsSUFDRjtBQUNFLGFBQU8sVUFBVSxlQUFlO0FBQ2hDO0FBQUEsRUFDSjtBQUVBLFFBQU0sYUFBYSxLQUFLLElBQUksQ0FBQyxRQUFRLElBQUksR0FBRyxHQUFHLEVBQUUsS0FBSyxHQUFHO0FBQ3pELFFBQU0sVUFBVSxhQUFhRCxjQUFhLFlBQVksVUFBVTtBQUVoRSxTQUFPLGdCQUFnQixPQUFPO0FBQ2hDO0FBRUEsZUFBc0IsU0FBUyxVQUFpQztBQUM5RCxRQUFNLEVBQUUsZUFBQUEsZUFBYyxRQUFJLGlDQUFpQztBQUMzRCxRQUFNLDBDQUFlLHFCQUFxQkEsY0FBYTtBQUFBO0FBQUEsbUJBRXRDLFFBQVE7QUFBQTtBQUFBLFdBRWhCO0FBQ1g7QUFFQSxlQUFzQixhQUFhLEtBQXlCO0FBQzFELFFBQU0sRUFBRSxlQUFBQSxlQUFjLFFBQUksaUNBQWlDO0FBQzNELFFBQU0sMENBQWU7QUFBQSx3QkFDQ0EsY0FBYTtBQUFBO0FBQUEsNkJBRVIsSUFBSSxZQUFZLG1CQUFtQixJQUFJLFlBQVk7QUFBQSx3Q0FDeEMsSUFBSSxZQUFZLG1CQUFtQixJQUFJLFFBQVE7QUFBQTtBQUFBO0FBQUEsR0FHcEY7QUFDSDtBQUVBLElBQU0sb0JBQW9CLFlBQThCO0FBQ3RELFFBQU0sRUFBRSxlQUFBQSxlQUFjLFFBQUksaUNBQWlDO0FBRTNELFFBQU0sZUFBZSxNQUFNLDBDQUFlO0FBQUE7QUFBQTtBQUFBLDJEQUdlQSxjQUFhO0FBQUE7QUFBQTtBQUFBO0FBQUEsbUJBSXJEO0FBQ2pCLE1BQUksaUJBQWlCLFNBQVM7QUFDNUIsVUFBTSxJQUFJLE1BQU0scUJBQXFCO0FBQUEsRUFDdkM7QUFDQSxTQUFPO0FBQ1Q7QUFFQSxlQUFzQixrQkFBa0IsTUFBNkI7QUFDbkUsUUFBTSxFQUFFLGVBQUFBLGVBQWMsUUFBSSxpQ0FBaUM7QUFFM0QsTUFBSTtBQUNGLFVBQU0sY0FBYyxtQkFBbUIsSUFBSTtBQUkzQyxVQUFNLGNBQWMsWUFDakIsUUFBUSxPQUFPLE1BQU0sRUFDckIsUUFBUSxNQUFNLEtBQUssRUFDbkIsUUFBUSxPQUFPLEtBQUssRUFDcEIsUUFBUSxPQUFPLEtBQUssRUFDcEIsUUFBUSxPQUFPLEtBQUssRUFDcEIsUUFBUSxTQUFTLEtBQUssRUFDdEIsUUFBUSxPQUFPLEtBQUs7QUFFdkIsVUFBTSxTQUFTO0FBQUEsMEJBQ09BLGNBQWE7QUFBQTtBQUFBO0FBQUEsZ0NBR1AsV0FBVztBQUFBO0FBQUE7QUFBQTtBQUl2QyxVQUFNLDBDQUFlLE1BQU07QUFDM0IsY0FBTSw2QkFBZ0I7QUFBQSxFQUN4QixTQUFTLEdBQUc7QUFDVixZQUFRLE1BQU0sQ0FBQztBQUNmLFFBQUksYUFBYSxTQUFTLEVBQUUsUUFBUSxTQUFTLG9DQUFvQyxHQUFHO0FBQ2xGLFlBQU0sMENBQWlCLDBFQUEwRTtBQUFBLElBQ25HLE9BQU87QUFDTCxZQUFNLDBDQUFpQiw2QkFBNkI7QUFBQSxRQUNsRCxTQUFTLGFBQWEsUUFBUSxFQUFFLFVBQVUsT0FBTyxDQUFDO0FBQUEsTUFDcEQsQ0FBQztBQUFBLElBQ0g7QUFBQSxFQUNGO0FBQ0Y7OztBRHhPTSxJQUFBRyxzQkFBQTtBQWJDLElBQU0sZUFBTixNQUFtQjtBQUFBLEVBQ3hCLE9BQWMsU0FBUztBQUFBLEVBQ3ZCLE9BQWMsVUFBVTtBQUFBLEVBQ3hCLE9BQWMsYUFBYTtBQUFBLEVBQzNCLE9BQWMsMkJBQTJCO0FBQzNDO0FBRUEsU0FBUywrQkFBK0IsT0FBNEM7QUFDbEYsUUFBTSxFQUFFLGlCQUFpQixRQUFJLGlDQUFpQztBQUM5RCxRQUFNLENBQUMsY0FBYyxJQUFJLDBDQUFlLG1CQUFtQix3QkFBd0I7QUFFbkYsU0FDRSw2Q0FBQywyQkFBWSxPQUFNLGdDQUNqQjtBQUFBLElBQUM7QUFBQTtBQUFBLE1BQ0MsT0FBTTtBQUFBLE1BQ04sVUFBVSxNQUNSLHlCQUF5QjtBQUFBLFFBQ3ZCLE1BQU0sTUFBTTtBQUFBLFFBQ1o7QUFBQSxRQUNBO0FBQUEsTUFDRixDQUFDO0FBQUE7QUFBQSxFQUVMLEdBQ0Y7QUFFSjtBQUVBLFNBQVMsY0FBYyxFQUFFLE9BQU8sVUFBVSxHQUEwRDtBQUNsRyxRQUFNLEVBQUUsaUJBQWlCLFFBQUksaUNBQWlDO0FBQzlELFFBQU0sQ0FBQyxjQUFjLElBQUksMENBQWUsbUJBQW1CLHdCQUF3QjtBQUVuRixTQUNFLDZDQUFDLDJCQUFZLE9BQU0sV0FDakI7QUFBQSxJQUFDO0FBQUE7QUFBQSxNQUNDLFVBQVUsTUFBTSxXQUFXLEVBQUUsT0FBTyxnQkFBZ0Isa0JBQWtCLFVBQVUsQ0FBQztBQUFBLE1BQ2pGLE9BQU8sUUFBUSxXQUFXLEtBQUssTUFBTTtBQUFBLE1BQ3JDLE1BQU0saUJBQUs7QUFBQTtBQUFBLEVBQ2IsR0FDRjtBQUVKO0FBRUEsU0FBUyxtQkFBbUIsRUFBRSxJQUFJLEdBQWlCO0FBQ2pELFFBQU0sRUFBRSxpQkFBaUIsUUFBSSxpQ0FBaUM7QUFDOUQsUUFBTSxDQUFDLGNBQWMsSUFBSSwwQ0FBZSxtQkFBbUIsd0JBQXdCO0FBRW5GLFNBQ0UsOENBQUMsMkJBQVksT0FBTyxJQUFJLE9BQ3RCO0FBQUEsaURBQUMsV0FBUSxLQUFVO0FBQUEsSUFDbkI7QUFBQSxNQUFDO0FBQUE7QUFBQSxRQUNDLE9BQU07QUFBQSxRQUNOLE1BQU0saUJBQUs7QUFBQSxRQUNYLFVBQVUsWUFBWTtBQUNwQixnQkFBTSxTQUFTLElBQUksUUFBUTtBQUMzQixnQkFBTSxXQUFXLEVBQUUsS0FBSyxJQUFJLEtBQUssZ0JBQWdCLGtCQUFrQixXQUFXLEtBQUssQ0FBQztBQUFBLFFBQ3RGO0FBQUE7QUFBQSxJQUNGO0FBQUEsSUFDQTtBQUFBLE1BQUM7QUFBQTtBQUFBLFFBQ0MsT0FBTTtBQUFBLFFBQ04sTUFBTSxpQkFBSztBQUFBLFFBQ1gsVUFBVSxZQUFZO0FBQ3BCLGdCQUFNLFNBQVMsSUFBSSxRQUFRO0FBQzNCLGdCQUFNLFdBQVcsRUFBRSxLQUFLLElBQUksS0FBSyxnQkFBZ0Isa0JBQWtCLFdBQVcsS0FBSyxDQUFDO0FBQUEsUUFDdEY7QUFBQTtBQUFBLElBQ0Y7QUFBQSxJQUNBLDZDQUFDLG1CQUFPLGlCQUFQLEVBQXVCLE9BQU0sWUFBVyxTQUFTLElBQUksS0FBSztBQUFBLEtBQzdEO0FBRUo7QUFFQSxTQUFTLG1CQUFtQjtBQUFBLEVBQzFCO0FBQUEsRUFDQTtBQUFBLEVBQ0EsU0FBUztBQUNYLEdBSWlCO0FBQ2YsUUFBTSxFQUFFLGlCQUFpQixRQUFJLGlDQUFpQztBQUM5RCxRQUFNLENBQUMsY0FBYyxJQUFJLDBDQUFlLG1CQUFtQix3QkFBd0I7QUFFbkYsTUFBSSxJQUFJLFdBQVcsYUFBYSxHQUFHO0FBQ2pDLFVBQU0sT0FBTyxJQUFJLFVBQVUsY0FBYyxNQUFNO0FBQy9DLFdBQ0UsOENBQUMsMkJBQVksT0FDWDtBQUFBLG1EQUFDLHNCQUFPLFVBQVUsTUFBTSxrQkFBa0IsSUFBSSxHQUFHLE1BQU0saUJBQUssTUFBTSxPQUFNLG1CQUFrQjtBQUFBLE1BQzFGLDZDQUFDLG1CQUFPLGlCQUFQLEVBQXVCLE9BQU0sYUFBWSxTQUFTLE1BQU0sVUFBVSxFQUFFLFdBQVcsQ0FBQyxLQUFLLEdBQUcsS0FBSyxJQUFJLEdBQUc7QUFBQSxPQUN2RztBQUFBLEVBRUo7QUFFQSxTQUNFLDhDQUFDLDJCQUFZLE9BQ1g7QUFBQTtBQUFBLE1BQUM7QUFBQTtBQUFBLFFBQ0MsVUFBVSxZQUFZLE1BQU0sV0FBVyxFQUFFLEtBQUssaUJBQWlCLGdCQUFnQixpQkFBaUIsQ0FBQztBQUFBLFFBQ2pHLE1BQU0saUJBQUs7QUFBQSxRQUNYLE9BQU07QUFBQTtBQUFBLElBQ1I7QUFBQSxJQUNBO0FBQUEsTUFBQztBQUFBO0FBQUEsUUFDQyxPQUFNO0FBQUEsUUFDTixNQUFNLGlCQUFLO0FBQUEsUUFDWCxVQUFVLFlBQ1IsTUFBTSxXQUFXLEVBQUUsS0FBSyxpQkFBaUIsZ0JBQWdCLGtCQUFrQixXQUFXLEtBQUssQ0FBQztBQUFBO0FBQUEsSUFFaEc7QUFBQSxJQUNBO0FBQUEsTUFBQztBQUFBO0FBQUEsUUFDQyxPQUFNO0FBQUEsUUFDTixNQUFNLGlCQUFLO0FBQUEsUUFDWCxVQUFVLFlBQ1IsTUFBTSxXQUFXLEVBQUUsS0FBSyxpQkFBaUIsZ0JBQWdCLGtCQUFrQixXQUFXLEtBQUssQ0FBQztBQUFBO0FBQUEsSUFFaEc7QUFBQSxJQUNBLDhDQUFDLHdCQUFZLFNBQVosRUFBb0IsT0FBTyxtQkFDMUI7QUFBQTtBQUFBLFFBQUM7QUFBQTtBQUFBLFVBQ0MsVUFBVSxNQUNSLFdBQVc7QUFBQSxZQUNUO0FBQUEsWUFDQTtBQUFBLFlBQ0E7QUFBQSxZQUNBO0FBQUEsVUFDRixDQUFDO0FBQUEsVUFFSCxPQUFPO0FBQUE7QUFBQSxNQUNUO0FBQUEsTUFDQTtBQUFBLFFBQUM7QUFBQTtBQUFBLFVBQ0MsVUFBVSxNQUNSLFdBQVc7QUFBQSxZQUNUO0FBQUEsWUFDQTtBQUFBLFlBQ0E7QUFBQSxZQUNBO0FBQUEsVUFDRixDQUFDO0FBQUEsVUFFSCxPQUFPO0FBQUE7QUFBQSxNQUNUO0FBQUEsT0FDRjtBQUFBLElBQ0EsNkNBQUMsbUJBQU8saUJBQVAsRUFBdUIsT0FBTSxZQUFXLFNBQVMsS0FBSyxVQUFVLEVBQUUsV0FBVyxDQUFDLEtBQUssR0FBRyxLQUFLLElBQUksR0FBRztBQUFBLEtBQ3JHO0FBRUo7QUFFQSxTQUFTLFFBQVEsT0FBcUI7QUFDcEMsaUJBQWUsZUFBZTtBQUM1QixRQUFJO0FBQ0YsWUFBTSxhQUFhLE1BQU0sR0FBRztBQUM1QixnQkFBTSw2QkFBZ0I7QUFBQSxJQUN4QixRQUFRO0FBQ04sWUFBTSwwQ0FBaUIsd0JBQXdCO0FBQUEsUUFDN0MsU0FBUztBQUFBLE1BQ1gsQ0FBQztBQUFBLElBQ0g7QUFBQSxFQUNGO0FBRUEsU0FBTyw2Q0FBQyx3QkFBWSxNQUFaLEVBQWlCLE9BQU0sWUFBVyxNQUFNLEVBQUUsUUFBUSxpQkFBSyxJQUFJLEdBQUcsVUFBVSxjQUFjO0FBQ2hHOzs7QUUvSkEsSUFBQUMsY0FBMkI7QUEyQ1osSUFBQUMsc0JBQUE7QUF4Q1IsSUFBTSxpQkFBTixNQUFxQjtBQUFBLEVBQzFCLE9BQWMsVUFBVTtBQUFBLEVBQ3hCLE9BQWMsYUFBYTtBQUFBLEVBQzNCLE9BQWMsaUJBQWlCO0FBQ2pDO0FBRUEsU0FBUyxlQUFlLEtBQXNCO0FBQzVDLE1BQUk7QUFDRixVQUFNLFNBQVMsSUFBSSxJQUFJLEdBQUc7QUFDMUIsV0FBTyxPQUFPLGFBQWEsV0FBVyxPQUFPLGFBQWE7QUFBQSxFQUM1RCxRQUFRO0FBQ04sV0FBTztBQUFBLEVBQ1Q7QUFDRjtBQUVBLFNBQVMsZUFBZSxLQUF1QjtBQUM3QyxNQUFJO0FBQ0YsVUFBTSxTQUFTLElBQUksSUFBSSxHQUFHO0FBRTFCLFVBQU0sWUFBWSxPQUFPLFNBQVMsUUFBUSxRQUFRLEVBQUUsRUFBRSxNQUFNLEdBQUc7QUFDL0QsVUFBTSxZQUFZLE9BQU8sU0FBUyxNQUFNLEdBQUcsRUFBRSxPQUFPLENBQUMsTUFBTSxFQUFFLFNBQVMsQ0FBQztBQUN2RSxXQUFPLENBQUMsR0FBRyxXQUFXLEdBQUcsV0FBVyxPQUFPLFVBQVUsR0FBRztBQUFBLEVBQzFELFFBQVE7QUFDTixXQUFPLENBQUMsR0FBRztBQUFBLEVBQ2I7QUFDRjtBQUNBLFNBQVMsbUJBQW1CO0FBQUEsRUFDMUI7QUFBQSxFQUNBLE9BQU8sRUFBRSxNQUFNLFVBQVUsR0FBRztBQUM5QixHQUdpQjtBQUNmLFFBQU0sT0FBTyxTQUFTLE9BQU8sQ0FBQyxNQUFNLEVBQUUsU0FBUyxLQUFLLEVBQUUsSUFBSSxDQUFDLE1BQU0sRUFBRSxHQUFHO0FBQ3RFLFNBQ0U7QUFBQSxJQUFDLGlCQUFLO0FBQUEsSUFBTDtBQUFBLE1BQ0MsSUFBSSxHQUFHLE9BQU8sSUFBSSxFQUFFO0FBQUEsTUFDcEIsT0FBTztBQUFBLE1BQ1AsVUFBVSxHQUFHLEtBQUssTUFBTTtBQUFBLE1BQ3hCLE1BQU0saUJBQUs7QUFBQSxNQUNYLFNBQVMsNkNBQUMsYUFBYSwwQkFBYixFQUFzQyxNQUF3QixTQUFrQjtBQUFBO0FBQUEsRUFDNUY7QUFFSjtBQUVBLFNBQVMsWUFBWSxFQUFFLFNBQVMsT0FBTyxFQUFFLEtBQUssT0FBTyxHQUFHLEVBQUUsR0FBMkQ7QUFDbkgsU0FDRTtBQUFBLElBQUMsaUJBQUs7QUFBQSxJQUFMO0FBQUEsTUFDQyxJQUFJLEdBQUcsT0FBTyxJQUFJLEVBQUU7QUFBQSxNQUNwQjtBQUFBLE1BQ0EsVUFBVTtBQUFBLE1BQ1YsVUFBVSxlQUFlLEdBQUc7QUFBQSxNQUM1QixNQUFNLGVBQWUsR0FBRyxJQUFJLDBDQUFXLEdBQUcsSUFBSSxpQkFBSztBQUFBLE1BQ25ELFNBQVMsNkNBQUMsYUFBYSxZQUFiLEVBQXdCLE9BQWMsS0FBVSxTQUFrQjtBQUFBO0FBQUEsRUFDOUU7QUFFSjtBQUVBLFNBQVMsWUFBWSxPQUFrRDtBQUNyRSxTQUNFO0FBQUEsSUFBQyxpQkFBSztBQUFBLElBQUw7QUFBQSxNQUNDLE9BQU8sTUFBTSxJQUFJO0FBQUEsTUFDakIsVUFBVSxNQUFNLElBQUksaUJBQWlCO0FBQUEsTUFDckMsVUFBVSxlQUFlLE1BQU0sSUFBSSxHQUFHO0FBQUEsTUFDdEMsU0FBUyw2Q0FBQyxhQUFhLFNBQWIsRUFBcUIsS0FBSyxNQUFNLEtBQUs7QUFBQSxNQUMvQyxNQUFNLE1BQU0scUJBQXFCLE1BQU0sSUFBSSxVQUFVLE1BQU0sSUFBSSxjQUFjO0FBQUE7QUFBQSxFQUMvRTtBQUVKOzs7QUMxRUEsSUFBQUMsY0FBcUI7QUFDckIsSUFBQUMsZ0JBQTBCO0FBRTFCLElBQUFDLGFBQXFDO0FBb0Q3QixJQUFBQyxzQkFBQTtBQTNDUixlQUFlLG9CQUE2QztBQUMxRCxRQUFNQyxRQUFPLGtCQUFrQjtBQUMvQixNQUFJLEtBQUMsdUJBQVdBLEtBQUksR0FBRztBQUNyQixXQUFPLENBQUMsRUFBRSxNQUFNLFdBQVcsSUFBSSxVQUFVLENBQUM7QUFBQSxFQUM1QztBQUVBLFFBQU0sYUFBYSxNQUFNLG9CQUFTLFNBQVNBLE9BQU0sT0FBTztBQUN4RCxRQUFNLFdBQVcsS0FBSyxNQUFNLFVBQVUsRUFBRSxRQUFRO0FBQ2hELFNBQU8sT0FBTyxRQUEwQixRQUFRLEVBQUUsSUFBSSxDQUFDLENBQUMsS0FBSyxHQUFHLE9BQU87QUFBQSxJQUNyRSxNQUFNLElBQUk7QUFBQSxJQUNWLElBQUk7QUFBQSxFQUNOLEVBQUU7QUFDSjtBQUVlLFNBQVIscUJBQXNDLEVBQUUsa0JBQWtCLEdBQVU7QUFDekUsUUFBTSxDQUFDLGlCQUFpQixrQkFBa0IsSUFBSSwwQ0FBdUIsbUJBQW1CLHdCQUF3QjtBQUNoSCxRQUFNLENBQUMsVUFBVSxXQUFXLElBQUksMENBQStCLG9CQUFvQjtBQUFBLElBQ2pGLEVBQUUsTUFBTSxXQUFXLElBQUkseUJBQXlCO0FBQUEsRUFDbEQsQ0FBQztBQUNELFFBQU0sRUFBRSxNQUFNLGVBQWUsSUFBSSwwQ0FBaUIsaUJBQWlCO0FBRW5FLCtCQUFVLE1BQU07QUFDZCxRQUFJLGdCQUFnQjtBQUNsQixrQkFBWSxjQUFjO0FBQzFCLFVBQUksQ0FBQyxpQkFBaUI7QUFDcEIsMkJBQW1CLFNBQVMsQ0FBQyxFQUFFLEVBQUU7QUFBQSxNQUNuQztBQUFBLElBQ0Y7QUFBQSxFQUNGLEdBQUcsQ0FBQyxjQUFjLENBQUM7QUFFbkIsK0JBQVUsTUFBTTtBQUNkLFFBQUksaUJBQWlCO0FBQ25CLDBCQUFvQixlQUFlO0FBQUEsSUFDckM7QUFBQSxFQUNGLEdBQUcsQ0FBQyxlQUFlLENBQUM7QUFFcEIsTUFBSSxDQUFDLFlBQVksU0FBUyxTQUFTLEdBQUc7QUFDcEMsV0FBTztBQUFBLEVBQ1Q7QUFFQSxTQUNFLDZDQUFDLGlCQUFLLFVBQUwsRUFBYyxTQUFRLHdCQUF1QixPQUFPLGlCQUFpQixVQUFVLG9CQUM3RSxtQkFBUyxJQUFJLENBQUMsWUFDYiw2Q0FBQyxpQkFBSyxTQUFTLE1BQWQsRUFBb0MsT0FBTyxRQUFRLElBQUksT0FBTyxRQUFRLFFBQTlDLFFBQVEsRUFBNEMsQ0FDOUUsR0FDSDtBQUVKOzs7QS9DakJxQyxJQUFBQyxzQkFBQTtBQWpDckMsSUFBTSxlQUFlLENBQUMsZUFDcEIsYUFDSSxXQUFXLE9BQU8sQ0FBQyxLQUFLLFFBQVE7QUFDOUIsUUFBTSxRQUFRLElBQUksS0FBSyxJQUFJLFdBQVcsRUFBRSxtQkFBbUIsUUFBVztBQUFBLElBQ3BFLFNBQVM7QUFBQSxJQUNULE1BQU07QUFBQSxJQUNOLE9BQU87QUFBQSxJQUNQLEtBQUs7QUFBQSxFQUNQLENBQUM7QUFDRCxRQUFNQyxnQkFBZSxJQUFJLElBQUksS0FBSyxLQUFLLENBQUM7QUFDeEMsRUFBQUEsY0FBYSxLQUFLLEdBQUc7QUFDckIsTUFBSSxJQUFJLE9BQU9BLGFBQVk7QUFDM0IsU0FBTztBQUNULEdBQUcsb0JBQUksSUFBNEIsQ0FBQyxJQUNwQyxvQkFBSSxJQUE0QjtBQUV2QixTQUFSLFVBQXlDO0FBQzlDLFFBQU0sQ0FBQyxZQUFZLGFBQWEsUUFBSSx3QkFBaUI7QUFDckQsUUFBTSxDQUFDLFFBQVEsSUFBSSwwQ0FBK0Isb0JBQW9CO0FBQUEsSUFDcEUsRUFBRSxNQUFNLFdBQVcsSUFBSSx5QkFBeUI7QUFBQSxFQUNsRCxDQUFDO0FBQ0QsUUFBTSxDQUFDLE9BQU8sSUFBSSwwQ0FBdUIsbUJBQW1CLHdCQUF3QjtBQUNwRixRQUFNLFlBQVksaUJBQWlCLFVBQVUsVUFBVTtBQUV2RCwrQkFBVSxNQUFNO0FBQ2QsUUFBSSxVQUFVLENBQUMsR0FBRztBQUNoQixnQkFBVSxDQUFDLEVBQUUsYUFBYSxPQUFPO0FBQUEsSUFDbkM7QUFBQSxFQUNGLEdBQUcsQ0FBQyxPQUFPLENBQUM7QUFFWixRQUFNLGlCQUFpQixVQUFVLFNBQVMsVUFBVSxLQUFLLENBQUMsTUFBTSxFQUFFLFFBQVEsTUFBTSxPQUFPLElBQUk7QUFFM0YsTUFBSSxDQUFDLGdCQUFnQjtBQUNuQixXQUFPLDZDQUFDLG9CQUFLLG9CQUFvQiw2Q0FBQyx3QkFBcUIsR0FBSTtBQUFBLEVBQzdEO0FBRUEsTUFBSSxlQUFlLFdBQVc7QUFDNUIsV0FBTyxlQUFlO0FBQUEsRUFDeEI7QUFFQSxRQUFNLGlCQUFpQixhQUFhLGVBQWUsSUFBSTtBQUN2RCxRQUFNLFNBQVMsTUFBTSxLQUFLLGVBQWUsS0FBSyxDQUFDO0FBRS9DLFNBQ0U7QUFBQSxJQUFDO0FBQUE7QUFBQSxNQUNDLG9CQUFvQjtBQUFBLE1BQ3BCLFdBQVcsZUFBZTtBQUFBLE1BQzFCLFVBQVU7QUFBQSxNQUNWLG9CQUFvQiw2Q0FBQyx3QkFBcUI7QUFBQSxNQUV6QyxrQkFBUSxJQUFJLENBQUMsVUFDWiw2Q0FBQyxpQkFBSyxTQUFMLEVBQWEsT0FBTyxPQUNsQiwwQkFBZ0IsSUFBSSxLQUFLLEdBQUcsSUFBSSxDQUFDLE1BQ2hDLDZDQUFDLGVBQWUsWUFBZixFQUEwQixPQUFPLEdBQWMsV0FBTixFQUFFLEVBQXNCLENBQ25FLEtBSDhCLEtBSWpDLENBQ0Q7QUFBQTtBQUFBLEVBQ0g7QUFFSjsiLAogICJuYW1lcyI6IFsiaW1wb3J0X2FwaSIsICJpbXBvcnRfcmVhY3QiLCAicGF0aCIsICJpbXBvcnRfcmVhY3QiLCAiJGhnVVcxJHVzZVJlZiIsICIkaGdVVzEkdXNlTWVtbyIsICIkaGdVVzEkc2hvd1RvYXN0IiwgIiRoZ1VXMSRUb2FzdCIsICIkaGdVVzEkcmVhZEZpbGVTeW5jIiwgIiRoZ1VXMSRqb2luIiwgIiRoZ1VXMSRlbnZpcm9ubWVudCIsICIkaGdVVzEkQ2xpcGJvYXJkIiwgIiRoZ1VXMSRvcGVuIiwgIiRoZ1VXMSR1c2VTdGF0ZSIsICIkaGdVVzEkdXNlQ2FsbGJhY2siLCAiYXJncyIsICIkaGdVVzEkTGF1bmNoVHlwZSIsICJvcHRpb25zIiwgIiRoZ1VXMSR1c2VFZmZlY3QiLCAiJGhnVVcxJG5vZGVjcnlwdG8iLCAiJGhnVVcxJENhY2hlIiwgIiRoZ1VXMSR1c2VTeW5jRXh0ZXJuYWxTdG9yZSIsICJwYWdpbmF0aW9uIiwgIiRoZ1VXMSRub2Rlc3RyZWFtIiwgIiRoZ1VXMSRjb25zdGFudHMiLCAiJGhnVVcxJHByb21pc2lmeSIsICIkaGdVVzEkZXhpc3RzU3luYyIsICJtb2R1bGUiLCAiJGhnVVcxJG5vZGVwYXRoIiwgIiRoZ1VXMSRub2Rlb3MiLCAiJGhnVVcxJG1rZGlyIiwgIiRoZ1VXMSRjb3B5RmlsZSIsICIkaGdVVzEkd3JpdGVGaWxlIiwgIiRoZ1VXMSRub2RlY2hpbGRfcHJvY2VzcyIsICIkaGdVVzEkdXNlU3RhdGUiLCAiJGhnVVcxJHVzZVJlZiIsICIkaGdVVzEkdXNlQ2FsbGJhY2siLCAiJGhnVVcxJGpzeCIsICIkaGdVVzEkZW52aXJvbm1lbnQiLCAiJGhnVVcxJExhdW5jaFR5cGUiLCAiJGhnVVcxJHVzZU1lbW8iLCAiZGF0YWJhc2VQYXRoIiwgInF1ZXJ5IiwgIiRoZ1VXMSRqc3hzIiwgIiRoZ1VXMSRNZW51QmFyRXh0cmEiLCAiJGhnVVcxJEljb24iLCAiJGhnVVcxJG9wZW4iLCAiJGhnVVcxJExpc3QiLCAiJGhnVVcxJEFjdGlvblBhbmVsIiwgIiRoZ1VXMSRBY3Rpb24iLCAidXJsIiwgIiRoZ1VXMSRVUkwiLCAiJGhnVVcxJEljb24iLCAiJGhnVVcxJG5vZGVjaGlsZF9wcm9jZXNzIiwgImltcG9ydF9yZWFjdCIsICJpbXBvcnRfYXBpIiwgImltcG9ydF9qc3hfcnVudGltZSIsICJpbXBvcnRfYXBpIiwgImltcG9ydF9qc3hfcnVudGltZSIsICJpbXBvcnRfYXBpIiwgImltcG9ydF9hcGkiLCAiaW1wb3J0X2NoaWxkX3Byb2Nlc3MiLCAiYnJvd3Nlck9wdGlvbiIsICJhcmdzIiwgImNvbW1hbmQiLCAiaW1wb3J0X2pzeF9ydW50aW1lIiwgImltcG9ydF9hcGkiLCAiaW1wb3J0X2pzeF9ydW50aW1lIiwgImltcG9ydF9hcGkiLCAiaW1wb3J0X3JlYWN0IiwgImltcG9ydF9mcyIsICJpbXBvcnRfanN4X3J1bnRpbWUiLCAicGF0aCIsICJpbXBvcnRfanN4X3J1bnRpbWUiLCAiZ3JvdXBFbnRyaWVzIl0KfQo=
