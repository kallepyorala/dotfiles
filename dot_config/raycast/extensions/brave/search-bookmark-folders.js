"use strict";
var __create = Object.create;
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __getProtoOf = Object.getPrototypeOf;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toESM = (mod, isNodeMode, target) => (target = mod != null ? __create(__getProtoOf(mod)) : {}, __copyProps(
  // If the importer is in node compatibility mode or this is not an ESM
  // file that has been converted to a CommonJS file using a Babel-
  // compatible transform (i.e. "__esModule" has not been set), then set
  // "default" to the CommonJS "module.exports" for node compatibility.
  isNodeMode || !mod || !mod.__esModule ? __defProp(target, "default", { value: mod, enumerable: true }) : target,
  mod
));
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/search-bookmark-folders.tsx
var search_bookmark_folders_exports = {};
__export(search_bookmark_folders_exports, {
  default: () => Command
});
module.exports = __toCommonJS(search_bookmark_folders_exports);
var import_api8 = require("@raycast/api");

// node_modules/@raycast/utils/dist/module.js
var import_react = __toESM(require("react"));
var import_api = require("@raycast/api");
var import_node_fs = __toESM(require("node:fs"));
var import_node_path = __toESM(require("node:path"));
var import_node_child_process = __toESM(require("node:child_process"));
var import_node_buffer = require("node:buffer");
var import_node_stream = __toESM(require("node:stream"));
var import_node_util = require("node:util");
var import_jsx_runtime = require("react/jsx-runtime");
var import_node_url = require("node:url");
var $parcel$global = globalThis;
function $bfcf6ee368b3bd9f$export$d4b699e2c1148419(value) {
  const ref = (0, import_react.useRef)(value);
  ref.current = value;
  return ref;
}
function $c718fd03aba6111c$export$80e5033e369189f3(error, options) {
  const message = error instanceof Error ? error.message : String(error);
  return (0, import_api.showToast)({
    style: (0, import_api.Toast).Style.Failure,
    title: options?.title ?? "Something went wrong",
    message: options?.message ?? message,
    primaryAction: options?.primaryAction ?? $c718fd03aba6111c$var$handleErrorToastAction(error),
    secondaryAction: options?.primaryAction ? $c718fd03aba6111c$var$handleErrorToastAction(error) : void 0
  });
}
var $c718fd03aba6111c$var$handleErrorToastAction = (error) => {
  let privateExtension = true;
  let title = "[Extension Name]...";
  let extensionURL = "";
  try {
    const packageJSON = JSON.parse((0, import_node_fs.readFileSync)((0, import_node_path.join)((0, import_api.environment).assetsPath, "..", "package.json"), "utf8"));
    title = `[${packageJSON.title}]...`;
    extensionURL = `https://raycast.com/${packageJSON.owner || packageJSON.author}/${packageJSON.name}`;
    if (!packageJSON.owner || packageJSON.access === "public") privateExtension = false;
  } catch (err) {
  }
  const fallback = (0, import_api.environment).isDevelopment || privateExtension;
  const stack = error instanceof Error ? error?.stack || error?.message || "" : String(error);
  return {
    title: fallback ? "Copy Logs" : "Report Error",
    onAction(toast) {
      toast.hide();
      if (fallback) (0, import_api.Clipboard).copy(stack);
      else (0, import_api.open)(`https://github.com/raycast/extensions/issues/new?&labels=extension%2Cbug&template=extension_bug_report.yml&title=${encodeURIComponent(title)}&extension-url=${encodeURI(extensionURL)}&description=${encodeURIComponent(`#### Error:
\`\`\`
${stack}
\`\`\`
`)}`);
    }
  };
};
function $e2e1ea6dd3b7d2e1$export$b644b65666fe0c18(key, _value) {
  const value = this[key];
  if (value instanceof Date) return `__raycast_cached_date__${value.toISOString()}`;
  if (Buffer.isBuffer(value)) return `__raycast_cached_buffer__${value.toString("base64")}`;
  return _value;
}
function $e2e1ea6dd3b7d2e1$export$63698c10df99509c(_key, value) {
  if (typeof value === "string" && value.startsWith("__raycast_cached_date__")) return new Date(value.replace("__raycast_cached_date__", ""));
  if (typeof value === "string" && value.startsWith("__raycast_cached_buffer__")) return Buffer.from(value.replace("__raycast_cached_buffer__", ""), "base64");
  return value;
}
var $c40d7eded38ca69c$var$rootCache = /* @__PURE__ */ Symbol("cache without namespace");
var $c40d7eded38ca69c$var$cacheMap = /* @__PURE__ */ new Map();
function $c40d7eded38ca69c$export$14afb9e4c16377d3(key, initialState, config) {
  const cacheKey = config?.cacheNamespace || $c40d7eded38ca69c$var$rootCache;
  const cache = $c40d7eded38ca69c$var$cacheMap.get(cacheKey) || $c40d7eded38ca69c$var$cacheMap.set(cacheKey, new (0, import_api.Cache)({
    namespace: config?.cacheNamespace
  })).get(cacheKey);
  if (!cache) throw new Error("Missing cache");
  const keyRef = (0, $bfcf6ee368b3bd9f$export$d4b699e2c1148419)(key);
  const initialValueRef = (0, $bfcf6ee368b3bd9f$export$d4b699e2c1148419)(initialState);
  const cachedState = (0, import_react.useSyncExternalStore)(cache.subscribe, () => {
    try {
      return cache.get(keyRef.current);
    } catch (error) {
      console.error("Could not get Cache data:", error);
      return void 0;
    }
  });
  const state = (0, import_react.useMemo)(() => {
    if (typeof cachedState !== "undefined") {
      if (cachedState === "undefined") return void 0;
      try {
        return JSON.parse(cachedState, (0, $e2e1ea6dd3b7d2e1$export$63698c10df99509c));
      } catch (err) {
        console.warn("The cached data is corrupted", err);
        return initialValueRef.current;
      }
    } else return initialValueRef.current;
  }, [
    cachedState,
    initialValueRef
  ]);
  const stateRef = (0, $bfcf6ee368b3bd9f$export$d4b699e2c1148419)(state);
  const setStateAndCache = (0, import_react.useCallback)((updater) => {
    const newValue = typeof updater === "function" ? updater(stateRef.current) : updater;
    if (typeof newValue === "undefined") cache.set(keyRef.current, "undefined");
    else {
      const stringifiedValue = JSON.stringify(newValue, (0, $e2e1ea6dd3b7d2e1$export$b644b65666fe0c18));
      cache.set(keyRef.current, stringifiedValue);
    }
    return newValue;
  }, [
    cache,
    keyRef,
    stateRef
  ]);
  return [
    state,
    setStateAndCache
  ];
}
var $e6272883088c6834$var$processOk = (process1) => !!process1 && typeof process1 === "object" && typeof process1.removeListener === "function" && typeof process1.emit === "function" && typeof process1.reallyExit === "function" && typeof process1.listeners === "function" && typeof process1.kill === "function" && typeof process1.pid === "number" && typeof process1.on === "function";
var $e6272883088c6834$var$kExitEmitter = /* @__PURE__ */ Symbol.for("signal-exit emitter");
var $e6272883088c6834$var$Emitter = class {
  constructor() {
    this.emitted = {
      afterExit: false,
      exit: false
    };
    this.listeners = {
      afterExit: [],
      exit: []
    };
    this.count = 0;
    this.id = Math.random();
    if ($parcel$global[$e6272883088c6834$var$kExitEmitter])
      return $parcel$global[$e6272883088c6834$var$kExitEmitter];
    Object.defineProperty($parcel$global, $e6272883088c6834$var$kExitEmitter, {
      value: this,
      writable: false,
      enumerable: false,
      configurable: false
    });
  }
  on(ev, fn) {
    this.listeners[ev].push(fn);
  }
  removeListener(ev, fn) {
    const list = this.listeners[ev];
    const i = list.indexOf(fn);
    if (i === -1) return;
    if (i === 0 && list.length === 1) list.length = 0;
    else list.splice(i, 1);
  }
  emit(ev, code, signal) {
    if (this.emitted[ev]) return false;
    this.emitted[ev] = true;
    let ret = false;
    for (const fn of this.listeners[ev]) ret = fn(code, signal) === true || ret;
    if (ev === "exit") ret = this.emit("afterExit", code, signal) || ret;
    return ret;
  }
};
var $e6272883088c6834$var$SignalExitFallback = class {
  onExit() {
    return () => {
    };
  }
  load() {
  }
  unload() {
  }
};
var $e6272883088c6834$var$SignalExit = class {
  // "SIGHUP" throws an `ENOSYS` error on Windows,
  // so use a supported signal instead
  /* c8 ignore start */
  // @ts-ignore
  #hupSig;
  /* c8 ignore stop */
  #emitter;
  #process;
  #originalProcessEmit;
  #originalProcessReallyExit;
  #sigListeners;
  #loaded;
  #signals;
  constructor(process1) {
    this.#hupSig = process.platform === "win32" ? "SIGINT" : "SIGHUP";
    this.#emitter = new $e6272883088c6834$var$Emitter();
    this.#sigListeners = {};
    this.#loaded = false;
    this.#signals = [];
    this.#signals.push("SIGHUP", "SIGINT", "SIGTERM");
    if (globalThis.process.platform !== "win32") this.#signals.push("SIGALRM", "SIGABRT", "SIGVTALRM", "SIGXCPU", "SIGXFSZ", "SIGUSR2", "SIGTRAP", "SIGSYS", "SIGQUIT", "SIGIOT");
    if (globalThis.process.platform === "linux") this.#signals.push("SIGIO", "SIGPOLL", "SIGPWR", "SIGSTKFLT");
    this.#process = process1;
    this.#sigListeners = {};
    for (const sig of this.#signals)
      this.#sigListeners[sig] = () => {
        const listeners = this.#process.listeners(sig);
        let { count } = this.#emitter;
        const p = process1;
        if (typeof p.__signal_exit_emitter__ === "object" && typeof p.__signal_exit_emitter__.count === "number") count += p.__signal_exit_emitter__.count;
        if (listeners.length === count) {
          this.unload();
          const ret = this.#emitter.emit("exit", null, sig);
          const s = sig === "SIGHUP" ? this.#hupSig : sig;
          if (!ret) process1.kill(process1.pid, s);
        }
      };
    this.#originalProcessReallyExit = process1.reallyExit;
    this.#originalProcessEmit = process1.emit;
  }
  onExit(cb, opts) {
    if (!$e6272883088c6834$var$processOk(this.#process)) return () => {
    };
    if (this.#loaded === false) this.load();
    const ev = opts?.alwaysLast ? "afterExit" : "exit";
    this.#emitter.on(ev, cb);
    return () => {
      this.#emitter.removeListener(ev, cb);
      if (this.#emitter.listeners["exit"].length === 0 && this.#emitter.listeners["afterExit"].length === 0) this.unload();
    };
  }
  load() {
    if (this.#loaded) return;
    this.#loaded = true;
    this.#emitter.count += 1;
    for (const sig of this.#signals) try {
      const fn = this.#sigListeners[sig];
      if (fn) this.#process.on(sig, fn);
    } catch (_) {
    }
    this.#process.emit = (ev, ...a) => {
      return this.#processEmit(ev, ...a);
    };
    this.#process.reallyExit = (code) => {
      return this.#processReallyExit(code);
    };
  }
  unload() {
    if (!this.#loaded) return;
    this.#loaded = false;
    this.#signals.forEach((sig) => {
      const listener = this.#sigListeners[sig];
      if (!listener) throw new Error("Listener not defined for signal: " + sig);
      try {
        this.#process.removeListener(sig, listener);
      } catch (_) {
      }
    });
    this.#process.emit = this.#originalProcessEmit;
    this.#process.reallyExit = this.#originalProcessReallyExit;
    this.#emitter.count -= 1;
  }
  #processReallyExit(code) {
    if (!$e6272883088c6834$var$processOk(this.#process)) return 0;
    this.#process.exitCode = code || 0;
    this.#emitter.emit("exit", this.#process.exitCode, null);
    return this.#originalProcessReallyExit.call(this.#process, this.#process.exitCode);
  }
  #processEmit(ev, ...args) {
    const og = this.#originalProcessEmit;
    if (ev === "exit" && $e6272883088c6834$var$processOk(this.#process)) {
      if (typeof args[0] === "number") this.#process.exitCode = args[0];
      const ret = og.call(this.#process, ev, ...args);
      this.#emitter.emit("exit", this.#process.exitCode, null);
      return ret;
    } else return og.call(this.#process, ev, ...args);
  }
};
var $e6272883088c6834$var$signalExit = null;
var $e6272883088c6834$export$47a57ed64c292d4f = (cb, opts) => {
  if (!$e6272883088c6834$var$signalExit) $e6272883088c6834$var$signalExit = $e6272883088c6834$var$processOk(process) ? new $e6272883088c6834$var$SignalExit(process) : new $e6272883088c6834$var$SignalExitFallback();
  return $e6272883088c6834$var$signalExit.onExit(cb, opts);
};
function $c86e3701e284ece4$export$6e3a9b5342d42997(spawned, { timeout } = {}) {
  const spawnedPromise = new Promise((resolve, reject) => {
    spawned.on("exit", (exitCode, signal) => {
      resolve({
        exitCode,
        signal,
        timedOut: false
      });
    });
    spawned.on("error", (error) => {
      reject(error);
    });
    if (spawned.stdin) spawned.stdin.on("error", (error) => {
      reject(error);
    });
  });
  const removeExitHandler = (0, $e6272883088c6834$export$47a57ed64c292d4f)(() => {
    spawned.kill();
  });
  if (timeout === 0 || timeout === void 0) return spawnedPromise.finally(() => removeExitHandler());
  let timeoutId;
  const timeoutPromise = new Promise((_resolve, reject) => {
    timeoutId = setTimeout(() => {
      spawned.kill("SIGTERM");
      reject(Object.assign(new Error("Timed out"), {
        timedOut: true,
        signal: "SIGTERM"
      }));
    }, timeout);
  });
  const safeSpawnedPromise = spawnedPromise.finally(() => {
    clearTimeout(timeoutId);
  });
  return Promise.race([
    timeoutPromise,
    safeSpawnedPromise
  ]).finally(() => removeExitHandler());
}
var $c86e3701e284ece4$var$MaxBufferError = class extends Error {
  constructor() {
    super("The output is too big");
    this.name = "MaxBufferError";
  }
};
function $c86e3701e284ece4$var$bufferStream(options) {
  const { encoding } = options;
  const isBuffer = encoding === "buffer";
  const stream = new (0, import_node_stream.default).PassThrough({
    objectMode: false
  });
  if (encoding && encoding !== "buffer") stream.setEncoding(encoding);
  let length = 0;
  const chunks = [];
  stream.on("data", (chunk) => {
    chunks.push(chunk);
    length += chunk.length;
  });
  stream.getBufferedValue = () => {
    return isBuffer ? Buffer.concat(chunks, length) : chunks.join("");
  };
  stream.getBufferedLength = () => length;
  return stream;
}
async function $c86e3701e284ece4$var$getStream(inputStream, options) {
  const stream = $c86e3701e284ece4$var$bufferStream(options);
  await new Promise((resolve, reject) => {
    const rejectPromise = (error) => {
      if (error && stream.getBufferedLength() <= (0, import_node_buffer.constants).MAX_LENGTH) error.bufferedData = stream.getBufferedValue();
      reject(error);
    };
    (async () => {
      try {
        await (0, import_node_util.promisify)((0, import_node_stream.default).pipeline)(inputStream, stream);
        resolve();
      } catch (error) {
        rejectPromise(error);
      }
    })();
    stream.on("data", () => {
      if (stream.getBufferedLength() > 8e7) rejectPromise(new $c86e3701e284ece4$var$MaxBufferError());
    });
  });
  return stream.getBufferedValue();
}
async function $c86e3701e284ece4$var$getBufferedData(stream, streamPromise) {
  stream.destroy();
  try {
    return await streamPromise;
  } catch (error) {
    return error.bufferedData;
  }
}
async function $c86e3701e284ece4$export$67b768ac9e1c70fa({ stdout, stderr }, { encoding }, processDone) {
  const stdoutPromise = $c86e3701e284ece4$var$getStream(stdout, {
    encoding
  });
  const stderrPromise = $c86e3701e284ece4$var$getStream(stderr, {
    encoding
  });
  try {
    return await Promise.all([
      processDone,
      stdoutPromise,
      stderrPromise
    ]);
  } catch (error) {
    return Promise.all([
      {
        error,
        exitCode: null,
        signal: error.signal,
        timedOut: error.timedOut || false
      },
      $c86e3701e284ece4$var$getBufferedData(stdout, stdoutPromise),
      $c86e3701e284ece4$var$getBufferedData(stderr, stderrPromise)
    ]);
  }
}
function $c86e3701e284ece4$var$stripFinalNewline(input) {
  const LF = typeof input === "string" ? "\n" : "\n".charCodeAt(0);
  const CR = typeof input === "string" ? "\r" : "\r".charCodeAt(0);
  if (input[input.length - 1] === LF)
    input = input.slice(0, -1);
  if (input[input.length - 1] === CR)
    input = input.slice(0, -1);
  return input;
}
function $c86e3701e284ece4$export$200978bbc0b73ca(options, value) {
  if (options.stripFinalNewline) return $c86e3701e284ece4$var$stripFinalNewline(value);
  return value;
}
function $c86e3701e284ece4$var$getErrorPrefix({ timedOut, timeout, signal, exitCode }) {
  if (timedOut) return `timed out after ${timeout} milliseconds`;
  if (signal !== void 0 && signal !== null) return `was killed with ${signal}`;
  if (exitCode !== void 0 && exitCode !== null) return `failed with exit code ${exitCode}`;
  return "failed";
}
function $c86e3701e284ece4$var$makeError({ stdout, stderr, error, signal, exitCode, command, timedOut, options, parentError }) {
  const prefix = $c86e3701e284ece4$var$getErrorPrefix({
    timedOut,
    timeout: options?.timeout,
    signal,
    exitCode
  });
  const execaMessage = `Command ${prefix}: ${command}`;
  const shortMessage = error ? `${execaMessage}
${error.message}` : execaMessage;
  const message = [
    shortMessage,
    stderr,
    stdout
  ].filter(Boolean).join("\n");
  if (error)
    error.originalMessage = error.message;
  else error = parentError;
  error.message = message;
  error.shortMessage = shortMessage;
  error.command = command;
  error.exitCode = exitCode;
  error.signal = signal;
  error.stdout = stdout;
  error.stderr = stderr;
  if ("bufferedData" in error) delete error["bufferedData"];
  return error;
}
function $c86e3701e284ece4$export$a8f5efe603803b77({ stdout, stderr, error, exitCode, signal, timedOut, command, options, parentError }) {
  if (error || exitCode !== 0 || signal !== null) {
    const returnedError = $c86e3701e284ece4$var$makeError({
      error,
      exitCode,
      signal,
      stdout,
      stderr,
      command,
      timedOut,
      options,
      parentError
    });
    throw returnedError;
  }
  return stdout;
}
function $d64c8f690cf3b07a$export$30c2a0095db95d06(url, options) {
  try {
    const sanitize = (url2) => {
      if (!url2.startsWith("http")) return `https://${url2}`;
      return url2;
    };
    const urlObj = typeof url === "string" ? new (0, import_node_url.URL)(sanitize(url)) : url;
    const hostname = urlObj.hostname;
    const faviconProvider = process.env.FAVICON_PROVIDER ?? "raycast";
    switch (faviconProvider) {
      case "none":
        return {
          source: options?.fallback ?? (0, import_api.Icon).Link,
          mask: options?.mask
        };
      case "apple":
        return {
          source: options?.fallback ?? (0, import_api.Icon).Link,
          mask: options?.mask
        };
      case "duckduckgo":
      case "duckDuckGo":
        return {
          source: `https://icons.duckduckgo.com/ip3/${hostname}.ico`,
          fallback: options?.fallback ?? (0, import_api.Icon).Link,
          mask: options?.mask
        };
      case "google":
        return {
          source: `https://www.google.com/s2/favicons?sz=${options?.size ?? 64}&domain=${hostname}`,
          fallback: options?.fallback ?? (0, import_api.Icon).Link,
          mask: options?.mask
        };
      case "legacy":
      case "raycast":
      default:
        return {
          source: `https://api.ray.so/favicon?url=${hostname}&size=${options?.size ?? 64}`,
          fallback: options?.fallback ?? (0, import_api.Icon).Link,
          mask: options?.mask
        };
    }
  } catch (e) {
    console.error(e);
    return (0, import_api.Icon).Link;
  }
}
async function $179449bbef1d262b$export$8982d27dc997624f(script, optionsOrArgs, options) {
  if (process.platform !== "darwin") throw new Error("AppleScript is only supported on macOS");
  const { humanReadableOutput, language, timeout, ...execOptions } = Array.isArray(optionsOrArgs) ? options || {} : optionsOrArgs || {};
  const outputArguments = humanReadableOutput !== false ? [] : [
    "-ss"
  ];
  if (language === "JavaScript") outputArguments.push("-l", "JavaScript");
  if (Array.isArray(optionsOrArgs)) outputArguments.push("-", ...optionsOrArgs);
  const spawned = (0, import_node_child_process.default).spawn("osascript", outputArguments, {
    ...execOptions,
    env: {
      PATH: "/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin"
    }
  });
  const spawnedPromise = (0, $c86e3701e284ece4$export$6e3a9b5342d42997)(spawned, {
    timeout: timeout ?? 1e4
  });
  spawned.stdin.end(script);
  const [{ error, exitCode, signal, timedOut }, stdoutResult, stderrResult] = await (0, $c86e3701e284ece4$export$67b768ac9e1c70fa)(spawned, {
    encoding: "utf8"
  }, spawnedPromise);
  const stdout = (0, $c86e3701e284ece4$export$200978bbc0b73ca)({
    stripFinalNewline: true
  }, stdoutResult);
  const stderr = (0, $c86e3701e284ece4$export$200978bbc0b73ca)({
    stripFinalNewline: true
  }, stderrResult);
  return (0, $c86e3701e284ece4$export$a8f5efe603803b77)({
    stdout,
    stderr,
    error,
    exitCode,
    signal,
    timedOut,
    command: "osascript",
    options,
    parentError: new Error()
  });
}

// src/components/BraveListItems.tsx
var import_api6 = require("@raycast/api");

// src/components/error/NotInstalledError.tsx
var import_react2 = require("react");
var import_api2 = require("@raycast/api");
var import_child_process = require("child_process");

// src/constants.ts
var defaultBraveProfilePath = ["Application Support", "BraveSoftware", "Brave-Browser"];
var defaultBraveBetaProfilePath = ["Application Support", "BraveSoftware", "Brave-Browser-Beta"];
var defaultBraveNightlyProfilePath = ["Application Support", "BraveSoftware", "Brave-Browser-Nightly"];
var DEFAULT_BRAVE_PROFILE_ID = "Default";
var BRAVE_PROFILE_KEY = "BRAVE_PROFILE_KEY";
var DownloadText = `
# \u{1F6A8}Error: Brave browser is not installed
## This extension depends on Brave browser. You must install it to continue.
  
If you have [Homebrew](https://brew.sh/) installed then press \u23CE (Enter Key) to install Brave browser.

[Click here](https://brave.com/download/) if you want to download manually.
  
[![Brave](https://brave.com/static-assets/images/brave-logo.svg)]()
`;
var UnknownErrorText = `
# \u{1F6A8}Error: Something happened while trying to run your command
  
[![Brave](https://brave.com/static-assets/images/brave-logo.svg)]()
`;
var DEFAULT_ERROR_TITLE = "An Error Occurred";
var NOT_INSTALLED_MESSAGE = "Brave not installed";

// src/components/error/NotInstalledError.tsx
var import_os = require("os");
var import_path = require("path");
var import_jsx_runtime2 = require("react/jsx-runtime");
var brewPrefix = (() => {
  try {
    return (0, import_child_process.execSync)("brew --prefix", { encoding: "utf8" }).trim();
  } catch {
    return (0, import_os.cpus)()[0].model.includes("Apple") ? "/opt/homebrew" : "/usr/local";
  }
})();
function brewExecutable() {
  return (0, import_path.join)(brewPrefix, "bin/brew");
}
function execBrew(cask) {
  try {
    return (0, import_child_process.execSync)(`${brewExecutable()} install --cask ${cask}`, { maxBuffer: 10 * 1024 * 1024 });
  } catch (err) {
    const execErr = err;
    if (execErr && execErr.code === 127) {
      execErr.stderr = `Brew executable not found at ${brewExecutable()}`;
      throw execErr;
    } else {
      throw err;
    }
  }
}
function NotInstalledError() {
  const [isLoading, setIsLoading] = (0, import_react2.useState)(true);
  return /* @__PURE__ */ (0, import_jsx_runtime2.jsx)(
    import_api2.Detail,
    {
      actions: /* @__PURE__ */ (0, import_jsx_runtime2.jsx)(import_api2.ActionPanel, { children: isLoading && /* @__PURE__ */ (0, import_jsx_runtime2.jsx)(
        import_api2.ActionPanel.Item,
        {
          title: "Install with Homebrew",
          onAction: async () => {
            if (!isLoading) return;
            const toast = new import_api2.Toast({ style: import_api2.Toast.Style.Animated, title: "Installing..." });
            await toast.show();
            try {
              execBrew("brave-browser");
              await toast.hide();
            } catch {
              await toast.hide();
              await (0, import_api2.showToast)(
                import_api2.Toast.Style.Failure,
                DEFAULT_ERROR_TITLE,
                "An unknown error occurred while trying to install"
              );
            }
            toast.title = "Installed! Please go back and try again.";
            toast.style = import_api2.Toast.Style.Success;
            await toast.show();
            setIsLoading(false);
          }
        }
      ) }),
      markdown: DownloadText
    }
  );
}

// src/components/error/UnknownError.tsx
var import_api3 = require("@raycast/api");
var import_jsx_runtime3 = require("react/jsx-runtime");
function UnknownError() {
  (0, import_api3.showToast)(import_api3.Toast.Style.Failure, DEFAULT_ERROR_TITLE, "Something happened while trying to run your command");
  return /* @__PURE__ */ (0, import_jsx_runtime3.jsx)(import_api3.Detail, { markdown: UnknownErrorText });
}

// src/components/BraveActions.tsx
var import_api5 = require("@raycast/api");

// src/actions/index.tsx
var import_api4 = require("@raycast/api");
var import_child_process2 = require("child_process");
async function openAllBookmarksInFolder({
  urls,
  profileCurrent,
  openTabInProfile
}) {
  try {
    const { browserOption: browserOption2 } = (0, import_api4.getPreferenceValues)();
    const buildArgs = (profile) => {
      const args2 = [];
      if (profile) {
        args2.push(`--profile-directory=${profile}`);
      }
      return args2;
    };
    let args = [];
    switch (openTabInProfile) {
      case "default" /* Default */:
        args = buildArgs();
        break;
      case "profile_current" /* ProfileCurrent */:
        args = buildArgs(profileCurrent);
        break;
      case "profile_original" /* ProfileOriginal */:
        args = buildArgs(profileCurrent);
        break;
    }
    const urlsString = urls.map((url) => `"${url}"`).join(" ");
    const argsString = args.map((arg) => `"${arg}"`).join(" ");
    const command = `open -na "${browserOption2}" --args ${argsString} ${urlsString}`;
    await new Promise((resolve, reject) => {
      (0, import_child_process2.exec)(command, (error) => {
        if (error) {
          reject(error);
        } else {
          (0, import_api4.closeMainWindow)({ clearRootSearch: true });
          resolve(true);
        }
      });
    });
  } catch (e) {
    console.error(e);
    await $c718fd03aba6111c$export$80e5033e369189f3("Could not open all bookmarks", {
      message: e instanceof Error ? e.message : String(e)
    });
  }
}
async function openNewTab({
  url,
  query,
  profileCurrent,
  profileOriginal,
  openTabInProfile,
  newWindow,
  incognito
}) {
  setTimeout(() => {
    (0, import_api4.popToRoot)({ clearSearchBar: true });
  }, 3e3);
  const installed = await checkAppInstalled();
  if (installed) {
    (0, import_api4.closeMainWindow)({ clearRootSearch: true });
  }
  const { browserOption: browserOption2 } = (0, import_api4.getPreferenceValues)();
  const targetUrl = url ? url : query ? `https://www.google.com/search?q=${encodeURIComponent(query)}` : "";
  const runShellCommand = (command2) => {
    return new Promise((resolve, reject) => {
      (0, import_child_process2.exec)(command2, (error) => {
        if (error) {
          reject(error);
        } else {
          resolve(true);
        }
      });
    });
  };
  const buildArgs = (profile) => {
    const args2 = [];
    if (profile) {
      args2.push(`--profile-directory=${profile}`);
    }
    if (newWindow) {
      args2.push("--new-window");
    }
    if (incognito) {
      args2.push("--incognito");
    }
    if (targetUrl) {
      args2.push(targetUrl);
    }
    return args2;
  };
  let args = [];
  switch (openTabInProfile) {
    case "default" /* Default */:
      args = buildArgs();
      break;
    case "profile_current" /* ProfileCurrent */:
      args = buildArgs(profileCurrent);
      break;
    case "profile_original" /* ProfileOriginal */:
      args = buildArgs(profileOriginal);
      break;
  }
  const argsString = args.map((arg) => `"${arg}"`).join(" ");
  const command = `open -na "${browserOption2}" --args ${argsString}`;
  return runShellCommand(command);
}
async function closeTab(tabIndex) {
  const { browserOption: browserOption2 } = (0, import_api4.getPreferenceValues)();
  await $179449bbef1d262b$export$8982d27dc997624f(`tell application "${browserOption2}}"
    tell window 1
      delete tab ${tabIndex}
    end tell
  end tell`);
}
async function setActiveTab(tab) {
  const { browserOption: browserOption2 } = (0, import_api4.getPreferenceValues)();
  await $179449bbef1d262b$export$8982d27dc997624f(`
    tell application "${browserOption2}"
      activate
      set index of window (${tab.windowsIndex} as number) to (${tab.windowsIndex} as number)
      set active tab index of window (${tab.windowsIndex} as number) to (${tab.tabIndex} as number)
    end tell
    return true
  `);
}
var checkAppInstalled = async () => {
  const { browserOption: browserOption2 } = (0, import_api4.getPreferenceValues)();
  const appInstalled = await $179449bbef1d262b$export$8982d27dc997624f(`
set isInstalled to false
try
    do shell script "osascript -e 'exists application \\"${browserOption2}\\"'"
    set isInstalled to true
end try

return isInstalled`);
  if (appInstalled === "false") {
    throw new Error(NOT_INSTALLED_MESSAGE);
  }
  return true;
};
async function executeJavascript(code) {
  const { browserOption: browserOption2 } = (0, import_api4.getPreferenceValues)();
  try {
    const decodedCode = decodeURIComponent(code);
    const escapedCode = decodedCode.replace(/\\/g, "\\\\").replace(/"/g, '\\"').replace(/\r/g, "\\r").replace(/\n/g, "\\n").replace(/\t/g, "\\t").replace(/[\b]/g, "\\b").replace(/\f/g, "\\f");
    const script = `
      tell application "${browserOption2}"
        activate
        tell active tab of front window
          execute javascript "${escapedCode}"
        end tell
      end tell
    `;
    await $179449bbef1d262b$export$8982d27dc997624f(script);
    await (0, import_api4.closeMainWindow)();
  } catch (e) {
    console.error(e);
    if (e instanceof Error && e.message.includes("Allow JavaScript from Apple Events")) {
      await $c718fd03aba6111c$export$80e5033e369189f3("Enable 'View > Developer > Allow JavaScript from Apple Events' in Brave.");
    } else {
      await $c718fd03aba6111c$export$80e5033e369189f3("Could not run bookmarklet", {
        message: e instanceof Error ? e.message : String(e)
      });
    }
  }
}

// src/components/BraveActions.tsx
var import_jsx_runtime4 = require("react/jsx-runtime");
var BraveActions = class {
  static NewTab = NewTabActions;
  static TabList = TabListItemActions;
  static TabHistory = HistoryItemActions;
  static OpenAllBookmarksInFolder = OpenAllBookmarksInFolderAction;
};
function OpenAllBookmarksInFolderAction(props) {
  const { openTabInProfile } = (0, import_api5.getPreferenceValues)();
  const [profileCurrent] = $c40d7eded38ca69c$export$14afb9e4c16377d3(BRAVE_PROFILE_KEY, DEFAULT_BRAVE_PROFILE_ID);
  return /* @__PURE__ */ (0, import_jsx_runtime4.jsx)(import_api5.ActionPanel, { title: "Open All Bookmarks In Folder", children: /* @__PURE__ */ (0, import_jsx_runtime4.jsx)(
    import_api5.Action,
    {
      title: "Open All Bookmarks in Folder",
      onAction: () => openAllBookmarksInFolder({
        urls: props.urls,
        profileCurrent,
        openTabInProfile
      })
    }
  ) });
}
function NewTabActions({ query, incognito }) {
  const { openTabInProfile } = (0, import_api5.getPreferenceValues)();
  const [profileCurrent] = $c40d7eded38ca69c$export$14afb9e4c16377d3(BRAVE_PROFILE_KEY, DEFAULT_BRAVE_PROFILE_ID);
  return /* @__PURE__ */ (0, import_jsx_runtime4.jsx)(import_api5.ActionPanel, { title: "New Tab", children: /* @__PURE__ */ (0, import_jsx_runtime4.jsx)(
    import_api5.Action,
    {
      onAction: () => openNewTab({ query, profileCurrent, openTabInProfile, incognito }),
      title: query ? `Search "${query}"` : "Open New Tab",
      icon: import_api5.Icon.Globe
    }
  ) });
}
function TabListItemActions({ tab }) {
  const { openTabInProfile } = (0, import_api5.getPreferenceValues)();
  const [profileCurrent] = $c40d7eded38ca69c$export$14afb9e4c16377d3(BRAVE_PROFILE_KEY, DEFAULT_BRAVE_PROFILE_ID);
  return /* @__PURE__ */ (0, import_jsx_runtime4.jsxs)(import_api5.ActionPanel, { title: tab.title, children: [
    /* @__PURE__ */ (0, import_jsx_runtime4.jsx)(GoToTab, { tab }),
    /* @__PURE__ */ (0, import_jsx_runtime4.jsx)(
      import_api5.Action,
      {
        title: "Move to New Window",
        icon: import_api5.Icon.Window,
        onAction: async () => {
          await closeTab(tab.tabIndex);
          await openNewTab({ url: tab.url, profileCurrent, openTabInProfile, newWindow: true });
        }
      }
    ),
    /* @__PURE__ */ (0, import_jsx_runtime4.jsx)(
      import_api5.Action,
      {
        title: "Move to Incognito Window",
        icon: import_api5.Icon.EyeDisabled,
        onAction: async () => {
          await closeTab(tab.tabIndex);
          await openNewTab({ url: tab.url, profileCurrent, openTabInProfile, incognito: true });
        }
      }
    ),
    /* @__PURE__ */ (0, import_jsx_runtime4.jsx)(import_api5.Action.CopyToClipboard, { title: "Copy URL", content: tab.url })
  ] });
}
function HistoryItemActions({
  title,
  url,
  profile: profileOriginal
}) {
  const { openTabInProfile } = (0, import_api5.getPreferenceValues)();
  const [profileCurrent] = $c40d7eded38ca69c$export$14afb9e4c16377d3(BRAVE_PROFILE_KEY, DEFAULT_BRAVE_PROFILE_ID);
  if (url.startsWith("javascript:")) {
    const code = url.substring("javascript:".length);
    return /* @__PURE__ */ (0, import_jsx_runtime4.jsxs)(import_api5.ActionPanel, { title, children: [
      /* @__PURE__ */ (0, import_jsx_runtime4.jsx)(import_api5.Action, { onAction: () => executeJavascript(code), icon: import_api5.Icon.Play, title: "Run Bookmarklet" }),
      /* @__PURE__ */ (0, import_jsx_runtime4.jsx)(import_api5.Action.CopyToClipboard, { title: "Copy Code", content: code, shortcut: { modifiers: ["cmd"], key: "c" } })
    ] });
  }
  return /* @__PURE__ */ (0, import_jsx_runtime4.jsxs)(import_api5.ActionPanel, { title, children: [
    /* @__PURE__ */ (0, import_jsx_runtime4.jsx)(
      import_api5.Action,
      {
        onAction: async () => await openNewTab({ url, profileOriginal, profileCurrent, openTabInProfile }),
        icon: import_api5.Icon.Eye,
        title: "Open"
      }
    ),
    /* @__PURE__ */ (0, import_jsx_runtime4.jsx)(
      import_api5.Action,
      {
        title: "Open in New Window",
        icon: import_api5.Icon.Window,
        onAction: async () => await openNewTab({ url, profileOriginal, profileCurrent, openTabInProfile, newWindow: true })
      }
    ),
    /* @__PURE__ */ (0, import_jsx_runtime4.jsx)(
      import_api5.Action,
      {
        title: "Open in Incognito Window",
        icon: import_api5.Icon.EyeDisabled,
        onAction: async () => await openNewTab({ url, profileOriginal, profileCurrent, openTabInProfile, incognito: true })
      }
    ),
    /* @__PURE__ */ (0, import_jsx_runtime4.jsxs)(import_api5.ActionPanel.Section, { title: "Open in profile", children: [
      /* @__PURE__ */ (0, import_jsx_runtime4.jsx)(
        import_api5.Action,
        {
          onAction: () => openNewTab({
            url,
            profileOriginal,
            profileCurrent,
            openTabInProfile: "profile_current" /* ProfileCurrent */
          }),
          title: "Open in Current Profile"
        }
      ),
      /* @__PURE__ */ (0, import_jsx_runtime4.jsx)(
        import_api5.Action,
        {
          onAction: () => openNewTab({
            url,
            profileOriginal,
            profileCurrent,
            openTabInProfile: "profile_original" /* ProfileOriginal */
          }),
          title: "Open in Original Profile"
        }
      )
    ] }),
    /* @__PURE__ */ (0, import_jsx_runtime4.jsx)(import_api5.Action.CopyToClipboard, { title: "Copy URL", content: url, shortcut: { modifiers: ["cmd"], key: "c" } })
  ] });
}
function GoToTab(props) {
  async function handleAction() {
    try {
      await setActiveTab(props.tab);
      await (0, import_api5.closeMainWindow)();
    } catch {
      await $c718fd03aba6111c$export$80e5033e369189f3("Tab no longer exists", {
        message: "The tab may have been closed. Try searching again."
      });
    }
  }
  return /* @__PURE__ */ (0, import_jsx_runtime4.jsx)(import_api5.ActionPanel.Item, { title: "Open Tab", icon: { source: import_api5.Icon.Eye }, onAction: handleAction });
}

// src/components/BraveListItems.tsx
var import_jsx_runtime5 = require("react/jsx-runtime");
var BraveListItems = class {
  static TabList = TabListItem;
  static TabHistory = HistoryItem;
  static BookmarkFolder = BookmarkFolderItem;
};
function isValidHttpUrl(url) {
  try {
    const parsed = new URL(url);
    return parsed.protocol === "http:" || parsed.protocol === "https:";
  } catch {
    return false;
  }
}
function getUrlKeywords(url) {
  try {
    const parsed = new URL(url);
    const hostParts = parsed.hostname.replace("www.", "").split(".");
    const pathParts = parsed.pathname.split("/").filter((p) => p.length > 0);
    return [...hostParts, ...pathParts, parsed.hostname, url];
  } catch {
    return [url];
  }
}
function BookmarkFolderItem({
  profile,
  entry: { name, children, id }
}) {
  const urls = children.filter((c) => c.type === "url").map((c) => c.url);
  return /* @__PURE__ */ (0, import_jsx_runtime5.jsx)(
    import_api6.List.Item,
    {
      id: `${profile}-${id}`,
      title: name,
      subtitle: `${urls.length} bookmarks`,
      icon: import_api6.Icon.Folder,
      actions: /* @__PURE__ */ (0, import_jsx_runtime5.jsx)(BraveActions.OpenAllBookmarksInFolder, { urls, profile })
    }
  );
}
function HistoryItem({ profile, entry: { url, title, id } }) {
  return /* @__PURE__ */ (0, import_jsx_runtime5.jsx)(
    import_api6.List.Item,
    {
      id: `${profile}-${id}`,
      title,
      subtitle: url,
      keywords: getUrlKeywords(url),
      icon: isValidHttpUrl(url) ? $d64c8f690cf3b07a$export$30c2a0095db95d06(url) : import_api6.Icon.Globe,
      actions: /* @__PURE__ */ (0, import_jsx_runtime5.jsx)(BraveActions.TabHistory, { title, url, profile })
    }
  );
}
function TabListItem(props) {
  return /* @__PURE__ */ (0, import_jsx_runtime5.jsx)(
    import_api6.List.Item,
    {
      title: props.tab.title,
      subtitle: props.tab.urlWithoutScheme(),
      keywords: getUrlKeywords(props.tab.url),
      actions: /* @__PURE__ */ (0, import_jsx_runtime5.jsx)(BraveActions.TabList, { tab: props.tab }),
      icon: props.useOriginalFavicon ? props.tab.favicon : props.tab.googleFavicon()
    }
  );
}

// src/hooks/useBookmarkFolderSearch.tsx
var import_fs = require("fs");

// src/util/index.ts
var import_path2 = __toESM(require("path"));
var import_api7 = require("@raycast/api");
var { browserOption } = (0, import_api7.getPreferenceValues)();
var prefProfile;
switch (browserOption) {
  case "Brave Browser Beta":
    prefProfile = defaultBraveBetaProfilePath;
    break;
  case "Brave Browser Nightly":
    prefProfile = defaultBraveNightlyProfilePath;
    break;
  default:
    prefProfile = defaultBraveProfilePath;
}
var userLibraryDirectoryPath = () => {
  if (!process.env.HOME) {
    throw new Error("$HOME environment variable is not set.");
  }
  return import_path2.default.join(process.env.HOME, "Library");
};
var getBookmarksFilePath = (profile) => import_path2.default.join(userLibraryDirectoryPath(), ...prefProfile, profile ?? DEFAULT_BRAVE_PROFILE_ID, "Bookmarks");

// src/hooks/useBookmarkFolderSearch.tsx
var import_react3 = require("react");
var import_jsx_runtime6 = require("react/jsx-runtime");
function extractBookmarkFolderFromBookmarkDirectory(bookmarkDirectory) {
  const bookmarks = [];
  if (bookmarkDirectory.type === "folder") {
    const urlCount = bookmarkDirectory.children.filter((child) => child.type === "url").length;
    if (urlCount > 1) {
      bookmarks.push({
        id: bookmarkDirectory.id,
        name: bookmarkDirectory.name,
        children: bookmarkDirectory.children
      });
    }
    bookmarkDirectory.children.forEach((child) => {
      bookmarks.push(...extractBookmarkFolderFromBookmarkDirectory(child));
    });
  }
  return bookmarks;
}
var extractBookmarkFolders = (rawBookmarks) => {
  const bookmarks = [];
  Object.keys(rawBookmarks.roots).forEach((rootKey) => {
    const rootLevelBookmarkFolders = rawBookmarks.roots[rootKey];
    const bookmarkEntries = extractBookmarkFolderFromBookmarkDirectory(rootLevelBookmarkFolders);
    bookmarks.push(...bookmarkEntries);
  });
  return bookmarks;
};
var getBookmarkFolders = async (profile) => {
  const bookmarksFilePath = getBookmarksFilePath(profile);
  if (!(0, import_fs.existsSync)(bookmarksFilePath)) {
    return [];
  }
  const fileBuffer = await import_fs.promises.readFile(bookmarksFilePath, { encoding: "utf-8" });
  return extractBookmarkFolders(JSON.parse(fileBuffer));
};
function useBookmarkFolderSearch() {
  const [profile] = $c40d7eded38ca69c$export$14afb9e4c16377d3(BRAVE_PROFILE_KEY, DEFAULT_BRAVE_PROFILE_ID);
  const [data, setData] = (0, import_react3.useState)([]);
  const [isLoading, setIsLoading] = (0, import_react3.useState)(true);
  const [errorView, setErrorView] = (0, import_react3.useState)();
  (0, import_react3.useEffect)(() => {
    getBookmarkFolders(profile).then((bookmarks) => {
      setData(bookmarks);
      setIsLoading(false);
    }).catch((e) => {
      if (e.message === NOT_INSTALLED_MESSAGE) {
        setErrorView(/* @__PURE__ */ (0, import_jsx_runtime6.jsx)(NotInstalledError, {}));
      } else {
        setErrorView(/* @__PURE__ */ (0, import_jsx_runtime6.jsx)(UnknownError, {}));
      }
      setIsLoading(false);
    });
  }, [profile]);
  return { errorView, isLoading, data, profile: { name: "", id: profile } };
}

// src/search-bookmark-folders.tsx
var import_jsx_runtime7 = require("react/jsx-runtime");
function Command() {
  const { errorView, isLoading, data, profile } = useBookmarkFolderSearch();
  if (errorView) {
    return errorView;
  }
  return /* @__PURE__ */ (0, import_jsx_runtime7.jsx)(import_api8.List, { isLoading, searchBarPlaceholder: "Search in bookmark folders...", children: /* @__PURE__ */ (0, import_jsx_runtime7.jsx)(import_api8.List.Section, { title: "Bookmark Folders", children: data?.map((e) => /* @__PURE__ */ (0, import_jsx_runtime7.jsx)(BraveListItems.BookmarkFolder, { entry: e, profile: profile.id }, e.id)) }) });
}
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiLi4vLi4vLi4vLi4vUHJvamVjdHMvZ2l0aHViL2thbGxlcHlvcmFsYS9yYXljYXN0LWV4dGVuc2lvbnMvYnJhdmUvc3JjL3NlYXJjaC1ib29rbWFyay1mb2xkZXJzLnRzeCIsICIuLi8uLi8uLi8uLi9Qcm9qZWN0cy9naXRodWIva2FsbGVweW9yYWxhL3JheWNhc3QtZXh0ZW5zaW9ucy9icmF2ZS9ub2RlX21vZHVsZXMvQHJheWNhc3QvdXRpbHMvZGlzdC9zcmMvaW5kZXgudHMiLCAiLi4vLi4vLi4vLi4vUHJvamVjdHMvZ2l0aHViL2thbGxlcHlvcmFsYS9yYXljYXN0LWV4dGVuc2lvbnMvYnJhdmUvbm9kZV9tb2R1bGVzL0ByYXljYXN0L3V0aWxzL2Rpc3Qvc3JjL3VzZVByb21pc2UudHMiLCAiLi4vLi4vLi4vLi4vUHJvamVjdHMvZ2l0aHViL2thbGxlcHlvcmFsYS9yYXljYXN0LWV4dGVuc2lvbnMvYnJhdmUvbm9kZV9tb2R1bGVzL0ByYXljYXN0L3V0aWxzL2Rpc3Qvc3JjL3VzZURlZXBNZW1vLnRzIiwgIi4uLy4uLy4uLy4uL1Byb2plY3RzL2dpdGh1Yi9rYWxsZXB5b3JhbGEvcmF5Y2FzdC1leHRlbnNpb25zL2JyYXZlL25vZGVfbW9kdWxlcy9AcmF5Y2FzdC91dGlscy9kaXN0L3NyYy91c2VMYXRlc3QudHMiLCAiLi4vLi4vLi4vLi4vUHJvamVjdHMvZ2l0aHViL2thbGxlcHlvcmFsYS9yYXljYXN0LWV4dGVuc2lvbnMvYnJhdmUvbm9kZV9tb2R1bGVzL0ByYXljYXN0L3V0aWxzL2Rpc3Qvc3JjL3Nob3dGYWlsdXJlVG9hc3QudHMiLCAiLi4vLi4vLi4vLi4vUHJvamVjdHMvZ2l0aHViL2thbGxlcHlvcmFsYS9yYXljYXN0LWV4dGVuc2lvbnMvYnJhdmUvbm9kZV9tb2R1bGVzL0ByYXljYXN0L3V0aWxzL2Rpc3Qvc3JjL3VzZUNhY2hlZFN0YXRlLnRzIiwgIi4uLy4uLy4uLy4uL1Byb2plY3RzL2dpdGh1Yi9rYWxsZXB5b3JhbGEvcmF5Y2FzdC1leHRlbnNpb25zL2JyYXZlL25vZGVfbW9kdWxlcy9AcmF5Y2FzdC91dGlscy9kaXN0L3NyYy9oZWxwZXJzLnRzIiwgIi4uLy4uLy4uLy4uL1Byb2plY3RzL2dpdGh1Yi9rYWxsZXB5b3JhbGEvcmF5Y2FzdC1leHRlbnNpb25zL2JyYXZlL25vZGVfbW9kdWxlcy9AcmF5Y2FzdC91dGlscy9kaXN0L3NyYy92ZW5kb3JzL3R5cGUtaGFzaGVyLnRzIiwgIi4uLy4uLy4uLy4uL1Byb2plY3RzL2dpdGh1Yi9rYWxsZXB5b3JhbGEvcmF5Y2FzdC1leHRlbnNpb25zL2JyYXZlL25vZGVfbW9kdWxlcy9AcmF5Y2FzdC91dGlscy9kaXN0L3NyYy91c2VDYWNoZWRQcm9taXNlLnRzIiwgIi4uLy4uLy4uLy4uL1Byb2plY3RzL2dpdGh1Yi9rYWxsZXB5b3JhbGEvcmF5Y2FzdC1leHRlbnNpb25zL2JyYXZlL25vZGVfbW9kdWxlcy9AcmF5Y2FzdC91dGlscy9kaXN0L3NyYy91c2VGZXRjaC50cyIsICIuLi8uLi8uLi8uLi9Qcm9qZWN0cy9naXRodWIva2FsbGVweW9yYWxhL3JheWNhc3QtZXh0ZW5zaW9ucy9icmF2ZS9ub2RlX21vZHVsZXMvQHJheWNhc3QvdXRpbHMvZGlzdC9zcmMvZmV0Y2gtdXRpbHMudHMiLCAiLi4vLi4vLi4vLi4vUHJvamVjdHMvZ2l0aHViL2thbGxlcHlvcmFsYS9yYXljYXN0LWV4dGVuc2lvbnMvYnJhdmUvbm9kZV9tb2R1bGVzL0ByYXljYXN0L3V0aWxzL2Rpc3Qvc3JjL3VzZUV4ZWMudHMiLCAiLi4vLi4vLi4vLi4vUHJvamVjdHMvZ2l0aHViL2thbGxlcHlvcmFsYS9yYXljYXN0LWV4dGVuc2lvbnMvYnJhdmUvbm9kZV9tb2R1bGVzL0ByYXljYXN0L3V0aWxzL2Rpc3Qvc3JjL2V4ZWMtdXRpbHMudHMiLCAiLi4vLi4vLi4vLi4vUHJvamVjdHMvZ2l0aHViL2thbGxlcHlvcmFsYS9yYXljYXN0LWV4dGVuc2lvbnMvYnJhdmUvbm9kZV9tb2R1bGVzL0ByYXljYXN0L3V0aWxzL2Rpc3Qvc3JjL3ZlbmRvcnMvc2lnbmFsLWV4aXQudHMiLCAiLi4vLi4vLi4vLi4vUHJvamVjdHMvZ2l0aHViL2thbGxlcHlvcmFsYS9yYXljYXN0LWV4dGVuc2lvbnMvYnJhdmUvbm9kZV9tb2R1bGVzL0ByYXljYXN0L3V0aWxzL2Rpc3Qvc3JjL3VzZVN0cmVhbUpTT04udHMiLCAiLi4vLi4vLi4vLi4vUHJvamVjdHMvZ2l0aHViL2thbGxlcHlvcmFsYS9yYXljYXN0LWV4dGVuc2lvbnMvYnJhdmUvbm9kZV9tb2R1bGVzL0ByYXljYXN0L3V0aWxzL2Rpc3Qvc3JjL3ZlbmRvcnMvc3RyZWFtLWNoYWluLnRzIiwgIi4uLy4uLy4uLy4uL1Byb2plY3RzL2dpdGh1Yi9rYWxsZXB5b3JhbGEvcmF5Y2FzdC1leHRlbnNpb25zL2JyYXZlL25vZGVfbW9kdWxlcy9AcmF5Y2FzdC91dGlscy9kaXN0L3NyYy92ZW5kb3JzL3N0cmVhbS1qc29uLnRzIiwgIi4uLy4uLy4uLy4uL1Byb2plY3RzL2dpdGh1Yi9rYWxsZXB5b3JhbGEvcmF5Y2FzdC1leHRlbnNpb25zL2JyYXZlL25vZGVfbW9kdWxlcy9AcmF5Y2FzdC91dGlscy9kaXN0L3NyYy91c2VTUUwudHN4IiwgIi4uLy4uLy4uLy4uL1Byb2plY3RzL2dpdGh1Yi9rYWxsZXB5b3JhbGEvcmF5Y2FzdC1leHRlbnNpb25zL2JyYXZlL25vZGVfbW9kdWxlcy9AcmF5Y2FzdC91dGlscy9kaXN0L3NyYy9zcWwtdXRpbHMudHMiLCAiLi4vLi4vLi4vLi4vUHJvamVjdHMvZ2l0aHViL2thbGxlcHlvcmFsYS9yYXljYXN0LWV4dGVuc2lvbnMvYnJhdmUvbm9kZV9tb2R1bGVzL0ByYXljYXN0L3V0aWxzL2Rpc3Qvc3JjL3VzZUZvcm0udHN4IiwgIi4uLy4uLy4uLy4uL1Byb2plY3RzL2dpdGh1Yi9rYWxsZXB5b3JhbGEvcmF5Y2FzdC1leHRlbnNpb25zL2JyYXZlL25vZGVfbW9kdWxlcy9AcmF5Y2FzdC91dGlscy9kaXN0L3NyYy91c2VBSS50cyIsICIuLi8uLi8uLi8uLi9Qcm9qZWN0cy9naXRodWIva2FsbGVweW9yYWxhL3JheWNhc3QtZXh0ZW5zaW9ucy9icmF2ZS9ub2RlX21vZHVsZXMvQHJheWNhc3QvdXRpbHMvZGlzdC9zcmMvdXNlRnJlY2VuY3lTb3J0aW5nLnRzIiwgIi4uLy4uLy4uLy4uL1Byb2plY3RzL2dpdGh1Yi9rYWxsZXB5b3JhbGEvcmF5Y2FzdC1leHRlbnNpb25zL2JyYXZlL25vZGVfbW9kdWxlcy9AcmF5Y2FzdC91dGlscy9kaXN0L3NyYy91c2VMb2NhbFN0b3JhZ2UudHMiLCAiLi4vLi4vLi4vLi4vUHJvamVjdHMvZ2l0aHViL2thbGxlcHlvcmFsYS9yYXljYXN0LWV4dGVuc2lvbnMvYnJhdmUvbm9kZV9tb2R1bGVzL0ByYXljYXN0L3V0aWxzL2Rpc3Qvc3JjL2ljb24vaW5kZXgudHMiLCAiLi4vLi4vLi4vLi4vUHJvamVjdHMvZ2l0aHViL2thbGxlcHlvcmFsYS9yYXljYXN0LWV4dGVuc2lvbnMvYnJhdmUvbm9kZV9tb2R1bGVzL0ByYXljYXN0L3V0aWxzL2Rpc3Qvc3JjL2ljb24vYXZhdGFyLnRzIiwgIi4uLy4uLy4uLy4uL1Byb2plY3RzL2dpdGh1Yi9rYWxsZXB5b3JhbGEvcmF5Y2FzdC1leHRlbnNpb25zL2JyYXZlL25vZGVfbW9kdWxlcy9AcmF5Y2FzdC91dGlscy9kaXN0L3NyYy9pY29uL2NvbG9yLnRzIiwgIi4uLy4uLy4uLy4uL1Byb2plY3RzL2dpdGh1Yi9rYWxsZXB5b3JhbGEvcmF5Y2FzdC1leHRlbnNpb25zL2JyYXZlL25vZGVfbW9kdWxlcy9AcmF5Y2FzdC91dGlscy9kaXN0L3NyYy9pY29uL2Zhdmljb24udHMiLCAiLi4vLi4vLi4vLi4vUHJvamVjdHMvZ2l0aHViL2thbGxlcHlvcmFsYS9yYXljYXN0LWV4dGVuc2lvbnMvYnJhdmUvbm9kZV9tb2R1bGVzL0ByYXljYXN0L3V0aWxzL2Rpc3Qvc3JjL2ljb24vcHJvZ3Jlc3MudHMiLCAiLi4vLi4vLi4vLi4vUHJvamVjdHMvZ2l0aHViL2thbGxlcHlvcmFsYS9yYXljYXN0LWV4dGVuc2lvbnMvYnJhdmUvbm9kZV9tb2R1bGVzL0ByYXljYXN0L3V0aWxzL2Rpc3Qvc3JjL29hdXRoL2luZGV4LnRzIiwgIi4uLy4uLy4uLy4uL1Byb2plY3RzL2dpdGh1Yi9rYWxsZXB5b3JhbGEvcmF5Y2FzdC1leHRlbnNpb25zL2JyYXZlL25vZGVfbW9kdWxlcy9AcmF5Y2FzdC91dGlscy9kaXN0L3NyYy9vYXV0aC9PQXV0aFNlcnZpY2UudHMiLCAiLi4vLi4vLi4vLi4vUHJvamVjdHMvZ2l0aHViL2thbGxlcHlvcmFsYS9yYXljYXN0LWV4dGVuc2lvbnMvYnJhdmUvbm9kZV9tb2R1bGVzL0ByYXljYXN0L3V0aWxzL2Rpc3Qvc3JjL29hdXRoL3Byb3ZpZGVycy50cyIsICIuLi8uLi8uLi8uLi9Qcm9qZWN0cy9naXRodWIva2FsbGVweW9yYWxhL3JheWNhc3QtZXh0ZW5zaW9ucy9icmF2ZS9ub2RlX21vZHVsZXMvQHJheWNhc3QvdXRpbHMvZGlzdC9zcmMvb2F1dGgvd2l0aEFjY2Vzc1Rva2VuLnRzeCIsICIuLi8uLi8uLi8uLi9Qcm9qZWN0cy9naXRodWIva2FsbGVweW9yYWxhL3JheWNhc3QtZXh0ZW5zaW9ucy9icmF2ZS9ub2RlX21vZHVsZXMvQHJheWNhc3QvdXRpbHMvZGlzdC9zcmMvY3JlYXRlRGVlcGxpbmsudHMiLCAiLi4vLi4vLi4vLi4vUHJvamVjdHMvZ2l0aHViL2thbGxlcHlvcmFsYS9yYXljYXN0LWV4dGVuc2lvbnMvYnJhdmUvbm9kZV9tb2R1bGVzL0ByYXljYXN0L3V0aWxzL2Rpc3Qvc3JjL2V4ZWN1dGVTUUwudHMiLCAiLi4vLi4vLi4vLi4vUHJvamVjdHMvZ2l0aHViL2thbGxlcHlvcmFsYS9yYXljYXN0LWV4dGVuc2lvbnMvYnJhdmUvbm9kZV9tb2R1bGVzL0ByYXljYXN0L3V0aWxzL2Rpc3Qvc3JjL3J1bi1hcHBsZXNjcmlwdC50cyIsICIuLi8uLi8uLi8uLi9Qcm9qZWN0cy9naXRodWIva2FsbGVweW9yYWxhL3JheWNhc3QtZXh0ZW5zaW9ucy9icmF2ZS9ub2RlX21vZHVsZXMvQHJheWNhc3QvdXRpbHMvZGlzdC9zcmMvcnVuLXBvd2Vyc2hlbGwtc2NyaXB0LnRzIiwgIi4uLy4uLy4uLy4uL1Byb2plY3RzL2dpdGh1Yi9rYWxsZXB5b3JhbGEvcmF5Y2FzdC1leHRlbnNpb25zL2JyYXZlL25vZGVfbW9kdWxlcy9AcmF5Y2FzdC91dGlscy9kaXN0L3NyYy9jYWNoZS50cyIsICIuLi8uLi8uLi8uLi9Qcm9qZWN0cy9naXRodWIva2FsbGVweW9yYWxhL3JheWNhc3QtZXh0ZW5zaW9ucy9icmF2ZS9zcmMvY29tcG9uZW50cy9CcmF2ZUxpc3RJdGVtcy50c3giLCAiLi4vLi4vLi4vLi4vUHJvamVjdHMvZ2l0aHViL2thbGxlcHlvcmFsYS9yYXljYXN0LWV4dGVuc2lvbnMvYnJhdmUvc3JjL2NvbXBvbmVudHMvZXJyb3IvTm90SW5zdGFsbGVkRXJyb3IudHN4IiwgIi4uLy4uLy4uLy4uL1Byb2plY3RzL2dpdGh1Yi9rYWxsZXB5b3JhbGEvcmF5Y2FzdC1leHRlbnNpb25zL2JyYXZlL3NyYy9jb25zdGFudHMudHMiLCAiLi4vLi4vLi4vLi4vUHJvamVjdHMvZ2l0aHViL2thbGxlcHlvcmFsYS9yYXljYXN0LWV4dGVuc2lvbnMvYnJhdmUvc3JjL2NvbXBvbmVudHMvZXJyb3IvVW5rbm93bkVycm9yLnRzeCIsICIuLi8uLi8uLi8uLi9Qcm9qZWN0cy9naXRodWIva2FsbGVweW9yYWxhL3JheWNhc3QtZXh0ZW5zaW9ucy9icmF2ZS9zcmMvY29tcG9uZW50cy9CcmF2ZUFjdGlvbnMudHN4IiwgIi4uLy4uLy4uLy4uL1Byb2plY3RzL2dpdGh1Yi9rYWxsZXB5b3JhbGEvcmF5Y2FzdC1leHRlbnNpb25zL2JyYXZlL3NyYy9hY3Rpb25zL2luZGV4LnRzeCIsICIuLi8uLi8uLi8uLi9Qcm9qZWN0cy9naXRodWIva2FsbGVweW9yYWxhL3JheWNhc3QtZXh0ZW5zaW9ucy9icmF2ZS9zcmMvaG9va3MvdXNlQm9va21hcmtGb2xkZXJTZWFyY2gudHN4IiwgIi4uLy4uLy4uLy4uL1Byb2plY3RzL2dpdGh1Yi9rYWxsZXB5b3JhbGEvcmF5Y2FzdC1leHRlbnNpb25zL2JyYXZlL3NyYy91dGlsL2luZGV4LnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyJpbXBvcnQgeyBMaXN0IH0gZnJvbSBcIkByYXljYXN0L2FwaVwiO1xuaW1wb3J0IHsgQnJhdmVMaXN0SXRlbXMgfSBmcm9tIFwiLi9jb21wb25lbnRzL0JyYXZlTGlzdEl0ZW1zXCI7XG5pbXBvcnQgeyB1c2VCb29rbWFya0ZvbGRlclNlYXJjaCB9IGZyb20gXCIuL2hvb2tzL3VzZUJvb2ttYXJrRm9sZGVyU2VhcmNoXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIENvbW1hbmQoKSB7XG4gIGNvbnN0IHsgZXJyb3JWaWV3LCBpc0xvYWRpbmcsIGRhdGEsIHByb2ZpbGUgfSA9IHVzZUJvb2ttYXJrRm9sZGVyU2VhcmNoKCk7XG5cbiAgaWYgKGVycm9yVmlldykge1xuICAgIHJldHVybiBlcnJvclZpZXc7XG4gIH1cblxuICByZXR1cm4gKFxuICAgIDxMaXN0IGlzTG9hZGluZz17aXNMb2FkaW5nfSBzZWFyY2hCYXJQbGFjZWhvbGRlcj1cIlNlYXJjaCBpbiBib29rbWFyayBmb2xkZXJzLi4uXCI+XG4gICAgICA8TGlzdC5TZWN0aW9uIHRpdGxlPVwiQm9va21hcmsgRm9sZGVyc1wiPlxuICAgICAgICB7ZGF0YT8ubWFwKChlKSA9PiAoXG4gICAgICAgICAgPEJyYXZlTGlzdEl0ZW1zLkJvb2ttYXJrRm9sZGVyIGtleT17ZS5pZH0gZW50cnk9e2V9IHByb2ZpbGU9e3Byb2ZpbGUuaWR9IC8+XG4gICAgICAgICkpfVxuICAgICAgPC9MaXN0LlNlY3Rpb24+XG4gICAgPC9MaXN0PlxuICApO1xufVxuIiwgIi8vLyA8cmVmZXJlbmNlIHR5cGVzPVwibm9kZVwiIC8+XG5cbmV4cG9ydCB7IHVzZVByb21pc2UgfSBmcm9tIFwiLi91c2VQcm9taXNlXCI7XG5leHBvcnQgeyB1c2VDYWNoZWRTdGF0ZSB9IGZyb20gXCIuL3VzZUNhY2hlZFN0YXRlXCI7XG5leHBvcnQgeyB1c2VDYWNoZWRQcm9taXNlIH0gZnJvbSBcIi4vdXNlQ2FjaGVkUHJvbWlzZVwiO1xuZXhwb3J0IHsgdXNlRmV0Y2ggfSBmcm9tIFwiLi91c2VGZXRjaFwiO1xuZXhwb3J0IHsgdXNlRXhlYyB9IGZyb20gXCIuL3VzZUV4ZWNcIjtcbmV4cG9ydCB7IHVzZVN0cmVhbUpTT04gfSBmcm9tIFwiLi91c2VTdHJlYW1KU09OXCI7XG5leHBvcnQgeyB1c2VTUUwgfSBmcm9tIFwiLi91c2VTUUxcIjtcbmV4cG9ydCB7IHVzZUZvcm0sIEZvcm1WYWxpZGF0aW9uIH0gZnJvbSBcIi4vdXNlRm9ybVwiO1xuZXhwb3J0IHsgdXNlQUkgfSBmcm9tIFwiLi91c2VBSVwiO1xuZXhwb3J0IHsgdXNlRnJlY2VuY3lTb3J0aW5nIH0gZnJvbSBcIi4vdXNlRnJlY2VuY3lTb3J0aW5nXCI7XG5leHBvcnQgeyB1c2VMb2NhbFN0b3JhZ2UgfSBmcm9tIFwiLi91c2VMb2NhbFN0b3JhZ2VcIjtcblxuZXhwb3J0IHsgZ2V0QXZhdGFySWNvbiwgZ2V0RmF2aWNvbiwgZ2V0UHJvZ3Jlc3NJY29uIH0gZnJvbSBcIi4vaWNvblwiO1xuXG5leHBvcnQgeyBPQXV0aFNlcnZpY2UsIHdpdGhBY2Nlc3NUb2tlbiwgZ2V0QWNjZXNzVG9rZW4gfSBmcm9tIFwiLi9vYXV0aFwiO1xuXG5leHBvcnQgeyBjcmVhdGVEZWVwbGluaywgY3JlYXRlRXh0ZW5zaW9uRGVlcGxpbmssIGNyZWF0ZVNjcmlwdENvbW1hbmREZWVwbGluaywgRGVlcGxpbmtUeXBlIH0gZnJvbSBcIi4vY3JlYXRlRGVlcGxpbmtcIjtcbmV4cG9ydCB7IGV4ZWN1dGVTUUwgfSBmcm9tIFwiLi9leGVjdXRlU1FMXCI7XG5leHBvcnQgeyBydW5BcHBsZVNjcmlwdCB9IGZyb20gXCIuL3J1bi1hcHBsZXNjcmlwdFwiO1xuZXhwb3J0IHsgcnVuUG93ZXJTaGVsbFNjcmlwdCB9IGZyb20gXCIuL3J1bi1wb3dlcnNoZWxsLXNjcmlwdFwiO1xuZXhwb3J0IHsgc2hvd0ZhaWx1cmVUb2FzdCB9IGZyb20gXCIuL3Nob3dGYWlsdXJlVG9hc3RcIjtcbmV4cG9ydCB7IHdpdGhDYWNoZSB9IGZyb20gXCIuL2NhY2hlXCI7XG5cbmV4cG9ydCB0eXBlIHsgUHJvbWlzZU9wdGlvbnMgfSBmcm9tIFwiLi91c2VQcm9taXNlXCI7XG5leHBvcnQgdHlwZSB7IENhY2hlZFByb21pc2VPcHRpb25zIH0gZnJvbSBcIi4vdXNlQ2FjaGVkUHJvbWlzZVwiO1xuZXhwb3J0IHR5cGUge1xuICBPQXV0aFNlcnZpY2VPcHRpb25zLFxuICBPbkF1dGhvcml6ZVBhcmFtcyxcbiAgV2l0aEFjY2Vzc1Rva2VuQ29tcG9uZW50T3JGbixcbiAgUHJvdmlkZXJXaXRoRGVmYXVsdENsaWVudE9wdGlvbnMsXG4gIFByb3ZpZGVyT3B0aW9ucyxcbn0gZnJvbSBcIi4vb2F1dGhcIjtcbmV4cG9ydCB0eXBlIHsgQXN5bmNTdGF0ZSwgTXV0YXRlUHJvbWlzZSB9IGZyb20gXCIuL3R5cGVzXCI7XG4iLCAiaW1wb3J0IHsgdXNlRWZmZWN0LCB1c2VDYWxsYmFjaywgUmVmT2JqZWN0LCB1c2VSZWYsIHVzZVN0YXRlIH0gZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgeyBlbnZpcm9ubWVudCwgTGF1bmNoVHlwZSwgVG9hc3QgfSBmcm9tIFwiQHJheWNhc3QvYXBpXCI7XG5pbXBvcnQgeyB1c2VEZWVwTWVtbyB9IGZyb20gXCIuL3VzZURlZXBNZW1vXCI7XG5pbXBvcnQge1xuICBGdW5jdGlvblJldHVybmluZ1Byb21pc2UsXG4gIE11dGF0ZVByb21pc2UsXG4gIFVzZVByb21pc2VSZXR1cm5UeXBlLFxuICBBc3luY1N0YXRlLFxuICBGdW5jdGlvblJldHVybmluZ1BhZ2luYXRlZFByb21pc2UsXG4gIFVud3JhcFJldHVybixcbiAgUGFnaW5hdGlvbk9wdGlvbnMsXG59IGZyb20gXCIuL3R5cGVzXCI7XG5pbXBvcnQgeyB1c2VMYXRlc3QgfSBmcm9tIFwiLi91c2VMYXRlc3RcIjtcbmltcG9ydCB7IHNob3dGYWlsdXJlVG9hc3QgfSBmcm9tIFwiLi9zaG93RmFpbHVyZVRvYXN0XCI7XG5cbmV4cG9ydCB0eXBlIFByb21pc2VPcHRpb25zPFQgZXh0ZW5kcyBGdW5jdGlvblJldHVybmluZ1Byb21pc2UgfCBGdW5jdGlvblJldHVybmluZ1BhZ2luYXRlZFByb21pc2U+ID0ge1xuICAvKipcbiAgICogQSByZWZlcmVuY2UgdG8gYW4gYEFib3J0Q29udHJvbGxlcmAgdG8gY2FuY2VsIGEgcHJldmlvdXMgY2FsbCB3aGVuIHRyaWdnZXJpbmcgYSBuZXcgb25lXG4gICAqL1xuICBhYm9ydGFibGU/OiBSZWZPYmplY3Q8QWJvcnRDb250cm9sbGVyIHwgbnVsbCB8IHVuZGVmaW5lZD47XG4gIC8qKlxuICAgKiBXaGV0aGVyIHRvIGFjdHVhbGx5IGV4ZWN1dGUgdGhlIGZ1bmN0aW9uIG9yIG5vdC5cbiAgICogVGhpcyBpcyB1c2VmdWwgZm9yIGNhc2VzIHdoZXJlIG9uZSBvZiB0aGUgZnVuY3Rpb24ncyBhcmd1bWVudHMgZGVwZW5kcyBvbiBzb21ldGhpbmcgdGhhdFxuICAgKiBtaWdodCBub3QgYmUgYXZhaWxhYmxlIHJpZ2h0IGF3YXkgKGZvciBleGFtcGxlLCBkZXBlbmRzIG9uIHNvbWUgdXNlciBpbnB1dHMpLiBCZWNhdXNlIFJlYWN0IHJlcXVpcmVzXG4gICAqIGV2ZXJ5IGhvb2tzIHRvIGJlIGRlZmluZWQgb24gdGhlIHJlbmRlciwgdGhpcyBmbGFnIGVuYWJsZXMgeW91IHRvIGRlZmluZSB0aGUgaG9vayByaWdodCBhd2F5IGJ1dFxuICAgKiB3YWl0IHV0aWwgeW91IGhhdmUgYWxsIHRoZSBhcmd1bWVudHMgcmVhZHkgdG8gZXhlY3V0ZSB0aGUgZnVuY3Rpb24uXG4gICAqL1xuICBleGVjdXRlPzogYm9vbGVhbjtcbiAgLyoqXG4gICAqIE9wdGlvbnMgZm9yIHRoZSBnZW5lcmljIGZhaWx1cmUgdG9hc3QuXG4gICAqIEl0IGFsbG93cyB5b3UgdG8gY3VzdG9taXplIHRoZSB0aXRsZSwgbWVzc2FnZSwgYW5kIHByaW1hcnkgYWN0aW9uIG9mIHRoZSBmYWlsdXJlIHRvYXN0LlxuICAgKi9cbiAgZmFpbHVyZVRvYXN0T3B0aW9ucz86IFBhcnRpYWw8UGljazxUb2FzdC5PcHRpb25zLCBcInRpdGxlXCIgfCBcInByaW1hcnlBY3Rpb25cIiB8IFwibWVzc2FnZVwiPj47XG4gIC8qKlxuICAgKiBDYWxsZWQgd2hlbiBhbiBleGVjdXRpb24gZmFpbHMuIEJ5IGRlZmF1bHQgaXQgd2lsbCBsb2cgdGhlIGVycm9yIGFuZCBzaG93XG4gICAqIGEgZ2VuZXJpYyBmYWlsdXJlIHRvYXN0LlxuICAgKi9cbiAgb25FcnJvcj86IChlcnJvcjogRXJyb3IpID0+IHZvaWQgfCBQcm9taXNlPHZvaWQ+O1xuICAvKipcbiAgICogQ2FsbGVkIHdoZW4gYW4gZXhlY3V0aW9uIHN1Y2NlZWRzLlxuICAgKi9cbiAgb25EYXRhPzogKGRhdGE6IFVud3JhcFJldHVybjxUPiwgcGFnaW5hdGlvbj86IFBhZ2luYXRpb25PcHRpb25zPFVud3JhcFJldHVybjxUPj4pID0+IHZvaWQgfCBQcm9taXNlPHZvaWQ+O1xuICAvKipcbiAgICogQ2FsbGVkIHdoZW4gYW4gZXhlY3V0aW9uIHdpbGwgc3RhcnRcbiAgICovXG4gIG9uV2lsbEV4ZWN1dGU/OiAocGFyYW1ldGVyczogUGFyYW1ldGVyczxUPikgPT4gdm9pZDtcbn07XG5cbi8qKlxuICogV3JhcHMgYW4gYXN5bmNocm9ub3VzIGZ1bmN0aW9uIG9yIGEgZnVuY3Rpb24gdGhhdCByZXR1cm5zIGEgUHJvbWlzZSBpbiBhbm90aGVyIGZ1bmN0aW9uLCBhbmQgcmV0dXJucyB0aGUge0BsaW5rIEFzeW5jU3RhdGV9IGNvcnJlc3BvbmRpbmcgdG8gdGhlIGV4ZWN1dGlvbiBvZiB0aGUgZnVuY3Rpb24uXG4gKlxuICogQHJlbWFyayBUaGlzIG92ZXJsb2FkIHNob3VsZCBiZSB1c2VkIHdoZW4gd29ya2luZyB3aXRoIHBhZ2luYXRlZCBkYXRhIHNvdXJjZXMuXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYFxuICogaW1wb3J0IHsgc2V0VGltZW91dCB9IGZyb20gXCJub2RlOnRpbWVycy9wcm9taXNlc1wiO1xuICogaW1wb3J0IHsgdXNlU3RhdGUgfSBmcm9tIFwicmVhY3RcIjtcbiAqIGltcG9ydCB7IExpc3QgfSBmcm9tIFwiQHJheWNhc3QvYXBpXCI7XG4gKiBpbXBvcnQgeyB1c2VQcm9taXNlIH0gZnJvbSBcIkByYXljYXN0L3V0aWxzXCI7XG4gKlxuICogZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gQ29tbWFuZCgpIHtcbiAqICAgY29uc3QgW3NlYXJjaFRleHQsIHNldFNlYXJjaFRleHRdID0gdXNlU3RhdGUoXCJcIik7XG4gKlxuICogICBjb25zdCB7IGlzTG9hZGluZywgZGF0YSwgcGFnaW5hdGlvbiB9ID0gdXNlUHJvbWlzZShcbiAqICAgICAoc2VhcmNoVGV4dDogc3RyaW5nKSA9PiBhc3luYyAob3B0aW9uczogeyBwYWdlOiBudW1iZXIgfSkgPT4ge1xuICogICAgICAgYXdhaXQgc2V0VGltZW91dCgyMDApO1xuICogICAgICAgY29uc3QgbmV3RGF0YSA9IEFycmF5LmZyb20oeyBsZW5ndGg6IDI1IH0sIChfdiwgaW5kZXgpID0+ICh7XG4gKiAgICAgICAgIGluZGV4LFxuICogICAgICAgICBwYWdlOiBvcHRpb25zLnBhZ2UsXG4gKiAgICAgICAgIHRleHQ6IHNlYXJjaFRleHQsXG4gKiAgICAgICB9KSk7XG4gKiAgICAgICByZXR1cm4geyBkYXRhOiBuZXdEYXRhLCBoYXNNb3JlOiBvcHRpb25zLnBhZ2UgPCAxMCB9O1xuICogICAgIH0sXG4gKiAgICAgW3NlYXJjaFRleHRdXG4gKiAgICk7XG4gKlxuICogICByZXR1cm4gKFxuICogICAgIDxMaXN0IGlzTG9hZGluZz17aXNMb2FkaW5nfSBvblNlYXJjaFRleHRDaGFuZ2U9e3NldFNlYXJjaFRleHR9IHBhZ2luYXRpb249e3BhZ2luYXRpb259PlxuICogICAgICAge2RhdGE/Lm1hcCgoaXRlbSkgPT4gKFxuICogICAgICAgICA8TGlzdC5JdGVtXG4gKiAgICAgICAgICAga2V5PXtgJHtpdGVtLnBhZ2V9ICR7aXRlbS5pbmRleH0gJHtpdGVtLnRleHR9YH1cbiAqICAgICAgICAgICB0aXRsZT17YFBhZ2UgJHtpdGVtLnBhZ2V9IEl0ZW0gJHtpdGVtLmluZGV4fWB9XG4gKiAgICAgICAgICAgc3VidGl0bGU9e2l0ZW0udGV4dH1cbiAqICAgICAgICAgLz5cbiAqICAgICAgICkpfVxuICogICAgIDwvTGlzdD5cbiAqICAgKTtcbiAqIH07XG4gKiBgYGBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHVzZVByb21pc2U8VCBleHRlbmRzIEZ1bmN0aW9uUmV0dXJuaW5nUGFnaW5hdGVkUHJvbWlzZTxbXT4+KFxuICBmbjogVCxcbik6IFVzZVByb21pc2VSZXR1cm5UeXBlPFVud3JhcFJldHVybjxUPj47XG5leHBvcnQgZnVuY3Rpb24gdXNlUHJvbWlzZTxUIGV4dGVuZHMgRnVuY3Rpb25SZXR1cm5pbmdQYWdpbmF0ZWRQcm9taXNlPihcbiAgZm46IFQsXG4gIGFyZ3M6IFBhcmFtZXRlcnM8VD4sXG4gIG9wdGlvbnM/OiBQcm9taXNlT3B0aW9uczxUPixcbik6IFVzZVByb21pc2VSZXR1cm5UeXBlPFVud3JhcFJldHVybjxUPj47XG5cbi8qKlxuICogV3JhcHMgYW4gYXN5bmNocm9ub3VzIGZ1bmN0aW9uIG9yIGEgZnVuY3Rpb24gdGhhdCByZXR1cm5zIGEgUHJvbWlzZSBhbmQgcmV0dXJucyB0aGUge0BsaW5rIEFzeW5jU3RhdGV9IGNvcnJlc3BvbmRpbmcgdG8gdGhlIGV4ZWN1dGlvbiBvZiB0aGUgZnVuY3Rpb24uXG4gKlxuICogQHJlbWFyayBUaGUgZnVuY3Rpb24gaXMgYXNzdW1lZCB0byBiZSBjb25zdGFudCAoZWcuIGNoYW5naW5nIGl0IHdvbid0IHRyaWdnZXIgYSByZXZhbGlkYXRpb24pLlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGBcbiAqIGltcG9ydCB7IHVzZVByb21pc2UgfSBmcm9tICdAcmF5Y2FzdC91dGlscyc7XG4gKlxuICogZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gQ29tbWFuZCgpIHtcbiAqICAgY29uc3QgYWJvcnRhYmxlID0gdXNlUmVmPEFib3J0Q29udHJvbGxlcj4oKTtcbiAqICAgY29uc3QgeyBpc0xvYWRpbmcsIGRhdGEsIHJldmFsaWRhdGUgfSA9IHVzZVByb21pc2UoYXN5bmMgKHVybDogc3RyaW5nKSA9PiB7XG4gKiAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh1cmwsIHsgc2lnbmFsOiBhYm9ydGFibGUuY3VycmVudD8uc2lnbmFsIH0pO1xuICogICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHJlc3BvbnNlLnRleHQoKTtcbiAqICAgICByZXR1cm4gcmVzdWx0XG4gKiAgIH0sXG4gKiAgIFsnaHR0cHM6Ly9hcGkuZXhhbXBsZSddLFxuICogICB7XG4gKiAgICAgYWJvcnRhYmxlXG4gKiAgIH0pO1xuICpcbiAqICAgcmV0dXJuIChcbiAqICAgICA8RGV0YWlsXG4gKiAgICAgICBpc0xvYWRpbmc9e2lzTG9hZGluZ31cbiAqICAgICAgIG1hcmtkb3duPXtkYXRhfVxuICogICAgICAgYWN0aW9ucz17XG4gKiAgICAgICAgIDxBY3Rpb25QYW5lbD5cbiAqICAgICAgICAgICA8QWN0aW9uIHRpdGxlPVwiUmVsb2FkXCIgb25BY3Rpb249eygpID0+IHJldmFsaWRhdGUoKX0gLz5cbiAqICAgICAgICAgPC9BY3Rpb25QYW5lbD5cbiAqICAgICAgIH1cbiAqICAgICAvPlxuICogICApO1xuICogfTtcbiAqIGBgYFxuICovXG5leHBvcnQgZnVuY3Rpb24gdXNlUHJvbWlzZTxUIGV4dGVuZHMgRnVuY3Rpb25SZXR1cm5pbmdQcm9taXNlPFtdPj4oZm46IFQpOiBVc2VQcm9taXNlUmV0dXJuVHlwZTxVbndyYXBSZXR1cm48VD4+O1xuZXhwb3J0IGZ1bmN0aW9uIHVzZVByb21pc2U8VCBleHRlbmRzIEZ1bmN0aW9uUmV0dXJuaW5nUHJvbWlzZT4oXG4gIGZuOiBULFxuICBhcmdzOiBQYXJhbWV0ZXJzPFQ+LFxuICBvcHRpb25zPzogUHJvbWlzZU9wdGlvbnM8VD4sXG4pOiBVc2VQcm9taXNlUmV0dXJuVHlwZTxVbndyYXBSZXR1cm48VD4+O1xuXG5leHBvcnQgZnVuY3Rpb24gdXNlUHJvbWlzZTxUIGV4dGVuZHMgRnVuY3Rpb25SZXR1cm5pbmdQcm9taXNlIHwgRnVuY3Rpb25SZXR1cm5pbmdQYWdpbmF0ZWRQcm9taXNlPihcbiAgZm46IFQsXG4gIGFyZ3M/OiBQYXJhbWV0ZXJzPFQ+LFxuICBvcHRpb25zPzogUHJvbWlzZU9wdGlvbnM8VD4sXG4pOiBVc2VQcm9taXNlUmV0dXJuVHlwZTxhbnk+IHtcbiAgY29uc3QgbGFzdENhbGxJZCA9IHVzZVJlZigwKTtcbiAgY29uc3QgW3N0YXRlLCBzZXRdID0gdXNlU3RhdGU8QXN5bmNTdGF0ZTxVbndyYXBSZXR1cm48VD4+Pih7IGlzTG9hZGluZzogdHJ1ZSB9KTtcblxuICBjb25zdCBmblJlZiA9IHVzZUxhdGVzdChmbik7XG4gIGNvbnN0IGxhdGVzdEFib3J0YWJsZSA9IHVzZUxhdGVzdChvcHRpb25zPy5hYm9ydGFibGUpO1xuICBjb25zdCBsYXRlc3RBcmdzID0gdXNlTGF0ZXN0KGFyZ3MgfHwgW10pO1xuICBjb25zdCBsYXRlc3RPbkVycm9yID0gdXNlTGF0ZXN0KG9wdGlvbnM/Lm9uRXJyb3IpO1xuICBjb25zdCBsYXRlc3RPbkRhdGEgPSB1c2VMYXRlc3Qob3B0aW9ucz8ub25EYXRhKTtcbiAgY29uc3QgbGF0ZXN0T25XaWxsRXhlY3V0ZSA9IHVzZUxhdGVzdChvcHRpb25zPy5vbldpbGxFeGVjdXRlKTtcbiAgY29uc3QgbGF0ZXN0RmFpbHVyZVRvYXN0ID0gdXNlTGF0ZXN0KG9wdGlvbnM/LmZhaWx1cmVUb2FzdE9wdGlvbnMpO1xuICBjb25zdCBsYXRlc3RWYWx1ZSA9IHVzZUxhdGVzdChzdGF0ZS5kYXRhKTtcbiAgY29uc3QgbGF0ZXN0Q2FsbGJhY2sgPSB1c2VSZWY8KC4uLmFyZ3M6IFBhcmFtZXRlcnM8VD4pID0+IFByb21pc2U8VW53cmFwUmV0dXJuPFQ+Pj4obnVsbCk7XG5cbiAgY29uc3QgcGFnaW5hdGlvbkFyZ3NSZWYgPSB1c2VSZWY8UGFnaW5hdGlvbk9wdGlvbnM+KHsgcGFnZTogMCB9KTtcbiAgY29uc3QgdXNlUGFnaW5hdGlvblJlZiA9IHVzZVJlZihmYWxzZSk7XG4gIGNvbnN0IGhhc01vcmVSZWYgPSB1c2VSZWYodHJ1ZSk7XG4gIGNvbnN0IHBhZ2VTaXplUmVmID0gdXNlUmVmKDUwKTtcblxuICBjb25zdCBhYm9ydCA9IHVzZUNhbGxiYWNrKCgpID0+IHtcbiAgICBpZiAobGF0ZXN0QWJvcnRhYmxlLmN1cnJlbnQpIHtcbiAgICAgIGxhdGVzdEFib3J0YWJsZS5jdXJyZW50LmN1cnJlbnQ/LmFib3J0KCk7XG4gICAgICBsYXRlc3RBYm9ydGFibGUuY3VycmVudC5jdXJyZW50ID0gbmV3IEFib3J0Q29udHJvbGxlcigpO1xuICAgIH1cbiAgICByZXR1cm4gKytsYXN0Q2FsbElkLmN1cnJlbnQ7XG4gIH0sIFtsYXRlc3RBYm9ydGFibGVdKTtcblxuICBjb25zdCBjYWxsYmFjayA9IHVzZUNhbGxiYWNrKFxuICAgICguLi5hcmdzOiBQYXJhbWV0ZXJzPFQ+KTogUHJvbWlzZTxVbndyYXBSZXR1cm48VD4+ID0+IHtcbiAgICAgIGNvbnN0IGNhbGxJZCA9IGFib3J0KCk7XG5cbiAgICAgIGxhdGVzdE9uV2lsbEV4ZWN1dGUuY3VycmVudD8uKGFyZ3MpO1xuXG4gICAgICBzZXQoKHByZXZTdGF0ZSkgPT4gKHsgLi4ucHJldlN0YXRlLCBpc0xvYWRpbmc6IHRydWUgfSkpO1xuXG4gICAgICBjb25zdCBwcm9taXNlT3JQYWdpbmF0ZWRQcm9taXNlID0gYmluZFByb21pc2VJZk5lZWRlZChmblJlZi5jdXJyZW50KSguLi5hcmdzKTtcblxuICAgICAgZnVuY3Rpb24gaGFuZGxlRXJyb3IoZXJyb3I6IGFueSkge1xuICAgICAgICBpZiAoZXJyb3IubmFtZSA9PSBcIkFib3J0RXJyb3JcIikge1xuICAgICAgICAgIHJldHVybiBlcnJvcjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChjYWxsSWQgPT09IGxhc3RDYWxsSWQuY3VycmVudCkge1xuICAgICAgICAgIC8vIGhhbmRsZSBlcnJvcnNcbiAgICAgICAgICBpZiAobGF0ZXN0T25FcnJvci5jdXJyZW50KSB7XG4gICAgICAgICAgICBsYXRlc3RPbkVycm9yLmN1cnJlbnQoZXJyb3IpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAoZW52aXJvbm1lbnQubGF1bmNoVHlwZSAhPT0gTGF1bmNoVHlwZS5CYWNrZ3JvdW5kKSB7XG4gICAgICAgICAgICAgIHNob3dGYWlsdXJlVG9hc3QoZXJyb3IsIHtcbiAgICAgICAgICAgICAgICB0aXRsZTogXCJGYWlsZWQgdG8gZmV0Y2ggbGF0ZXN0IGRhdGFcIixcbiAgICAgICAgICAgICAgICBwcmltYXJ5QWN0aW9uOiB7XG4gICAgICAgICAgICAgICAgICB0aXRsZTogXCJSZXRyeVwiLFxuICAgICAgICAgICAgICAgICAgb25BY3Rpb24odG9hc3QpIHtcbiAgICAgICAgICAgICAgICAgICAgdG9hc3QuaGlkZSgpO1xuICAgICAgICAgICAgICAgICAgICBsYXRlc3RDYWxsYmFjay5jdXJyZW50Py4oLi4uKChsYXRlc3RBcmdzLmN1cnJlbnQgfHwgW10pIGFzIFBhcmFtZXRlcnM8VD4pKTtcbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAuLi5sYXRlc3RGYWlsdXJlVG9hc3QuY3VycmVudCxcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIHNldCh7IGVycm9yLCBpc0xvYWRpbmc6IGZhbHNlIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGVycm9yO1xuICAgICAgfVxuXG4gICAgICBpZiAodHlwZW9mIHByb21pc2VPclBhZ2luYXRlZFByb21pc2UgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICB1c2VQYWdpbmF0aW9uUmVmLmN1cnJlbnQgPSB0cnVlO1xuICAgICAgICByZXR1cm4gcHJvbWlzZU9yUGFnaW5hdGVkUHJvbWlzZShwYWdpbmF0aW9uQXJnc1JlZi5jdXJyZW50KS50aGVuKFxuICAgICAgICAgIC8vIEB0cy1leHBlY3QtZXJyb3IgdG9vIGNvbXBsaWNhdGVkIGZvciBUU1xuICAgICAgICAgICh7IGRhdGEsIGhhc01vcmUsIGN1cnNvciB9OiB7IGRhdGE6IFVud3JhcFJldHVybjxUPjsgaGFzTW9yZTogYm9vbGVhbjsgY3Vyc29yPzogYW55IH0pID0+IHtcbiAgICAgICAgICAgIGlmIChjYWxsSWQgPT09IGxhc3RDYWxsSWQuY3VycmVudCkge1xuICAgICAgICAgICAgICBpZiAocGFnaW5hdGlvbkFyZ3NSZWYuY3VycmVudCkge1xuICAgICAgICAgICAgICAgIHBhZ2luYXRpb25BcmdzUmVmLmN1cnJlbnQuY3Vyc29yID0gY3Vyc29yO1xuICAgICAgICAgICAgICAgIHBhZ2luYXRpb25BcmdzUmVmLmN1cnJlbnQubGFzdEl0ZW0gPSBkYXRhPy5bZGF0YS5sZW5ndGggLSAxXTtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIGlmIChsYXRlc3RPbkRhdGEuY3VycmVudCkge1xuICAgICAgICAgICAgICAgIGxhdGVzdE9uRGF0YS5jdXJyZW50KGRhdGEsIHBhZ2luYXRpb25BcmdzUmVmLmN1cnJlbnQpO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgaWYgKGhhc01vcmUpIHtcbiAgICAgICAgICAgICAgICBwYWdlU2l6ZVJlZi5jdXJyZW50ID0gZGF0YS5sZW5ndGg7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgaGFzTW9yZVJlZi5jdXJyZW50ID0gaGFzTW9yZTtcblxuICAgICAgICAgICAgICBzZXQoKHByZXZpb3VzRGF0YSkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChwYWdpbmF0aW9uQXJnc1JlZi5jdXJyZW50LnBhZ2UgPT09IDApIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiB7IGRhdGEsIGlzTG9hZGluZzogZmFsc2UgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gQHRzLWV4cGVjdC1lcnJvciB3ZSBrbm93IGl0J3MgYW4gYXJyYXkgaGVyZVxuICAgICAgICAgICAgICAgIHJldHVybiB7IGRhdGE6IChwcmV2aW91c0RhdGEuZGF0YSB8fCBbXSk/LmNvbmNhdChkYXRhKSwgaXNMb2FkaW5nOiBmYWxzZSB9O1xuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgICAgICAgfSxcbiAgICAgICAgICAoZXJyb3I6IHVua25vd24pID0+IHtcbiAgICAgICAgICAgIGhhc01vcmVSZWYuY3VycmVudCA9IGZhbHNlO1xuICAgICAgICAgICAgcmV0dXJuIGhhbmRsZUVycm9yKGVycm9yKTtcbiAgICAgICAgICB9LFxuICAgICAgICApIGFzIFByb21pc2U8VW53cmFwUmV0dXJuPFQ+PjtcbiAgICAgIH1cblxuICAgICAgdXNlUGFnaW5hdGlvblJlZi5jdXJyZW50ID0gZmFsc2U7XG4gICAgICByZXR1cm4gcHJvbWlzZU9yUGFnaW5hdGVkUHJvbWlzZS50aGVuKChkYXRhOiBVbndyYXBSZXR1cm48VD4pID0+IHtcbiAgICAgICAgaWYgKGNhbGxJZCA9PT0gbGFzdENhbGxJZC5jdXJyZW50KSB7XG4gICAgICAgICAgaWYgKGxhdGVzdE9uRGF0YS5jdXJyZW50KSB7XG4gICAgICAgICAgICBsYXRlc3RPbkRhdGEuY3VycmVudChkYXRhKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgc2V0KHsgZGF0YSwgaXNMb2FkaW5nOiBmYWxzZSB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgfSwgaGFuZGxlRXJyb3IpIGFzIFByb21pc2U8VW53cmFwUmV0dXJuPFQ+PjtcbiAgICB9LFxuICAgIFtcbiAgICAgIGxhdGVzdE9uRGF0YSxcbiAgICAgIGxhdGVzdE9uRXJyb3IsXG4gICAgICBsYXRlc3RBcmdzLFxuICAgICAgZm5SZWYsXG4gICAgICBzZXQsXG4gICAgICBsYXRlc3RDYWxsYmFjayxcbiAgICAgIGxhdGVzdE9uV2lsbEV4ZWN1dGUsXG4gICAgICBwYWdpbmF0aW9uQXJnc1JlZixcbiAgICAgIGxhdGVzdEZhaWx1cmVUb2FzdCxcbiAgICAgIGFib3J0LFxuICAgIF0sXG4gICk7XG5cbiAgbGF0ZXN0Q2FsbGJhY2suY3VycmVudCA9IGNhbGxiYWNrO1xuXG4gIGNvbnN0IHJldmFsaWRhdGUgPSB1c2VDYWxsYmFjaygoKSA9PiB7XG4gICAgLy8gcmVzZXQgdGhlIHBhZ2luYXRpb25cbiAgICBwYWdpbmF0aW9uQXJnc1JlZi5jdXJyZW50ID0geyBwYWdlOiAwIH07XG5cbiAgICBjb25zdCBhcmdzID0gKGxhdGVzdEFyZ3MuY3VycmVudCB8fCBbXSkgYXMgUGFyYW1ldGVyczxUPjtcbiAgICByZXR1cm4gY2FsbGJhY2soLi4uYXJncyk7XG4gIH0sIFtjYWxsYmFjaywgbGF0ZXN0QXJnc10pO1xuXG4gIGNvbnN0IG11dGF0ZSA9IHVzZUNhbGxiYWNrPE11dGF0ZVByb21pc2U8QXdhaXRlZDxSZXR1cm5UeXBlPFQ+PiwgdW5kZWZpbmVkPj4oXG4gICAgYXN5bmMgKGFzeW5jVXBkYXRlLCBvcHRpb25zKSA9PiB7XG4gICAgICBsZXQgZGF0YUJlZm9yZU9wdGltaXN0aWNVcGRhdGU6IEF3YWl0ZWQ8UmV0dXJuVHlwZTxUPj4gfCB1bmRlZmluZWQ7XG4gICAgICB0cnkge1xuICAgICAgICBpZiAob3B0aW9ucz8ub3B0aW1pc3RpY1VwZGF0ZSkge1xuICAgICAgICAgIC8vIGNhbmNlbCB0aGUgaW4tZmxpZ2h0IHJlcXVlc3QgdG8gbWFrZSBzdXJlIGl0IHdvbid0IG92ZXJ3cml0ZSB0aGUgb3B0aW1pc3RpYyB1cGRhdGVcbiAgICAgICAgICBhYm9ydCgpO1xuXG4gICAgICAgICAgaWYgKHR5cGVvZiBvcHRpb25zPy5yb2xsYmFja09uRXJyb3IgIT09IFwiZnVuY3Rpb25cIiAmJiBvcHRpb25zPy5yb2xsYmFja09uRXJyb3IgIT09IGZhbHNlKSB7XG4gICAgICAgICAgICAvLyBrZWVwIHRyYWNrIG9mIHRoZSBkYXRhIGJlZm9yZSB0aGUgb3B0aW1pc3RpYyB1cGRhdGUsXG4gICAgICAgICAgICAvLyBidXQgb25seSBpZiB3ZSBuZWVkIGl0IChlZy4gb25seSB3aGVuIHdlIHdhbnQgdG8gYXV0b21hdGljYWxseSByb2xsYmFjayBhZnRlcilcbiAgICAgICAgICAgIGRhdGFCZWZvcmVPcHRpbWlzdGljVXBkYXRlID0gc3RydWN0dXJlZENsb25lKGxhdGVzdFZhbHVlLmN1cnJlbnQ/LnZhbHVlKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3QgdXBkYXRlID0gb3B0aW9ucy5vcHRpbWlzdGljVXBkYXRlO1xuICAgICAgICAgIHNldCgocHJldlN0YXRlKSA9PiAoeyAuLi5wcmV2U3RhdGUsIGRhdGE6IHVwZGF0ZShwcmV2U3RhdGUuZGF0YSkgfSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhd2FpdCBhc3luY1VwZGF0ZTtcbiAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICBpZiAodHlwZW9mIG9wdGlvbnM/LnJvbGxiYWNrT25FcnJvciA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgY29uc3QgdXBkYXRlID0gb3B0aW9ucy5yb2xsYmFja09uRXJyb3I7XG4gICAgICAgICAgc2V0KChwcmV2U3RhdGUpID0+ICh7IC4uLnByZXZTdGF0ZSwgZGF0YTogdXBkYXRlKHByZXZTdGF0ZS5kYXRhKSB9KSk7XG4gICAgICAgIH0gZWxzZSBpZiAob3B0aW9ucz8ub3B0aW1pc3RpY1VwZGF0ZSAmJiBvcHRpb25zPy5yb2xsYmFja09uRXJyb3IgIT09IGZhbHNlKSB7XG4gICAgICAgICAgc2V0KChwcmV2U3RhdGUpID0+ICh7IC4uLnByZXZTdGF0ZSwgZGF0YTogZGF0YUJlZm9yZU9wdGltaXN0aWNVcGRhdGUgfSkpO1xuICAgICAgICB9XG4gICAgICAgIHRocm93IGVycjtcbiAgICAgIH0gZmluYWxseSB7XG4gICAgICAgIGlmIChvcHRpb25zPy5zaG91bGRSZXZhbGlkYXRlQWZ0ZXIgIT09IGZhbHNlKSB7XG4gICAgICAgICAgaWYgKGVudmlyb25tZW50LmxhdW5jaFR5cGUgPT09IExhdW5jaFR5cGUuQmFja2dyb3VuZCB8fCBlbnZpcm9ubWVudC5jb21tYW5kTW9kZSA9PT0gXCJtZW51LWJhclwiKSB7XG4gICAgICAgICAgICAvLyB3aGVuIGluIHRoZSBiYWNrZ3JvdW5kIG9yIGluIGEgbWVudSBiYXIsIHdlIGFyZSBnb2luZyB0byBhd2FpdCB0aGUgcmV2YWxpZGF0aW9uXG4gICAgICAgICAgICAvLyB0byBtYWtlIHN1cmUgd2UgZ2V0IHRoZSByaWdodCBkYXRhIGF0IHRoZSBlbmQgb2YgdGhlIG11dGF0aW9uXG4gICAgICAgICAgICBhd2FpdCByZXZhbGlkYXRlKCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldmFsaWRhdGUoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LFxuICAgIFtyZXZhbGlkYXRlLCBsYXRlc3RWYWx1ZSwgc2V0LCBhYm9ydF0sXG4gICk7XG5cbiAgY29uc3Qgb25Mb2FkTW9yZSA9IHVzZUNhbGxiYWNrKCgpID0+IHtcbiAgICBwYWdpbmF0aW9uQXJnc1JlZi5jdXJyZW50LnBhZ2UgKz0gMTtcbiAgICBjb25zdCBhcmdzID0gKGxhdGVzdEFyZ3MuY3VycmVudCB8fCBbXSkgYXMgUGFyYW1ldGVyczxUPjtcbiAgICBjYWxsYmFjayguLi5hcmdzKTtcbiAgfSwgW3BhZ2luYXRpb25BcmdzUmVmLCBsYXRlc3RBcmdzLCBjYWxsYmFja10pO1xuXG4gIC8vIHJldmFsaWRhdGUgd2hlbiB0aGUgYXJncyBjaGFuZ2VcbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAvLyByZXNldCB0aGUgcGFnaW5hdGlvblxuICAgIHBhZ2luYXRpb25BcmdzUmVmLmN1cnJlbnQgPSB7IHBhZ2U6IDAgfTtcblxuICAgIGlmIChvcHRpb25zPy5leGVjdXRlICE9PSBmYWxzZSkge1xuICAgICAgY2FsbGJhY2soLi4uKChhcmdzIHx8IFtdKSBhcyBQYXJhbWV0ZXJzPFQ+KSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIGNhbmNlbCB0aGUgcHJldmlvdXMgcmVxdWVzdCBpZiB3ZSBkb24ndCB3YW50IHRvIGV4ZWN1dGUgYW55bW9yZVxuICAgICAgYWJvcnQoKTtcbiAgICB9XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHJlYWN0LWhvb2tzL2V4aGF1c3RpdmUtZGVwc1xuICB9LCBbdXNlRGVlcE1lbW8oW2FyZ3MsIG9wdGlvbnM/LmV4ZWN1dGUsIGNhbGxiYWNrXSksIGxhdGVzdEFib3J0YWJsZSwgcGFnaW5hdGlvbkFyZ3NSZWZdKTtcblxuICAvLyBhYm9ydCByZXF1ZXN0IHdoZW4gdW5tb3VudGluZ1xuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICBhYm9ydCgpO1xuICAgIH07XG4gIH0sIFthYm9ydF0pO1xuXG4gIC8vIHdlIG9ubHkgd2FudCB0byBzaG93IHRoZSBsb2FkaW5nIGluZGljYXRvciBpZiB0aGUgcHJvbWlzZSBpcyBleGVjdXRpbmdcbiAgY29uc3QgaXNMb2FkaW5nID0gb3B0aW9ucz8uZXhlY3V0ZSAhPT0gZmFsc2UgPyBzdGF0ZS5pc0xvYWRpbmcgOiBmYWxzZTtcblxuICAvLyBAdHMtZXhwZWN0LWVycm9yIGxvYWRpbmcgaXMgaGFzIHNvbWUgZml4ZWQgdmFsdWUgaW4gdGhlIGVudW0gd2hpY2hcbiAgY29uc3Qgc3RhdGVXaXRoTG9hZGluZ0ZpeGVkOiBBc3luY1N0YXRlPEF3YWl0ZWQ8UmV0dXJuVHlwZTxUPj4+ID0geyAuLi5zdGF0ZSwgaXNMb2FkaW5nIH07XG5cbiAgY29uc3QgcGFnaW5hdGlvbiA9IHVzZVBhZ2luYXRpb25SZWYuY3VycmVudFxuICAgID8ge1xuICAgICAgICBwYWdlU2l6ZTogcGFnZVNpemVSZWYuY3VycmVudCxcbiAgICAgICAgaGFzTW9yZTogaGFzTW9yZVJlZi5jdXJyZW50LFxuICAgICAgICBvbkxvYWRNb3JlLFxuICAgICAgfVxuICAgIDogdW5kZWZpbmVkO1xuXG4gIHJldHVybiB7IC4uLnN0YXRlV2l0aExvYWRpbmdGaXhlZCwgcmV2YWxpZGF0ZSwgbXV0YXRlLCBwYWdpbmF0aW9uIH07XG59XG5cbi8qKiBCaW5kIHRoZSBmbiBpZiBpdCdzIGEgUHJvbWlzZSBtZXRob2QgKi9cbmZ1bmN0aW9uIGJpbmRQcm9taXNlSWZOZWVkZWQ8VD4oZm46IFQpOiBUIHtcbiAgaWYgKGZuID09PSAoUHJvbWlzZS5hbGwgYXMgYW55KSkge1xuICAgIC8vIEB0cy1leHBlY3QtZXJyb3IgdGhpcyBpcyBmaW5lXG4gICAgcmV0dXJuIGZuLmJpbmQoUHJvbWlzZSk7XG4gIH1cbiAgaWYgKGZuID09PSAoUHJvbWlzZS5yYWNlIGFzIGFueSkpIHtcbiAgICAvLyBAdHMtZXhwZWN0LWVycm9yIHRoaXMgaXMgZmluZVxuICAgIHJldHVybiBmbi5iaW5kKFByb21pc2UpO1xuICB9XG4gIGlmIChmbiA9PT0gKFByb21pc2UucmVzb2x2ZSBhcyBhbnkpKSB7XG4gICAgLy8gQHRzLWV4cGVjdC1lcnJvciB0aGlzIGlzIGZpbmVcbiAgICByZXR1cm4gZm4uYmluZChQcm9taXNlIGFzIGFueSk7XG4gIH1cbiAgaWYgKGZuID09PSAoUHJvbWlzZS5yZWplY3QgYXMgYW55KSkge1xuICAgIC8vIEB0cy1leHBlY3QtZXJyb3IgdGhpcyBpcyBmaW5lXG4gICAgcmV0dXJuIGZuLmJpbmQoUHJvbWlzZSk7XG4gIH1cbiAgcmV0dXJuIGZuO1xufVxuIiwgImltcG9ydCB7IHVzZVJlZiwgdXNlTWVtbyB9IGZyb20gXCJyZWFjdFwiO1xuaW1wb3J0IHsgZGVxdWFsIH0gZnJvbSBcImRlcXVhbC9saXRlXCI7XG5cbi8qKlxuICogQHBhcmFtIHZhbHVlIHRoZSB2YWx1ZSB0byBiZSBtZW1vaXplZCAodXN1YWxseSBhIGRlcGVuZGVuY3kgbGlzdClcbiAqIEByZXR1cm5zIGEgbWVtb2l6ZWQgdmVyc2lvbiBvZiB0aGUgdmFsdWUgYXMgbG9uZyBhcyBpdCByZW1haW5zIGRlZXBseSBlcXVhbFxuICovXG5leHBvcnQgZnVuY3Rpb24gdXNlRGVlcE1lbW88VD4odmFsdWU6IFQpIHtcbiAgY29uc3QgcmVmID0gdXNlUmVmPFQ+KHZhbHVlKTtcbiAgY29uc3Qgc2lnbmFsUmVmID0gdXNlUmVmPG51bWJlcj4oMCk7XG5cbiAgaWYgKCFkZXF1YWwodmFsdWUsIHJlZi5jdXJyZW50KSkge1xuICAgIHJlZi5jdXJyZW50ID0gdmFsdWU7XG4gICAgc2lnbmFsUmVmLmN1cnJlbnQgKz0gMTtcbiAgfVxuXG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSByZWFjdC1ob29rcy9leGhhdXN0aXZlLWRlcHNcbiAgcmV0dXJuIHVzZU1lbW8oKCkgPT4gcmVmLmN1cnJlbnQsIFtzaWduYWxSZWYuY3VycmVudF0pO1xufVxuIiwgImltcG9ydCB7IHVzZVJlZiB9IGZyb20gXCJyZWFjdFwiO1xuXG4vKipcbiAqIFJldHVybnMgdGhlIGxhdGVzdCBzdGF0ZS5cbiAqXG4gKiBUaGlzIGlzIG1vc3RseSB1c2VmdWwgdG8gZ2V0IGFjY2VzcyB0byB0aGUgbGF0ZXN0IHZhbHVlIG9mIHNvbWUgcHJvcHMgb3Igc3RhdGUgaW5zaWRlIGFuIGFzeW5jaHJvbm91cyBjYWxsYmFjaywgaW5zdGVhZCBvZiB0aGF0IHZhbHVlIGF0IHRoZSB0aW1lIHRoZSBjYWxsYmFjayB3YXMgY3JlYXRlZCBmcm9tLlxuICovXG5leHBvcnQgZnVuY3Rpb24gdXNlTGF0ZXN0PFQ+KHZhbHVlOiBUKTogeyByZWFkb25seSBjdXJyZW50OiBUIH0ge1xuICBjb25zdCByZWYgPSB1c2VSZWYodmFsdWUpO1xuICByZWYuY3VycmVudCA9IHZhbHVlO1xuICByZXR1cm4gcmVmO1xufVxuIiwgImltcG9ydCAqIGFzIGZzIGZyb20gXCJub2RlOmZzXCI7XG5pbXBvcnQgKiBhcyBwYXRoIGZyb20gXCJub2RlOnBhdGhcIjtcbmltcG9ydCB7IENsaXBib2FyZCwgZW52aXJvbm1lbnQsIG9wZW4sIFRvYXN0LCBzaG93VG9hc3QgfSBmcm9tIFwiQHJheWNhc3QvYXBpXCI7XG5cbi8qKlxuICogU2hvd3MgYSBmYWlsdXJlIFRvYXN0IGZvciBhIGdpdmVuIEVycm9yLlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGB0eXBlc2NyaXB0XG4gKiBpbXBvcnQgeyBzaG93SFVEIH0gZnJvbSBcIkByYXljYXN0L2FwaVwiO1xuICogaW1wb3J0IHsgcnVuQXBwbGVTY3JpcHQsIHNob3dGYWlsdXJlVG9hc3QgfSBmcm9tIFwiQHJheWNhc3QvdXRpbHNcIjtcbiAqXG4gKiBleHBvcnQgZGVmYXVsdCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gKiAgIHRyeSB7XG4gKiAgICAgY29uc3QgcmVzID0gYXdhaXQgcnVuQXBwbGVTY3JpcHQoXG4gKiAgICAgICBgXG4gKiAgICAgICBvbiBydW4gYXJndlxuICogICAgICAgICByZXR1cm4gXCJoZWxsbywgXCIgJiBpdGVtIDEgb2YgYXJndiAmIFwiLlwiXG4gKiAgICAgICBlbmQgcnVuXG4gKiAgICAgICBgLFxuICogICAgICAgW1wid29ybGRcIl1cbiAqICAgICApO1xuICogICAgIGF3YWl0IHNob3dIVUQocmVzKTtcbiAqICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAqICAgICBzaG93RmFpbHVyZVRvYXN0KGVycm9yLCB7IHRpdGxlOiBcIkNvdWxkIG5vdCBydW4gQXBwbGVTY3JpcHRcIiB9KTtcbiAqICAgfVxuICogfVxuICogYGBgXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzaG93RmFpbHVyZVRvYXN0KFxuICBlcnJvcjogdW5rbm93bixcbiAgb3B0aW9ucz86IFBhcnRpYWw8UGljazxUb2FzdC5PcHRpb25zLCBcInRpdGxlXCIgfCBcInByaW1hcnlBY3Rpb25cIiB8IFwibWVzc2FnZVwiPj4sXG4pIHtcbiAgY29uc3QgbWVzc2FnZSA9IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogU3RyaW5nKGVycm9yKTtcbiAgcmV0dXJuIHNob3dUb2FzdCh7XG4gICAgc3R5bGU6IFRvYXN0LlN0eWxlLkZhaWx1cmUsXG4gICAgdGl0bGU6IG9wdGlvbnM/LnRpdGxlID8/IFwiU29tZXRoaW5nIHdlbnQgd3JvbmdcIixcbiAgICBtZXNzYWdlOiBvcHRpb25zPy5tZXNzYWdlID8/IG1lc3NhZ2UsXG4gICAgcHJpbWFyeUFjdGlvbjogb3B0aW9ucz8ucHJpbWFyeUFjdGlvbiA/PyBoYW5kbGVFcnJvclRvYXN0QWN0aW9uKGVycm9yKSxcbiAgICBzZWNvbmRhcnlBY3Rpb246IG9wdGlvbnM/LnByaW1hcnlBY3Rpb24gPyBoYW5kbGVFcnJvclRvYXN0QWN0aW9uKGVycm9yKSA6IHVuZGVmaW5lZCxcbiAgfSk7XG59XG5cbmNvbnN0IGhhbmRsZUVycm9yVG9hc3RBY3Rpb24gPSAoZXJyb3I6IHVua25vd24pOiBUb2FzdC5BY3Rpb25PcHRpb25zID0+IHtcbiAgbGV0IHByaXZhdGVFeHRlbnNpb24gPSB0cnVlO1xuICBsZXQgdGl0bGUgPSBcIltFeHRlbnNpb24gTmFtZV0uLi5cIjtcbiAgbGV0IGV4dGVuc2lvblVSTCA9IFwiXCI7XG4gIHRyeSB7XG4gICAgY29uc3QgcGFja2FnZUpTT04gPSBKU09OLnBhcnNlKGZzLnJlYWRGaWxlU3luYyhwYXRoLmpvaW4oZW52aXJvbm1lbnQuYXNzZXRzUGF0aCwgXCIuLlwiLCBcInBhY2thZ2UuanNvblwiKSwgXCJ1dGY4XCIpKTtcbiAgICB0aXRsZSA9IGBbJHtwYWNrYWdlSlNPTi50aXRsZX1dLi4uYDtcbiAgICBleHRlbnNpb25VUkwgPSBgaHR0cHM6Ly9yYXljYXN0LmNvbS8ke3BhY2thZ2VKU09OLm93bmVyIHx8IHBhY2thZ2VKU09OLmF1dGhvcn0vJHtwYWNrYWdlSlNPTi5uYW1lfWA7XG4gICAgaWYgKCFwYWNrYWdlSlNPTi5vd25lciB8fCBwYWNrYWdlSlNPTi5hY2Nlc3MgPT09IFwicHVibGljXCIpIHtcbiAgICAgIHByaXZhdGVFeHRlbnNpb24gPSBmYWxzZTtcbiAgICB9XG4gIH0gY2F0Y2ggKGVycikge1xuICAgIC8vIG5vLW9wXG4gIH1cblxuICAvLyBpZiBpdCdzIGEgcHJpdmF0ZSBleHRlbnNpb24sIHdlIGNhbid0IGNvbnN0cnVjdCB0aGUgVVJMIHRvIHJlcG9ydCB0aGUgZXJyb3JcbiAgLy8gc28gd2UgZmFsbGJhY2sgdG8gY29weWluZyB0aGUgZXJyb3IgdG8gdGhlIGNsaXBib2FyZFxuICBjb25zdCBmYWxsYmFjayA9IGVudmlyb25tZW50LmlzRGV2ZWxvcG1lbnQgfHwgcHJpdmF0ZUV4dGVuc2lvbjtcblxuICBjb25zdCBzdGFjayA9IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvcj8uc3RhY2sgfHwgZXJyb3I/Lm1lc3NhZ2UgfHwgXCJcIiA6IFN0cmluZyhlcnJvcik7XG5cbiAgcmV0dXJuIHtcbiAgICB0aXRsZTogZmFsbGJhY2sgPyBcIkNvcHkgTG9nc1wiIDogXCJSZXBvcnQgRXJyb3JcIixcbiAgICBvbkFjdGlvbih0b2FzdCkge1xuICAgICAgdG9hc3QuaGlkZSgpO1xuICAgICAgaWYgKGZhbGxiYWNrKSB7XG4gICAgICAgIENsaXBib2FyZC5jb3B5KHN0YWNrKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG9wZW4oXG4gICAgICAgICAgYGh0dHBzOi8vZ2l0aHViLmNvbS9yYXljYXN0L2V4dGVuc2lvbnMvaXNzdWVzL25ldz8mbGFiZWxzPWV4dGVuc2lvbiUyQ2J1ZyZ0ZW1wbGF0ZT1leHRlbnNpb25fYnVnX3JlcG9ydC55bWwmdGl0bGU9JHtlbmNvZGVVUklDb21wb25lbnQoXG4gICAgICAgICAgICB0aXRsZSxcbiAgICAgICAgICApfSZleHRlbnNpb24tdXJsPSR7ZW5jb2RlVVJJKGV4dGVuc2lvblVSTCl9JmRlc2NyaXB0aW9uPSR7ZW5jb2RlVVJJQ29tcG9uZW50KFxuICAgICAgICAgICAgYCMjIyMgRXJyb3I6XG5cXGBcXGBcXGBcbiR7c3RhY2t9XG5cXGBcXGBcXGBcbmAsXG4gICAgICAgICAgKX1gLFxuICAgICAgICApO1xuICAgICAgfVxuICAgIH0sXG4gIH07XG59O1xuIiwgImltcG9ydCB7IHVzZUNhbGxiYWNrLCBEaXNwYXRjaCwgU2V0U3RhdGVBY3Rpb24sIHVzZVN5bmNFeHRlcm5hbFN0b3JlLCB1c2VNZW1vIH0gZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgeyBDYWNoZSB9IGZyb20gXCJAcmF5Y2FzdC9hcGlcIjtcbmltcG9ydCB7IHVzZUxhdGVzdCB9IGZyb20gXCIuL3VzZUxhdGVzdFwiO1xuaW1wb3J0IHsgcmVwbGFjZXIsIHJldml2ZXIgfSBmcm9tIFwiLi9oZWxwZXJzXCI7XG5cbmNvbnN0IHJvb3RDYWNoZSA9IC8qICNfX1BVUkVfXyAqLyBTeW1ib2woXCJjYWNoZSB3aXRob3V0IG5hbWVzcGFjZVwiKTtcbmNvbnN0IGNhY2hlTWFwID0gLyogI19fUFVSRV9fICovIG5ldyBNYXA8c3RyaW5nIHwgc3ltYm9sLCBDYWNoZT4oKTtcblxuLyoqXG4gKiBSZXR1cm5zIGEgc3RhdGVmdWwgdmFsdWUsIGFuZCBhIGZ1bmN0aW9uIHRvIHVwZGF0ZSBpdC4gVGhlIHZhbHVlIHdpbGwgYmUga2VwdCBiZXR3ZWVuIGNvbW1hbmQgcnVucy5cbiAqXG4gKiBAcmVtYXJrIFRoZSB2YWx1ZSBuZWVkcyB0byBiZSBKU09OIHNlcmlhbGl6YWJsZS5cbiAqXG4gKiBAcGFyYW0ga2V5IC0gVGhlIHVuaXF1ZSBpZGVudGlmaWVyIG9mIHRoZSBzdGF0ZS4gVGhpcyBjYW4gYmUgdXNlZCB0byBzaGFyZSB0aGUgc3RhdGUgYWNyb3NzIGNvbXBvbmVudHMgYW5kL29yIGNvbW1hbmRzLlxuICogQHBhcmFtIGluaXRpYWxTdGF0ZSAtIFRoZSBpbml0aWFsIHZhbHVlIG9mIHRoZSBzdGF0ZSBpZiB0aGVyZSBhcmVuJ3QgYW55IGluIHRoZSBDYWNoZSB5ZXQuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB1c2VDYWNoZWRTdGF0ZTxUPihcbiAga2V5OiBzdHJpbmcsXG4gIGluaXRpYWxTdGF0ZTogVCxcbiAgY29uZmlnPzogeyBjYWNoZU5hbWVzcGFjZT86IHN0cmluZyB9LFxuKTogW1QsIERpc3BhdGNoPFNldFN0YXRlQWN0aW9uPFQ+Pl07XG5leHBvcnQgZnVuY3Rpb24gdXNlQ2FjaGVkU3RhdGU8VCA9IHVuZGVmaW5lZD4oa2V5OiBzdHJpbmcpOiBbVCB8IHVuZGVmaW5lZCwgRGlzcGF0Y2g8U2V0U3RhdGVBY3Rpb248VCB8IHVuZGVmaW5lZD4+XTtcbmV4cG9ydCBmdW5jdGlvbiB1c2VDYWNoZWRTdGF0ZTxUPihcbiAga2V5OiBzdHJpbmcsXG4gIGluaXRpYWxTdGF0ZT86IFQsXG4gIGNvbmZpZz86IHsgY2FjaGVOYW1lc3BhY2U/OiBzdHJpbmcgfSxcbik6IFtULCBEaXNwYXRjaDxTZXRTdGF0ZUFjdGlvbjxUPj5dIHtcbiAgY29uc3QgY2FjaGVLZXkgPSBjb25maWc/LmNhY2hlTmFtZXNwYWNlIHx8IHJvb3RDYWNoZTtcbiAgY29uc3QgY2FjaGUgPVxuICAgIGNhY2hlTWFwLmdldChjYWNoZUtleSkgfHwgY2FjaGVNYXAuc2V0KGNhY2hlS2V5LCBuZXcgQ2FjaGUoeyBuYW1lc3BhY2U6IGNvbmZpZz8uY2FjaGVOYW1lc3BhY2UgfSkpLmdldChjYWNoZUtleSk7XG5cbiAgaWYgKCFjYWNoZSkge1xuICAgIHRocm93IG5ldyBFcnJvcihcIk1pc3NpbmcgY2FjaGVcIik7XG4gIH1cblxuICBjb25zdCBrZXlSZWYgPSB1c2VMYXRlc3Qoa2V5KTtcbiAgY29uc3QgaW5pdGlhbFZhbHVlUmVmID0gdXNlTGF0ZXN0KGluaXRpYWxTdGF0ZSk7XG5cbiAgY29uc3QgY2FjaGVkU3RhdGUgPSB1c2VTeW5jRXh0ZXJuYWxTdG9yZShjYWNoZS5zdWJzY3JpYmUsICgpID0+IHtcbiAgICB0cnkge1xuICAgICAgcmV0dXJuIGNhY2hlLmdldChrZXlSZWYuY3VycmVudCk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJDb3VsZCBub3QgZ2V0IENhY2hlIGRhdGE6XCIsIGVycm9yKTtcbiAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuICB9KTtcblxuICBjb25zdCBzdGF0ZSA9IHVzZU1lbW8oKCkgPT4ge1xuICAgIGlmICh0eXBlb2YgY2FjaGVkU3RhdGUgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgIGlmIChjYWNoZWRTdGF0ZSA9PT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgfVxuICAgICAgdHJ5IHtcbiAgICAgICAgcmV0dXJuIEpTT04ucGFyc2UoY2FjaGVkU3RhdGUsIHJldml2ZXIpO1xuICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgIC8vIHRoZSBkYXRhIGdvdCBjb3JydXB0ZWQgc29tZWhvd1xuICAgICAgICBjb25zb2xlLndhcm4oXCJUaGUgY2FjaGVkIGRhdGEgaXMgY29ycnVwdGVkXCIsIGVycik7XG4gICAgICAgIHJldHVybiBpbml0aWFsVmFsdWVSZWYuY3VycmVudDtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIGluaXRpYWxWYWx1ZVJlZi5jdXJyZW50O1xuICAgIH1cbiAgfSwgW2NhY2hlZFN0YXRlLCBpbml0aWFsVmFsdWVSZWZdKTtcblxuICBjb25zdCBzdGF0ZVJlZiA9IHVzZUxhdGVzdChzdGF0ZSk7XG5cbiAgY29uc3Qgc2V0U3RhdGVBbmRDYWNoZSA9IHVzZUNhbGxiYWNrKFxuICAgICh1cGRhdGVyOiBTZXRTdGF0ZUFjdGlvbjxUPikgPT4ge1xuICAgICAgLy8gQHRzLWV4cGVjdC1lcnJvciBUUyBzdHJ1Z2dsZXMgdG8gaW5mZXIgdGhlIHR5cGVzIGFzIFQgY291bGQgcG90ZW50aWFsbHkgYmUgYSBmdW5jdGlvblxuICAgICAgY29uc3QgbmV3VmFsdWUgPSB0eXBlb2YgdXBkYXRlciA9PT0gXCJmdW5jdGlvblwiID8gdXBkYXRlcihzdGF0ZVJlZi5jdXJyZW50KSA6IHVwZGF0ZXI7XG4gICAgICBpZiAodHlwZW9mIG5ld1ZhbHVlID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgIGNhY2hlLnNldChrZXlSZWYuY3VycmVudCwgXCJ1bmRlZmluZWRcIik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCBzdHJpbmdpZmllZFZhbHVlID0gSlNPTi5zdHJpbmdpZnkobmV3VmFsdWUsIHJlcGxhY2VyKTtcbiAgICAgICAgY2FjaGUuc2V0KGtleVJlZi5jdXJyZW50LCBzdHJpbmdpZmllZFZhbHVlKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBuZXdWYWx1ZTtcbiAgICB9LFxuICAgIFtjYWNoZSwga2V5UmVmLCBzdGF0ZVJlZl0sXG4gICk7XG5cbiAgcmV0dXJuIFtzdGF0ZSwgc2V0U3RhdGVBbmRDYWNoZV07XG59XG4iLCAiaW1wb3J0IGNyeXB0byBmcm9tIFwibm9kZTpjcnlwdG9cIjtcbmltcG9ydCB7IHR5cGVIYXNoZXIgfSBmcm9tIFwiLi92ZW5kb3JzL3R5cGUtaGFzaGVyXCI7XG5cbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG5leHBvcnQgZnVuY3Rpb24gcmVwbGFjZXIodGhpczogYW55LCBrZXk6IHN0cmluZywgX3ZhbHVlOiB1bmtub3duKSB7XG4gIGNvbnN0IHZhbHVlID0gdGhpc1trZXldO1xuICBpZiAodmFsdWUgaW5zdGFuY2VvZiBEYXRlKSB7XG4gICAgcmV0dXJuIGBfX3JheWNhc3RfY2FjaGVkX2RhdGVfXyR7dmFsdWUudG9JU09TdHJpbmcoKX1gO1xuICB9XG4gIGlmIChCdWZmZXIuaXNCdWZmZXIodmFsdWUpKSB7XG4gICAgcmV0dXJuIGBfX3JheWNhc3RfY2FjaGVkX2J1ZmZlcl9fJHt2YWx1ZS50b1N0cmluZyhcImJhc2U2NFwiKX1gO1xuICB9XG4gIHJldHVybiBfdmFsdWU7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiByZXZpdmVyKF9rZXk6IHN0cmluZywgdmFsdWU6IHVua25vd24pIHtcbiAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIiAmJiB2YWx1ZS5zdGFydHNXaXRoKFwiX19yYXljYXN0X2NhY2hlZF9kYXRlX19cIikpIHtcbiAgICByZXR1cm4gbmV3IERhdGUodmFsdWUucmVwbGFjZShcIl9fcmF5Y2FzdF9jYWNoZWRfZGF0ZV9fXCIsIFwiXCIpKTtcbiAgfVxuICBpZiAodHlwZW9mIHZhbHVlID09PSBcInN0cmluZ1wiICYmIHZhbHVlLnN0YXJ0c1dpdGgoXCJfX3JheWNhc3RfY2FjaGVkX2J1ZmZlcl9fXCIpKSB7XG4gICAgcmV0dXJuIEJ1ZmZlci5mcm9tKHZhbHVlLnJlcGxhY2UoXCJfX3JheWNhc3RfY2FjaGVkX2J1ZmZlcl9fXCIsIFwiXCIpLCBcImJhc2U2NFwiKTtcbiAgfVxuICByZXR1cm4gdmFsdWU7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBoYXNoKG9iamVjdDogYW55KSB7XG4gIGNvbnN0IGhhc2hpbmdTdHJlYW0gPSBjcnlwdG8uY3JlYXRlSGFzaChcInNoYTFcIik7XG4gIGNvbnN0IGhhc2hlciA9IHR5cGVIYXNoZXIoaGFzaGluZ1N0cmVhbSk7XG4gIGhhc2hlci5kaXNwYXRjaChvYmplY3QpO1xuXG4gIHJldHVybiBoYXNoaW5nU3RyZWFtLmRpZ2VzdChcImhleFwiKTtcbn1cbiIsICIvKiBlc2xpbnQtZGlzYWJsZSBAdHlwZXNjcmlwdC1lc2xpbnQvYmFuLXRzLWNvbW1lbnQgKi9cbi8qIGVzbGludC1kaXNhYmxlIEB0eXBlc2NyaXB0LWVzbGludC9uby10aGlzLWFsaWFzICovXG4vKiBlc2xpbnQtZGlzYWJsZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55ICovXG5pbXBvcnQgY3J5cHRvIGZyb20gXCJub2RlOmNyeXB0b1wiO1xuXG4vKiogQ2hlY2sgaWYgdGhlIGdpdmVuIGZ1bmN0aW9uIGlzIGEgbmF0aXZlIGZ1bmN0aW9uICovXG5mdW5jdGlvbiBpc05hdGl2ZUZ1bmN0aW9uKGY6IGFueSkge1xuICBpZiAodHlwZW9mIGYgIT09IFwiZnVuY3Rpb25cIikge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICBjb25zdCBleHAgPSAvXmZ1bmN0aW9uXFxzK1xcdypcXHMqXFwoXFxzKlxcKVxccyp7XFxzK1xcW25hdGl2ZSBjb2RlXFxdXFxzK30kL2k7XG4gIHJldHVybiBleHAuZXhlYyhGdW5jdGlvbi5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChmKSkgIT09IG51bGw7XG59XG5cbmZ1bmN0aW9uIGhhc2hSZXBsYWNlcih2YWx1ZTogYW55KTogc3RyaW5nIHtcbiAgaWYgKHZhbHVlIGluc3RhbmNlb2YgVVJMU2VhcmNoUGFyYW1zKSB7XG4gICAgcmV0dXJuIHZhbHVlLnRvU3RyaW5nKCk7XG4gIH1cbiAgcmV0dXJuIHZhbHVlO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdHlwZUhhc2hlcihcbiAgd3JpdGVUbzpcbiAgICB8IGNyeXB0by5IYXNoXG4gICAgfCB7XG4gICAgICAgIGJ1Zjogc3RyaW5nO1xuICAgICAgICB3cml0ZTogKGI6IGFueSkgPT4gdm9pZDtcbiAgICAgICAgZW5kOiAoYjogYW55KSA9PiB2b2lkO1xuICAgICAgICByZWFkOiAoKSA9PiBzdHJpbmc7XG4gICAgICB9LFxuICBjb250ZXh0OiBhbnlbXSA9IFtdLFxuKSB7XG4gIGZ1bmN0aW9uIHdyaXRlKHN0cjogc3RyaW5nKSB7XG4gICAgaWYgKFwidXBkYXRlXCIgaW4gd3JpdGVUbykge1xuICAgICAgcmV0dXJuIHdyaXRlVG8udXBkYXRlKHN0ciwgXCJ1dGY4XCIpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gd3JpdGVUby53cml0ZShzdHIpO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiB7XG4gICAgZGlzcGF0Y2g6IGZ1bmN0aW9uICh2YWx1ZTogYW55KSB7XG4gICAgICB2YWx1ZSA9IGhhc2hSZXBsYWNlcih2YWx1ZSk7XG5cbiAgICAgIGNvbnN0IHR5cGUgPSB0eXBlb2YgdmFsdWU7XG4gICAgICBpZiAodmFsdWUgPT09IG51bGwpIHtcbiAgICAgICAgdGhpc1tcIl9udWxsXCJdKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgIHRoaXNbXCJfXCIgKyB0eXBlXSh2YWx1ZSk7XG4gICAgICB9XG4gICAgfSxcbiAgICBfb2JqZWN0OiBmdW5jdGlvbiAob2JqZWN0OiBhbnkpIHtcbiAgICAgIGNvbnN0IHBhdHRlcm4gPSAvXFxbb2JqZWN0ICguKilcXF0vaTtcbiAgICAgIGNvbnN0IG9ialN0cmluZyA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChvYmplY3QpO1xuICAgICAgbGV0IG9ialR5cGUgPSBwYXR0ZXJuLmV4ZWMob2JqU3RyaW5nKT8uWzFdID8/IFwidW5rbm93bjpbXCIgKyBvYmpTdHJpbmcgKyBcIl1cIjtcbiAgICAgIG9ialR5cGUgPSBvYmpUeXBlLnRvTG93ZXJDYXNlKCk7XG5cbiAgICAgIGxldCBvYmplY3ROdW1iZXIgPSBudWxsIGFzIGFueTtcblxuICAgICAgaWYgKChvYmplY3ROdW1iZXIgPSBjb250ZXh0LmluZGV4T2Yob2JqZWN0KSkgPj0gMCkge1xuICAgICAgICB0aGlzLmRpc3BhdGNoKFwiW0NJUkNVTEFSOlwiICsgb2JqZWN0TnVtYmVyICsgXCJdXCIpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb250ZXh0LnB1c2gob2JqZWN0KTtcbiAgICAgIH1cblxuICAgICAgaWYgKEJ1ZmZlci5pc0J1ZmZlcihvYmplY3QpKSB7XG4gICAgICAgIHdyaXRlKFwiYnVmZmVyOlwiKTtcbiAgICAgICAgcmV0dXJuIHdyaXRlKG9iamVjdC50b1N0cmluZyhcInV0ZjhcIikpO1xuICAgICAgfVxuXG4gICAgICBpZiAob2JqVHlwZSAhPT0gXCJvYmplY3RcIiAmJiBvYmpUeXBlICE9PSBcImZ1bmN0aW9uXCIgJiYgb2JqVHlwZSAhPT0gXCJhc3luY2Z1bmN0aW9uXCIpIHtcbiAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICBpZiAodGhpc1tcIl9cIiArIG9ialR5cGVdKSB7XG4gICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgIHRoaXNbXCJfXCIgKyBvYmpUeXBlXShvYmplY3QpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignVW5rbm93biBvYmplY3QgdHlwZSBcIicgKyBvYmpUeXBlICsgJ1wiJyk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGxldCBrZXlzID0gT2JqZWN0LmtleXMob2JqZWN0KTtcbiAgICAgICAga2V5cyA9IGtleXMuc29ydCgpO1xuICAgICAgICAvLyBNYWtlIHN1cmUgdG8gaW5jb3Jwb3JhdGUgc3BlY2lhbCBwcm9wZXJ0aWVzLCBzb1xuICAgICAgICAvLyBUeXBlcyB3aXRoIGRpZmZlcmVudCBwcm90b3R5cGVzIHdpbGwgcHJvZHVjZVxuICAgICAgICAvLyBhIGRpZmZlcmVudCBoYXNoIGFuZCBvYmplY3RzIGRlcml2ZWQgZnJvbVxuICAgICAgICAvLyBkaWZmZXJlbnQgZnVuY3Rpb25zIChgbmV3IEZvb2AsIGBuZXcgQmFyYCkgd2lsbFxuICAgICAgICAvLyBwcm9kdWNlIGRpZmZlcmVudCBoYXNoZXMuXG4gICAgICAgIC8vIFdlIG5ldmVyIGRvIHRoaXMgZm9yIG5hdGl2ZSBmdW5jdGlvbnMgc2luY2Ugc29tZVxuICAgICAgICAvLyBzZWVtIHRvIGJyZWFrIGJlY2F1c2Ugb2YgdGhhdC5cbiAgICAgICAgaWYgKCFpc05hdGl2ZUZ1bmN0aW9uKG9iamVjdCkpIHtcbiAgICAgICAgICBrZXlzLnNwbGljZSgwLCAwLCBcInByb3RvdHlwZVwiLCBcIl9fcHJvdG9fX1wiLCBcImNvbnN0cnVjdG9yXCIpO1xuICAgICAgICB9XG5cbiAgICAgICAgd3JpdGUoXCJvYmplY3Q6XCIgKyBrZXlzLmxlbmd0aCArIFwiOlwiKTtcbiAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XG4gICAgICAgIHJldHVybiBrZXlzLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xuICAgICAgICAgIHNlbGYuZGlzcGF0Y2goa2V5KTtcbiAgICAgICAgICB3cml0ZShcIjpcIik7XG4gICAgICAgICAgc2VsZi5kaXNwYXRjaChvYmplY3Rba2V5XSk7XG4gICAgICAgICAgd3JpdGUoXCIsXCIpO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9LFxuICAgIF9hcnJheTogZnVuY3Rpb24gKGFycjogYW55W10sIHVub3JkZXJlZDogYm9vbGVhbikge1xuICAgICAgdW5vcmRlcmVkID0gdHlwZW9mIHVub3JkZXJlZCAhPT0gXCJ1bmRlZmluZWRcIiA/IHVub3JkZXJlZCA6IGZhbHNlOyAvLyBkZWZhdWx0IHRvIG9wdGlvbnMudW5vcmRlcmVkQXJyYXlzXG5cbiAgICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xuICAgICAgd3JpdGUoXCJhcnJheTpcIiArIGFyci5sZW5ndGggKyBcIjpcIik7XG4gICAgICBpZiAoIXVub3JkZXJlZCB8fCBhcnIubGVuZ3RoIDw9IDEpIHtcbiAgICAgICAgYXJyLmZvckVhY2goZnVuY3Rpb24gKGVudHJ5OiBhbnkpIHtcbiAgICAgICAgICBzZWxmLmRpc3BhdGNoKGVudHJ5KTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgLy8gdGhlIHVub3JkZXJlZCBjYXNlIGlzIGEgbGl0dGxlIG1vcmUgY29tcGxpY2F0ZWQ6XG4gICAgICAvLyBzaW5jZSB0aGVyZSBpcyBubyBjYW5vbmljYWwgb3JkZXJpbmcgb24gb2JqZWN0cyxcbiAgICAgIC8vIGkuZS4ge2E6MX0gPCB7YToyfSBhbmQge2E6MX0gPiB7YToyfSBhcmUgYm90aCBmYWxzZSxcbiAgICAgIC8vIHdlIGZpcnN0IHNlcmlhbGl6ZSBlYWNoIGVudHJ5IHVzaW5nIGEgUGFzc1Rocm91Z2ggc3RyZWFtXG4gICAgICAvLyBiZWZvcmUgc29ydGluZy5cbiAgICAgIC8vIGFsc286IHdlIGNhbuKAmXQgdXNlIHRoZSBzYW1lIGNvbnRleHQgYXJyYXkgZm9yIGFsbCBlbnRyaWVzXG4gICAgICAvLyBzaW5jZSB0aGUgb3JkZXIgb2YgaGFzaGluZyBzaG91bGQgKm5vdCogbWF0dGVyLiBpbnN0ZWFkLFxuICAgICAgLy8gd2Uga2VlcCB0cmFjayBvZiB0aGUgYWRkaXRpb25zIHRvIGEgY29weSBvZiB0aGUgY29udGV4dCBhcnJheVxuICAgICAgLy8gYW5kIGFkZCBhbGwgb2YgdGhlbSB0byB0aGUgZ2xvYmFsIGNvbnRleHQgYXJyYXkgd2hlbiB3ZeKAmXJlIGRvbmVcbiAgICAgIGxldCBjb250ZXh0QWRkaXRpb25zOiBhbnlbXSA9IFtdO1xuICAgICAgY29uc3QgZW50cmllcyA9IGFyci5tYXAoZnVuY3Rpb24gKGVudHJ5OiBhbnkpIHtcbiAgICAgICAgY29uc3Qgc3RybSA9IFBhc3NUaHJvdWdoKCk7XG4gICAgICAgIGNvbnN0IGxvY2FsQ29udGV4dCA9IGNvbnRleHQuc2xpY2UoKTsgLy8gbWFrZSBjb3B5XG4gICAgICAgIGNvbnN0IGhhc2hlciA9IHR5cGVIYXNoZXIoc3RybSwgbG9jYWxDb250ZXh0KTtcbiAgICAgICAgaGFzaGVyLmRpc3BhdGNoKGVudHJ5KTtcbiAgICAgICAgLy8gdGFrZSBvbmx5IHdoYXQgd2FzIGFkZGVkIHRvIGxvY2FsQ29udGV4dCBhbmQgYXBwZW5kIGl0IHRvIGNvbnRleHRBZGRpdGlvbnNcbiAgICAgICAgY29udGV4dEFkZGl0aW9ucyA9IGNvbnRleHRBZGRpdGlvbnMuY29uY2F0KGxvY2FsQ29udGV4dC5zbGljZShjb250ZXh0Lmxlbmd0aCkpO1xuICAgICAgICByZXR1cm4gc3RybS5yZWFkKCkudG9TdHJpbmcoKTtcbiAgICAgIH0pO1xuICAgICAgY29udGV4dCA9IGNvbnRleHQuY29uY2F0KGNvbnRleHRBZGRpdGlvbnMpO1xuICAgICAgZW50cmllcy5zb3J0KCk7XG4gICAgICB0aGlzLl9hcnJheShlbnRyaWVzLCBmYWxzZSk7XG4gICAgfSxcbiAgICBfZGF0ZTogZnVuY3Rpb24gKGRhdGU6IERhdGUpIHtcbiAgICAgIHdyaXRlKFwiZGF0ZTpcIiArIGRhdGUudG9KU09OKCkpO1xuICAgIH0sXG4gICAgX3N5bWJvbDogZnVuY3Rpb24gKHN5bTogc3ltYm9sKSB7XG4gICAgICB3cml0ZShcInN5bWJvbDpcIiArIHN5bS50b1N0cmluZygpKTtcbiAgICB9LFxuICAgIF9lcnJvcjogZnVuY3Rpb24gKGVycjogRXJyb3IpIHtcbiAgICAgIHdyaXRlKFwiZXJyb3I6XCIgKyBlcnIudG9TdHJpbmcoKSk7XG4gICAgfSxcbiAgICBfYm9vbGVhbjogZnVuY3Rpb24gKGJvb2w6IGJvb2xlYW4pIHtcbiAgICAgIHdyaXRlKFwiYm9vbDpcIiArIGJvb2wudG9TdHJpbmcoKSk7XG4gICAgfSxcbiAgICBfc3RyaW5nOiBmdW5jdGlvbiAoc3RyaW5nOiBzdHJpbmcpIHtcbiAgICAgIHdyaXRlKFwic3RyaW5nOlwiICsgc3RyaW5nLmxlbmd0aCArIFwiOlwiKTtcbiAgICAgIHdyaXRlKHN0cmluZy50b1N0cmluZygpKTtcbiAgICB9LFxuICAgIF9mdW5jdGlvbjogZnVuY3Rpb24gKGZuOiBhbnkpIHtcbiAgICAgIHdyaXRlKFwiZm46XCIpO1xuICAgICAgaWYgKGlzTmF0aXZlRnVuY3Rpb24oZm4pKSB7XG4gICAgICAgIHRoaXMuZGlzcGF0Y2goXCJbbmF0aXZlXVwiKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuZGlzcGF0Y2goZm4udG9TdHJpbmcoKSk7XG4gICAgICB9XG5cbiAgICAgIC8vIE1ha2Ugc3VyZSB3ZSBjYW4gc3RpbGwgZGlzdGluZ3Vpc2ggbmF0aXZlIGZ1bmN0aW9uc1xuICAgICAgLy8gYnkgdGhlaXIgbmFtZSwgb3RoZXJ3aXNlIFN0cmluZyBhbmQgRnVuY3Rpb24gd2lsbFxuICAgICAgLy8gaGF2ZSB0aGUgc2FtZSBoYXNoXG4gICAgICB0aGlzLmRpc3BhdGNoKFwiZnVuY3Rpb24tbmFtZTpcIiArIFN0cmluZyhmbi5uYW1lKSk7XG5cbiAgICAgIHRoaXMuX29iamVjdChmbik7XG4gICAgfSxcbiAgICBfbnVtYmVyOiBmdW5jdGlvbiAobnVtYmVyOiBudW1iZXIpIHtcbiAgICAgIHdyaXRlKFwibnVtYmVyOlwiICsgbnVtYmVyLnRvU3RyaW5nKCkpO1xuICAgIH0sXG4gICAgX3htbDogZnVuY3Rpb24gKHhtbDogYW55KSB7XG4gICAgICB3cml0ZShcInhtbDpcIiArIHhtbC50b1N0cmluZygpKTtcbiAgICB9LFxuICAgIF9udWxsOiBmdW5jdGlvbiAoKSB7XG4gICAgICB3cml0ZShcIk51bGxcIik7XG4gICAgfSxcbiAgICBfdW5kZWZpbmVkOiBmdW5jdGlvbiAoKSB7XG4gICAgICB3cml0ZShcIlVuZGVmaW5lZFwiKTtcbiAgICB9LFxuICAgIF9yZWdleHA6IGZ1bmN0aW9uIChyZWdleDogUmVnRXhwKSB7XG4gICAgICB3cml0ZShcInJlZ2V4OlwiICsgcmVnZXgudG9TdHJpbmcoKSk7XG4gICAgfSxcbiAgICBfdWludDhhcnJheTogZnVuY3Rpb24gKGFycjogVWludDhBcnJheSkge1xuICAgICAgd3JpdGUoXCJ1aW50OGFycmF5OlwiKTtcbiAgICAgIHRoaXMuZGlzcGF0Y2goQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJyKSk7XG4gICAgfSxcbiAgICBfdWludDhjbGFtcGVkYXJyYXk6IGZ1bmN0aW9uIChhcnI6IFVpbnQ4Q2xhbXBlZEFycmF5KSB7XG4gICAgICB3cml0ZShcInVpbnQ4Y2xhbXBlZGFycmF5OlwiKTtcbiAgICAgIHRoaXMuZGlzcGF0Y2goQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJyKSk7XG4gICAgfSxcbiAgICBfaW50OGFycmF5OiBmdW5jdGlvbiAoYXJyOiBJbnQ4QXJyYXkpIHtcbiAgICAgIHdyaXRlKFwiaW50OGFycmF5OlwiKTtcbiAgICAgIHRoaXMuZGlzcGF0Y2goQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJyKSk7XG4gICAgfSxcbiAgICBfdWludDE2YXJyYXk6IGZ1bmN0aW9uIChhcnI6IFVpbnQxNkFycmF5KSB7XG4gICAgICB3cml0ZShcInVpbnQxNmFycmF5OlwiKTtcbiAgICAgIHRoaXMuZGlzcGF0Y2goQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJyKSk7XG4gICAgfSxcbiAgICBfaW50MTZhcnJheTogZnVuY3Rpb24gKGFycjogSW50MTZBcnJheSkge1xuICAgICAgd3JpdGUoXCJpbnQxNmFycmF5OlwiKTtcbiAgICAgIHRoaXMuZGlzcGF0Y2goQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJyKSk7XG4gICAgfSxcbiAgICBfdWludDMyYXJyYXk6IGZ1bmN0aW9uIChhcnI6IFVpbnQzMkFycmF5KSB7XG4gICAgICB3cml0ZShcInVpbnQzMmFycmF5OlwiKTtcbiAgICAgIHRoaXMuZGlzcGF0Y2goQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJyKSk7XG4gICAgfSxcbiAgICBfaW50MzJhcnJheTogZnVuY3Rpb24gKGFycjogSW50MzJBcnJheSkge1xuICAgICAgd3JpdGUoXCJpbnQzMmFycmF5OlwiKTtcbiAgICAgIHRoaXMuZGlzcGF0Y2goQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJyKSk7XG4gICAgfSxcbiAgICBfZmxvYXQzMmFycmF5OiBmdW5jdGlvbiAoYXJyOiBGbG9hdDMyQXJyYXkpIHtcbiAgICAgIHdyaXRlKFwiZmxvYXQzMmFycmF5OlwiKTtcbiAgICAgIHRoaXMuZGlzcGF0Y2goQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJyKSk7XG4gICAgfSxcbiAgICBfZmxvYXQ2NGFycmF5OiBmdW5jdGlvbiAoYXJyOiBGbG9hdDY0QXJyYXkpIHtcbiAgICAgIHdyaXRlKFwiZmxvYXQ2NGFycmF5OlwiKTtcbiAgICAgIHRoaXMuZGlzcGF0Y2goQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJyKSk7XG4gICAgfSxcbiAgICBfYXJyYXlidWZmZXI6IGZ1bmN0aW9uIChhcnI6IEFycmF5QnVmZmVyKSB7XG4gICAgICB3cml0ZShcImFycmF5YnVmZmVyOlwiKTtcbiAgICAgIHRoaXMuZGlzcGF0Y2gobmV3IFVpbnQ4QXJyYXkoYXJyKSk7XG4gICAgfSxcbiAgICBfdXJsOiBmdW5jdGlvbiAodXJsOiBVUkwpIHtcbiAgICAgIHdyaXRlKFwidXJsOlwiICsgdXJsLnRvU3RyaW5nKCkpO1xuICAgIH0sXG4gICAgX21hcDogZnVuY3Rpb24gKG1hcDogTWFwPGFueSwgYW55Pikge1xuICAgICAgd3JpdGUoXCJtYXA6XCIpO1xuICAgICAgY29uc3QgYXJyID0gQXJyYXkuZnJvbShtYXApO1xuICAgICAgdGhpcy5fYXJyYXkoYXJyLCB0cnVlKTtcbiAgICB9LFxuICAgIF9zZXQ6IGZ1bmN0aW9uIChzZXQ6IFNldDxhbnk+KSB7XG4gICAgICB3cml0ZShcInNldDpcIik7XG4gICAgICBjb25zdCBhcnIgPSBBcnJheS5mcm9tKHNldCk7XG4gICAgICB0aGlzLl9hcnJheShhcnIsIHRydWUpO1xuICAgIH0sXG4gICAgX2ZpbGU6IGZ1bmN0aW9uIChmaWxlOiBhbnkpIHtcbiAgICAgIHdyaXRlKFwiZmlsZTpcIik7XG4gICAgICB0aGlzLmRpc3BhdGNoKFtmaWxlLm5hbWUsIGZpbGUuc2l6ZSwgZmlsZS50eXBlLCBmaWxlLmxhc3RNb2RpZmllZF0pO1xuICAgIH0sXG4gICAgX2Jsb2I6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRocm93IEVycm9yKFxuICAgICAgICBcIkhhc2hpbmcgQmxvYiBvYmplY3RzIGlzIGN1cnJlbnRseSBub3Qgc3VwcG9ydGVkXFxuXCIgK1xuICAgICAgICAgIFwiKHNlZSBodHRwczovL2dpdGh1Yi5jb20vcHVsZW9zL29iamVjdC1oYXNoL2lzc3Vlcy8yNilcXG5cIiArXG4gICAgICAgICAgJ1VzZSBcIm9wdGlvbnMucmVwbGFjZXJcIiBvciBcIm9wdGlvbnMuaWdub3JlVW5rbm93blwiXFxuJyxcbiAgICAgICk7XG4gICAgfSxcbiAgICBfZG9td2luZG93OiBmdW5jdGlvbiAoKSB7XG4gICAgICB3cml0ZShcImRvbXdpbmRvd1wiKTtcbiAgICB9LFxuICAgIF9iaWdpbnQ6IGZ1bmN0aW9uIChudW1iZXI6IGJpZ2ludCkge1xuICAgICAgd3JpdGUoXCJiaWdpbnQ6XCIgKyBudW1iZXIudG9TdHJpbmcoKSk7XG4gICAgfSxcbiAgICAvKiBOb2RlLmpzIHN0YW5kYXJkIG5hdGl2ZSBvYmplY3RzICovXG4gICAgX3Byb2Nlc3M6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHdyaXRlKFwicHJvY2Vzc1wiKTtcbiAgICB9LFxuICAgIF90aW1lcjogZnVuY3Rpb24gKCkge1xuICAgICAgd3JpdGUoXCJ0aW1lclwiKTtcbiAgICB9LFxuICAgIF9waXBlOiBmdW5jdGlvbiAoKSB7XG4gICAgICB3cml0ZShcInBpcGVcIik7XG4gICAgfSxcbiAgICBfdGNwOiBmdW5jdGlvbiAoKSB7XG4gICAgICB3cml0ZShcInRjcFwiKTtcbiAgICB9LFxuICAgIF91ZHA6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHdyaXRlKFwidWRwXCIpO1xuICAgIH0sXG4gICAgX3R0eTogZnVuY3Rpb24gKCkge1xuICAgICAgd3JpdGUoXCJ0dHlcIik7XG4gICAgfSxcbiAgICBfc3RhdHdhdGNoZXI6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHdyaXRlKFwic3RhdHdhdGNoZXJcIik7XG4gICAgfSxcbiAgICBfc2VjdXJlY29udGV4dDogZnVuY3Rpb24gKCkge1xuICAgICAgd3JpdGUoXCJzZWN1cmVjb250ZXh0XCIpO1xuICAgIH0sXG4gICAgX2Nvbm5lY3Rpb246IGZ1bmN0aW9uICgpIHtcbiAgICAgIHdyaXRlKFwiY29ubmVjdGlvblwiKTtcbiAgICB9LFxuICAgIF96bGliOiBmdW5jdGlvbiAoKSB7XG4gICAgICB3cml0ZShcInpsaWJcIik7XG4gICAgfSxcbiAgICBfY29udGV4dDogZnVuY3Rpb24gKCkge1xuICAgICAgd3JpdGUoXCJjb250ZXh0XCIpO1xuICAgIH0sXG4gICAgX25vZGVzY3JpcHQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHdyaXRlKFwibm9kZXNjcmlwdFwiKTtcbiAgICB9LFxuICAgIF9odHRwcGFyc2VyOiBmdW5jdGlvbiAoKSB7XG4gICAgICB3cml0ZShcImh0dHBwYXJzZXJcIik7XG4gICAgfSxcbiAgICBfZGF0YXZpZXc6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHdyaXRlKFwiZGF0YXZpZXdcIik7XG4gICAgfSxcbiAgICBfc2lnbmFsOiBmdW5jdGlvbiAoKSB7XG4gICAgICB3cml0ZShcInNpZ25hbFwiKTtcbiAgICB9LFxuICAgIF9mc2V2ZW50OiBmdW5jdGlvbiAoKSB7XG4gICAgICB3cml0ZShcImZzZXZlbnRcIik7XG4gICAgfSxcbiAgICBfdGxzd3JhcDogZnVuY3Rpb24gKCkge1xuICAgICAgd3JpdGUoXCJ0bHN3cmFwXCIpO1xuICAgIH0sXG4gIH07XG59XG5cbi8vIE1pbmktaW1wbGVtZW50YXRpb24gb2Ygc3RyZWFtLlBhc3NUaHJvdWdoXG4vLyBXZSBhcmUgZmFyIGZyb20gaGF2aW5nIG5lZWQgZm9yIHRoZSBmdWxsIGltcGxlbWVudGF0aW9uLCBhbmQgd2UgY2FuXG4vLyBtYWtlIGFzc3VtcHRpb25zIGxpa2UgXCJtYW55IHdyaXRlcywgdGhlbiBvbmx5IG9uZSBmaW5hbCByZWFkXCJcbi8vIGFuZCB3ZSBjYW4gaWdub3JlIGVuY29kaW5nIHNwZWNpZmljc1xuZnVuY3Rpb24gUGFzc1Rocm91Z2goKSB7XG4gIHJldHVybiB7XG4gICAgYnVmOiBcIlwiLFxuXG4gICAgd3JpdGU6IGZ1bmN0aW9uIChiOiBzdHJpbmcpIHtcbiAgICAgIHRoaXMuYnVmICs9IGI7XG4gICAgfSxcblxuICAgIGVuZDogZnVuY3Rpb24gKGI6IHN0cmluZykge1xuICAgICAgdGhpcy5idWYgKz0gYjtcbiAgICB9LFxuXG4gICAgcmVhZDogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuYnVmO1xuICAgIH0sXG4gIH07XG59XG4iLCAiaW1wb3J0IHsgdXNlRWZmZWN0LCB1c2VSZWYsIHVzZUNhbGxiYWNrIH0gZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQge1xuICBGdW5jdGlvblJldHVybmluZ1Byb21pc2UsXG4gIFVzZUNhY2hlZFByb21pc2VSZXR1cm5UeXBlLFxuICBNdXRhdGVQcm9taXNlLFxuICBGdW5jdGlvblJldHVybmluZ1BhZ2luYXRlZFByb21pc2UsXG4gIFVud3JhcFJldHVybixcbiAgUGFnaW5hdGlvbk9wdGlvbnMsXG59IGZyb20gXCIuL3R5cGVzXCI7XG5pbXBvcnQgeyB1c2VDYWNoZWRTdGF0ZSB9IGZyb20gXCIuL3VzZUNhY2hlZFN0YXRlXCI7XG5pbXBvcnQgeyB1c2VQcm9taXNlLCBQcm9taXNlT3B0aW9ucyB9IGZyb20gXCIuL3VzZVByb21pc2VcIjtcbmltcG9ydCB7IHVzZUxhdGVzdCB9IGZyb20gXCIuL3VzZUxhdGVzdFwiO1xuaW1wb3J0IHsgaGFzaCB9IGZyb20gXCIuL2hlbHBlcnNcIjtcblxuLy8gU3ltYm9sIHRvIGRpZmZlcmVudGlhdGUgYW4gZW1wdHkgY2FjaGUgZnJvbSBgdW5kZWZpbmVkYFxuY29uc3QgZW1wdHlDYWNoZSA9IC8qICNfX1BVUkVfXyAqLyBTeW1ib2woKTtcblxuZXhwb3J0IHR5cGUgQ2FjaGVkUHJvbWlzZU9wdGlvbnM8XG4gIFQgZXh0ZW5kcyBGdW5jdGlvblJldHVybmluZ1Byb21pc2UgfCBGdW5jdGlvblJldHVybmluZ1BhZ2luYXRlZFByb21pc2UsXG4gIFUsXG4+ID0gUHJvbWlzZU9wdGlvbnM8VD4gJiB7XG4gIC8qKlxuICAgKiBUaGUgaW5pdGlhbCBkYXRhIGlmIHRoZXJlIGFyZW4ndCBhbnkgaW4gdGhlIENhY2hlIHlldC5cbiAgICovXG4gIGluaXRpYWxEYXRhPzogVTtcbiAgLyoqXG4gICAqIFRlbGxzIHRoZSBob29rIHRvIGtlZXAgdGhlIHByZXZpb3VzIHJlc3VsdHMgaW5zdGVhZCBvZiByZXR1cm5pbmcgdGhlIGluaXRpYWwgdmFsdWVcbiAgICogaWYgdGhlcmUgYXJlbid0IGFueSBpbiB0aGUgY2FjaGUgZm9yIHRoZSBuZXcgYXJndW1lbnRzLlxuICAgKiBUaGlzIGlzIHBhcnRpY3VsYXJseSB1c2VmdWwgd2hlbiB1c2VkIGZvciBkYXRhIGZvciBhIExpc3QgdG8gYXZvaWQgZmxpY2tlcmluZy5cbiAgICovXG4gIGtlZXBQcmV2aW91c0RhdGE/OiBib29sZWFuO1xufTtcblxuLyoqXG4gKiBXcmFwcyBhbiBhc3luY2hyb25vdXMgZnVuY3Rpb24gb3IgYSBmdW5jdGlvbiB0aGF0IHJldHVybnMgYSBQcm9taXNlIGluIGFub3RoZXIgZnVuY3Rpb24sIGFuZCByZXR1cm5zIHRoZSB7QGxpbmsgQXN5bmNTdGF0ZX0gY29ycmVzcG9uZGluZyB0byB0aGUgZXhlY3V0aW9uIG9mIHRoZSBmdW5jdGlvbi4gVGhlIGxhc3QgdmFsdWUgd2lsbCBiZSBrZXB0IGJldHdlZW4gY29tbWFuZCBydW5zLlxuICpcbiAqIEByZW1hcmsgVGhpcyBvdmVybG9hZCBzaG91bGQgYmUgdXNlZCB3aGVuIHdvcmtpbmcgd2l0aCBwYWdpbmF0ZWQgZGF0YSBzb3VyY2VzLlxuICogQHJlbWFyayBXaGVuIHBhZ2luYXRpbmcsIG9ubHkgdGhlIGZpcnN0IHBhZ2Ugd2lsbCBiZSBjYWNoZWQuXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYFxuICogaW1wb3J0IHsgc2V0VGltZW91dCB9IGZyb20gXCJub2RlOnRpbWVycy9wcm9taXNlc1wiO1xuICogaW1wb3J0IHsgdXNlU3RhdGUgfSBmcm9tIFwicmVhY3RcIjtcbiAqIGltcG9ydCB7IExpc3QgfSBmcm9tIFwiQHJheWNhc3QvYXBpXCI7XG4gKiBpbXBvcnQgeyB1c2VDYWNoZWRQcm9taXNlIH0gZnJvbSBcIkByYXljYXN0L3V0aWxzXCI7XG4gKlxuICogZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gQ29tbWFuZCgpIHtcbiAqICAgY29uc3QgW3NlYXJjaFRleHQsIHNldFNlYXJjaFRleHRdID0gdXNlU3RhdGUoXCJcIik7XG4gKlxuICogICBjb25zdCB7IGlzTG9hZGluZywgZGF0YSwgcGFnaW5hdGlvbiB9ID0gdXNlQ2FjaGVkUHJvbWlzZShcbiAqICAgICAoc2VhcmNoVGV4dDogc3RyaW5nKSA9PiBhc3luYyAob3B0aW9uczogeyBwYWdlOiBudW1iZXIgfSkgPT4ge1xuICogICAgICAgYXdhaXQgc2V0VGltZW91dCgyMDApO1xuICogICAgICAgY29uc3QgbmV3RGF0YSA9IEFycmF5LmZyb20oeyBsZW5ndGg6IDI1IH0sIChfdiwgaW5kZXgpID0+ICh7XG4gKiAgICAgICAgIGluZGV4LFxuICogICAgICAgICBwYWdlOiBvcHRpb25zLnBhZ2UsXG4gKiAgICAgICAgIHRleHQ6IHNlYXJjaFRleHQsXG4gKiAgICAgICB9KSk7XG4gKiAgICAgICByZXR1cm4geyBkYXRhOiBuZXdEYXRhLCBoYXNNb3JlOiBvcHRpb25zLnBhZ2UgPCAxMCB9O1xuICogICAgIH0sXG4gKiAgICAgW3NlYXJjaFRleHRdLFxuICogICApO1xuICpcbiAqICAgcmV0dXJuIChcbiAqICAgICA8TGlzdCBpc0xvYWRpbmc9e2lzTG9hZGluZ30gb25TZWFyY2hUZXh0Q2hhbmdlPXtzZXRTZWFyY2hUZXh0fSBwYWdpbmF0aW9uPXtwYWdpbmF0aW9ufT5cbiAqICAgICAgIHtkYXRhPy5tYXAoKGl0ZW0pID0+IChcbiAqICAgICAgICAgPExpc3QuSXRlbVxuICogICAgICAgICAgIGtleT17YCR7aXRlbS5wYWdlfSAke2l0ZW0uaW5kZXh9ICR7aXRlbS50ZXh0fWB9XG4gKiAgICAgICAgICAgdGl0bGU9e2BQYWdlICR7aXRlbS5wYWdlfSBJdGVtICR7aXRlbS5pbmRleH1gfVxuICogICAgICAgICAgIHN1YnRpdGxlPXtpdGVtLnRleHR9XG4gKiAgICAgICAgIC8+XG4gKiAgICAgICApKX1cbiAqICAgICA8L0xpc3Q+XG4gKiAgICk7XG4gKiB9XG4gKiBgYGBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHVzZUNhY2hlZFByb21pc2U8VCBleHRlbmRzIEZ1bmN0aW9uUmV0dXJuaW5nUGFnaW5hdGVkUHJvbWlzZTxbXT4+KFxuICBmbjogVCxcbik6IFVzZUNhY2hlZFByb21pc2VSZXR1cm5UeXBlPFVud3JhcFJldHVybjxUPiwgdW5kZWZpbmVkPjtcbmV4cG9ydCBmdW5jdGlvbiB1c2VDYWNoZWRQcm9taXNlPFQgZXh0ZW5kcyBGdW5jdGlvblJldHVybmluZ1BhZ2luYXRlZFByb21pc2UsIFUgZXh0ZW5kcyBhbnlbXSA9IGFueVtdPihcbiAgZm46IFQsXG4gIGFyZ3M6IFBhcmFtZXRlcnM8VD4sXG4gIG9wdGlvbnM/OiBDYWNoZWRQcm9taXNlT3B0aW9uczxULCBVPixcbik6IFVzZUNhY2hlZFByb21pc2VSZXR1cm5UeXBlPFVud3JhcFJldHVybjxUPiwgVT47XG5cbi8qKlxuICogV3JhcHMgYW4gYXN5bmNocm9ub3VzIGZ1bmN0aW9uIG9yIGEgZnVuY3Rpb24gdGhhdCByZXR1cm5zIGEgUHJvbWlzZSBhbmQgcmV0dXJucyB0aGUge0BsaW5rIEFzeW5jU3RhdGV9IGNvcnJlc3BvbmRpbmcgdG8gdGhlIGV4ZWN1dGlvbiBvZiB0aGUgZnVuY3Rpb24uIFRoZSBsYXN0IHZhbHVlIHdpbGwgYmUga2VwdCBiZXR3ZWVuIGNvbW1hbmQgcnVucy5cbiAqXG4gKiBAcmVtYXJrIFRoZSB2YWx1ZSBuZWVkcyB0byBiZSBKU09OIHNlcmlhbGl6YWJsZS5cbiAqIEByZW1hcmsgVGhlIGZ1bmN0aW9uIGlzIGFzc3VtZWQgdG8gYmUgY29uc3RhbnQgKGVnLiBjaGFuZ2luZyBpdCB3b24ndCB0cmlnZ2VyIGEgcmV2YWxpZGF0aW9uKS5cbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgXG4gKiBpbXBvcnQgeyB1c2VDYWNoZWRQcm9taXNlIH0gZnJvbSAnQHJheWNhc3QvdXRpbHMnO1xuICpcbiAqIGV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIENvbW1hbmQoKSB7XG4gKiAgIGNvbnN0IGFib3J0YWJsZSA9IHVzZVJlZjxBYm9ydENvbnRyb2xsZXI+KCk7XG4gKiAgIGNvbnN0IHsgaXNMb2FkaW5nLCBkYXRhLCByZXZhbGlkYXRlIH0gPSB1c2VDYWNoZWRQcm9taXNlKGFzeW5jICh1cmw6IHN0cmluZykgPT4ge1xuICogICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsLCB7IHNpZ25hbDogYWJvcnRhYmxlLmN1cnJlbnQ/LnNpZ25hbCB9KTtcbiAqICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCByZXNwb25zZS50ZXh0KCk7XG4gKiAgICAgcmV0dXJuIHJlc3VsdFxuICogICB9LFxuICogICBbJ2h0dHBzOi8vYXBpLmV4YW1wbGUnXSxcbiAqICAge1xuICogICAgIGFib3J0YWJsZVxuICogICB9KTtcbiAqXG4gKiAgIHJldHVybiAoXG4gKiAgICAgPERldGFpbFxuICogICAgICAgaXNMb2FkaW5nPXtpc0xvYWRpbmd9XG4gKiAgICAgICBtYXJrZG93bj17ZGF0YX1cbiAqICAgICAgIGFjdGlvbnM9e1xuICogICAgICAgICA8QWN0aW9uUGFuZWw+XG4gKiAgICAgICAgICAgPEFjdGlvbiB0aXRsZT1cIlJlbG9hZFwiIG9uQWN0aW9uPXsoKSA9PiByZXZhbGlkYXRlKCl9IC8+XG4gKiAgICAgICAgIDwvQWN0aW9uUGFuZWw+XG4gKiAgICAgICB9XG4gKiAgICAgLz5cbiAqICAgKTtcbiAqIH07XG4gKiBgYGBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHVzZUNhY2hlZFByb21pc2U8VCBleHRlbmRzIEZ1bmN0aW9uUmV0dXJuaW5nUHJvbWlzZTxbXT4+KFxuICBmbjogVCxcbik6IFVzZUNhY2hlZFByb21pc2VSZXR1cm5UeXBlPFVud3JhcFJldHVybjxUPiwgdW5kZWZpbmVkPjtcbmV4cG9ydCBmdW5jdGlvbiB1c2VDYWNoZWRQcm9taXNlPFQgZXh0ZW5kcyBGdW5jdGlvblJldHVybmluZ1Byb21pc2UsIFUgPSB1bmRlZmluZWQ+KFxuICBmbjogVCxcbiAgYXJnczogUGFyYW1ldGVyczxUPixcbiAgb3B0aW9ucz86IENhY2hlZFByb21pc2VPcHRpb25zPFQsIFU+LFxuKTogVXNlQ2FjaGVkUHJvbWlzZVJldHVyblR5cGU8VW53cmFwUmV0dXJuPFQ+LCBVPjtcblxuZXhwb3J0IGZ1bmN0aW9uIHVzZUNhY2hlZFByb21pc2U8XG4gIFQgZXh0ZW5kcyBGdW5jdGlvblJldHVybmluZ1Byb21pc2UgfCBGdW5jdGlvblJldHVybmluZ1BhZ2luYXRlZFByb21pc2UsXG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gIFUgZXh0ZW5kcyBhbnlbXSB8IHVuZGVmaW5lZCA9IHVuZGVmaW5lZCxcbj4oZm46IFQsIGFyZ3M/OiBQYXJhbWV0ZXJzPFQ+LCBvcHRpb25zPzogQ2FjaGVkUHJvbWlzZU9wdGlvbnM8VCwgVT4pIHtcbiAgLyoqXG4gICAqIFRoZSBob29rIGdlbmVyYXRlcyBhIGNhY2hlIGtleSBmcm9tIHRoZSBwcm9taXNlIGl0IHJlY2VpdmVzICYgaXRzIGFyZ3VtZW50cy5cbiAgICogU29tZXRpbWVzIHRoYXQncyBub3QgZW5vdWdoIHRvIGd1YXJhbnRlZSB1bmlxdWVuZXNzLCBzbyBob29rcyB0aGF0IGJ1aWxkIG9uIHRvcCBvZiBgdXNlQ2FjaGVkUHJvbWlzZWAgY2FuXG4gICAqIHVzZSBhbiBgaW50ZXJuYWxfY2FjaGVLZXlTdWZmaXhgIHRvIGhlbHAgaXQuXG4gICAqXG4gICAqIEByZW1hcmsgRm9yIGludGVybmFsIHVzZSBvbmx5LlxuICAgKi9cbiAgY29uc3Qge1xuICAgIGluaXRpYWxEYXRhLFxuICAgIGtlZXBQcmV2aW91c0RhdGEsXG4gICAgaW50ZXJuYWxfY2FjaGVLZXlTdWZmaXgsXG4gICAgLi4udXNlUHJvbWlzZU9wdGlvbnNcbiAgfTogQ2FjaGVkUHJvbWlzZU9wdGlvbnM8VCwgVT4gJiB7IGludGVybmFsX2NhY2hlS2V5U3VmZml4Pzogc3RyaW5nIH0gPSBvcHRpb25zIHx8IHt9O1xuICBjb25zdCBsYXN0VXBkYXRlRnJvbSA9IHVzZVJlZjxcImNhY2hlXCIgfCBcInByb21pc2VcIj4obnVsbCk7XG5cbiAgY29uc3QgW2NhY2hlZERhdGEsIG11dGF0ZUNhY2hlXSA9IHVzZUNhY2hlZFN0YXRlPHR5cGVvZiBlbXB0eUNhY2hlIHwgKFVud3JhcFJldHVybjxUPiB8IFUpPihcbiAgICBoYXNoKGFyZ3MgfHwgW10pICsgaW50ZXJuYWxfY2FjaGVLZXlTdWZmaXgsXG4gICAgZW1wdHlDYWNoZSxcbiAgICB7XG4gICAgICBjYWNoZU5hbWVzcGFjZTogaGFzaChmbiksXG4gICAgfSxcbiAgKTtcblxuICAvLyBVc2UgYSByZWYgdG8gc3RvcmUgcHJldmlvdXMgcmV0dXJuZWQgZGF0YS4gVXNlIHRoZSBpbml0YWwgZGF0YSBhcyBpdHMgaW5pdGFsIHZhbHVlIGZyb20gdGhlIGNhY2hlLlxuICBjb25zdCBsYWdneURhdGFSZWYgPSB1c2VSZWY8QXdhaXRlZDxSZXR1cm5UeXBlPFQ+PiB8IFU+KGNhY2hlZERhdGEgIT09IGVtcHR5Q2FjaGUgPyBjYWNoZWREYXRhIDogKGluaXRpYWxEYXRhIGFzIFUpKTtcbiAgY29uc3QgcGFnaW5hdGlvbkFyZ3NSZWYgPSB1c2VSZWY8UGFnaW5hdGlvbk9wdGlvbnM8VW53cmFwUmV0dXJuPFQ+IHwgVT4gfCB1bmRlZmluZWQ+KHVuZGVmaW5lZCk7XG5cbiAgY29uc3Qge1xuICAgIG11dGF0ZTogX211dGF0ZSxcbiAgICByZXZhbGlkYXRlLFxuICAgIC4uLnN0YXRlXG4gICAgLy8gQHRzLWV4cGVjdC1lcnJvciBmbiBoYXMgdGhlIHNhbWUgc2lnbmF0dXJlIGluIGJvdGggdXNlUHJvbWlzZSBhbmQgdXNlQ2FjaGVkUHJvbWlzZVxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gIH0gPSB1c2VQcm9taXNlKGZuLCBhcmdzIHx8IChbXSBhcyBhbnkgYXMgUGFyYW1ldGVyczxUPiksIHtcbiAgICAuLi51c2VQcm9taXNlT3B0aW9ucyxcbiAgICBvbkRhdGEoZGF0YSwgcGFnaW5hdGlvbikge1xuICAgICAgcGFnaW5hdGlvbkFyZ3NSZWYuY3VycmVudCA9IHBhZ2luYXRpb247XG4gICAgICBpZiAodXNlUHJvbWlzZU9wdGlvbnMub25EYXRhKSB7XG4gICAgICAgIHVzZVByb21pc2VPcHRpb25zLm9uRGF0YShkYXRhLCBwYWdpbmF0aW9uKTtcbiAgICAgIH1cbiAgICAgIGlmIChwYWdpbmF0aW9uICYmIHBhZ2luYXRpb24ucGFnZSA+IDApIHtcbiAgICAgICAgLy8gZG9uJ3QgY2FjaGUgYmV5b25kIHRoZSBmaXJzdCBwYWdlXG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGxhc3RVcGRhdGVGcm9tLmN1cnJlbnQgPSBcInByb21pc2VcIjtcbiAgICAgIGxhZ2d5RGF0YVJlZi5jdXJyZW50ID0gZGF0YTtcbiAgICAgIG11dGF0ZUNhY2hlKGRhdGEpO1xuICAgIH0sXG4gIH0pO1xuXG4gIGxldCByZXR1cm5lZERhdGE6IFUgfCBBd2FpdGVkPFJldHVyblR5cGU8VD4+IHwgVW53cmFwUmV0dXJuPFQ+O1xuICBjb25zdCBwYWdpbmF0aW9uID0gc3RhdGUucGFnaW5hdGlvbjtcbiAgLy8gd2hlbiBwYWdpbmF0aW5nLCBvbmx5IHRoZSBmaXJzdCBwYWdlIGdldHMgY2FjaGVkLCBzbyB3ZSByZXR1cm4gdGhlIGRhdGEgd2UgZ2V0IGZyb20gYHVzZVByb21pc2VgLCBiZWNhdXNlXG4gIC8vIGl0IHdpbGwgYmUgYWNjdW11bGF0ZWQuXG4gIGlmIChwYWdpbmF0aW9uQXJnc1JlZi5jdXJyZW50ICYmIHBhZ2luYXRpb25BcmdzUmVmLmN1cnJlbnQucGFnZSA+IDAgJiYgc3RhdGUuZGF0YSkge1xuICAgIHJldHVybmVkRGF0YSA9IHN0YXRlLmRhdGEgYXMgVW53cmFwUmV0dXJuPFQ+O1xuICAgIC8vIGlmIHRoZSBsYXRlc3QgdXBkYXRlIGlmIGZyb20gdGhlIFByb21pc2UsIHdlIGtlZXAgaXRcbiAgfSBlbHNlIGlmIChsYXN0VXBkYXRlRnJvbS5jdXJyZW50ID09PSBcInByb21pc2VcIikge1xuICAgIHJldHVybmVkRGF0YSA9IGxhZ2d5RGF0YVJlZi5jdXJyZW50O1xuICB9IGVsc2UgaWYgKGtlZXBQcmV2aW91c0RhdGEgJiYgY2FjaGVkRGF0YSAhPT0gZW1wdHlDYWNoZSkge1xuICAgIC8vIGlmIHdlIHdhbnQgdG8ga2VlcCB0aGUgbGF0ZXN0IGRhdGEsIHdlIHBpY2sgdGhlIGNhY2hlIGJ1dCBvbmx5IGlmIGl0J3Mgbm90IGVtcHR5XG4gICAgcmV0dXJuZWREYXRhID0gY2FjaGVkRGF0YTtcbiAgICBpZiAocGFnaW5hdGlvbikge1xuICAgICAgcGFnaW5hdGlvbi5oYXNNb3JlID0gdHJ1ZTtcbiAgICAgIHBhZ2luYXRpb24ucGFnZVNpemUgPSBjYWNoZWREYXRhLmxlbmd0aDtcbiAgICB9XG4gIH0gZWxzZSBpZiAoa2VlcFByZXZpb3VzRGF0YSAmJiBjYWNoZWREYXRhID09PSBlbXB0eUNhY2hlKSB7XG4gICAgLy8gaWYgdGhlIGNhY2hlIGlzIGVtcHR5LCB3ZSB3aWxsIHJldHVybiB0aGUgcHJldmlvdXMgZGF0YVxuICAgIHJldHVybmVkRGF0YSA9IGxhZ2d5RGF0YVJlZi5jdXJyZW50O1xuICAgIC8vIHRoZXJlIGFyZSBubyBzcGVjaWFsIGNhc2VzLCBzbyBlaXRoZXIgcmV0dXJuIHRoZSBjYWNoZSBvciBpbml0aWFsIGRhdGFcbiAgfSBlbHNlIGlmIChjYWNoZWREYXRhICE9PSBlbXB0eUNhY2hlKSB7XG4gICAgcmV0dXJuZWREYXRhID0gY2FjaGVkRGF0YTtcbiAgICBpZiAocGFnaW5hdGlvbikge1xuICAgICAgcGFnaW5hdGlvbi5oYXNNb3JlID0gdHJ1ZTtcbiAgICAgIHBhZ2luYXRpb24ucGFnZVNpemUgPSBjYWNoZWREYXRhLmxlbmd0aDtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuZWREYXRhID0gaW5pdGlhbERhdGEgYXMgVTtcbiAgfVxuXG4gIGNvbnN0IGxhdGVzdERhdGEgPSB1c2VMYXRlc3QocmV0dXJuZWREYXRhKTtcblxuICAvLyB3ZSByZXdyaXRlIHRoZSBtdXRhdGUgZnVuY3Rpb24gdG8gdXBkYXRlIHRoZSBjYWNoZSBpbnN0ZWFkXG4gIGNvbnN0IG11dGF0ZSA9IHVzZUNhbGxiYWNrPE11dGF0ZVByb21pc2U8QXdhaXRlZDxSZXR1cm5UeXBlPFQ+PiB8IFU+PihcbiAgICBhc3luYyAoYXN5bmNVcGRhdGUsIG9wdGlvbnMpID0+IHtcbiAgICAgIGxldCBkYXRhQmVmb3JlT3B0aW1pc3RpY1VwZGF0ZTtcbiAgICAgIHRyeSB7XG4gICAgICAgIGlmIChvcHRpb25zPy5vcHRpbWlzdGljVXBkYXRlKSB7XG4gICAgICAgICAgaWYgKHR5cGVvZiBvcHRpb25zPy5yb2xsYmFja09uRXJyb3IgIT09IFwiZnVuY3Rpb25cIiAmJiBvcHRpb25zPy5yb2xsYmFja09uRXJyb3IgIT09IGZhbHNlKSB7XG4gICAgICAgICAgICAvLyBrZWVwIHRyYWNrIG9mIHRoZSBkYXRhIGJlZm9yZSB0aGUgb3B0aW1pc3RpYyB1cGRhdGUsXG4gICAgICAgICAgICAvLyBidXQgb25seSBpZiB3ZSBuZWVkIGl0IChlZy4gb25seSB3aGVuIHdlIHdhbnQgdG8gYXV0b21hdGljYWxseSByb2xsYmFjayBhZnRlcilcbiAgICAgICAgICAgIGRhdGFCZWZvcmVPcHRpbWlzdGljVXBkYXRlID0gc3RydWN0dXJlZENsb25lKGxhdGVzdERhdGEuY3VycmVudCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IGRhdGEgPSBvcHRpb25zLm9wdGltaXN0aWNVcGRhdGUobGF0ZXN0RGF0YS5jdXJyZW50KTtcbiAgICAgICAgICBsYXN0VXBkYXRlRnJvbS5jdXJyZW50ID0gXCJjYWNoZVwiO1xuICAgICAgICAgIGxhZ2d5RGF0YVJlZi5jdXJyZW50ID0gZGF0YTtcbiAgICAgICAgICBtdXRhdGVDYWNoZShkYXRhKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYXdhaXQgX211dGF0ZShhc3luY1VwZGF0ZSwgeyBzaG91bGRSZXZhbGlkYXRlQWZ0ZXI6IG9wdGlvbnM/LnNob3VsZFJldmFsaWRhdGVBZnRlciB9KTtcbiAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICBpZiAodHlwZW9mIG9wdGlvbnM/LnJvbGxiYWNrT25FcnJvciA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgY29uc3QgZGF0YSA9IG9wdGlvbnMucm9sbGJhY2tPbkVycm9yKGxhdGVzdERhdGEuY3VycmVudCk7XG4gICAgICAgICAgbGFzdFVwZGF0ZUZyb20uY3VycmVudCA9IFwiY2FjaGVcIjtcbiAgICAgICAgICBsYWdneURhdGFSZWYuY3VycmVudCA9IGRhdGE7XG4gICAgICAgICAgbXV0YXRlQ2FjaGUoZGF0YSk7XG4gICAgICAgIH0gZWxzZSBpZiAob3B0aW9ucz8ub3B0aW1pc3RpY1VwZGF0ZSAmJiBvcHRpb25zPy5yb2xsYmFja09uRXJyb3IgIT09IGZhbHNlKSB7XG4gICAgICAgICAgbGFzdFVwZGF0ZUZyb20uY3VycmVudCA9IFwiY2FjaGVcIjtcbiAgICAgICAgICAvLyBAdHMtZXhwZWN0LWVycm9yIHdoZW4gdW5kZWZpbmVkLCBpdCdzIGV4cGVjdGVkXG4gICAgICAgICAgbGFnZ3lEYXRhUmVmLmN1cnJlbnQgPSBkYXRhQmVmb3JlT3B0aW1pc3RpY1VwZGF0ZTtcbiAgICAgICAgICAvLyBAdHMtZXhwZWN0LWVycm9yIHdoZW4gdW5kZWZpbmVkLCBpdCdzIGV4cGVjdGVkXG4gICAgICAgICAgbXV0YXRlQ2FjaGUoZGF0YUJlZm9yZU9wdGltaXN0aWNVcGRhdGUpO1xuICAgICAgICB9XG4gICAgICAgIHRocm93IGVycjtcbiAgICAgIH1cbiAgICB9LFxuICAgIFttdXRhdGVDYWNoZSwgX211dGF0ZSwgbGF0ZXN0RGF0YSwgbGFnZ3lEYXRhUmVmLCBsYXN0VXBkYXRlRnJvbV0sXG4gICk7XG5cbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBpZiAoY2FjaGVkRGF0YSAhPT0gZW1wdHlDYWNoZSkge1xuICAgICAgbGFzdFVwZGF0ZUZyb20uY3VycmVudCA9IFwiY2FjaGVcIjtcbiAgICAgIGxhZ2d5RGF0YVJlZi5jdXJyZW50ID0gY2FjaGVkRGF0YTtcbiAgICB9XG4gIH0sIFtjYWNoZWREYXRhXSk7XG5cbiAgcmV0dXJuIHtcbiAgICBkYXRhOiByZXR1cm5lZERhdGEsXG4gICAgaXNMb2FkaW5nOiBzdGF0ZS5pc0xvYWRpbmcsXG4gICAgZXJyb3I6IHN0YXRlLmVycm9yLFxuICAgIG11dGF0ZTogcGFnaW5hdGlvbkFyZ3NSZWYuY3VycmVudCAmJiBwYWdpbmF0aW9uQXJnc1JlZi5jdXJyZW50LnBhZ2UgPiAwID8gX211dGF0ZSA6IG11dGF0ZSxcbiAgICBwYWdpbmF0aW9uLFxuICAgIHJldmFsaWRhdGUsXG4gIH07XG59XG4iLCAiaW1wb3J0IHsgdXNlQ2FsbGJhY2ssIHVzZU1lbW8sIHVzZVJlZiB9IGZyb20gXCJyZWFjdFwiO1xuaW1wb3J0IHsgdXNlQ2FjaGVkUHJvbWlzZSwgQ2FjaGVkUHJvbWlzZU9wdGlvbnMgfSBmcm9tIFwiLi91c2VDYWNoZWRQcm9taXNlXCI7XG5pbXBvcnQgeyB1c2VMYXRlc3QgfSBmcm9tIFwiLi91c2VMYXRlc3RcIjtcbmltcG9ydCB7IEZ1bmN0aW9uUmV0dXJuaW5nUGFnaW5hdGVkUHJvbWlzZSwgRnVuY3Rpb25SZXR1cm5pbmdQcm9taXNlLCBVc2VDYWNoZWRQcm9taXNlUmV0dXJuVHlwZSB9IGZyb20gXCIuL3R5cGVzXCI7XG5pbXBvcnQgeyBpc0pTT04gfSBmcm9tIFwiLi9mZXRjaC11dGlsc1wiO1xuaW1wb3J0IHsgaGFzaCB9IGZyb20gXCIuL2hlbHBlcnNcIjtcblxuYXN5bmMgZnVuY3Rpb24gZGVmYXVsdFBhcnNpbmcocmVzcG9uc2U6IFJlc3BvbnNlKSB7XG4gIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IocmVzcG9uc2Uuc3RhdHVzVGV4dCk7XG4gIH1cblxuICBjb25zdCBjb250ZW50VHlwZUhlYWRlciA9IHJlc3BvbnNlLmhlYWRlcnMuZ2V0KFwiY29udGVudC10eXBlXCIpO1xuXG4gIGlmIChjb250ZW50VHlwZUhlYWRlciAmJiBpc0pTT04oY29udGVudFR5cGVIZWFkZXIpKSB7XG4gICAgcmV0dXJuIGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgfVxuICByZXR1cm4gYXdhaXQgcmVzcG9uc2UudGV4dCgpO1xufVxuXG5mdW5jdGlvbiBkZWZhdWx0TWFwcGluZzxWLCBUIGV4dGVuZHMgdW5rbm93bltdPihyZXN1bHQ6IFYpOiB7IGRhdGE6IFQ7IGhhc01vcmU/OiBib29sZWFuOyBjdXJzb3I/OiBhbnkgfSB7XG4gIHJldHVybiB7IGRhdGE6IHJlc3VsdCBhcyB1bmtub3duIGFzIFQsIGhhc01vcmU6IGZhbHNlIH07XG59XG5cbnR5cGUgUmVxdWVzdEluZm8gPSBzdHJpbmcgfCBVUkwgfCBnbG9iYWxUaGlzLlJlcXVlc3Q7XG50eXBlIFBhZ2luYXRlZFJlcXVlc3RJbmZvID0gKHBhZ2luYXRpb246IHsgcGFnZTogbnVtYmVyOyBsYXN0SXRlbT86IGFueTsgY3Vyc29yPzogYW55IH0pID0+IFJlcXVlc3RJbmZvO1xuXG4vKipcbiAqIEZldGNoZXMgdGhlIHBhZ2luYXRlZFVSTCBhbmQgcmV0dXJucyB0aGUge0BsaW5rIEFzeW5jU3RhdGV9IGNvcnJlc3BvbmRpbmcgdG8gdGhlIGV4ZWN1dGlvbiBvZiB0aGUgZmV0Y2guIFRoZSBsYXN0IHZhbHVlIHdpbGwgYmUga2VwdCBiZXR3ZWVuIGNvbW1hbmQgcnVucy5cbiAqXG4gKiBAcmVtYXJrIFRoaXMgb3ZlcmxvYWQgc2hvdWxkIGJlIHVzZWQgd2hlbiB3b3JraW5nIHdpdGggcGFnaW5hdGVkIGRhdGEgc291cmNlcy5cbiAqIEByZW1hcmsgV2hlbiBwYWdpbmF0aW5nLCBvbmx5IHRoZSBmaXJzdCBwYWdlIHdpbGwgYmUgY2FjaGVkLlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGBcbiAqIGltcG9ydCB7IEljb24sIEltYWdlLCBMaXN0IH0gZnJvbSBcIkByYXljYXN0L2FwaVwiO1xuICogaW1wb3J0IHsgdXNlRmV0Y2ggfSBmcm9tIFwiQHJheWNhc3QvdXRpbHNcIjtcbiAqIGltcG9ydCB7IHVzZVN0YXRlIH0gZnJvbSBcInJlYWN0XCI7XG4gKlxuICogdHlwZSBTZWFyY2hSZXN1bHQgPSB7IGNvbXBhbmllczogQ29tcGFueVtdOyBwYWdlOiBudW1iZXI7IHRvdGFsUGFnZXM6IG51bWJlciB9O1xuICogdHlwZSBDb21wYW55ID0geyBpZDogbnVtYmVyOyBuYW1lOiBzdHJpbmc7IHNtYWxsTG9nb1VybD86IHN0cmluZyB9O1xuICogZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gQ29tbWFuZCgpIHtcbiAqICAgY29uc3QgW3NlYXJjaFRleHQsIHNldFNlYXJjaFRleHRdID0gdXNlU3RhdGUoXCJcIik7XG4gKiAgIGNvbnN0IHsgaXNMb2FkaW5nLCBkYXRhLCBwYWdpbmF0aW9uIH0gPSB1c2VGZXRjaChcbiAqICAgICAob3B0aW9ucykgPT5cbiAqICAgICAgIFwiaHR0cHM6Ly9hcGkueWNvbWJpbmF0b3IuY29tL3YwLjEvY29tcGFuaWVzP1wiICtcbiAqICAgICAgIG5ldyBVUkxTZWFyY2hQYXJhbXMoeyBwYWdlOiBTdHJpbmcob3B0aW9ucy5wYWdlICsgMSksIHE6IHNlYXJjaFRleHQgfSkudG9TdHJpbmcoKSxcbiAqICAgICB7XG4gKiAgICAgICBtYXBSZXN1bHQocmVzdWx0OiBTZWFyY2hSZXN1bHQpIHtcbiAqICAgICAgICAgcmV0dXJuIHtcbiAqICAgICAgICAgICBkYXRhOiByZXN1bHQuY29tcGFuaWVzLFxuICogICAgICAgICAgIGhhc01vcmU6IHJlc3VsdC5wYWdlIDwgcmVzdWx0LnRvdGFsUGFnZXMsXG4gKiAgICAgICAgIH07XG4gKiAgICAgICB9LFxuICogICAgICAga2VlcFByZXZpb3VzRGF0YTogdHJ1ZSxcbiAqICAgICAgIGluaXRpYWxEYXRhOiBbXSxcbiAqICAgICB9LFxuICogICApO1xuICpcbiAqICAgcmV0dXJuIChcbiAqICAgICA8TGlzdCBpc0xvYWRpbmc9e2lzTG9hZGluZ30gcGFnaW5hdGlvbj17cGFnaW5hdGlvbn0gb25TZWFyY2hUZXh0Q2hhbmdlPXtzZXRTZWFyY2hUZXh0fT5cbiAqICAgICAgIHtkYXRhLm1hcCgoY29tcGFueSkgPT4gKFxuICogICAgICAgICA8TGlzdC5JdGVtXG4gKiAgICAgICAgICAga2V5PXtjb21wYW55LmlkfVxuICogICAgICAgICAgIGljb249e3sgc291cmNlOiBjb21wYW55LnNtYWxsTG9nb1VybCA/PyBJY29uLk1pbnVzQ2lyY2xlLCBtYXNrOiBJbWFnZS5NYXNrLlJvdW5kZWRSZWN0YW5nbGUgfX1cbiAqICAgICAgICAgICB0aXRsZT17Y29tcGFueS5uYW1lfVxuICogICAgICAgICAvPlxuICogICAgICAgKSl9XG4gKiAgICAgPC9MaXN0PlxuICogICApO1xuICogfVxuICogYGBgXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB1c2VGZXRjaDxWID0gdW5rbm93biwgVSA9IHVuZGVmaW5lZCwgVCBleHRlbmRzIHVua25vd25bXSA9IHVua25vd25bXT4oXG4gIHVybDogUGFnaW5hdGVkUmVxdWVzdEluZm8sXG4gIG9wdGlvbnM6IFJlcXVlc3RJbml0ICYge1xuICAgIG1hcFJlc3VsdDogKHJlc3VsdDogVikgPT4geyBkYXRhOiBUOyBoYXNNb3JlPzogYm9vbGVhbjsgY3Vyc29yPzogYW55IH07XG4gICAgcGFyc2VSZXNwb25zZT86IChyZXNwb25zZTogUmVzcG9uc2UpID0+IFByb21pc2U8Vj47XG4gIH0gJiBPbWl0PENhY2hlZFByb21pc2VPcHRpb25zPCh1cmw6IFJlcXVlc3RJbmZvLCBvcHRpb25zPzogUmVxdWVzdEluaXQpID0+IFByb21pc2U8VD4sIFU+LCBcImFib3J0YWJsZVwiPixcbik6IFVzZUNhY2hlZFByb21pc2VSZXR1cm5UeXBlPFQsIFU+O1xuLyoqXG4gKiBGZXRjaCB0aGUgVVJMIGFuZCByZXR1cm5zIHRoZSB7QGxpbmsgQXN5bmNTdGF0ZX0gY29ycmVzcG9uZGluZyB0byB0aGUgZXhlY3V0aW9uIG9mIHRoZSBmZXRjaC4gVGhlIGxhc3QgdmFsdWUgd2lsbCBiZSBrZXB0IGJldHdlZW4gY29tbWFuZCBydW5zLlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGBcbiAqIGltcG9ydCB7IHVzZUZldGNoIH0gZnJvbSAnQHJheWNhc3QvdXRpbHMnO1xuICpcbiAqIGV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIENvbW1hbmQoKSB7XG4gKiAgIGNvbnN0IHsgaXNMb2FkaW5nLCBkYXRhLCByZXZhbGlkYXRlIH0gPSB1c2VGZXRjaCgnaHR0cHM6Ly9hcGkuZXhhbXBsZScpO1xuICpcbiAqICAgcmV0dXJuIChcbiAqICAgICA8RGV0YWlsXG4gKiAgICAgICBpc0xvYWRpbmc9e2lzTG9hZGluZ31cbiAqICAgICAgIG1hcmtkb3duPXtkYXRhfVxuICogICAgICAgYWN0aW9ucz17XG4gKiAgICAgICAgIDxBY3Rpb25QYW5lbD5cbiAqICAgICAgICAgICA8QWN0aW9uIHRpdGxlPVwiUmVsb2FkXCIgb25BY3Rpb249eygpID0+IHJldmFsaWRhdGUoKX0gLz5cbiAqICAgICAgICAgPC9BY3Rpb25QYW5lbD5cbiAqICAgICAgIH1cbiAqICAgICAvPlxuICogICApO1xuICogfTtcbiAqIGBgYFxuICovXG5leHBvcnQgZnVuY3Rpb24gdXNlRmV0Y2g8ViA9IHVua25vd24sIFUgPSB1bmRlZmluZWQsIFQgPSBWPihcbiAgdXJsOiBSZXF1ZXN0SW5mbyxcbiAgb3B0aW9ucz86IFJlcXVlc3RJbml0ICYge1xuICAgIG1hcFJlc3VsdD86IChyZXN1bHQ6IFYpID0+IHsgZGF0YTogVDsgaGFzTW9yZT86IGJvb2xlYW47IGN1cnNvcj86IGFueSB9O1xuICAgIHBhcnNlUmVzcG9uc2U/OiAocmVzcG9uc2U6IFJlc3BvbnNlKSA9PiBQcm9taXNlPFY+O1xuICB9ICYgT21pdDxDYWNoZWRQcm9taXNlT3B0aW9uczwodXJsOiBSZXF1ZXN0SW5mbywgb3B0aW9ucz86IFJlcXVlc3RJbml0KSA9PiBQcm9taXNlPFQ+LCBVPiwgXCJhYm9ydGFibGVcIj4sXG4pOiBVc2VDYWNoZWRQcm9taXNlUmV0dXJuVHlwZTxULCBVPiAmIHsgcGFnaW5hdGlvbjogdW5kZWZpbmVkIH07XG5cbmV4cG9ydCBmdW5jdGlvbiB1c2VGZXRjaDxWID0gdW5rbm93biwgVSA9IHVuZGVmaW5lZCwgVCBleHRlbmRzIHVua25vd25bXSA9IHVua25vd25bXT4oXG4gIHVybDogUmVxdWVzdEluZm8gfCBQYWdpbmF0ZWRSZXF1ZXN0SW5mbyxcbiAgb3B0aW9ucz86IFJlcXVlc3RJbml0ICYge1xuICAgIG1hcFJlc3VsdD86IChyZXN1bHQ6IFYpID0+IHsgZGF0YTogVDsgaGFzTW9yZT86IGJvb2xlYW47IGN1cnNvcj86IGFueSB9O1xuICAgIHBhcnNlUmVzcG9uc2U/OiAocmVzcG9uc2U6IFJlc3BvbnNlKSA9PiBQcm9taXNlPFY+O1xuICB9ICYgT21pdDxDYWNoZWRQcm9taXNlT3B0aW9uczwodXJsOiBSZXF1ZXN0SW5mbywgb3B0aW9ucz86IFJlcXVlc3RJbml0KSA9PiBQcm9taXNlPFQ+LCBVPiwgXCJhYm9ydGFibGVcIj4sXG4pOiBVc2VDYWNoZWRQcm9taXNlUmV0dXJuVHlwZTxULCBVPiB7XG4gIGNvbnN0IHtcbiAgICBwYXJzZVJlc3BvbnNlLFxuICAgIG1hcFJlc3VsdCxcbiAgICBpbml0aWFsRGF0YSxcbiAgICBleGVjdXRlLFxuICAgIGtlZXBQcmV2aW91c0RhdGEsXG4gICAgb25FcnJvcixcbiAgICBvbkRhdGEsXG4gICAgb25XaWxsRXhlY3V0ZSxcbiAgICBmYWlsdXJlVG9hc3RPcHRpb25zLFxuICAgIC4uLmZldGNoT3B0aW9uc1xuICB9ID0gb3B0aW9ucyB8fCB7fTtcblxuICBjb25zdCB1c2VDYWNoZWRQcm9taXNlT3B0aW9uczogQ2FjaGVkUHJvbWlzZU9wdGlvbnM8KHVybDogUmVxdWVzdEluZm8sIG9wdGlvbnM/OiBSZXF1ZXN0SW5pdCkgPT4gUHJvbWlzZTxUPiwgVT4gPSB7XG4gICAgaW5pdGlhbERhdGEsXG4gICAgZXhlY3V0ZSxcbiAgICBrZWVwUHJldmlvdXNEYXRhLFxuICAgIG9uRXJyb3IsXG4gICAgb25EYXRhLFxuICAgIG9uV2lsbEV4ZWN1dGUsXG4gICAgZmFpbHVyZVRvYXN0T3B0aW9ucyxcbiAgfTtcblxuICBjb25zdCBwYXJzZVJlc3BvbnNlUmVmID0gdXNlTGF0ZXN0KHBhcnNlUmVzcG9uc2UgfHwgZGVmYXVsdFBhcnNpbmcpO1xuICBjb25zdCBtYXBSZXN1bHRSZWYgPSB1c2VMYXRlc3QobWFwUmVzdWx0IHx8IGRlZmF1bHRNYXBwaW5nKTtcbiAgY29uc3QgdXJsUmVmID0gdXNlUmVmPFJlcXVlc3RJbmZvIHwgUGFnaW5hdGVkUmVxdWVzdEluZm8+KG51bGwpO1xuICBjb25zdCBmaXJzdFBhZ2VVcmxSZWYgPSB1c2VSZWY8UmVxdWVzdEluZm8gfCB1bmRlZmluZWQ+KG51bGwpO1xuICBjb25zdCBmaXJzdFBhZ2VVcmwgPSB0eXBlb2YgdXJsID09PSBcImZ1bmN0aW9uXCIgPyB1cmwoeyBwYWdlOiAwIH0pIDogdW5kZWZpbmVkO1xuICAvKipcbiAgICogV2hlbiBwYWdpbmF0aW5nLCBgdXJsYCBpcyBhIGBQYWdpbmF0ZWRSZXF1ZXN0SW5mb2AsIHNvIHdlIG9ubHkgd2FudCB0byB1cGRhdGUgdGhlIHJlZiB3aGVuIHRoZSBgZmlyc3RQYWdlVXJsYCBjaGFuZ2VzLlxuICAgKiBXaGVuIG5vdCBwYWdpbmF0aW5nLCBgdXJsYCBpcyBhIGBSZXF1ZXN0SW5mb2AsIHNvIHdlIHdhbnQgdG8gdXBkYXRlIHRoZSByZWYgd2hlbmV2ZXIgYHVybGAgY2hhbmdlcy5cbiAgICovXG4gIGlmICghdXJsUmVmLmN1cnJlbnQgfHwgdHlwZW9mIGZpcnN0UGFnZVVybFJlZi5jdXJyZW50ID09PSBcInVuZGVmaW5lZFwiIHx8IGZpcnN0UGFnZVVybFJlZi5jdXJyZW50ICE9PSBmaXJzdFBhZ2VVcmwpIHtcbiAgICB1cmxSZWYuY3VycmVudCA9IHVybDtcbiAgfVxuICBmaXJzdFBhZ2VVcmxSZWYuY3VycmVudCA9IGZpcnN0UGFnZVVybDtcbiAgY29uc3QgYWJvcnRhYmxlID0gdXNlUmVmPEFib3J0Q29udHJvbGxlcj4obnVsbCk7XG5cbiAgY29uc3QgcGFnaW5hdGVkRm46IEZ1bmN0aW9uUmV0dXJuaW5nUGFnaW5hdGVkUHJvbWlzZTxbUGFnaW5hdGVkUmVxdWVzdEluZm8sIHR5cGVvZiBmZXRjaE9wdGlvbnNdLCBUPiA9IHVzZUNhbGxiYWNrKFxuICAgICh1cmw6IFBhZ2luYXRlZFJlcXVlc3RJbmZvLCBvcHRpb25zPzogUmVxdWVzdEluaXQpID0+IGFzeW5jIChwYWdpbmF0aW9uOiB7IHBhZ2U6IG51bWJlciB9KSA9PiB7XG4gICAgICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaCh1cmwocGFnaW5hdGlvbiksIHsgc2lnbmFsOiBhYm9ydGFibGUuY3VycmVudD8uc2lnbmFsLCAuLi5vcHRpb25zIH0pO1xuICAgICAgY29uc3QgcGFyc2VkID0gKGF3YWl0IHBhcnNlUmVzcG9uc2VSZWYuY3VycmVudChyZXMpKSBhcyBWO1xuICAgICAgcmV0dXJuIG1hcFJlc3VsdFJlZi5jdXJyZW50Py4ocGFyc2VkKTtcbiAgICB9LFxuICAgIFtwYXJzZVJlc3BvbnNlUmVmLCBtYXBSZXN1bHRSZWZdLFxuICApO1xuICBjb25zdCBmbjogRnVuY3Rpb25SZXR1cm5pbmdQcm9taXNlPFtSZXF1ZXN0SW5mbywgUmVxdWVzdEluaXQ/XSwgVD4gPSB1c2VDYWxsYmFjayhcbiAgICBhc3luYyAodXJsOiBSZXF1ZXN0SW5mbywgb3B0aW9ucz86IFJlcXVlc3RJbml0KSA9PiB7XG4gICAgICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaCh1cmwsIHsgc2lnbmFsOiBhYm9ydGFibGUuY3VycmVudD8uc2lnbmFsLCAuLi5vcHRpb25zIH0pO1xuICAgICAgY29uc3QgcGFyc2VkID0gKGF3YWl0IHBhcnNlUmVzcG9uc2VSZWYuY3VycmVudChyZXMpKSBhcyBWO1xuICAgICAgY29uc3QgbWFwcGVkID0gbWFwUmVzdWx0UmVmLmN1cnJlbnQocGFyc2VkKTtcbiAgICAgIHJldHVybiBtYXBwZWQ/LmRhdGEgYXMgdW5rbm93biBhcyBUO1xuICAgIH0sXG4gICAgW3BhcnNlUmVzcG9uc2VSZWYsIG1hcFJlc3VsdFJlZl0sXG4gICk7XG5cbiAgY29uc3QgcHJvbWlzZSA9IHVzZU1lbW8oKCkgPT4ge1xuICAgIGlmIChmaXJzdFBhZ2VVcmxSZWYuY3VycmVudCkge1xuICAgICAgcmV0dXJuIHBhZ2luYXRlZEZuO1xuICAgIH1cbiAgICByZXR1cm4gZm47XG4gIH0sIFtmaXJzdFBhZ2VVcmxSZWYsIGZuLCBwYWdpbmF0ZWRGbl0pO1xuXG4gIC8vIEB0cy1leHBlY3QtZXJyb3IgbGFzdEl0ZW0gY2FuJ3QgYmUgaW5mZXJyZWQgcHJvcGVybHlcbiAgcmV0dXJuIHVzZUNhY2hlZFByb21pc2UocHJvbWlzZSwgW3VybFJlZi5jdXJyZW50IGFzIFBhZ2luYXRlZFJlcXVlc3RJbmZvLCBmZXRjaE9wdGlvbnNdLCB7XG4gICAgLi4udXNlQ2FjaGVkUHJvbWlzZU9wdGlvbnMsXG4gICAgaW50ZXJuYWxfY2FjaGVLZXlTdWZmaXg6IGZpcnN0UGFnZVVybFJlZi5jdXJyZW50ICsgaGFzaChtYXBSZXN1bHRSZWYuY3VycmVudCkgKyBoYXNoKHBhcnNlUmVzcG9uc2VSZWYuY3VycmVudCksXG4gICAgYWJvcnRhYmxlLFxuICB9KTtcbn1cbiIsICJleHBvcnQgZnVuY3Rpb24gaXNKU09OKGNvbnRlbnRUeXBlSGVhZGVyOiBzdHJpbmcgfCBudWxsIHwgdW5kZWZpbmVkKTogYm9vbGVhbiB7XG4gIGlmIChjb250ZW50VHlwZUhlYWRlcikge1xuICAgIGNvbnN0IG1lZGlhVHlwZSA9IHBhcnNlQ29udGVudFR5cGUoY29udGVudFR5cGVIZWFkZXIpO1xuXG4gICAgaWYgKCFtZWRpYVR5cGUpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBpZiAobWVkaWFUeXBlLnN1YnR5cGUgPT09IFwianNvblwiKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICBpZiAobWVkaWFUeXBlLnN1ZmZpeCA9PT0gXCJqc29uXCIpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIGlmIChtZWRpYVR5cGUuc3VmZml4ICYmIC9cXGJqc29uXFxiL2kudGVzdChtZWRpYVR5cGUuc3VmZml4KSkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgaWYgKG1lZGlhVHlwZS5zdWJ0eXBlICYmIC9cXGJqc29uXFxiL2kudGVzdChtZWRpYVR5cGUuc3VidHlwZSkpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgfVxuICByZXR1cm4gZmFsc2U7XG59XG5cbi8qKlxuICogUmVnRXhwIHRvIG1hdGNoIHR5cGUgaW4gUkZDIDY4Mzggd2l0aCBhbiBvcHRpb25hbCB0cmFpbGluZyBgO2AgYmVjYXVzZSBzb21lIEFwcGxlIEFQSXMgcmV0dXJucyBvbmUuLi5cbiAqXG4gKiB0eXBlLW5hbWUgPSByZXN0cmljdGVkLW5hbWVcbiAqIHN1YnR5cGUtbmFtZSA9IHJlc3RyaWN0ZWQtbmFtZVxuICogcmVzdHJpY3RlZC1uYW1lID0gcmVzdHJpY3RlZC1uYW1lLWZpcnN0ICoxMjZyZXN0cmljdGVkLW5hbWUtY2hhcnNcbiAqIHJlc3RyaWN0ZWQtbmFtZS1maXJzdCAgPSBBTFBIQSAvIERJR0lUXG4gKiByZXN0cmljdGVkLW5hbWUtY2hhcnMgID0gQUxQSEEgLyBESUdJVCAvIFwiIVwiIC8gXCIjXCIgL1xuICogICAgICAgICAgICAgICAgICAgICAgICAgIFwiJFwiIC8gXCImXCIgLyBcIi1cIiAvIFwiXlwiIC8gXCJfXCJcbiAqIHJlc3RyaWN0ZWQtbmFtZS1jaGFycyA9LyBcIi5cIiA7IENoYXJhY3RlcnMgYmVmb3JlIGZpcnN0IGRvdCBhbHdheXNcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOyBzcGVjaWZ5IGEgZmFjZXQgbmFtZVxuICogcmVzdHJpY3RlZC1uYW1lLWNoYXJzID0vIFwiK1wiIDsgQ2hhcmFjdGVycyBhZnRlciBsYXN0IHBsdXMgYWx3YXlzXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDsgc3BlY2lmeSBhIHN0cnVjdHVyZWQgc3ludGF4IHN1ZmZpeFxuICogQUxQSEEgPSAgJXg0MS01QSAvICV4NjEtN0EgICA7IEEtWiAvIGEtelxuICogRElHSVQgPSAgJXgzMC0zOSAgICAgICAgICAgICA7IDAtOVxuICovXG5jb25zdCBNRURJQV9UWVBFX1JFR0VYUCA9IC9eKFtBLVphLXowLTldW0EtWmEtejAtOSEjJCZeXy1dezAsMTI2fSlcXC8oW0EtWmEtejAtOV1bQS1aYS16MC05ISMkJl5fListXXswLDEyNn0pOz8kLztcblxuZnVuY3Rpb24gcGFyc2VDb250ZW50VHlwZShoZWFkZXI6IHN0cmluZykge1xuICBjb25zdCBoZWFkZXJEZWxpbWl0YXRpb25pbmRleCA9IGhlYWRlci5pbmRleE9mKFwiO1wiKTtcbiAgY29uc3QgY29udGVudFR5cGUgPSBoZWFkZXJEZWxpbWl0YXRpb25pbmRleCAhPT0gLTEgPyBoZWFkZXIuc2xpY2UoMCwgaGVhZGVyRGVsaW1pdGF0aW9uaW5kZXgpLnRyaW0oKSA6IGhlYWRlci50cmltKCk7XG5cbiAgY29uc3QgbWF0Y2ggPSBNRURJQV9UWVBFX1JFR0VYUC5leGVjKGNvbnRlbnRUeXBlLnRvTG93ZXJDYXNlKCkudG9Mb3dlckNhc2UoKSk7XG5cbiAgaWYgKCFtYXRjaCkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGNvbnN0IHR5cGUgPSBtYXRjaFsxXTtcbiAgbGV0IHN1YnR5cGUgPSBtYXRjaFsyXTtcbiAgbGV0IHN1ZmZpeDtcblxuICAvLyBzdWZmaXggYWZ0ZXIgbGFzdCArXG4gIGNvbnN0IGluZGV4ID0gc3VidHlwZS5sYXN0SW5kZXhPZihcIitcIik7XG4gIGlmIChpbmRleCAhPT0gLTEpIHtcbiAgICBzdWZmaXggPSBzdWJ0eXBlLnN1YnN0cmluZyhpbmRleCArIDEpO1xuICAgIHN1YnR5cGUgPSBzdWJ0eXBlLnN1YnN0cmluZygwLCBpbmRleCk7XG4gIH1cblxuICByZXR1cm4geyB0eXBlLCBzdWJ0eXBlLCBzdWZmaXggfTtcbn1cbiIsICIvKlxuICogSW5zcGlyZWQgYnkgRXhlY2FcbiAqL1xuXG5pbXBvcnQgY2hpbGRQcm9jZXNzIGZyb20gXCJub2RlOmNoaWxkX3Byb2Nlc3NcIjtcbmltcG9ydCB7IHVzZUNhbGxiYWNrLCB1c2VSZWYgfSBmcm9tIFwicmVhY3RcIjtcblxuaW1wb3J0IHsgdXNlQ2FjaGVkUHJvbWlzZSwgQ2FjaGVkUHJvbWlzZU9wdGlvbnMgfSBmcm9tIFwiLi91c2VDYWNoZWRQcm9taXNlXCI7XG5pbXBvcnQgeyB1c2VMYXRlc3QgfSBmcm9tIFwiLi91c2VMYXRlc3RcIjtcbmltcG9ydCB7IFVzZUNhY2hlZFByb21pc2VSZXR1cm5UeXBlIH0gZnJvbSBcIi4vdHlwZXNcIjtcbmltcG9ydCB7XG4gIGdldFNwYXduZWRQcm9taXNlLFxuICBnZXRTcGF3bmVkUmVzdWx0LFxuICBoYW5kbGVPdXRwdXQsXG4gIGRlZmF1bHRQYXJzaW5nLFxuICBQYXJzZUV4ZWNPdXRwdXRIYW5kbGVyLFxufSBmcm9tIFwiLi9leGVjLXV0aWxzXCI7XG5cbnR5cGUgRXhlY09wdGlvbnMgPSB7XG4gIC8qKlxuICAgKiBJZiBgdHJ1ZWAsIHJ1bnMgdGhlIGNvbW1hbmQgaW5zaWRlIG9mIGEgc2hlbGwuIFVzZXMgYC9iaW4vc2hgLiBBIGRpZmZlcmVudCBzaGVsbCBjYW4gYmUgc3BlY2lmaWVkIGFzIGEgc3RyaW5nLiBUaGUgc2hlbGwgc2hvdWxkIHVuZGVyc3RhbmQgdGhlIGAtY2Agc3dpdGNoLlxuICAgKlxuICAgKiBXZSByZWNvbW1lbmQgYWdhaW5zdCB1c2luZyB0aGlzIG9wdGlvbiBzaW5jZSBpdCBpczpcbiAgICogLSBub3QgY3Jvc3MtcGxhdGZvcm0sIGVuY291cmFnaW5nIHNoZWxsLXNwZWNpZmljIHN5bnRheC5cbiAgICogLSBzbG93ZXIsIGJlY2F1c2Ugb2YgdGhlIGFkZGl0aW9uYWwgc2hlbGwgaW50ZXJwcmV0YXRpb24uXG4gICAqIC0gdW5zYWZlLCBwb3RlbnRpYWxseSBhbGxvd2luZyBjb21tYW5kIGluamVjdGlvbi5cbiAgICpcbiAgICogQGRlZmF1bHQgZmFsc2VcbiAgICovXG4gIHNoZWxsPzogYm9vbGVhbiB8IHN0cmluZztcbiAgLyoqXG4gICAqIFN0cmlwIHRoZSBmaW5hbCBuZXdsaW5lIGNoYXJhY3RlciBmcm9tIHRoZSBvdXRwdXQuXG4gICAqIEBkZWZhdWx0IHRydWVcbiAgICovXG4gIHN0cmlwRmluYWxOZXdsaW5lPzogYm9vbGVhbjtcbiAgLyoqXG4gICAqIEN1cnJlbnQgd29ya2luZyBkaXJlY3Rvcnkgb2YgdGhlIGNoaWxkIHByb2Nlc3MuXG4gICAqIEBkZWZhdWx0IHByb2Nlc3MuY3dkKClcbiAgICovXG4gIGN3ZD86IHN0cmluZztcbiAgLyoqXG4gICAqIEVudmlyb25tZW50IGtleS12YWx1ZSBwYWlycy4gRXh0ZW5kcyBhdXRvbWF0aWNhbGx5IGZyb20gYHByb2Nlc3MuZW52YC5cbiAgICogQGRlZmF1bHQgcHJvY2Vzcy5lbnZcbiAgICovXG4gIGVudj86IE5vZGVKUy5Qcm9jZXNzRW52O1xuICAvKipcbiAgICogU3BlY2lmeSB0aGUgY2hhcmFjdGVyIGVuY29kaW5nIHVzZWQgdG8gZGVjb2RlIHRoZSBzdGRvdXQgYW5kIHN0ZGVyciBvdXRwdXQuIElmIHNldCB0byBgXCJidWZmZXJcImAsIHRoZW4gc3Rkb3V0IGFuZCBzdGRlcnIgd2lsbCBiZSBhIEJ1ZmZlciBpbnN0ZWFkIG9mIGEgc3RyaW5nLlxuICAgKlxuICAgKiBAZGVmYXVsdCBcInV0ZjhcIlxuICAgKi9cbiAgZW5jb2Rpbmc/OiBCdWZmZXJFbmNvZGluZyB8IFwiYnVmZmVyXCI7XG4gIC8qKlxuICAgKiBXcml0ZSBzb21lIGlucHV0IHRvIHRoZSBgc3RkaW5gIG9mIHlvdXIgYmluYXJ5LlxuICAgKi9cbiAgaW5wdXQ/OiBzdHJpbmcgfCBCdWZmZXI7XG4gIC8qKiBJZiB0aW1lb3V0IGlzIGdyZWF0ZXIgdGhhbiBgMGAsIHRoZSBwYXJlbnQgd2lsbCBzZW5kIHRoZSBzaWduYWwgYFNJR1RFUk1gIGlmIHRoZSBjaGlsZCBydW5zIGxvbmdlciB0aGFuIHRpbWVvdXQgbWlsbGlzZWNvbmRzLlxuICAgKlxuICAgKiBAZGVmYXVsdCAxMDAwMFxuICAgKi9cbiAgdGltZW91dD86IG51bWJlcjtcbn07XG5cbmNvbnN0IFNQQUNFU19SRUdFWFAgPSAvICsvZztcbmZ1bmN0aW9uIHBhcnNlQ29tbWFuZChjb21tYW5kOiBzdHJpbmcsIGFyZ3M/OiBzdHJpbmdbXSkge1xuICBpZiAoYXJncykge1xuICAgIHJldHVybiBbY29tbWFuZCwgLi4uYXJnc107XG4gIH1cbiAgY29uc3QgdG9rZW5zOiBzdHJpbmdbXSA9IFtdO1xuICBmb3IgKGNvbnN0IHRva2VuIG9mIGNvbW1hbmQudHJpbSgpLnNwbGl0KFNQQUNFU19SRUdFWFApKSB7XG4gICAgLy8gQWxsb3cgc3BhY2VzIHRvIGJlIGVzY2FwZWQgYnkgYSBiYWNrc2xhc2ggaWYgbm90IG1lYW50IGFzIGEgZGVsaW1pdGVyXG4gICAgY29uc3QgcHJldmlvdXNUb2tlbiA9IHRva2Vuc1t0b2tlbnMubGVuZ3RoIC0gMV07XG4gICAgaWYgKHByZXZpb3VzVG9rZW4gJiYgcHJldmlvdXNUb2tlbi5lbmRzV2l0aChcIlxcXFxcIikpIHtcbiAgICAgIC8vIE1lcmdlIHByZXZpb3VzIHRva2VuIHdpdGggY3VycmVudCBvbmVcbiAgICAgIHRva2Vuc1t0b2tlbnMubGVuZ3RoIC0gMV0gPSBgJHtwcmV2aW91c1Rva2VuLnNsaWNlKDAsIC0xKX0gJHt0b2tlbn1gO1xuICAgIH0gZWxzZSB7XG4gICAgICB0b2tlbnMucHVzaCh0b2tlbik7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHRva2Vucztcbn1cblxudHlwZSBFeGVjQ2FjaGVkUHJvbWlzZU9wdGlvbnM8VCwgVT4gPSBPbWl0PFxuICBDYWNoZWRQcm9taXNlT3B0aW9uczxcbiAgICAoX2NvbW1hbmQ6IHN0cmluZywgX2FyZ3M6IHN0cmluZ1tdLCBfb3B0aW9ucz86IEV4ZWNPcHRpb25zLCBpbnB1dD86IHN0cmluZyB8IEJ1ZmZlcikgPT4gUHJvbWlzZTxUPixcbiAgICBVXG4gID4sXG4gIFwiYWJvcnRhYmxlXCJcbj47XG5cbi8qKlxuICogRXhlY3V0ZXMgYSBjb21tYW5kIGFuZCByZXR1cm5zIHRoZSB7QGxpbmsgQXN5bmNTdGF0ZX0gY29ycmVzcG9uZGluZyB0byB0aGUgZXhlY3V0aW9uIG9mIHRoZSBjb21tYW5kLiBUaGUgbGFzdCB2YWx1ZSB3aWxsIGJlIGtlcHQgYmV0d2VlbiBjb21tYW5kIHJ1bnMuXG4gKlxuICogQHJlbWFyayBXaGVuIHNwZWNpZnlpbmcgdGhlIGFyZ3VtZW50cyB2aWEgdGhlIGBjb21tYW5kYCBzdHJpbmcsIGlmIHRoZSBmaWxlIG9yIGFuIGFyZ3VtZW50IG9mIHRoZSBjb21tYW5kIGNvbnRhaW5zIHNwYWNlcywgdGhleSBtdXN0IGJlIGVzY2FwZWQgd2l0aCBiYWNrc2xhc2hlcy4gVGhpcyBtYXR0ZXJzIGVzcGVjaWFsbHkgaWYgYGNvbW1hbmRgIGlzIG5vdCBhIGNvbnN0YW50IGJ1dCBhIHZhcmlhYmxlLCBmb3IgZXhhbXBsZSB3aXRoIGBfX2Rpcm5hbWVgIG9yIGBwcm9jZXNzLmN3ZCgpYC4gRXhjZXB0IGZvciBzcGFjZXMsIG5vIGVzY2FwaW5nL3F1b3RpbmcgaXMgbmVlZGVkLlxuICpcbiAqIFRoZSBgc2hlbGxgIG9wdGlvbiBtdXN0IGJlIHVzZWQgaWYgdGhlIGNvbW1hbmQgdXNlcyBzaGVsbC1zcGVjaWZpYyBmZWF0dXJlcyAoZm9yIGV4YW1wbGUsIGAmJmAgb3IgYHx8YCksIGFzIG9wcG9zZWQgdG8gYmVpbmcgYSBzaW1wbGUgZmlsZSBmb2xsb3dlZCBieSBpdHMgYXJndW1lbnRzLlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGBcbiAqIGltcG9ydCB7IHVzZUV4ZWMgfSBmcm9tICdAcmF5Y2FzdC91dGlscyc7XG4gKlxuICogZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gQ29tbWFuZCgpIHtcbiAqICAgY29uc3QgeyBpc0xvYWRpbmcsIGRhdGEsIHJldmFsaWRhdGUgfSA9IHVzZUV4ZWMoXCJicmV3XCIsIFtcImluZm9cIiwgXCItLWpzb249djJcIiwgXCItLWluc3RhbGxlZFwiXSk7XG4gKiAgIGNvbnN0IHJlc3VsdHMgPSB1c2VNZW1vPHt9W10+KCgpID0+IEpTT04ucGFyc2UoZGF0YSB8fCBcIltdXCIpLCBbZGF0YV0pO1xuICpcbiAqICAgcmV0dXJuIChcbiAqICAgICA8TGlzdCBpc0xvYWRpbmc9e2lzTG9hZGluZ30+XG4gKiAgICAgIHsoZGF0YSB8fCBbXSkubWFwKChpdGVtKSA9PiAoXG4gKiAgICAgICAgPExpc3QuSXRlbSBrZXk9e2l0ZW0uaWR9IHRpdGxlPXtpdGVtLm5hbWV9IC8+XG4gKiAgICAgICkpfVxuICogICAgPC9MaXN0PlxuICogICApO1xuICogfTtcbiAqIGBgYFxuICovXG5leHBvcnQgZnVuY3Rpb24gdXNlRXhlYzxUID0gQnVmZmVyLCBVID0gdW5kZWZpbmVkPihcbiAgY29tbWFuZDogc3RyaW5nLFxuICBvcHRpb25zOiB7XG4gICAgcGFyc2VPdXRwdXQ/OiBQYXJzZUV4ZWNPdXRwdXRIYW5kbGVyPFQsIEJ1ZmZlciwgRXhlY09wdGlvbnM+O1xuICB9ICYgRXhlY09wdGlvbnMgJiB7XG4gICAgICBlbmNvZGluZzogXCJidWZmZXJcIjtcbiAgICB9ICYgRXhlY0NhY2hlZFByb21pc2VPcHRpb25zPFQsIFU+LFxuKTogVXNlQ2FjaGVkUHJvbWlzZVJldHVyblR5cGU8VCwgVT47XG5leHBvcnQgZnVuY3Rpb24gdXNlRXhlYzxUID0gc3RyaW5nLCBVID0gdW5kZWZpbmVkPihcbiAgY29tbWFuZDogc3RyaW5nLFxuICBvcHRpb25zPzoge1xuICAgIHBhcnNlT3V0cHV0PzogUGFyc2VFeGVjT3V0cHV0SGFuZGxlcjxULCBzdHJpbmcsIEV4ZWNPcHRpb25zPjtcbiAgfSAmIEV4ZWNPcHRpb25zICYge1xuICAgICAgZW5jb2Rpbmc/OiBCdWZmZXJFbmNvZGluZztcbiAgICB9ICYgRXhlY0NhY2hlZFByb21pc2VPcHRpb25zPFQsIFU+LFxuKTogVXNlQ2FjaGVkUHJvbWlzZVJldHVyblR5cGU8VCwgVT47XG5leHBvcnQgZnVuY3Rpb24gdXNlRXhlYzxUID0gQnVmZmVyLCBVID0gdW5kZWZpbmVkPihcbiAgZmlsZTogc3RyaW5nLFxuICAvKipcbiAgICogVGhlIGFyZ3VtZW50cyB0byBwYXNzIHRvIHRoZSBmaWxlLiBObyBlc2NhcGluZy9xdW90aW5nIGlzIG5lZWRlZC5cbiAgICpcbiAgICogSWYgZGVmaW5lZCwgdGhlIGNvbW1hbmRzIG5lZWRzIHRvIGJlIGEgZmlsZSB0byBleGVjdXRlLiBJZiB1bmRlZmluZWQsIHRoZSBhcmd1bWVudHMgd2lsbCBiZSBwYXJzZWQgZnJvbSB0aGUgY29tbWFuZC5cbiAgICovXG4gIGFyZ3M6IHN0cmluZ1tdLFxuICBvcHRpb25zOiB7XG4gICAgcGFyc2VPdXRwdXQ/OiBQYXJzZUV4ZWNPdXRwdXRIYW5kbGVyPFQsIEJ1ZmZlciwgRXhlY09wdGlvbnM+O1xuICB9ICYgRXhlY09wdGlvbnMgJiB7XG4gICAgICBlbmNvZGluZzogXCJidWZmZXJcIjtcbiAgICB9ICYgRXhlY0NhY2hlZFByb21pc2VPcHRpb25zPFQsIFU+LFxuKTogVXNlQ2FjaGVkUHJvbWlzZVJldHVyblR5cGU8VCwgVT47XG5leHBvcnQgZnVuY3Rpb24gdXNlRXhlYzxUID0gc3RyaW5nLCBVID0gdW5kZWZpbmVkPihcbiAgZmlsZTogc3RyaW5nLFxuICAvKipcbiAgICogVGhlIGFyZ3VtZW50cyB0byBwYXNzIHRvIHRoZSBmaWxlLiBObyBlc2NhcGluZy9xdW90aW5nIGlzIG5lZWRlZC5cbiAgICpcbiAgICogSWYgZGVmaW5lZCwgdGhlIGNvbW1hbmRzIG5lZWRzIHRvIGJlIGEgZmlsZSB0byBleGVjdXRlLiBJZiB1bmRlZmluZWQsIHRoZSBhcmd1bWVudHMgd2lsbCBiZSBwYXJzZWQgZnJvbSB0aGUgY29tbWFuZC5cbiAgICovXG4gIGFyZ3M6IHN0cmluZ1tdLFxuICBvcHRpb25zPzoge1xuICAgIHBhcnNlT3V0cHV0PzogUGFyc2VFeGVjT3V0cHV0SGFuZGxlcjxULCBzdHJpbmcsIEV4ZWNPcHRpb25zPjtcbiAgfSAmIEV4ZWNPcHRpb25zICYge1xuICAgICAgZW5jb2Rpbmc/OiBCdWZmZXJFbmNvZGluZztcbiAgICB9ICYgRXhlY0NhY2hlZFByb21pc2VPcHRpb25zPFQsIFU+LFxuKTogVXNlQ2FjaGVkUHJvbWlzZVJldHVyblR5cGU8VCwgVT47XG5leHBvcnQgZnVuY3Rpb24gdXNlRXhlYzxULCBVID0gdW5kZWZpbmVkPihcbiAgY29tbWFuZDogc3RyaW5nLFxuICBvcHRpb25zT3JBcmdzPzpcbiAgICB8IHN0cmluZ1tdXG4gICAgfCAoe1xuICAgICAgICBwYXJzZU91dHB1dD86IFBhcnNlRXhlY091dHB1dEhhbmRsZXI8VCwgQnVmZmVyLCBFeGVjT3B0aW9ucz4gfCBQYXJzZUV4ZWNPdXRwdXRIYW5kbGVyPFQsIHN0cmluZywgRXhlY09wdGlvbnM+O1xuICAgICAgfSAmIEV4ZWNPcHRpb25zICZcbiAgICAgICAgRXhlY0NhY2hlZFByb21pc2VPcHRpb25zPFQsIFU+KSxcbiAgb3B0aW9ucz86IHtcbiAgICBwYXJzZU91dHB1dD86IFBhcnNlRXhlY091dHB1dEhhbmRsZXI8VCwgQnVmZmVyLCBFeGVjT3B0aW9ucz4gfCBQYXJzZUV4ZWNPdXRwdXRIYW5kbGVyPFQsIHN0cmluZywgRXhlY09wdGlvbnM+O1xuICB9ICYgRXhlY09wdGlvbnMgJlxuICAgIEV4ZWNDYWNoZWRQcm9taXNlT3B0aW9uczxULCBVPixcbik6IFVzZUNhY2hlZFByb21pc2VSZXR1cm5UeXBlPFQsIFU+IHtcbiAgY29uc3Qge1xuICAgIHBhcnNlT3V0cHV0LFxuICAgIGlucHV0LFxuICAgIG9uRGF0YSxcbiAgICBvbldpbGxFeGVjdXRlLFxuICAgIGluaXRpYWxEYXRhLFxuICAgIGV4ZWN1dGUsXG4gICAga2VlcFByZXZpb3VzRGF0YSxcbiAgICBvbkVycm9yLFxuICAgIGZhaWx1cmVUb2FzdE9wdGlvbnMsXG4gICAgLi4uZXhlY09wdGlvbnNcbiAgfSA9IEFycmF5LmlzQXJyYXkob3B0aW9uc09yQXJncykgPyBvcHRpb25zIHx8IHt9IDogb3B0aW9uc09yQXJncyB8fCB7fTtcblxuICBjb25zdCB1c2VDYWNoZWRQcm9taXNlT3B0aW9uczogRXhlY0NhY2hlZFByb21pc2VPcHRpb25zPFQsIFU+ID0ge1xuICAgIGluaXRpYWxEYXRhLFxuICAgIGV4ZWN1dGUsXG4gICAga2VlcFByZXZpb3VzRGF0YSxcbiAgICBvbkVycm9yLFxuICAgIG9uRGF0YSxcbiAgICBvbldpbGxFeGVjdXRlLFxuICAgIGZhaWx1cmVUb2FzdE9wdGlvbnMsXG4gIH07XG5cbiAgY29uc3QgYWJvcnRhYmxlID0gdXNlUmVmPEFib3J0Q29udHJvbGxlcj4obnVsbCk7XG4gIGNvbnN0IHBhcnNlT3V0cHV0UmVmID0gdXNlTGF0ZXN0KHBhcnNlT3V0cHV0IHx8IGRlZmF1bHRQYXJzaW5nKTtcblxuICBjb25zdCBmbiA9IHVzZUNhbGxiYWNrKFxuICAgIGFzeW5jIChfY29tbWFuZDogc3RyaW5nLCBfYXJnczogc3RyaW5nW10sIF9vcHRpb25zPzogRXhlY09wdGlvbnMsIGlucHV0Pzogc3RyaW5nIHwgQnVmZmVyKSA9PiB7XG4gICAgICBjb25zdCBbZmlsZSwgLi4uYXJnc10gPSBwYXJzZUNvbW1hbmQoX2NvbW1hbmQsIF9hcmdzKTtcbiAgICAgIGNvbnN0IGNvbW1hbmQgPSBbZmlsZSwgLi4uYXJnc10uam9pbihcIiBcIik7XG5cbiAgICAgIGNvbnN0IG9wdGlvbnMgPSB7XG4gICAgICAgIHN0cmlwRmluYWxOZXdsaW5lOiB0cnVlLFxuICAgICAgICAuLi5fb3B0aW9ucyxcbiAgICAgICAgdGltZW91dDogX29wdGlvbnM/LnRpbWVvdXQgfHwgMTAwMDAsXG4gICAgICAgIHNpZ25hbDogYWJvcnRhYmxlLmN1cnJlbnQ/LnNpZ25hbCxcbiAgICAgICAgZW5jb2Rpbmc6IF9vcHRpb25zPy5lbmNvZGluZyA9PT0gbnVsbCA/IFwiYnVmZmVyXCIgOiBfb3B0aW9ucz8uZW5jb2RpbmcgfHwgXCJ1dGY4XCIsXG4gICAgICAgIGVudjogeyBQQVRIOiBcIi91c3IvbG9jYWwvYmluOi91c3IvYmluOi9iaW46L3Vzci9zYmluOi9zYmluXCIsIC4uLnByb2Nlc3MuZW52LCAuLi5fb3B0aW9ucz8uZW52IH0sXG4gICAgICB9O1xuXG4gICAgICBjb25zdCBzcGF3bmVkID0gY2hpbGRQcm9jZXNzLnNwYXduKGZpbGUsIGFyZ3MsIG9wdGlvbnMpO1xuICAgICAgY29uc3Qgc3Bhd25lZFByb21pc2UgPSBnZXRTcGF3bmVkUHJvbWlzZShzcGF3bmVkLCBvcHRpb25zKTtcblxuICAgICAgaWYgKGlucHV0KSB7XG4gICAgICAgIHNwYXduZWQuc3RkaW4uZW5kKGlucHV0KTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgW3sgZXJyb3IsIGV4aXRDb2RlLCBzaWduYWwsIHRpbWVkT3V0IH0sIHN0ZG91dFJlc3VsdCwgc3RkZXJyUmVzdWx0XSA9IGF3YWl0IGdldFNwYXduZWRSZXN1bHQoXG4gICAgICAgIHNwYXduZWQsXG4gICAgICAgIG9wdGlvbnMsXG4gICAgICAgIHNwYXduZWRQcm9taXNlLFxuICAgICAgKTtcbiAgICAgIGNvbnN0IHN0ZG91dCA9IGhhbmRsZU91dHB1dChvcHRpb25zLCBzdGRvdXRSZXN1bHQpO1xuICAgICAgY29uc3Qgc3RkZXJyID0gaGFuZGxlT3V0cHV0KG9wdGlvbnMsIHN0ZGVyclJlc3VsdCk7XG5cbiAgICAgIHJldHVybiBwYXJzZU91dHB1dFJlZi5jdXJyZW50KHtcbiAgICAgICAgLy8gQHRzLWV4cGVjdC1lcnJvciB0b28gbWFueSBnZW5lcmljcywgSSBnaXZlIHVwXG4gICAgICAgIHN0ZG91dCxcbiAgICAgICAgLy8gQHRzLWV4cGVjdC1lcnJvciB0b28gbWFueSBnZW5lcmljcywgSSBnaXZlIHVwXG4gICAgICAgIHN0ZGVycixcbiAgICAgICAgZXJyb3IsXG4gICAgICAgIGV4aXRDb2RlLFxuICAgICAgICBzaWduYWwsXG4gICAgICAgIHRpbWVkT3V0LFxuICAgICAgICBjb21tYW5kLFxuICAgICAgICBvcHRpb25zLFxuICAgICAgICBwYXJlbnRFcnJvcjogbmV3IEVycm9yKCksXG4gICAgICB9KSBhcyBUO1xuICAgIH0sXG4gICAgW3BhcnNlT3V0cHV0UmVmXSxcbiAgKTtcblxuICAvLyBAdHMtZXhwZWN0LWVycm9yIFQgY2FuJ3QgYmUgYSBQcm9taXNlIHNvIGl0J3MgYWN0dWFsbHkgdGhlIHNhbWVcbiAgcmV0dXJuIHVzZUNhY2hlZFByb21pc2UoZm4sIFtjb21tYW5kLCBBcnJheS5pc0FycmF5KG9wdGlvbnNPckFyZ3MpID8gb3B0aW9uc09yQXJncyA6IFtdLCBleGVjT3B0aW9ucywgaW5wdXRdLCB7XG4gICAgLi4udXNlQ2FjaGVkUHJvbWlzZU9wdGlvbnMsXG4gICAgYWJvcnRhYmxlLFxuICB9KTtcbn1cbiIsICJpbXBvcnQgY2hpbGRQcm9jZXNzIGZyb20gXCJub2RlOmNoaWxkX3Byb2Nlc3NcIjtcbmltcG9ydCB7IGNvbnN0YW50cyBhcyBCdWZmZXJDb25zdGFudHMgfSBmcm9tIFwibm9kZTpidWZmZXJcIjtcbmltcG9ydCBTdHJlYW0gZnJvbSBcIm5vZGU6c3RyZWFtXCI7XG5pbXBvcnQgeyBwcm9taXNpZnkgfSBmcm9tIFwibm9kZTp1dGlsXCI7XG5pbXBvcnQgeyBvbkV4aXQgfSBmcm9tIFwiLi92ZW5kb3JzL3NpZ25hbC1leGl0XCI7XG5cbmV4cG9ydCB0eXBlIFNwYXduZWRQcm9taXNlID0gUHJvbWlzZTx7XG4gIGV4aXRDb2RlOiBudW1iZXIgfCBudWxsO1xuICBlcnJvcj86IEVycm9yO1xuICBzaWduYWw6IE5vZGVKUy5TaWduYWxzIHwgbnVsbDtcbiAgdGltZWRPdXQ6IGJvb2xlYW47XG59PjtcblxuZXhwb3J0IGZ1bmN0aW9uIGdldFNwYXduZWRQcm9taXNlKFxuICBzcGF3bmVkOiBjaGlsZFByb2Nlc3MuQ2hpbGRQcm9jZXNzV2l0aG91dE51bGxTdHJlYW1zLFxuICB7IHRpbWVvdXQgfTogeyB0aW1lb3V0PzogbnVtYmVyIH0gPSB7fSxcbik6IFNwYXduZWRQcm9taXNlIHtcbiAgY29uc3Qgc3Bhd25lZFByb21pc2U6IFNwYXduZWRQcm9taXNlID0gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgIHNwYXduZWQub24oXCJleGl0XCIsIChleGl0Q29kZSwgc2lnbmFsKSA9PiB7XG4gICAgICByZXNvbHZlKHsgZXhpdENvZGUsIHNpZ25hbCwgdGltZWRPdXQ6IGZhbHNlIH0pO1xuICAgIH0pO1xuXG4gICAgc3Bhd25lZC5vbihcImVycm9yXCIsIChlcnJvcikgPT4ge1xuICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICB9KTtcblxuICAgIGlmIChzcGF3bmVkLnN0ZGluKSB7XG4gICAgICBzcGF3bmVkLnN0ZGluLm9uKFwiZXJyb3JcIiwgKGVycm9yKSA9PiB7XG4gICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICB9KTtcbiAgICB9XG4gIH0pO1xuXG4gIGNvbnN0IHJlbW92ZUV4aXRIYW5kbGVyID0gb25FeGl0KCgpID0+IHtcbiAgICBzcGF3bmVkLmtpbGwoKTtcbiAgfSk7XG5cbiAgaWYgKHRpbWVvdXQgPT09IDAgfHwgdGltZW91dCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgcmV0dXJuIHNwYXduZWRQcm9taXNlLmZpbmFsbHkoKCkgPT4gcmVtb3ZlRXhpdEhhbmRsZXIoKSk7XG4gIH1cblxuICBsZXQgdGltZW91dElkOiBOb2RlSlMuVGltZW91dDtcbiAgY29uc3QgdGltZW91dFByb21pc2U6IFNwYXduZWRQcm9taXNlID0gbmV3IFByb21pc2UoKF9yZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICB0aW1lb3V0SWQgPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIHNwYXduZWQua2lsbChcIlNJR1RFUk1cIik7XG4gICAgICByZWplY3QoT2JqZWN0LmFzc2lnbihuZXcgRXJyb3IoXCJUaW1lZCBvdXRcIiksIHsgdGltZWRPdXQ6IHRydWUsIHNpZ25hbDogXCJTSUdURVJNXCIgfSkpO1xuICAgIH0sIHRpbWVvdXQpO1xuICB9KTtcblxuICBjb25zdCBzYWZlU3Bhd25lZFByb21pc2UgPSBzcGF3bmVkUHJvbWlzZS5maW5hbGx5KCgpID0+IHtcbiAgICBjbGVhclRpbWVvdXQodGltZW91dElkKTtcbiAgfSk7XG5cbiAgcmV0dXJuIFByb21pc2UucmFjZShbdGltZW91dFByb21pc2UsIHNhZmVTcGF3bmVkUHJvbWlzZV0pLmZpbmFsbHkoKCkgPT4gcmVtb3ZlRXhpdEhhbmRsZXIoKSk7XG59XG5cbmNsYXNzIE1heEJ1ZmZlckVycm9yIGV4dGVuZHMgRXJyb3Ige1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBzdXBlcihcIlRoZSBvdXRwdXQgaXMgdG9vIGJpZ1wiKTtcbiAgICB0aGlzLm5hbWUgPSBcIk1heEJ1ZmZlckVycm9yXCI7XG4gIH1cbn1cblxuZnVuY3Rpb24gYnVmZmVyU3RyZWFtPFQgZXh0ZW5kcyBzdHJpbmcgfCBCdWZmZXI+KG9wdGlvbnM6IHsgZW5jb2Rpbmc6IEJ1ZmZlckVuY29kaW5nIHwgXCJidWZmZXJcIiB9KSB7XG4gIGNvbnN0IHsgZW5jb2RpbmcgfSA9IG9wdGlvbnM7XG4gIGNvbnN0IGlzQnVmZmVyID0gZW5jb2RpbmcgPT09IFwiYnVmZmVyXCI7XG5cbiAgLy8gQHRzLWV4cGVjdC1lcnJvciBtaXNzaW5nIHRoZSBtZXRob2RzIHdlIGFyZSBhZGRpbmcgYmVsb3dcbiAgY29uc3Qgc3RyZWFtOiBTdHJlYW0uUGFzc1Rocm91Z2ggJiB7IGdldEJ1ZmZlcmVkVmFsdWU6ICgpID0+IFQ7IGdldEJ1ZmZlcmVkTGVuZ3RoOiAoKSA9PiBudW1iZXIgfSA9XG4gICAgbmV3IFN0cmVhbS5QYXNzVGhyb3VnaCh7IG9iamVjdE1vZGU6IGZhbHNlIH0pO1xuXG4gIGlmIChlbmNvZGluZyAmJiBlbmNvZGluZyAhPT0gXCJidWZmZXJcIikge1xuICAgIHN0cmVhbS5zZXRFbmNvZGluZyhlbmNvZGluZyk7XG4gIH1cblxuICBsZXQgbGVuZ3RoID0gMDtcbiAgY29uc3QgY2h1bmtzOiBhbnlbXSA9IFtdO1xuXG4gIHN0cmVhbS5vbihcImRhdGFcIiwgKGNodW5rKSA9PiB7XG4gICAgY2h1bmtzLnB1c2goY2h1bmspO1xuXG4gICAgbGVuZ3RoICs9IGNodW5rLmxlbmd0aDtcbiAgfSk7XG5cbiAgc3RyZWFtLmdldEJ1ZmZlcmVkVmFsdWUgPSAoKSA9PiB7XG4gICAgcmV0dXJuIChpc0J1ZmZlciA/IEJ1ZmZlci5jb25jYXQoY2h1bmtzLCBsZW5ndGgpIDogY2h1bmtzLmpvaW4oXCJcIikpIGFzIFQ7XG4gIH07XG5cbiAgc3RyZWFtLmdldEJ1ZmZlcmVkTGVuZ3RoID0gKCkgPT4gbGVuZ3RoO1xuXG4gIHJldHVybiBzdHJlYW07XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGdldFN0cmVhbTxUIGV4dGVuZHMgc3RyaW5nIHwgQnVmZmVyPihcbiAgaW5wdXRTdHJlYW06IFN0cmVhbS5SZWFkYWJsZSxcbiAgb3B0aW9uczogeyBlbmNvZGluZzogQnVmZmVyRW5jb2RpbmcgfCBcImJ1ZmZlclwiIH0sXG4pIHtcbiAgY29uc3Qgc3RyZWFtID0gYnVmZmVyU3RyZWFtPFQ+KG9wdGlvbnMpO1xuXG4gIGF3YWl0IG5ldyBQcm9taXNlPHZvaWQ+KChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICBjb25zdCByZWplY3RQcm9taXNlID0gKGVycm9yOiBFcnJvciAmIHsgYnVmZmVyZWREYXRhPzogVCB9KSA9PiB7XG4gICAgICAvLyBEb24ndCByZXRyaWV2ZSBhbiBvdmVyc2l6ZWQgYnVmZmVyLlxuICAgICAgaWYgKGVycm9yICYmIHN0cmVhbS5nZXRCdWZmZXJlZExlbmd0aCgpIDw9IEJ1ZmZlckNvbnN0YW50cy5NQVhfTEVOR1RIKSB7XG4gICAgICAgIGVycm9yLmJ1ZmZlcmVkRGF0YSA9IHN0cmVhbS5nZXRCdWZmZXJlZFZhbHVlKCk7XG4gICAgICB9XG5cbiAgICAgIHJlamVjdChlcnJvcik7XG4gICAgfTtcblxuICAgIChhc3luYyAoKSA9PiB7XG4gICAgICB0cnkge1xuICAgICAgICBhd2FpdCBwcm9taXNpZnkoU3RyZWFtLnBpcGVsaW5lKShpbnB1dFN0cmVhbSwgc3RyZWFtKTtcbiAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgcmVqZWN0UHJvbWlzZShlcnJvciBhcyBhbnkpO1xuICAgICAgfVxuICAgIH0pKCk7XG5cbiAgICBzdHJlYW0ub24oXCJkYXRhXCIsICgpID0+IHtcbiAgICAgIC8vIDgwbWJcbiAgICAgIGlmIChzdHJlYW0uZ2V0QnVmZmVyZWRMZW5ndGgoKSA+IDEwMDAgKiAxMDAwICogODApIHtcbiAgICAgICAgcmVqZWN0UHJvbWlzZShuZXcgTWF4QnVmZmVyRXJyb3IoKSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xuXG4gIHJldHVybiBzdHJlYW0uZ2V0QnVmZmVyZWRWYWx1ZSgpO1xufVxuXG4vLyBPbiBmYWlsdXJlLCBgcmVzdWx0LnN0ZG91dHxzdGRlcnJgIHNob3VsZCBjb250YWluIHRoZSBjdXJyZW50bHkgYnVmZmVyZWQgc3RyZWFtXG5hc3luYyBmdW5jdGlvbiBnZXRCdWZmZXJlZERhdGE8VCBleHRlbmRzIHN0cmluZyB8IEJ1ZmZlcj4oc3RyZWFtOiBTdHJlYW0uUmVhZGFibGUsIHN0cmVhbVByb21pc2U6IFByb21pc2U8VD4pIHtcbiAgc3RyZWFtLmRlc3Ryb3koKTtcblxuICB0cnkge1xuICAgIHJldHVybiBhd2FpdCBzdHJlYW1Qcm9taXNlO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJldHVybiAoZXJyb3IgYXMgYW55IGFzIHsgYnVmZmVyZWREYXRhOiBUIH0pLmJ1ZmZlcmVkRGF0YTtcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0U3Bhd25lZFJlc3VsdDxUIGV4dGVuZHMgc3RyaW5nIHwgQnVmZmVyPihcbiAgeyBzdGRvdXQsIHN0ZGVyciB9OiBjaGlsZFByb2Nlc3MuQ2hpbGRQcm9jZXNzV2l0aG91dE51bGxTdHJlYW1zLFxuICB7IGVuY29kaW5nIH06IHsgZW5jb2Rpbmc6IEJ1ZmZlckVuY29kaW5nIHwgXCJidWZmZXJcIiB9LFxuICBwcm9jZXNzRG9uZTogU3Bhd25lZFByb21pc2UsXG4pIHtcbiAgY29uc3Qgc3Rkb3V0UHJvbWlzZSA9IGdldFN0cmVhbTxUPihzdGRvdXQsIHsgZW5jb2RpbmcgfSk7XG4gIGNvbnN0IHN0ZGVyclByb21pc2UgPSBnZXRTdHJlYW08VD4oc3RkZXJyLCB7IGVuY29kaW5nIH0pO1xuXG4gIHRyeSB7XG4gICAgcmV0dXJuIGF3YWl0IFByb21pc2UuYWxsKFtwcm9jZXNzRG9uZSwgc3Rkb3V0UHJvbWlzZSwgc3RkZXJyUHJvbWlzZV0pO1xuICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgcmV0dXJuIFByb21pc2UuYWxsKFtcbiAgICAgIHtcbiAgICAgICAgZXJyb3I6IGVycm9yIGFzIEVycm9yLFxuICAgICAgICBleGl0Q29kZTogbnVsbCxcbiAgICAgICAgc2lnbmFsOiBlcnJvci5zaWduYWwgYXMgTm9kZUpTLlNpZ25hbHMgfCBudWxsLFxuICAgICAgICB0aW1lZE91dDogKGVycm9yLnRpbWVkT3V0IGFzIGJvb2xlYW4pIHx8IGZhbHNlLFxuICAgICAgfSxcbiAgICAgIGdldEJ1ZmZlcmVkRGF0YShzdGRvdXQsIHN0ZG91dFByb21pc2UpLFxuICAgICAgZ2V0QnVmZmVyZWREYXRhKHN0ZGVyciwgc3RkZXJyUHJvbWlzZSksXG4gICAgXSk7XG4gIH1cbn1cblxuZnVuY3Rpb24gc3RyaXBGaW5hbE5ld2xpbmU8VCBleHRlbmRzIHN0cmluZyB8IEJ1ZmZlcj4oaW5wdXQ6IFQpIHtcbiAgY29uc3QgTEYgPSB0eXBlb2YgaW5wdXQgPT09IFwic3RyaW5nXCIgPyBcIlxcblwiIDogXCJcXG5cIi5jaGFyQ29kZUF0KDApO1xuICBjb25zdCBDUiA9IHR5cGVvZiBpbnB1dCA9PT0gXCJzdHJpbmdcIiA/IFwiXFxyXCIgOiBcIlxcclwiLmNoYXJDb2RlQXQoMCk7XG5cbiAgaWYgKGlucHV0W2lucHV0Lmxlbmd0aCAtIDFdID09PSBMRikge1xuICAgIC8vIEB0cy1leHBlY3QtZXJyb3Igd2UgYXJlIGRvaW5nIHNvbWUgbmFzdHkgc3R1ZmYgaGVyZVxuICAgIGlucHV0ID0gaW5wdXQuc2xpY2UoMCwgLTEpO1xuICB9XG5cbiAgaWYgKGlucHV0W2lucHV0Lmxlbmd0aCAtIDFdID09PSBDUikge1xuICAgIC8vIEB0cy1leHBlY3QtZXJyb3Igd2UgYXJlIGRvaW5nIHNvbWUgbmFzdHkgc3R1ZmYgaGVyZVxuICAgIGlucHV0ID0gaW5wdXQuc2xpY2UoMCwgLTEpO1xuICB9XG5cbiAgcmV0dXJuIGlucHV0O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaGFuZGxlT3V0cHV0PFQgZXh0ZW5kcyBzdHJpbmcgfCBCdWZmZXI+KG9wdGlvbnM6IHsgc3RyaXBGaW5hbE5ld2xpbmU/OiBib29sZWFuIH0sIHZhbHVlOiBUKSB7XG4gIGlmIChvcHRpb25zLnN0cmlwRmluYWxOZXdsaW5lKSB7XG4gICAgcmV0dXJuIHN0cmlwRmluYWxOZXdsaW5lKHZhbHVlKTtcbiAgfVxuXG4gIHJldHVybiB2YWx1ZTtcbn1cblxuZnVuY3Rpb24gZ2V0RXJyb3JQcmVmaXgoe1xuICB0aW1lZE91dCxcbiAgdGltZW91dCxcbiAgc2lnbmFsLFxuICBleGl0Q29kZSxcbn06IHtcbiAgZXhpdENvZGU6IG51bWJlciB8IG51bGw7XG4gIHNpZ25hbDogTm9kZUpTLlNpZ25hbHMgfCBudWxsO1xuICB0aW1lZE91dDogYm9vbGVhbjtcbiAgdGltZW91dD86IG51bWJlcjtcbn0pIHtcbiAgaWYgKHRpbWVkT3V0KSB7XG4gICAgcmV0dXJuIGB0aW1lZCBvdXQgYWZ0ZXIgJHt0aW1lb3V0fSBtaWxsaXNlY29uZHNgO1xuICB9XG5cbiAgaWYgKHNpZ25hbCAhPT0gdW5kZWZpbmVkICYmIHNpZ25hbCAhPT0gbnVsbCkge1xuICAgIHJldHVybiBgd2FzIGtpbGxlZCB3aXRoICR7c2lnbmFsfWA7XG4gIH1cblxuICBpZiAoZXhpdENvZGUgIT09IHVuZGVmaW5lZCAmJiBleGl0Q29kZSAhPT0gbnVsbCkge1xuICAgIHJldHVybiBgZmFpbGVkIHdpdGggZXhpdCBjb2RlICR7ZXhpdENvZGV9YDtcbiAgfVxuXG4gIHJldHVybiBcImZhaWxlZFwiO1xufVxuXG5mdW5jdGlvbiBtYWtlRXJyb3Ioe1xuICBzdGRvdXQsXG4gIHN0ZGVycixcbiAgZXJyb3IsXG4gIHNpZ25hbCxcbiAgZXhpdENvZGUsXG4gIGNvbW1hbmQsXG4gIHRpbWVkT3V0LFxuICBvcHRpb25zLFxuICBwYXJlbnRFcnJvcixcbn06IHtcbiAgc3Rkb3V0OiBzdHJpbmcgfCBCdWZmZXI7XG4gIHN0ZGVycjogc3RyaW5nIHwgQnVmZmVyO1xuICBlcnJvcj86IEVycm9yO1xuICBleGl0Q29kZTogbnVtYmVyIHwgbnVsbDtcbiAgc2lnbmFsOiBOb2RlSlMuU2lnbmFscyB8IG51bGw7XG4gIHRpbWVkT3V0OiBib29sZWFuO1xuICBjb21tYW5kOiBzdHJpbmc7XG4gIG9wdGlvbnM/OiB7IHRpbWVvdXQ/OiBudW1iZXIgfTtcbiAgcGFyZW50RXJyb3I6IEVycm9yO1xufSkge1xuICBjb25zdCBwcmVmaXggPSBnZXRFcnJvclByZWZpeCh7IHRpbWVkT3V0LCB0aW1lb3V0OiBvcHRpb25zPy50aW1lb3V0LCBzaWduYWwsIGV4aXRDb2RlIH0pO1xuICBjb25zdCBleGVjYU1lc3NhZ2UgPSBgQ29tbWFuZCAke3ByZWZpeH06ICR7Y29tbWFuZH1gO1xuICBjb25zdCBzaG9ydE1lc3NhZ2UgPSBlcnJvciA/IGAke2V4ZWNhTWVzc2FnZX1cXG4ke2Vycm9yLm1lc3NhZ2V9YCA6IGV4ZWNhTWVzc2FnZTtcbiAgY29uc3QgbWVzc2FnZSA9IFtzaG9ydE1lc3NhZ2UsIHN0ZGVyciwgc3Rkb3V0XS5maWx0ZXIoQm9vbGVhbikuam9pbihcIlxcblwiKTtcblxuICBpZiAoZXJyb3IpIHtcbiAgICAvLyBAdHMtZXhwZWN0LWVycm9yIG5vdCBvbiBFcnJvclxuICAgIGVycm9yLm9yaWdpbmFsTWVzc2FnZSA9IGVycm9yLm1lc3NhZ2U7XG4gIH0gZWxzZSB7XG4gICAgZXJyb3IgPSBwYXJlbnRFcnJvcjtcbiAgfVxuXG4gIGVycm9yLm1lc3NhZ2UgPSBtZXNzYWdlO1xuXG4gIC8vIEB0cy1leHBlY3QtZXJyb3Igbm90IG9uIEVycm9yXG4gIGVycm9yLnNob3J0TWVzc2FnZSA9IHNob3J0TWVzc2FnZTtcbiAgLy8gQHRzLWV4cGVjdC1lcnJvciBub3Qgb24gRXJyb3JcbiAgZXJyb3IuY29tbWFuZCA9IGNvbW1hbmQ7XG4gIC8vIEB0cy1leHBlY3QtZXJyb3Igbm90IG9uIEVycm9yXG4gIGVycm9yLmV4aXRDb2RlID0gZXhpdENvZGU7XG4gIC8vIEB0cy1leHBlY3QtZXJyb3Igbm90IG9uIEVycm9yXG4gIGVycm9yLnNpZ25hbCA9IHNpZ25hbDtcbiAgLy8gQHRzLWV4cGVjdC1lcnJvciBub3Qgb24gRXJyb3JcbiAgZXJyb3Iuc3Rkb3V0ID0gc3Rkb3V0O1xuICAvLyBAdHMtZXhwZWN0LWVycm9yIG5vdCBvbiBFcnJvclxuICBlcnJvci5zdGRlcnIgPSBzdGRlcnI7XG5cbiAgaWYgKFwiYnVmZmVyZWREYXRhXCIgaW4gZXJyb3IpIHtcbiAgICBkZWxldGUgZXJyb3JbXCJidWZmZXJlZERhdGFcIl07XG4gIH1cblxuICByZXR1cm4gZXJyb3I7XG59XG5cbmV4cG9ydCB0eXBlIFBhcnNlRXhlY091dHB1dEhhbmRsZXI8XG4gIFQsXG4gIERlY29kZWRPdXRwdXQgZXh0ZW5kcyBzdHJpbmcgfCBCdWZmZXIgPSBzdHJpbmcgfCBCdWZmZXIsXG4gIE9wdGlvbnMgPSB1bmtub3duLFxuPiA9IChhcmdzOiB7XG4gIC8qKiBUaGUgb3V0cHV0IG9mIHRoZSBwcm9jZXNzIG9uIHN0ZG91dC4gKi9cbiAgc3Rkb3V0OiBEZWNvZGVkT3V0cHV0O1xuICAvKiogVGhlIG91dHB1dCBvZiB0aGUgcHJvY2VzcyBvbiBzdGRlcnIuICovXG4gIHN0ZGVycjogRGVjb2RlZE91dHB1dDtcbiAgZXJyb3I/OiBFcnJvcjtcbiAgLyoqIFRoZSBudW1lcmljIGV4aXQgY29kZSBvZiB0aGUgcHJvY2VzcyB0aGF0IHdhcyBydW4uICovXG4gIGV4aXRDb2RlOiBudW1iZXIgfCBudWxsO1xuICAvKipcbiAgICogVGhlIG5hbWUgb2YgdGhlIHNpZ25hbCB0aGF0IHdhcyB1c2VkIHRvIHRlcm1pbmF0ZSB0aGUgcHJvY2Vzcy4gRm9yIGV4YW1wbGUsIFNJR0ZQRS5cbiAgICpcbiAgICogSWYgYSBzaWduYWwgdGVybWluYXRlZCB0aGUgcHJvY2VzcywgdGhpcyBwcm9wZXJ0eSBpcyBkZWZpbmVkLiBPdGhlcndpc2UgaXQgaXMgbnVsbC5cbiAgICovXG4gIHNpZ25hbDogTm9kZUpTLlNpZ25hbHMgfCBudWxsO1xuICAvKiogV2hldGhlciB0aGUgcHJvY2VzcyB0aW1lZCBvdXQuICovXG4gIHRpbWVkT3V0OiBib29sZWFuO1xuICAvKiogVGhlIGNvbW1hbmQgdGhhdCB3YXMgcnVuLCBmb3IgbG9nZ2luZyBwdXJwb3Nlcy4gKi9cbiAgY29tbWFuZDogc3RyaW5nO1xuICBvcHRpb25zPzogT3B0aW9ucztcbn0pID0+IFQ7XG5cbmV4cG9ydCBmdW5jdGlvbiBkZWZhdWx0UGFyc2luZzxUIGV4dGVuZHMgc3RyaW5nIHwgQnVmZmVyPih7XG4gIHN0ZG91dCxcbiAgc3RkZXJyLFxuICBlcnJvcixcbiAgZXhpdENvZGUsXG4gIHNpZ25hbCxcbiAgdGltZWRPdXQsXG4gIGNvbW1hbmQsXG4gIG9wdGlvbnMsXG4gIHBhcmVudEVycm9yLFxufToge1xuICBzdGRvdXQ6IFQ7XG4gIHN0ZGVycjogVDtcbiAgZXJyb3I/OiBFcnJvcjtcbiAgZXhpdENvZGU6IG51bWJlciB8IG51bGw7XG4gIHNpZ25hbDogTm9kZUpTLlNpZ25hbHMgfCBudWxsO1xuICB0aW1lZE91dDogYm9vbGVhbjtcbiAgY29tbWFuZDogc3RyaW5nO1xuICBvcHRpb25zPzogeyB0aW1lb3V0PzogbnVtYmVyIH07XG4gIHBhcmVudEVycm9yOiBFcnJvcjtcbn0pIHtcbiAgaWYgKGVycm9yIHx8IGV4aXRDb2RlICE9PSAwIHx8IHNpZ25hbCAhPT0gbnVsbCkge1xuICAgIGNvbnN0IHJldHVybmVkRXJyb3IgPSBtYWtlRXJyb3Ioe1xuICAgICAgZXJyb3IsXG4gICAgICBleGl0Q29kZSxcbiAgICAgIHNpZ25hbCxcbiAgICAgIHN0ZG91dCxcbiAgICAgIHN0ZGVycixcbiAgICAgIGNvbW1hbmQsXG4gICAgICB0aW1lZE91dCxcbiAgICAgIG9wdGlvbnMsXG4gICAgICBwYXJlbnRFcnJvcixcbiAgICB9KTtcblxuICAgIHRocm93IHJldHVybmVkRXJyb3I7XG4gIH1cblxuICByZXR1cm4gc3Rkb3V0O1xufVxuIiwgIi8qIGVzbGludC1kaXNhYmxlIEB0eXBlc2NyaXB0LWVzbGludC9iYW4tdHMtY29tbWVudCAqL1xuLyogZXNsaW50LWRpc2FibGUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueSAqL1xuLy8gTm90ZTogc2luY2UgbnljIHVzZXMgdGhpcyBtb2R1bGUgdG8gb3V0cHV0IGNvdmVyYWdlLCBhbnkgbGluZXNcbi8vIHRoYXQgYXJlIGluIHRoZSBkaXJlY3Qgc3luYyBmbG93IG9mIG55YydzIG91dHB1dENvdmVyYWdlIGFyZVxuLy8gaWdub3JlZCwgc2luY2Ugd2UgY2FuIG5ldmVyIGdldCBjb3ZlcmFnZSBmb3IgdGhlbS5cbi8vIGdyYWIgYSByZWZlcmVuY2UgdG8gbm9kZSdzIHJlYWwgcHJvY2VzcyBvYmplY3QgcmlnaHQgYXdheVxuXG5jb25zdCBwcm9jZXNzT2sgPSAocHJvY2VzczogYW55KSA9PlxuICAhIXByb2Nlc3MgJiZcbiAgdHlwZW9mIHByb2Nlc3MgPT09IFwib2JqZWN0XCIgJiZcbiAgdHlwZW9mIHByb2Nlc3MucmVtb3ZlTGlzdGVuZXIgPT09IFwiZnVuY3Rpb25cIiAmJlxuICB0eXBlb2YgcHJvY2Vzcy5lbWl0ID09PSBcImZ1bmN0aW9uXCIgJiZcbiAgdHlwZW9mIHByb2Nlc3MucmVhbGx5RXhpdCA9PT0gXCJmdW5jdGlvblwiICYmXG4gIHR5cGVvZiBwcm9jZXNzLmxpc3RlbmVycyA9PT0gXCJmdW5jdGlvblwiICYmXG4gIHR5cGVvZiBwcm9jZXNzLmtpbGwgPT09IFwiZnVuY3Rpb25cIiAmJlxuICB0eXBlb2YgcHJvY2Vzcy5waWQgPT09IFwibnVtYmVyXCIgJiZcbiAgdHlwZW9mIHByb2Nlc3Mub24gPT09IFwiZnVuY3Rpb25cIjtcbmNvbnN0IGtFeGl0RW1pdHRlciA9IC8qICNfX1BVUkVfXyAqLyBTeW1ib2wuZm9yKFwic2lnbmFsLWV4aXQgZW1pdHRlclwiKTtcbi8vIHRlZW55IHNwZWNpYWwgcHVycG9zZSBlZVxuY2xhc3MgRW1pdHRlciB7XG4gIGVtaXR0ZWQgPSB7XG4gICAgYWZ0ZXJFeGl0OiBmYWxzZSxcbiAgICBleGl0OiBmYWxzZSxcbiAgfTtcbiAgbGlzdGVuZXJzID0ge1xuICAgIGFmdGVyRXhpdDogW10sXG4gICAgZXhpdDogW10sXG4gIH07XG4gIGNvdW50ID0gMDtcbiAgaWQgPSBNYXRoLnJhbmRvbSgpO1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICAvLyBAdHMtaWdub3JlXG4gICAgaWYgKGdsb2JhbFtrRXhpdEVtaXR0ZXJdKSB7XG4gICAgICAvLyBAdHMtaWdub3JlXG4gICAgICByZXR1cm4gZ2xvYmFsW2tFeGl0RW1pdHRlcl07XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShnbG9iYWwsIGtFeGl0RW1pdHRlciwge1xuICAgICAgdmFsdWU6IHRoaXMsXG4gICAgICB3cml0YWJsZTogZmFsc2UsXG4gICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgIGNvbmZpZ3VyYWJsZTogZmFsc2UsXG4gICAgfSk7XG4gIH1cbiAgb24oZXY6IGFueSwgZm46IGFueSkge1xuICAgIC8vIEB0cy1pZ25vcmVcbiAgICB0aGlzLmxpc3RlbmVyc1tldl0ucHVzaChmbik7XG4gIH1cbiAgcmVtb3ZlTGlzdGVuZXIoZXY6IGFueSwgZm46IGFueSkge1xuICAgIC8vIEB0cy1pZ25vcmVcbiAgICBjb25zdCBsaXN0ID0gdGhpcy5saXN0ZW5lcnNbZXZdO1xuICAgIGNvbnN0IGkgPSBsaXN0LmluZGV4T2YoZm4pO1xuICAgIC8qIGM4IGlnbm9yZSBzdGFydCAqL1xuICAgIGlmIChpID09PSAtMSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICAvKiBjOCBpZ25vcmUgc3RvcCAqL1xuICAgIGlmIChpID09PSAwICYmIGxpc3QubGVuZ3RoID09PSAxKSB7XG4gICAgICBsaXN0Lmxlbmd0aCA9IDA7XG4gICAgfSBlbHNlIHtcbiAgICAgIGxpc3Quc3BsaWNlKGksIDEpO1xuICAgIH1cbiAgfVxuICBlbWl0KGV2OiBhbnksIGNvZGU6IGFueSwgc2lnbmFsOiBhbnkpOiBhbnkge1xuICAgIC8vIEB0cy1pZ25vcmVcbiAgICBpZiAodGhpcy5lbWl0dGVkW2V2XSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICAvLyBAdHMtaWdub3JlXG4gICAgdGhpcy5lbWl0dGVkW2V2XSA9IHRydWU7XG4gICAgbGV0IHJldCA9IGZhbHNlO1xuICAgIC8vIEB0cy1pZ25vcmVcbiAgICBmb3IgKGNvbnN0IGZuIG9mIHRoaXMubGlzdGVuZXJzW2V2XSkge1xuICAgICAgcmV0ID0gZm4oY29kZSwgc2lnbmFsKSA9PT0gdHJ1ZSB8fCByZXQ7XG4gICAgfVxuICAgIGlmIChldiA9PT0gXCJleGl0XCIpIHtcbiAgICAgIHJldCA9IHRoaXMuZW1pdChcImFmdGVyRXhpdFwiLCBjb2RlLCBzaWduYWwpIHx8IHJldDtcbiAgICB9XG4gICAgcmV0dXJuIHJldDtcbiAgfVxufVxuXG5jbGFzcyBTaWduYWxFeGl0RmFsbGJhY2sge1xuICBvbkV4aXQoKSB7XG4gICAgcmV0dXJuICgpID0+IHt9O1xuICB9XG4gIGxvYWQoKSB7fVxuICB1bmxvYWQoKSB7fVxufVxuY2xhc3MgU2lnbmFsRXhpdCB7XG4gIC8vIFwiU0lHSFVQXCIgdGhyb3dzIGFuIGBFTk9TWVNgIGVycm9yIG9uIFdpbmRvd3MsXG4gIC8vIHNvIHVzZSBhIHN1cHBvcnRlZCBzaWduYWwgaW5zdGVhZFxuICAvKiBjOCBpZ25vcmUgc3RhcnQgKi9cbiAgLy8gQHRzLWlnbm9yZVxuICAjaHVwU2lnID0gcHJvY2Vzcy5wbGF0Zm9ybSA9PT0gXCJ3aW4zMlwiID8gXCJTSUdJTlRcIiA6IFwiU0lHSFVQXCI7XG4gIC8qIGM4IGlnbm9yZSBzdG9wICovXG4gICNlbWl0dGVyID0gbmV3IEVtaXR0ZXIoKTtcbiAgI3Byb2Nlc3M6IGFueTtcbiAgI29yaWdpbmFsUHJvY2Vzc0VtaXQ6IGFueTtcbiAgI29yaWdpbmFsUHJvY2Vzc1JlYWxseUV4aXQ6IGFueTtcbiAgI3NpZ0xpc3RlbmVycyA9IHt9O1xuICAjbG9hZGVkID0gZmFsc2U7XG4gICNzaWduYWxzOiBzdHJpbmdbXSA9IFtdO1xuICBjb25zdHJ1Y3Rvcihwcm9jZXNzOiBhbnkpIHtcbiAgICAvKipcbiAgICAgKiBUaGlzIGlzIG5vdCB0aGUgc2V0IG9mIGFsbCBwb3NzaWJsZSBzaWduYWxzLlxuICAgICAqXG4gICAgICogSXQgSVMsIGhvd2V2ZXIsIHRoZSBzZXQgb2YgYWxsIHNpZ25hbHMgdGhhdCB0cmlnZ2VyXG4gICAgICogYW4gZXhpdCBvbiBlaXRoZXIgTGludXggb3IgQlNEIHN5c3RlbXMuICBMaW51eCBpcyBhXG4gICAgICogc3VwZXJzZXQgb2YgdGhlIHNpZ25hbCBuYW1lcyBzdXBwb3J0ZWQgb24gQlNELCBhbmRcbiAgICAgKiB0aGUgdW5rbm93biBzaWduYWxzIGp1c3QgZmFpbCB0byByZWdpc3Rlciwgc28gd2UgY2FuXG4gICAgICogY2F0Y2ggdGhhdCBlYXNpbHkgZW5vdWdoLlxuICAgICAqXG4gICAgICogV2luZG93cyBzaWduYWxzIGFyZSBhIGRpZmZlcmVudCBzZXQsIHNpbmNlIHRoZXJlIGFyZVxuICAgICAqIHNpZ25hbHMgdGhhdCB0ZXJtaW5hdGUgV2luZG93cyBwcm9jZXNzZXMsIGJ1dCBkb24ndFxuICAgICAqIHRlcm1pbmF0ZSAob3IgZG9uJ3QgZXZlbiBleGlzdCkgb24gUG9zaXggc3lzdGVtcy5cbiAgICAgKlxuICAgICAqIERvbid0IGJvdGhlciB3aXRoIFNJR0tJTEwuICBJdCdzIHVuY2F0Y2hhYmxlLCB3aGljaFxuICAgICAqIG1lYW5zIHRoYXQgd2UgY2FuJ3QgZmlyZSBhbnkgY2FsbGJhY2tzIGFueXdheS5cbiAgICAgKlxuICAgICAqIElmIGEgdXNlciBkb2VzIGhhcHBlbiB0byByZWdpc3RlciBhIGhhbmRsZXIgb24gYSBub24tXG4gICAgICogZmF0YWwgc2lnbmFsIGxpa2UgU0lHV0lOQ0ggb3Igc29tZXRoaW5nLCBhbmQgdGhlblxuICAgICAqIGV4aXQsIGl0J2xsIGVuZCB1cCBmaXJpbmcgYHByb2Nlc3MuZW1pdCgnZXhpdCcpYCwgc29cbiAgICAgKiB0aGUgaGFuZGxlciB3aWxsIGJlIGZpcmVkIGFueXdheS5cbiAgICAgKlxuICAgICAqIFNJR0JVUywgU0lHRlBFLCBTSUdTRUdWIGFuZCBTSUdJTEwsIHdoZW4gbm90IHJhaXNlZFxuICAgICAqIGFydGlmaWNpYWxseSwgaW5oZXJlbnRseSBsZWF2ZSB0aGUgcHJvY2VzcyBpbiBhXG4gICAgICogc3RhdGUgZnJvbSB3aGljaCBpdCBpcyBub3Qgc2FmZSB0byB0cnkgYW5kIGVudGVyIEpTXG4gICAgICogbGlzdGVuZXJzLlxuICAgICAqL1xuICAgIHRoaXMuI3NpZ25hbHMucHVzaChcIlNJR0hVUFwiLCBcIlNJR0lOVFwiLCBcIlNJR1RFUk1cIik7XG4gICAgaWYgKGdsb2JhbFRoaXMucHJvY2Vzcy5wbGF0Zm9ybSAhPT0gXCJ3aW4zMlwiKSB7XG4gICAgICB0aGlzLiNzaWduYWxzLnB1c2goXG4gICAgICAgIFwiU0lHQUxSTVwiLFxuICAgICAgICBcIlNJR0FCUlRcIixcbiAgICAgICAgXCJTSUdWVEFMUk1cIixcbiAgICAgICAgXCJTSUdYQ1BVXCIsXG4gICAgICAgIFwiU0lHWEZTWlwiLFxuICAgICAgICBcIlNJR1VTUjJcIixcbiAgICAgICAgXCJTSUdUUkFQXCIsXG4gICAgICAgIFwiU0lHU1lTXCIsXG4gICAgICAgIFwiU0lHUVVJVFwiLFxuICAgICAgICBcIlNJR0lPVFwiLFxuICAgICAgICAvLyBzaG91bGQgZGV0ZWN0IHByb2ZpbGVyIGFuZCBlbmFibGUvZGlzYWJsZSBhY2NvcmRpbmdseS5cbiAgICAgICAgLy8gc2VlICMyMVxuICAgICAgICAvLyAnU0lHUFJPRidcbiAgICAgICk7XG4gICAgfVxuICAgIGlmIChnbG9iYWxUaGlzLnByb2Nlc3MucGxhdGZvcm0gPT09IFwibGludXhcIikge1xuICAgICAgdGhpcy4jc2lnbmFscy5wdXNoKFwiU0lHSU9cIiwgXCJTSUdQT0xMXCIsIFwiU0lHUFdSXCIsIFwiU0lHU1RLRkxUXCIpO1xuICAgIH1cbiAgICB0aGlzLiNwcm9jZXNzID0gcHJvY2VzcztcbiAgICAvLyB7IDxzaWduYWw+OiA8bGlzdGVuZXIgZm4+LCAuLi4gfVxuICAgIHRoaXMuI3NpZ0xpc3RlbmVycyA9IHt9O1xuICAgIGZvciAoY29uc3Qgc2lnIG9mIHRoaXMuI3NpZ25hbHMpIHtcbiAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgIHRoaXMuI3NpZ0xpc3RlbmVyc1tzaWddID0gKCkgPT4ge1xuICAgICAgICAvLyBJZiB0aGVyZSBhcmUgbm8gb3RoZXIgbGlzdGVuZXJzLCBhbiBleGl0IGlzIGNvbWluZyFcbiAgICAgICAgLy8gU2ltcGxlc3Qgd2F5OiByZW1vdmUgdXMgYW5kIHRoZW4gcmUtc2VuZCB0aGUgc2lnbmFsLlxuICAgICAgICAvLyBXZSBrbm93IHRoYXQgdGhpcyB3aWxsIGtpbGwgdGhlIHByb2Nlc3MsIHNvIHdlIGNhblxuICAgICAgICAvLyBzYWZlbHkgZW1pdCBub3cuXG4gICAgICAgIGNvbnN0IGxpc3RlbmVycyA9IHRoaXMuI3Byb2Nlc3MubGlzdGVuZXJzKHNpZyk7XG4gICAgICAgIGxldCB7IGNvdW50IH0gPSB0aGlzLiNlbWl0dGVyO1xuICAgICAgICAvLyBUaGlzIGlzIGEgd29ya2Fyb3VuZCBmb3IgdGhlIGZhY3QgdGhhdCBzaWduYWwtZXhpdCB2MyBhbmQgc2lnbmFsXG4gICAgICAgIC8vIGV4aXQgdjQgYXJlIG5vdCBhd2FyZSBvZiBlYWNoIG90aGVyLCBhbmQgZWFjaCB3aWxsIGF0dGVtcHQgdG8gbGV0XG4gICAgICAgIC8vIHRoZSBvdGhlciBoYW5kbGUgaXQsIHNvIG5laXRoZXIgb2YgdGhlbSBkby4gVG8gY29ycmVjdCB0aGlzLCB3ZVxuICAgICAgICAvLyBkZXRlY3QgaWYgd2UncmUgdGhlIG9ubHkgaGFuZGxlciAqZXhjZXB0KiBmb3IgcHJldmlvdXMgdmVyc2lvbnNcbiAgICAgICAgLy8gb2Ygc2lnbmFsLWV4aXQsIGFuZCBpbmNyZW1lbnQgYnkgdGhlIGNvdW50IG9mIGxpc3RlbmVycyBpdCBoYXNcbiAgICAgICAgLy8gY3JlYXRlZC5cbiAgICAgICAgLyogYzggaWdub3JlIHN0YXJ0ICovXG4gICAgICAgIGNvbnN0IHAgPSBwcm9jZXNzO1xuICAgICAgICBpZiAodHlwZW9mIHAuX19zaWduYWxfZXhpdF9lbWl0dGVyX18gPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIHAuX19zaWduYWxfZXhpdF9lbWl0dGVyX18uY291bnQgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgICBjb3VudCArPSBwLl9fc2lnbmFsX2V4aXRfZW1pdHRlcl9fLmNvdW50O1xuICAgICAgICB9XG4gICAgICAgIC8qIGM4IGlnbm9yZSBzdG9wICovXG4gICAgICAgIGlmIChsaXN0ZW5lcnMubGVuZ3RoID09PSBjb3VudCkge1xuICAgICAgICAgIHRoaXMudW5sb2FkKCk7XG4gICAgICAgICAgY29uc3QgcmV0ID0gdGhpcy4jZW1pdHRlci5lbWl0KFwiZXhpdFwiLCBudWxsLCBzaWcpO1xuICAgICAgICAgIC8qIGM4IGlnbm9yZSBzdGFydCAqL1xuICAgICAgICAgIGNvbnN0IHMgPSBzaWcgPT09IFwiU0lHSFVQXCIgPyB0aGlzLiNodXBTaWcgOiBzaWc7XG4gICAgICAgICAgaWYgKCFyZXQpIHByb2Nlc3Mua2lsbChwcm9jZXNzLnBpZCwgcyk7XG4gICAgICAgICAgLyogYzggaWdub3JlIHN0b3AgKi9cbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9XG4gICAgdGhpcy4jb3JpZ2luYWxQcm9jZXNzUmVhbGx5RXhpdCA9IHByb2Nlc3MucmVhbGx5RXhpdDtcbiAgICB0aGlzLiNvcmlnaW5hbFByb2Nlc3NFbWl0ID0gcHJvY2Vzcy5lbWl0O1xuICB9XG4gIG9uRXhpdChjYjogYW55LCBvcHRzOiBhbnkpIHtcbiAgICAvKiBjOCBpZ25vcmUgc3RhcnQgKi9cbiAgICBpZiAoIXByb2Nlc3NPayh0aGlzLiNwcm9jZXNzKSkge1xuICAgICAgcmV0dXJuICgpID0+IHt9O1xuICAgIH1cbiAgICAvKiBjOCBpZ25vcmUgc3RvcCAqL1xuICAgIGlmICh0aGlzLiNsb2FkZWQgPT09IGZhbHNlKSB7XG4gICAgICB0aGlzLmxvYWQoKTtcbiAgICB9XG4gICAgY29uc3QgZXYgPSBvcHRzPy5hbHdheXNMYXN0ID8gXCJhZnRlckV4aXRcIiA6IFwiZXhpdFwiO1xuICAgIHRoaXMuI2VtaXR0ZXIub24oZXYsIGNiKTtcbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgdGhpcy4jZW1pdHRlci5yZW1vdmVMaXN0ZW5lcihldiwgY2IpO1xuICAgICAgaWYgKHRoaXMuI2VtaXR0ZXIubGlzdGVuZXJzW1wiZXhpdFwiXS5sZW5ndGggPT09IDAgJiYgdGhpcy4jZW1pdHRlci5saXN0ZW5lcnNbXCJhZnRlckV4aXRcIl0ubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHRoaXMudW5sb2FkKCk7XG4gICAgICB9XG4gICAgfTtcbiAgfVxuICBsb2FkKCkge1xuICAgIGlmICh0aGlzLiNsb2FkZWQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy4jbG9hZGVkID0gdHJ1ZTtcbiAgICAvLyBUaGlzIGlzIHRoZSBudW1iZXIgb2Ygb25TaWduYWxFeGl0J3MgdGhhdCBhcmUgaW4gcGxheS5cbiAgICAvLyBJdCdzIGltcG9ydGFudCBzbyB0aGF0IHdlIGNhbiBjb3VudCB0aGUgY29ycmVjdCBudW1iZXIgb2ZcbiAgICAvLyBsaXN0ZW5lcnMgb24gc2lnbmFscywgYW5kIGRvbid0IHdhaXQgZm9yIHRoZSBvdGhlciBvbmUgdG9cbiAgICAvLyBoYW5kbGUgaXQgaW5zdGVhZCBvZiB1cy5cbiAgICB0aGlzLiNlbWl0dGVyLmNvdW50ICs9IDE7XG4gICAgZm9yIChjb25zdCBzaWcgb2YgdGhpcy4jc2lnbmFscykge1xuICAgICAgdHJ5IHtcbiAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICBjb25zdCBmbiA9IHRoaXMuI3NpZ0xpc3RlbmVyc1tzaWddO1xuICAgICAgICBpZiAoZm4pIHRoaXMuI3Byb2Nlc3Mub24oc2lnLCBmbik7XG4gICAgICB9IGNhdGNoIChfKSB7XG4gICAgICAgIC8vIG5vLW9wXG4gICAgICB9XG4gICAgfVxuICAgIHRoaXMuI3Byb2Nlc3MuZW1pdCA9IChldjogYW55LCAuLi5hOiBhbnkpID0+IHtcbiAgICAgIHJldHVybiB0aGlzLiNwcm9jZXNzRW1pdChldiwgLi4uYSk7XG4gICAgfTtcbiAgICB0aGlzLiNwcm9jZXNzLnJlYWxseUV4aXQgPSAoY29kZTogYW55KSA9PiB7XG4gICAgICByZXR1cm4gdGhpcy4jcHJvY2Vzc1JlYWxseUV4aXQoY29kZSk7XG4gICAgfTtcbiAgfVxuICB1bmxvYWQoKSB7XG4gICAgaWYgKCF0aGlzLiNsb2FkZWQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy4jbG9hZGVkID0gZmFsc2U7XG4gICAgdGhpcy4jc2lnbmFscy5mb3JFYWNoKChzaWcpID0+IHtcbiAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgIGNvbnN0IGxpc3RlbmVyID0gdGhpcy4jc2lnTGlzdGVuZXJzW3NpZ107XG4gICAgICAvKiBjOCBpZ25vcmUgc3RhcnQgKi9cbiAgICAgIGlmICghbGlzdGVuZXIpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTGlzdGVuZXIgbm90IGRlZmluZWQgZm9yIHNpZ25hbDogXCIgKyBzaWcpO1xuICAgICAgfVxuICAgICAgLyogYzggaWdub3JlIHN0b3AgKi9cbiAgICAgIHRyeSB7XG4gICAgICAgIHRoaXMuI3Byb2Nlc3MucmVtb3ZlTGlzdGVuZXIoc2lnLCBsaXN0ZW5lcik7XG4gICAgICAgIC8qIGM4IGlnbm9yZSBzdGFydCAqL1xuICAgICAgfSBjYXRjaCAoXykge1xuICAgICAgICAvLyBuby1vcFxuICAgICAgfVxuICAgICAgLyogYzggaWdub3JlIHN0b3AgKi9cbiAgICB9KTtcbiAgICB0aGlzLiNwcm9jZXNzLmVtaXQgPSB0aGlzLiNvcmlnaW5hbFByb2Nlc3NFbWl0O1xuICAgIHRoaXMuI3Byb2Nlc3MucmVhbGx5RXhpdCA9IHRoaXMuI29yaWdpbmFsUHJvY2Vzc1JlYWxseUV4aXQ7XG4gICAgdGhpcy4jZW1pdHRlci5jb3VudCAtPSAxO1xuICB9XG4gICNwcm9jZXNzUmVhbGx5RXhpdChjb2RlOiBhbnkpIHtcbiAgICAvKiBjOCBpZ25vcmUgc3RhcnQgKi9cbiAgICBpZiAoIXByb2Nlc3NPayh0aGlzLiNwcm9jZXNzKSkge1xuICAgICAgcmV0dXJuIDA7XG4gICAgfVxuICAgIHRoaXMuI3Byb2Nlc3MuZXhpdENvZGUgPSBjb2RlIHx8IDA7XG4gICAgLyogYzggaWdub3JlIHN0b3AgKi9cbiAgICB0aGlzLiNlbWl0dGVyLmVtaXQoXCJleGl0XCIsIHRoaXMuI3Byb2Nlc3MuZXhpdENvZGUsIG51bGwpO1xuICAgIHJldHVybiB0aGlzLiNvcmlnaW5hbFByb2Nlc3NSZWFsbHlFeGl0LmNhbGwodGhpcy4jcHJvY2VzcywgdGhpcy4jcHJvY2Vzcy5leGl0Q29kZSk7XG4gIH1cbiAgI3Byb2Nlc3NFbWl0KGV2OiBhbnksIC4uLmFyZ3M6IGFueSkge1xuICAgIGNvbnN0IG9nID0gdGhpcy4jb3JpZ2luYWxQcm9jZXNzRW1pdDtcbiAgICBpZiAoZXYgPT09IFwiZXhpdFwiICYmIHByb2Nlc3NPayh0aGlzLiNwcm9jZXNzKSkge1xuICAgICAgaWYgKHR5cGVvZiBhcmdzWzBdID09PSBcIm51bWJlclwiKSB7XG4gICAgICAgIHRoaXMuI3Byb2Nlc3MuZXhpdENvZGUgPSBhcmdzWzBdO1xuICAgICAgICAvKiBjOCBpZ25vcmUgc3RhcnQgKi9cbiAgICAgIH1cbiAgICAgIC8qIGM4IGlnbm9yZSBzdGFydCAqL1xuICAgICAgY29uc3QgcmV0ID0gb2cuY2FsbCh0aGlzLiNwcm9jZXNzLCBldiwgLi4uYXJncyk7XG4gICAgICAvKiBjOCBpZ25vcmUgc3RhcnQgKi9cbiAgICAgIHRoaXMuI2VtaXR0ZXIuZW1pdChcImV4aXRcIiwgdGhpcy4jcHJvY2Vzcy5leGl0Q29kZSwgbnVsbCk7XG4gICAgICAvKiBjOCBpZ25vcmUgc3RvcCAqL1xuICAgICAgcmV0dXJuIHJldDtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIG9nLmNhbGwodGhpcy4jcHJvY2VzcywgZXYsIC4uLmFyZ3MpO1xuICAgIH1cbiAgfVxufVxuXG5sZXQgc2lnbmFsRXhpdDogU2lnbmFsRXhpdCB8IFNpZ25hbEV4aXRGYWxsYmFjayB8IG51bGwgPSBudWxsO1xuXG5leHBvcnQgY29uc3Qgb25FeGl0ID0gKFxuICBjYjogYW55LFxuICBvcHRzPzoge1xuICAgIGFsd2F5c0xhc3Q/OiBib29sZWFuIHwgdW5kZWZpbmVkO1xuICB9LFxuKSA9PiB7XG4gIGlmICghc2lnbmFsRXhpdCkge1xuICAgIHNpZ25hbEV4aXQgPSBwcm9jZXNzT2socHJvY2VzcykgPyBuZXcgU2lnbmFsRXhpdChwcm9jZXNzKSA6IG5ldyBTaWduYWxFeGl0RmFsbGJhY2soKTtcbiAgfVxuICByZXR1cm4gc2lnbmFsRXhpdC5vbkV4aXQoY2IsIG9wdHMpO1xufTtcbiIsICJpbXBvcnQgeyBlbnZpcm9ubWVudCB9IGZyb20gXCJAcmF5Y2FzdC9hcGlcIjtcbmltcG9ydCB7IGNyZWF0ZVJlYWRTdHJlYW0sIGNyZWF0ZVdyaXRlU3RyZWFtLCBta2RpclN5bmMsIFN0YXRzIH0gZnJvbSBcIm5vZGU6ZnNcIjtcbmltcG9ydCB7IHN0YXQgfSBmcm9tIFwibm9kZTpmcy9wcm9taXNlc1wiO1xuaW1wb3J0IHsgam9pbiwgbm9ybWFsaXplIH0gZnJvbSBcIm5vZGU6cGF0aFwiO1xuaW1wb3J0IHsgcGlwZWxpbmUgfSBmcm9tIFwibm9kZTpzdHJlYW0vcHJvbWlzZXNcIjtcbmltcG9ydCB7IHVzZVJlZiB9IGZyb20gXCJyZWFjdFwiO1xuaW1wb3J0IENoYWluIGZyb20gXCIuL3ZlbmRvcnMvc3RyZWFtLWNoYWluXCI7XG5pbXBvcnQgeyBwYXJzZXIsIFBpY2tQYXJzZXIsIFN0cmVhbUFycmF5IH0gZnJvbSBcIi4vdmVuZG9ycy9zdHJlYW0tanNvblwiO1xuaW1wb3J0IHsgaXNKU09OIH0gZnJvbSBcIi4vZmV0Y2gtdXRpbHNcIjtcbmltcG9ydCB7IEZsYXR0ZW4sIEZ1bmN0aW9uUmV0dXJuaW5nUGFnaW5hdGVkUHJvbWlzZSwgVXNlQ2FjaGVkUHJvbWlzZVJldHVyblR5cGUgfSBmcm9tIFwiLi90eXBlc1wiO1xuaW1wb3J0IHsgQ2FjaGVkUHJvbWlzZU9wdGlvbnMsIHVzZUNhY2hlZFByb21pc2UgfSBmcm9tIFwiLi91c2VDYWNoZWRQcm9taXNlXCI7XG5pbXBvcnQgeyBoYXNoIH0gZnJvbSBcIi4vaGVscGVyc1wiO1xuXG50eXBlIFJlcXVlc3RJbmZvID0gc3RyaW5nIHwgVVJMIHwgZ2xvYmFsVGhpcy5SZXF1ZXN0O1xuXG5hc3luYyBmdW5jdGlvbiBjYWNoZSh1cmw6IFJlcXVlc3RJbmZvLCBkZXN0aW5hdGlvbjogc3RyaW5nLCBmZXRjaE9wdGlvbnM/OiBSZXF1ZXN0SW5pdCkge1xuICBpZiAodHlwZW9mIHVybCA9PT0gXCJvYmplY3RcIiB8fCB1cmwuc3RhcnRzV2l0aChcImh0dHA6Ly9cIikgfHwgdXJsLnN0YXJ0c1dpdGgoXCJodHRwczovL1wiKSkge1xuICAgIHJldHVybiBhd2FpdCBjYWNoZVVSTCh1cmwsIGRlc3RpbmF0aW9uLCBmZXRjaE9wdGlvbnMpO1xuICB9IGVsc2UgaWYgKHVybC5zdGFydHNXaXRoKFwiZmlsZTovL1wiKSkge1xuICAgIHJldHVybiBhd2FpdCBjYWNoZUZpbGUoXG4gICAgICBub3JtYWxpemUoZGVjb2RlVVJJQ29tcG9uZW50KG5ldyBVUkwodXJsKS5wYXRobmFtZSkpLFxuICAgICAgZGVzdGluYXRpb24sXG4gICAgICBmZXRjaE9wdGlvbnM/LnNpZ25hbCA/IGZldGNoT3B0aW9ucy5zaWduYWwgOiB1bmRlZmluZWQsXG4gICAgKTtcbiAgfSBlbHNlIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJPbmx5IEhUVFAoUykgb3IgZmlsZSBVUkxzIGFyZSBzdXBwb3J0ZWRcIik7XG4gIH1cbn1cblxuYXN5bmMgZnVuY3Rpb24gY2FjaGVVUkwodXJsOiBSZXF1ZXN0SW5mbywgZGVzdGluYXRpb246IHN0cmluZywgZmV0Y2hPcHRpb25zPzogUmVxdWVzdEluaXQpIHtcbiAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh1cmwsIGZldGNoT3B0aW9ucyk7XG5cbiAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgIHRocm93IG5ldyBFcnJvcihcIkZhaWxlZCB0byBmZXRjaCBVUkxcIik7XG4gIH1cblxuICBpZiAoIWlzSlNPTihyZXNwb25zZS5oZWFkZXJzLmdldChcImNvbnRlbnQtdHlwZVwiKSkpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJVUkwgZG9lcyBub3QgcmV0dXJuIEpTT05cIik7XG4gIH1cbiAgaWYgKCFyZXNwb25zZS5ib2R5KSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiRmFpbGVkIHRvIHJldHJpZXZlIGV4cGVjdGVkIEpTT04gY29udGVudDogUmVzcG9uc2UgYm9keSBpcyBtaXNzaW5nIG9yIGluYWNjZXNzaWJsZS5cIik7XG4gIH1cbiAgYXdhaXQgcGlwZWxpbmUoXG4gICAgcmVzcG9uc2UuYm9keSBhcyB1bmtub3duIGFzIE5vZGVKUy5SZWFkYWJsZVN0cmVhbSxcbiAgICBjcmVhdGVXcml0ZVN0cmVhbShkZXN0aW5hdGlvbiksXG4gICAgZmV0Y2hPcHRpb25zPy5zaWduYWwgPyB7IHNpZ25hbDogZmV0Y2hPcHRpb25zLnNpZ25hbCB9IDogdW5kZWZpbmVkLFxuICApO1xufVxuXG5hc3luYyBmdW5jdGlvbiBjYWNoZUZpbGUoc291cmNlOiBzdHJpbmcsIGRlc3RpbmF0aW9uOiBzdHJpbmcsIGFib3J0U2lnbmFsPzogQWJvcnRTaWduYWwpIHtcbiAgYXdhaXQgcGlwZWxpbmUoXG4gICAgY3JlYXRlUmVhZFN0cmVhbShzb3VyY2UpLFxuICAgIGNyZWF0ZVdyaXRlU3RyZWFtKGRlc3RpbmF0aW9uKSxcbiAgICBhYm9ydFNpZ25hbCA/IHsgc2lnbmFsOiBhYm9ydFNpZ25hbCB9IDogdW5kZWZpbmVkLFxuICApO1xufVxuXG5hc3luYyBmdW5jdGlvbiBjYWNoZVVSTElmTmVjZXNzYXJ5KFxuICB1cmw6IFJlcXVlc3RJbmZvLFxuICBmb2xkZXI6IHN0cmluZyxcbiAgZmlsZU5hbWU6IHN0cmluZyxcbiAgZm9yY2VVcGRhdGU6IGJvb2xlYW4sXG4gIGZldGNoT3B0aW9ucz86IFJlcXVlc3RJbml0LFxuKSB7XG4gIGNvbnN0IGRlc3RpbmF0aW9uID0gam9pbihmb2xkZXIsIGZpbGVOYW1lKTtcblxuICB0cnkge1xuICAgIGF3YWl0IHN0YXQoZm9sZGVyKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIG1rZGlyU3luYyhmb2xkZXIsIHsgcmVjdXJzaXZlOiB0cnVlIH0pO1xuICAgIGF3YWl0IGNhY2hlKHVybCwgZGVzdGluYXRpb24sIGZldGNoT3B0aW9ucyk7XG4gICAgcmV0dXJuO1xuICB9XG4gIGlmIChmb3JjZVVwZGF0ZSkge1xuICAgIGF3YWl0IGNhY2hlKHVybCwgZGVzdGluYXRpb24sIGZldGNoT3B0aW9ucyk7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgbGV0IHN0YXRzOiBTdGF0cyB8IHVuZGVmaW5lZCA9IHVuZGVmaW5lZDtcbiAgdHJ5IHtcbiAgICBzdGF0cyA9IGF3YWl0IHN0YXQoZGVzdGluYXRpb24pO1xuICB9IGNhdGNoIChlKSB7XG4gICAgYXdhaXQgY2FjaGUodXJsLCBkZXN0aW5hdGlvbiwgZmV0Y2hPcHRpb25zKTtcbiAgICByZXR1cm47XG4gIH1cblxuICBpZiAodHlwZW9mIHVybCA9PT0gXCJvYmplY3RcIiB8fCB1cmwuc3RhcnRzV2l0aChcImh0dHA6Ly9cIikgfHwgdXJsLnN0YXJ0c1dpdGgoXCJodHRwczovL1wiKSkge1xuICAgIGNvbnN0IGhlYWRSZXNwb25zZSA9IGF3YWl0IGZldGNoKHVybCwgeyAuLi5mZXRjaE9wdGlvbnMsIG1ldGhvZDogXCJIRUFEXCIgfSk7XG4gICAgaWYgKCFoZWFkUmVzcG9uc2Uub2spIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIkNvdWxkIG5vdCBmZXRjaCBVUkxcIik7XG4gICAgfVxuXG4gICAgaWYgKCFpc0pTT04oaGVhZFJlc3BvbnNlLmhlYWRlcnMuZ2V0KFwiY29udGVudC10eXBlXCIpKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVVJMIGRvZXMgbm90IHJldHVybiBKU09OXCIpO1xuICAgIH1cblxuICAgIGNvbnN0IGxhc3RNb2RpZmllZCA9IERhdGUucGFyc2UoaGVhZFJlc3BvbnNlLmhlYWRlcnMuZ2V0KFwibGFzdC1tb2RpZmllZFwiKSA/PyBcIlwiKTtcbiAgICBpZiAoc3RhdHMuc2l6ZSA9PT0gMCB8fCBOdW1iZXIuaXNOYU4obGFzdE1vZGlmaWVkKSB8fCBsYXN0TW9kaWZpZWQgPiBzdGF0cy5tdGltZU1zKSB7XG4gICAgICBhd2FpdCBjYWNoZSh1cmwsIGRlc3RpbmF0aW9uLCBmZXRjaE9wdGlvbnMpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgfSBlbHNlIGlmICh1cmwuc3RhcnRzV2l0aChcImZpbGU6Ly9cIikpIHtcbiAgICB0cnkge1xuICAgICAgY29uc3Qgc291cmNlU3RhdHMgPSBhd2FpdCBzdGF0KG5vcm1hbGl6ZShkZWNvZGVVUklDb21wb25lbnQobmV3IFVSTCh1cmwpLnBhdGhuYW1lKSkpO1xuICAgICAgaWYgKHNvdXJjZVN0YXRzLm10aW1lTXMgPiBzdGF0cy5tdGltZU1zKSB7XG4gICAgICAgIGF3YWl0IGNhY2hlKHVybCwgZGVzdGluYXRpb24sIGZldGNoT3B0aW9ucyk7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiU291cmNlIGZpbGUgY291bGQgbm90IGJlIHJlYWRcIik7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIHRocm93IG5ldyBFcnJvcihcIk9ubHkgSFRUUChTKSBvciBmaWxlIFVSTHMgYXJlIHN1cHBvcnRlZFwiKTtcbiAgfVxufVxuXG5hc3luYyBmdW5jdGlvbiogc3RyZWFtSnNvbkZpbGU8VD4oXG4gIGZpbGVQYXRoOiBzdHJpbmcsXG4gIHBhZ2VTaXplOiBudW1iZXIsXG4gIGFib3J0U2lnbmFsPzogQWJvcnRTaWduYWwsXG4gIGRhdGFQYXRoPzogc3RyaW5nIHwgUmVnRXhwLFxuICBmaWx0ZXJGbj86IChpdGVtOiBGbGF0dGVuPFQ+KSA9PiBib29sZWFuLFxuICB0cmFuc2Zvcm1Gbj86IChpdGVtOiBhbnkpID0+IFQsXG4pOiBBc3luY0dlbmVyYXRvcjxUIGV4dGVuZHMgdW5rbm93bltdID8gVCA6IFRbXT4ge1xuICBsZXQgcGFnZTogVCBleHRlbmRzIHVua25vd25bXSA/IFQgOiBUW10gPSBbXSBhcyBUIGV4dGVuZHMgdW5rbm93bltdID8gVCA6IFRbXTtcblxuICBjb25zdCBwaXBlbGluZSA9IENoYWluKFtcbiAgICBjcmVhdGVSZWFkU3RyZWFtKGZpbGVQYXRoKSxcbiAgICBkYXRhUGF0aCA/IFBpY2tQYXJzZXIoeyBmaWx0ZXI6IGRhdGFQYXRoIH0pIDogcGFyc2VyKCksXG4gICAgU3RyZWFtQXJyYXkoKSxcbiAgICAoZGF0YTogYW55KSA9PiB0cmFuc2Zvcm1Gbj8uKGRhdGEudmFsdWUpID8/IGRhdGEudmFsdWUsXG4gIF0pO1xuXG4gIGFib3J0U2lnbmFsPy5hZGRFdmVudExpc3RlbmVyKFwiYWJvcnRcIiwgKCkgPT4ge1xuICAgIHBpcGVsaW5lLmRlc3Ryb3koKTtcbiAgfSk7XG5cbiAgdHJ5IHtcbiAgICBmb3IgYXdhaXQgKGNvbnN0IGRhdGEgb2YgcGlwZWxpbmUpIHtcbiAgICAgIGlmIChhYm9ydFNpZ25hbD8uYWJvcnRlZCkge1xuICAgICAgICByZXR1cm4gW107XG4gICAgICB9XG4gICAgICBpZiAoIWZpbHRlckZuIHx8IGZpbHRlckZuKGRhdGEpKSB7XG4gICAgICAgIHBhZ2UucHVzaChkYXRhKTtcbiAgICAgIH1cbiAgICAgIGlmIChwYWdlLmxlbmd0aCA+PSBwYWdlU2l6ZSkge1xuICAgICAgICB5aWVsZCBwYWdlO1xuICAgICAgICBwYWdlID0gW10gYXMgVCBleHRlbmRzIHVua25vd25bXSA/IFQgOiBUW107XG4gICAgICB9XG4gICAgfVxuICB9IGNhdGNoIChlKSB7XG4gICAgcGlwZWxpbmUuZGVzdHJveSgpO1xuICAgIHRocm93IGU7XG4gIH1cblxuICBpZiAocGFnZS5sZW5ndGggPiAwKSB7XG4gICAgeWllbGQgcGFnZTtcbiAgfVxuXG4gIHJldHVybiBbXTtcbn1cblxudHlwZSBPcHRpb25zPFQ+ID0ge1xuICAvKipcbiAgICogVGhlIGhvb2sgZXhwZWN0cyB0byBpdGVyYXRlIHRocm91Z2ggYW4gYXJyYXkgb2YgZGF0YSwgc28gYnkgZGVmYXVsdCwgaXQgYXNzdW1lcyB0aGUgSlNPTiBpdCByZWNlaXZlcyBpdHNlbGYgcmVwcmVzZW50cyBhbiBhcnJheS4gSG93ZXZlciwgc29tZXRpbWVzIHRoZSBhcnJheSBvZiBkYXRhIGlzIHdyYXBwZWQgaW4gYW4gb2JqZWN0LFxuICAgKiBpLmUuIGB7IFwic3VjY2Vzc1wiOiB0cnVlLCBcImRhdGFcIjogW+KApl0gfWAsIG9yIGV2ZW4gYHsgXCJzdWNjZXNzXCI6IHRydWUsIFwicmVzdWx0c1wiOiB7IFwiZGF0YVwiOiBb4oCmXSB9IH1gLiBJbiB0aG9zZSBjYXNlcywgeW91IGNhbiB1c2UgYGRhdGFQYXRoYCB0byBzcGVjaWZ5IHdoZXJlIHRoZSBkYXRhIGFycmF5IGNhbiBiZSBmb3VuZC5cbiAgICpcbiAgICogQHJlbWFyayBJZiB5b3VyIEpTT04gb2JqZWN0IGhhcyBtdWx0aXBsZSBhcnJheXMgdGhhdCB5b3Ugd2FudCB0byBzdHJlYW0gZGF0YSBmcm9tLCB5b3UgY2FuIHBhc3MgYSByZWd1bGFyIGV4cHJlc3Npb24gdG8gc3RyZWFtIHRocm91Z2ggYWxsIG9mIHRoZW0uXG4gICAqXG4gICAqIEBleGFtcGxlIEZvciBgeyBcInN1Y2Nlc3NcIjogdHJ1ZSwgXCJkYXRhXCI6IFvigKZdIH1gLCBkYXRhUGF0aCB3b3VsZCBiZSBgZGF0YWBcbiAgICogQGV4YW1wbGUgRm9yIGB7IFwic3VjY2Vzc1wiOiB0cnVlLCBcInJlc3VsdHNcIjogeyBcImRhdGFcIjogW+KApl0gfSB9YCwgZGF0YVBhdGggd291bGQgYmUgYHJlc3VsdHMuZGF0YWBcbiAgICogQGV4YW1wbGUgRm9yIGB7IFwic3VjY2Vzc1wiOiB0cnVlLCBcInJlc3VsdHNcIjogeyBcImZpcnN0X2xpc3RcIjogW+KApl0sIFwic2Vjb25kX2xpc3RcIjogW+KApl0sIFwidGhpcmRfbGlzdFwiOiBb4oCmXSB9IH1gLCBkYXRhUGF0aCB3b3VsZCBiZSBgL15yZXN1bHRzXFwuKGZpcnN0X2xpc3R8c2Vjb25kX2xpc3R8dGhpcmRfbGlzdCkkXG4vYC5cbiAgICovXG4gIGRhdGFQYXRoPzogc3RyaW5nIHwgUmVnRXhwO1xuICAvKipcbiAgICogQSBmdW5jdGlvbiB0byBkZWNpZGUgd2hldGhlciBhIHBhcnRpY3VsYXIgaXRlbSBzaG91bGQgYmUga2VwdCBvciBub3QuXG4gICAqIERlZmF1bHRzIHRvIGB1bmRlZmluZWRgLCBrZWVwaW5nIGFueSBlbmNvdW50ZXJlZCBpdGVtLlxuICAgKlxuICAgKiBAcmVtYXJrIFRoZSBob29rIHdpbGwgcmV2YWxpZGF0ZSBldmVyeSB0aW1lIHRoZSBmaWx0ZXIgZnVuY3Rpb24gY2hhbmdlcywgc28geW91IG5lZWQgdG8gdXNlIFt1c2VDYWxsYmFja10oaHR0cHM6Ly9yZWFjdC5kZXYvcmVmZXJlbmNlL3JlYWN0L3VzZUNhbGxiYWNrKSB0byBtYWtlIHN1cmUgaXQgb25seSBjaGFuZ2VzIHdoZW4gaXQgbmVlZHMgdG8uXG4gICAqL1xuICBmaWx0ZXI/OiAoaXRlbTogRmxhdHRlbjxUPikgPT4gYm9vbGVhbjtcbiAgLyoqXG4gICAqIEEgZnVuY3Rpb24gdG8gYXBwbHkgdG8gZWFjaCBpdGVtIGFzIGl0IGlzIGVuY291bnRlcmVkLiBVc2VmdWwgZm9yIGEgY291cGxlIG9mIHRoaW5nczpcbiAgICogMS4gZW5zdXJpbmcgdGhhdCBhbGwgaXRlbXMgaGF2ZSB0aGUgZXhwZWN0ZWQgcHJvcGVydGllcywgYW5kLCBhcyBvbiBvcHRpbWl6YXRpb24sIGZvciBnZXR0aW5nIHJpZCBvZiB0aGUgcHJvcGVydGllcyB0aGF0IHlvdSBkb24ndCBjYXJlIGFib3V0LlxuICAgKiAyLiB3aGVuIHRvcC1sZXZlbCBvYmplY3RzIGFjdHVhbGx5IHJlcHJlc2VudCBuZXN0ZWQgZGF0YSwgd2hpY2ggc2hvdWxkIGJlIGZsYXR0ZW5lZC4gSW4gdGhpcyBjYXNlLCBgdHJhbnNmb3JtYCBjYW4gcmV0dXJuIGFuIGFycmF5IG9mIGl0ZW1zLCBhbmQgdGhlIGhvb2sgd2lsbCBzdHJlYW0gdGhyb3VnaCBlYWNoIG9uZSBvZiB0aG9zZSBpdGVtcyxcbiAgICogcGFzc2luZyB0aGVtIHRvIGBmaWx0ZXJgIGV0Yy5cbiAgICpcbiAgICogRGVmYXVsdHMgdG8gYSBwYXNzdGhyb3VnaCBmdW5jdGlvbiBpZiBub3QgcHJvdmlkZWQuXG4gICAqXG4gICAqIEByZW1hcmsgVGhlIGhvb2sgd2lsbCByZXZhbGlkYXRlIGV2ZXJ5IHRpbWUgdGhlIHRyYW5zZm9ybSBmdW5jdGlvbiBjaGFuZ2VzLCBzbyBpdCBpcyBpbXBvcnRhbnQgdG8gdXNlIFt1c2VDYWxsYmFja10oaHR0cHM6Ly9yZWFjdC5kZXYvcmVmZXJlbmNlL3JlYWN0L3VzZUNhbGxiYWNrKSB0byBlbnN1cmUgaXQgb25seSBjaGFuZ2VzIHdoZW4gbmVjZXNzYXJ5IHRvIHByZXZlbnQgdW5uZWNlc3NhcnkgcmUtcmVuZGVycyBvciBjb21wdXRhdGlvbnMuXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqIGBgYFxuICAgKiAvLyBGb3IgZGF0YTogYHsgXCJkYXRhXCI6IFsgeyBcInR5cGVcIjogXCJmb2xkZXJcIiwgXCJuYW1lXCI6IFwiaXRlbSAxXCIsIFwiY2hpbGRyZW5cIjogWyB7IFwidHlwZVwiOiBcIml0ZW1cIiwgXCJuYW1lXCI6IFwiaXRlbSAyXCIgfSwgeyBcInR5cGVcIjogXCJpdGVtXCIsIFwibmFtZVwiOiBcIml0ZW0gM1wiIH0gXSB9LCB7IFwidHlwZVwiOiBcImZvbGRlclwiLCBcIm5hbWVcIjogXCJpdGVtIDRcIiwgY2hpbGRyZW46IFtdIH0gXSB9YFxuICAgKlxuICAgKiB0eXBlIEl0ZW0gPSB7XG4gICAqICB0eXBlOiBcIml0ZW1cIjtcbiAgICogIG5hbWU6IHN0cmluZztcbiAgICogfTtcbiAgICpcbiAgICogdHlwZSBGb2xkZXIgPSB7XG4gICAqICAgdHlwZTogXCJmb2xkZXJcIjtcbiAgICogICBuYW1lOiBzdHJpbmc7XG4gICAqICAgY2hpbGRyZW46IChJdGVtIHwgRm9sZGVyKVtdO1xuICAgKiB9O1xuICAgKlxuICAgKiBmdW5jdGlvbiBmbGF0dGVuKGl0ZW06IEl0ZW0gfCBGb2xkZXIpOiB7IG5hbWU6IHN0cmluZyB9W10ge1xuICAgKiAgIGNvbnN0IGZsYXR0ZW5lZDogeyBuYW1lOiBzdHJpbmcgfVtdID0gW107XG4gICAqICAgaWYgKGl0ZW0udHlwZSA9PT0gXCJmb2xkZXJcIikge1xuICAgKiAgICAgZmxhdHRlbmVkLnB1c2goLi4uaXRlbS5jaGlsZHJlbi5tYXAoZmxhdHRlbikuZmxhdCgpKTtcbiAgICogICB9XG4gICAqICAgaWYgKGl0ZW0udHlwZSA9PT0gXCJpdGVtXCIpIHtcbiAgICogICAgIGZsYXR0ZW5lZC5wdXNoKHsgbmFtZTogaXRlbS5uYW1lIH0pO1xuICAgKiAgIH1cbiAgICogICByZXR1cm4gZmxhdHRlbmVkO1xuICAgKiB9XG4gICAqXG4gICAqIGNvbnN0IHRyYW5zZm9ybSA9IHVzZUNhbGxiYWNrKGZsYXR0ZW4sIFtdKTtcbiAgICogY29uc3QgZmlsdGVyID0gdXNlQ2FsbGJhY2soKGl0ZW06IHsgbmFtZTogc3RyaW5nIH0pID0+IHtcbiAgICogICDigKZcbiAgICogfSlcbiAgICogYGBgXG4gICAqL1xuICB0cmFuc2Zvcm0/OiAoaXRlbTogYW55KSA9PiBUO1xuICAvKipcbiAgICogVGhlIGFtb3VudCBvZiBpdGVtcyB0byByZXR1cm4gZm9yIGVhY2ggcGFnZS5cbiAgICogRGVmYXVsdHMgdG8gYDIwYC5cbiAgICovXG4gIHBhZ2VTaXplPzogbnVtYmVyO1xufTtcblxuLyoqXG4gKiBUYWtlcyBhIGBodHRwOi8vYCwgYGh0dHBzOi8vYCBvciBgZmlsZTovLy9gIFVSTCBwb2ludGluZyB0byBhIEpTT04gcmVzb3VyY2UsIGNhY2hlcyBpdCB0byB0aGUgY29tbWFuZCdzIHN1cHBvcnRcbiAqIGZvbGRlciwgYW5kIHN0cmVhbXMgdGhyb3VnaCBpdHMgY29udGVudC4gVXNlZnVsIHdoZW4gZGVhbGluZyB3aXRoIGxhcmdlIEpTT04gYXJyYXlzIHdoaWNoIHdvdWxkIGJlIHRvbyBiaWcgdG8gZml0XG4gKiBpbiB0aGUgY29tbWFuZCdzIG1lbW9yeS5cbiAqXG4gKiBAcmVtYXJrIFRoZSBKU09OIHJlc291cmNlIG5lZWRzIHRvIGNvbnNpc3Qgb2YgYW4gYXJyYXkgb2Ygb2JqZWN0c1xuICpcbiAqIEBleGFtcGxlXG4gKiBgYGBcbiAqIGltcG9ydCB7IExpc3QgfSBmcm9tIFwiQHJheWNhc3QvYXBpXCI7XG4gKiBpbXBvcnQgeyB1c2VTdHJlYW1KU09OIH0gZnJvbSBcIkByYXljYXN0L3V0aWxzXCI7XG4gKlxuICogdHlwZSBGb3JtdWxhID0geyBuYW1lOiBzdHJpbmc7IGRlc2M/OiBzdHJpbmcgfTtcbiAqXG4gKiBleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBNYWluKCk6IFJlYWN0LkpTWC5FbGVtZW50IHtcbiAqICAgY29uc3QgeyBkYXRhLCBpc0xvYWRpbmcsIHBhZ2luYXRpb24gfSA9IHVzZVN0cmVhbUpTT048Rm9ybXVsYT4oXCJodHRwczovL2Zvcm11bGFlLmJyZXcuc2gvYXBpL2Zvcm11bGEuanNvblwiKTtcbiAqXG4gKiAgIHJldHVybiAoXG4gKiAgICAgPExpc3QgaXNMb2FkaW5nPXtpc0xvYWRpbmd9IHBhZ2luYXRpb249e3BhZ2luYXRpb259PlxuICogICAgICAgPExpc3QuU2VjdGlvbiB0aXRsZT1cIkZvcm11bGFlXCI+XG4gKiAgICAgICAgIHtkYXRhPy5tYXAoKGQpID0+IDxMaXN0Lkl0ZW0ga2V5PXtkLm5hbWV9IHRpdGxlPXtkLm5hbWV9IHN1YnRpdGxlPXtkLmRlc2N9IC8+KX1cbiAqICAgICAgIDwvTGlzdC5TZWN0aW9uPlxuICogICAgIDwvTGlzdD5cbiAqICAgKTtcbiAqIH1cbiAqIGBgYFxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGBcbiAqIGltcG9ydCB7IExpc3QgfSBmcm9tIFwiQHJheWNhc3QvYXBpXCI7XG4gKiBpbXBvcnQgeyB1c2VTdHJlYW1KU09OIH0gZnJvbSBcIkByYXljYXN0L3V0aWxzXCI7XG4gKiBpbXBvcnQgeyBob21lZGlyIH0gZnJvbSBcIm9zXCI7XG4gKiBpbXBvcnQgeyBqb2luIH0gZnJvbSBcInBhdGhcIjtcbiAqXG4gKiB0eXBlIEZvcm11bGEgPSB7IG5hbWU6IHN0cmluZzsgZGVzYz86IHN0cmluZyB9O1xuICpcbiAqIGV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIE1haW4oKTogUmVhY3QuSlNYLkVsZW1lbnQge1xuICogICBjb25zdCB7IGRhdGEsIGlzTG9hZGluZywgcGFnaW5hdGlvbiB9ID0gdXNlU3RyZWFtSlNPTjxGb3JtdWxhPihgZmlsZTovLy8ke2pvaW4oaG9tZWRpcigpLCBcIkRvd25sb2Fkc1wiLCBcImZvcm11bGFlLmpzb25cIil9YCk7XG4gKlxuICogICByZXR1cm4gKFxuICogICAgIDxMaXN0IGlzTG9hZGluZz17aXNMb2FkaW5nfSBwYWdpbmF0aW9uPXtwYWdpbmF0aW9ufT5cbiAqICAgICAgIDxMaXN0LlNlY3Rpb24gdGl0bGU9XCJGb3JtdWxhZVwiPlxuICogICAgICAgICB7ZGF0YT8ubWFwKChkKSA9PiA8TGlzdC5JdGVtIGtleT17ZC5uYW1lfSB0aXRsZT17ZC5uYW1lfSBzdWJ0aXRsZT17ZC5kZXNjfSAvPil9XG4gKiAgICAgICA8L0xpc3QuU2VjdGlvbj5cbiAqICAgICA8L0xpc3Q+XG4gKiAgICk7XG4gKiB9XG4gKiBgYGBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHVzZVN0cmVhbUpTT048VCwgVSA9IHVua25vd24+KHVybDogUmVxdWVzdEluZm8pOiBVc2VDYWNoZWRQcm9taXNlUmV0dXJuVHlwZTxULCBVPjtcblxuLyoqXG4gKiBUYWtlcyBhIGBodHRwOi8vYCwgYGh0dHBzOi8vYCBvciBgZmlsZTovLy9gIFVSTCBwb2ludGluZyB0byBhIEpTT04gcmVzb3VyY2UsIGNhY2hlcyBpdCB0byB0aGUgY29tbWFuZCdzIHN1cHBvcnRcbiAqIGZvbGRlciwgYW5kIHN0cmVhbXMgdGhyb3VnaCBpdHMgY29udGVudC4gVXNlZnVsIHdoZW4gZGVhbGluZyB3aXRoIGxhcmdlIEpTT04gYXJyYXlzIHdoaWNoIHdvdWxkIGJlIHRvbyBiaWcgdG8gZml0XG4gKiBpbiB0aGUgY29tbWFuZCdzIG1lbW9yeS5cbiAqXG4gKiBAcmVtYXJrIFRoZSBKU09OIHJlc291cmNlIG5lZWRzIHRvIGNvbnNpc3Qgb2YgYW4gYXJyYXkgb2Ygb2JqZWN0c1xuICpcbiAqIEBleGFtcGxlXG4gKiBgYGBcbiAqIGltcG9ydCB7IExpc3QsIGVudmlyb25tZW50IH0gZnJvbSBcIkByYXljYXN0L2FwaVwiO1xuICogaW1wb3J0IHsgdXNlU3RyZWFtSlNPTiB9IGZyb20gXCJAcmF5Y2FzdC91dGlsc1wiO1xuICogaW1wb3J0IHsgam9pbiB9IGZyb20gJ3BhdGgnO1xuICogaW1wb3J0IHsgdXNlQ2FsbGJhY2ssIHVzZVN0YXRlIH0gZnJvbSBcInJlYWN0XCI7XG4gKlxuICogdHlwZSBGb3JtdWxhID0geyBuYW1lOiBzdHJpbmc7IGRlc2M/OiBzdHJpbmcgfTtcbiAqXG4gKiBleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBNYWluKCk6IFJlYWN0LkpTWC5FbGVtZW50IHtcbiAqICAgY29uc3QgW3NlYXJjaFRleHQsIHNldFNlYXJjaFRleHRdID0gdXNlU3RhdGUoXCJcIik7XG4gKlxuICogICBjb25zdCBmb3JtdWxhRmlsdGVyID0gdXNlQ2FsbGJhY2soXG4gKiAgICAgKGl0ZW06IEZvcm11bGEpID0+IHtcbiAqICAgICAgIGlmICghc2VhcmNoVGV4dCkgcmV0dXJuIHRydWU7XG4gKiAgICAgICByZXR1cm4gaXRlbS5uYW1lLnRvTG9jYWxlTG93ZXJDYXNlKCkuaW5jbHVkZXMoc2VhcmNoVGV4dCk7XG4gKiAgICAgfSxcbiAqICAgICBbc2VhcmNoVGV4dF0sXG4gKiAgICk7XG4gKlxuICogICBjb25zdCBmb3JtdWxhVHJhbnNmb3JtID0gdXNlQ2FsbGJhY2soKGl0ZW06IGFueSk6IEZvcm11bGEgPT4ge1xuICogICAgIHJldHVybiB7IG5hbWU6IGl0ZW0ubmFtZSwgZGVzYzogaXRlbS5kZXNjIH07XG4gKiAgIH0sIFtdKTtcbiAqXG4gKiAgIGNvbnN0IHsgZGF0YSwgaXNMb2FkaW5nLCBwYWdpbmF0aW9uIH0gPSB1c2VTdHJlYW1KU09OKFwiaHR0cHM6Ly9mb3JtdWxhZS5icmV3LnNoL2FwaS9mb3JtdWxhLmpzb25cIiwge1xuICogICAgIGluaXRpYWxEYXRhOiBbXSBhcyBGb3JtdWxhW10sXG4gKiAgICAgcGFnZVNpemU6IDIwLFxuICogICAgIGZpbHRlcjogZm9ybXVsYUZpbHRlcixcbiAqICAgICB0cmFuc2Zvcm06IGZvcm11bGFUcmFuc2Zvcm0sXG4gKiAgIH0pO1xuICpcbiAqICAgcmV0dXJuIChcbiAqICAgICA8TGlzdCBpc0xvYWRpbmc9e2lzTG9hZGluZ30gcGFnaW5hdGlvbj17cGFnaW5hdGlvbn0gb25TZWFyY2hUZXh0Q2hhbmdlPXtzZXRTZWFyY2hUZXh0fT5cbiAqICAgICAgIDxMaXN0LlNlY3Rpb24gdGl0bGU9XCJGb3JtdWxhZVwiPlxuICogICAgICAgICB7ZGF0YS5tYXAoKGQpID0+IChcbiAqICAgICAgICAgICA8TGlzdC5JdGVtIGtleT17ZC5uYW1lfSB0aXRsZT17ZC5uYW1lfSBzdWJ0aXRsZT17ZC5kZXNjfSAvPlxuICogICAgICAgICApKX1cbiAqICAgICAgIDwvTGlzdC5TZWN0aW9uPlxuICogICAgIDwvTGlzdD5cbiAqICAgKTtcbiAqIH1cbiAqIGBgYCBzdXBwb3J0IGZvbGRlciwgYW5kIHN0cmVhbXMgdGhyb3VnaCBpdHMgY29udGVudC5cbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgXG4gKiBpbXBvcnQgeyBMaXN0LCBlbnZpcm9ubWVudCB9IGZyb20gXCJAcmF5Y2FzdC9hcGlcIjtcbiAqIGltcG9ydCB7IHVzZVN0cmVhbUpTT04gfSBmcm9tIFwiQHJheWNhc3QvdXRpbHNcIjtcbiAqIGltcG9ydCB7IGpvaW4gfSBmcm9tIFwicGF0aFwiO1xuICogaW1wb3J0IHsgaG9tZWRpciB9IGZyb20gXCJvc1wiO1xuICogaW1wb3J0IHsgdXNlQ2FsbGJhY2ssIHVzZVN0YXRlIH0gZnJvbSBcInJlYWN0XCI7XG4gKlxuICogdHlwZSBGb3JtdWxhID0geyBuYW1lOiBzdHJpbmc7IGRlc2M/OiBzdHJpbmcgfTtcbiAqXG4gKiBleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBNYWluKCk6IFJlYWN0LkpTWC5FbGVtZW50IHtcbiAqICAgY29uc3QgW3NlYXJjaFRleHQsIHNldFNlYXJjaFRleHRdID0gdXNlU3RhdGUoXCJcIik7XG4gKlxuICogICBjb25zdCBmb3JtdWxhRmlsdGVyID0gdXNlQ2FsbGJhY2soXG4gKiAgICAgKGl0ZW06IEZvcm11bGEpID0+IHtcbiAqICAgICAgIGlmICghc2VhcmNoVGV4dCkgcmV0dXJuIHRydWU7XG4gKiAgICAgICByZXR1cm4gaXRlbS5uYW1lLnRvTG9jYWxlTG93ZXJDYXNlKCkuaW5jbHVkZXMoc2VhcmNoVGV4dCk7XG4gKiAgICAgfSxcbiAqICAgICBbc2VhcmNoVGV4dF0sXG4gKiAgICk7XG4gKlxuICogICBjb25zdCBmb3JtdWxhVHJhbnNmb3JtID0gdXNlQ2FsbGJhY2soKGl0ZW06IGFueSk6IEZvcm11bGEgPT4ge1xuICogICAgIHJldHVybiB7IG5hbWU6IGl0ZW0ubmFtZSwgZGVzYzogaXRlbS5kZXNjIH07XG4gKiAgIH0sIFtdKTtcbiAqXG4gKiAgIGNvbnN0IHsgZGF0YSwgaXNMb2FkaW5nLCBwYWdpbmF0aW9uIH0gPSB1c2VTdHJlYW1KU09OKGBmaWxlOi8vLyR7am9pbihob21lZGlyKCksIFwiRG93bmxvYWRzXCIsIFwiZm9ybXVsYWUuanNvblwiKX1gLCB7XG4gKiAgICAgaW5pdGlhbERhdGE6IFtdIGFzIEZvcm11bGFbXSxcbiAqICAgICBwYWdlU2l6ZTogMjAsXG4gKiAgICAgZmlsdGVyOiBmb3JtdWxhRmlsdGVyLFxuICogICAgIHRyYW5zZm9ybTogZm9ybXVsYVRyYW5zZm9ybSxcbiAqICAgfSk7XG4gKlxuICogICByZXR1cm4gKFxuICogICAgIDxMaXN0IGlzTG9hZGluZz17aXNMb2FkaW5nfSBwYWdpbmF0aW9uPXtwYWdpbmF0aW9ufSBvblNlYXJjaFRleHRDaGFuZ2U9e3NldFNlYXJjaFRleHR9PlxuICogICAgICAgPExpc3QuU2VjdGlvbiB0aXRsZT1cIkZvcm11bGFlXCI+XG4gKiAgICAgICAgIHtkYXRhLm1hcCgoZCkgPT4gKFxuICogICAgICAgICAgIDxMaXN0Lkl0ZW0ga2V5PXtkLm5hbWV9IHRpdGxlPXtkLm5hbWV9IHN1YnRpdGxlPXtkLmRlc2N9IC8+XG4gKiAgICAgICAgICkpfVxuICogICAgICAgPC9MaXN0LlNlY3Rpb24+XG4gKiAgICAgPC9MaXN0PlxuICogICApO1xuICogfVxuICogYGBgXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB1c2VTdHJlYW1KU09OPFQsIFUgZXh0ZW5kcyBhbnlbXSA9IGFueVtdPihcbiAgdXJsOiBSZXF1ZXN0SW5mbyxcbiAgb3B0aW9uczogT3B0aW9uczxUPiAmIFJlcXVlc3RJbml0ICYgT21pdDxDYWNoZWRQcm9taXNlT3B0aW9uczxGdW5jdGlvblJldHVybmluZ1BhZ2luYXRlZFByb21pc2UsIFU+LCBcImFib3J0YWJsZVwiPixcbik6IFVzZUNhY2hlZFByb21pc2VSZXR1cm5UeXBlPFQgZXh0ZW5kcyB1bmtub3duW10gPyBUIDogVFtdLCBVPjtcblxuZXhwb3J0IGZ1bmN0aW9uIHVzZVN0cmVhbUpTT048VCwgVSBleHRlbmRzIGFueVtdID0gYW55W10+KFxuICB1cmw6IFJlcXVlc3RJbmZvLFxuICBvcHRpb25zPzogT3B0aW9uczxUPiAmIFJlcXVlc3RJbml0ICYgT21pdDxDYWNoZWRQcm9taXNlT3B0aW9uczxGdW5jdGlvblJldHVybmluZ1BhZ2luYXRlZFByb21pc2UsIFU+LCBcImFib3J0YWJsZVwiPixcbik6IFVzZUNhY2hlZFByb21pc2VSZXR1cm5UeXBlPFQgZXh0ZW5kcyB1bmtub3duW10gPyBUIDogVFtdLCBVPiB7XG4gIGNvbnN0IHtcbiAgICBpbml0aWFsRGF0YSxcbiAgICBleGVjdXRlLFxuICAgIGtlZXBQcmV2aW91c0RhdGEsXG4gICAgb25FcnJvcixcbiAgICBvbkRhdGEsXG4gICAgb25XaWxsRXhlY3V0ZSxcbiAgICBmYWlsdXJlVG9hc3RPcHRpb25zLFxuICAgIGRhdGFQYXRoLFxuICAgIGZpbHRlcixcbiAgICB0cmFuc2Zvcm0sXG4gICAgcGFnZVNpemUgPSAyMCxcbiAgICAuLi5mZXRjaE9wdGlvbnNcbiAgfSA9IG9wdGlvbnMgPz8ge307XG4gIGNvbnN0IHByZXZpb3VzVXJsID0gdXNlUmVmPFJlcXVlc3RJbmZvPihudWxsKTtcbiAgY29uc3QgcHJldmlvdXNEZXN0aW5hdGlvbiA9IHVzZVJlZjxzdHJpbmc+KG51bGwpO1xuXG4gIGNvbnN0IHVzZUNhY2hlZFByb21pc2VPcHRpb25zOiBDYWNoZWRQcm9taXNlT3B0aW9uczxGdW5jdGlvblJldHVybmluZ1BhZ2luYXRlZFByb21pc2UsIFU+ID0ge1xuICAgIGluaXRpYWxEYXRhLFxuICAgIGV4ZWN1dGUsXG4gICAga2VlcFByZXZpb3VzRGF0YSxcbiAgICBvbkVycm9yLFxuICAgIG9uRGF0YSxcbiAgICBvbldpbGxFeGVjdXRlLFxuICAgIGZhaWx1cmVUb2FzdE9wdGlvbnMsXG4gIH07XG5cbiAgY29uc3QgZ2VuZXJhdG9yUmVmID0gdXNlUmVmPEFzeW5jR2VuZXJhdG9yPFQgZXh0ZW5kcyB1bmtub3duW10gPyBUIDogVFtdPiB8IG51bGw+KG51bGwpO1xuICBjb25zdCBjb250cm9sbGVyUmVmID0gdXNlUmVmPEFib3J0Q29udHJvbGxlciB8IG51bGw+KG51bGwpO1xuICBjb25zdCBoYXNNb3JlUmVmID0gdXNlUmVmKGZhbHNlKTtcblxuICByZXR1cm4gdXNlQ2FjaGVkUHJvbWlzZShcbiAgICAoXG4gICAgICB1cmw6IFJlcXVlc3RJbmZvLFxuICAgICAgcGFnZVNpemU6IG51bWJlcixcbiAgICAgIGZldGNoT3B0aW9uczogUmVxdWVzdEluaXQgfCB1bmRlZmluZWQsXG4gICAgICBkYXRhUGF0aDogc3RyaW5nIHwgUmVnRXhwIHwgdW5kZWZpbmVkLFxuICAgICAgZmlsdGVyOiAoKGl0ZW06IEZsYXR0ZW48VD4pID0+IGJvb2xlYW4pIHwgdW5kZWZpbmVkLFxuICAgICAgdHJhbnNmb3JtOiAoKGl0ZW06IHVua25vd24pID0+IFQpIHwgdW5kZWZpbmVkLFxuICAgICkgPT5cbiAgICAgIGFzeW5jICh7IHBhZ2UgfSkgPT4ge1xuICAgICAgICBjb25zdCBmaWxlTmFtZSA9IGhhc2godXJsKSArIFwiLmpzb25cIjtcbiAgICAgICAgY29uc3QgZm9sZGVyID0gZW52aXJvbm1lbnQuc3VwcG9ydFBhdGg7XG4gICAgICAgIGlmIChwYWdlID09PSAwKSB7XG4gICAgICAgICAgY29udHJvbGxlclJlZi5jdXJyZW50Py5hYm9ydCgpO1xuICAgICAgICAgIGNvbnRyb2xsZXJSZWYuY3VycmVudCA9IG5ldyBBYm9ydENvbnRyb2xsZXIoKTtcbiAgICAgICAgICBjb25zdCBkZXN0aW5hdGlvbiA9IGpvaW4oZm9sZGVyLCBmaWxlTmFtZSk7XG4gICAgICAgICAgLyoqXG4gICAgICAgICAgICogRm9yY2UgdXBkYXRlIHRoZSBjYWNoZSB3aGVuIHRoZSBVUkwgY2hhbmdlcyBidXQgdGhlIGNhY2hlIGRlc3RpbmF0aW9uIGRvZXMgbm90LlxuICAgICAgICAgICAqL1xuICAgICAgICAgIGNvbnN0IGZvcmNlQ2FjaGVVcGRhdGUgPSBCb29sZWFuKFxuICAgICAgICAgICAgcHJldmlvdXNVcmwuY3VycmVudCAmJlxuICAgICAgICAgICAgICBwcmV2aW91c1VybC5jdXJyZW50ICE9PSB1cmwgJiZcbiAgICAgICAgICAgICAgcHJldmlvdXNEZXN0aW5hdGlvbi5jdXJyZW50ICYmXG4gICAgICAgICAgICAgIHByZXZpb3VzRGVzdGluYXRpb24uY3VycmVudCA9PT0gZGVzdGluYXRpb24sXG4gICAgICAgICAgKTtcbiAgICAgICAgICBwcmV2aW91c1VybC5jdXJyZW50ID0gdXJsO1xuICAgICAgICAgIHByZXZpb3VzRGVzdGluYXRpb24uY3VycmVudCA9IGRlc3RpbmF0aW9uO1xuICAgICAgICAgIGF3YWl0IGNhY2hlVVJMSWZOZWNlc3NhcnkodXJsLCBmb2xkZXIsIGZpbGVOYW1lLCBmb3JjZUNhY2hlVXBkYXRlLCB7XG4gICAgICAgICAgICAuLi5mZXRjaE9wdGlvbnMsXG4gICAgICAgICAgICBzaWduYWw6IGNvbnRyb2xsZXJSZWYuY3VycmVudD8uc2lnbmFsLFxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGdlbmVyYXRvclJlZi5jdXJyZW50ID0gc3RyZWFtSnNvbkZpbGUoXG4gICAgICAgICAgICBkZXN0aW5hdGlvbixcbiAgICAgICAgICAgIHBhZ2VTaXplLFxuICAgICAgICAgICAgY29udHJvbGxlclJlZi5jdXJyZW50Py5zaWduYWwsXG4gICAgICAgICAgICBkYXRhUGF0aCxcbiAgICAgICAgICAgIGZpbHRlcixcbiAgICAgICAgICAgIHRyYW5zZm9ybSxcbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICAgIGlmICghZ2VuZXJhdG9yUmVmLmN1cnJlbnQpIHtcbiAgICAgICAgICByZXR1cm4geyBoYXNNb3JlOiBoYXNNb3JlUmVmLmN1cnJlbnQsIGRhdGE6IFtdIGFzIFQgZXh0ZW5kcyB1bmtub3duW10gPyBUIDogVFtdIH07XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgeyB2YWx1ZTogbmV3RGF0YSwgZG9uZSB9ID0gYXdhaXQgZ2VuZXJhdG9yUmVmLmN1cnJlbnQubmV4dCgpO1xuICAgICAgICBoYXNNb3JlUmVmLmN1cnJlbnQgPSAhZG9uZTtcbiAgICAgICAgcmV0dXJuIHsgaGFzTW9yZTogaGFzTW9yZVJlZi5jdXJyZW50LCBkYXRhOiAobmV3RGF0YSA/PyBbXSkgYXMgVCBleHRlbmRzIHVua25vd25bXSA/IFQgOiBUW10gfTtcbiAgICAgIH0sXG4gICAgW3VybCwgcGFnZVNpemUsIGZldGNoT3B0aW9ucywgZGF0YVBhdGgsIGZpbHRlciwgdHJhbnNmb3JtXSxcbiAgICB1c2VDYWNoZWRQcm9taXNlT3B0aW9ucyxcbiAgKTtcbn1cbiIsICIvKiBlc2xpbnQtZGlzYWJsZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55ICovXG4vKiBlc2xpbnQtZGlzYWJsZSBAdHlwZXNjcmlwdC1lc2xpbnQvYmFuLXRzLWNvbW1lbnQgKi9cbmltcG9ydCB7IFJlYWRhYmxlLCBXcml0YWJsZSwgRHVwbGV4IH0gZnJvbSBcIm5vZGU6c3RyZWFtXCI7XG5cbmV4cG9ydCBjb25zdCBub25lID0gLyogI19fUFVSRV9fICovIFN5bWJvbC5mb3IoXCJvYmplY3Qtc3RyZWFtLm5vbmVcIik7XG5jb25zdCBzdG9wID0gLyogI19fUFVSRV9fICovIFN5bWJvbC5mb3IoXCJvYmplY3Qtc3RyZWFtLnN0b3BcIik7XG5cbmNvbnN0IGZpbmFsU3ltYm9sID0gLyogI19fUFVSRV9fICovIFN5bWJvbC5mb3IoXCJvYmplY3Qtc3RyZWFtLmZpbmFsXCIpO1xuY29uc3QgbWFueVN5bWJvbCA9IC8qICNfX1BVUkVfXyAqLyBTeW1ib2wuZm9yKFwib2JqZWN0LXN0cmVhbS5tYW55XCIpO1xuY29uc3QgZmx1c2hTeW1ib2wgPSAvKiAjX19QVVJFX18gKi8gU3ltYm9sLmZvcihcIm9iamVjdC1zdHJlYW0uZmx1c2hcIik7XG5jb25zdCBmTGlzdFN5bWJvbCA9IC8qICNfX1BVUkVfXyAqLyBTeW1ib2wuZm9yKFwib2JqZWN0LXN0cmVhbS5mTGlzdFwiKTtcblxuY29uc3QgZmluYWxWYWx1ZSA9ICh2YWx1ZTogYW55KSA9PiAoeyBbZmluYWxTeW1ib2xdOiAxLCB2YWx1ZSB9KTtcbmV4cG9ydCBjb25zdCBtYW55ID0gKHZhbHVlczogYW55KSA9PiAoeyBbbWFueVN5bWJvbF06IDEsIHZhbHVlcyB9KTtcblxuY29uc3QgaXNGaW5hbFZhbHVlID0gKG86IGFueSkgPT4gbyAmJiBvW2ZpbmFsU3ltYm9sXSA9PT0gMTtcbmNvbnN0IGlzTWFueSA9IChvOiBhbnkpID0+IG8gJiYgb1ttYW55U3ltYm9sXSA9PT0gMTtcbmNvbnN0IGlzRmx1c2hhYmxlID0gKG86IGFueSkgPT4gbyAmJiBvW2ZsdXNoU3ltYm9sXSA9PT0gMTtcbmNvbnN0IGlzRnVuY3Rpb25MaXN0ID0gKG86IGFueSkgPT4gbyAmJiBvW2ZMaXN0U3ltYm9sXSA9PT0gMTtcblxuY29uc3QgZ2V0RmluYWxWYWx1ZSA9IChvOiBhbnkpID0+IG8udmFsdWU7XG5jb25zdCBnZXRNYW55VmFsdWVzID0gKG86IGFueSkgPT4gby52YWx1ZXM7XG5jb25zdCBnZXRGdW5jdGlvbkxpc3QgPSAobzogYW55KSA9PiBvLmZMaXN0O1xuXG5leHBvcnQgY29uc3QgY29tYmluZU1hbnlNdXQgPSAoYTogYW55LCBiOiBhbnkpID0+IHtcbiAgY29uc3QgdmFsdWVzID0gYSA9PT0gbm9uZSA/IFtdIDogYT8uW21hbnlTeW1ib2xdID09PSAxID8gYS52YWx1ZXMgOiBbYV07XG4gIGlmIChiID09PSBub25lKSB7XG4gICAgLy8gZG8gbm90aGluZ1xuICB9IGVsc2UgaWYgKGI/LlttYW55U3ltYm9sXSA9PT0gMSkge1xuICAgIHZhbHVlcy5wdXNoKC4uLmIudmFsdWVzKTtcbiAgfSBlbHNlIHtcbiAgICB2YWx1ZXMucHVzaChiKTtcbiAgfVxuICByZXR1cm4gbWFueSh2YWx1ZXMpO1xufTtcblxuZXhwb3J0IGNvbnN0IGZsdXNoYWJsZSA9ICh3cml0ZTogKHZhbHVlOiBhbnkpID0+IGFueSwgZmluYWwgPSBudWxsKSA9PiB7XG4gIGNvbnN0IGZuID0gZmluYWwgPyAodmFsdWU6IGFueSkgPT4gKHZhbHVlID09PSBub25lID8gZmluYWxWYWx1ZSh1bmRlZmluZWQpIDogd3JpdGUodmFsdWUpKSA6IHdyaXRlO1xuICAvLyBAdHMtaWdub3JlXG4gIGZuW2ZsdXNoU3ltYm9sXSA9IDE7XG4gIHJldHVybiBmbjtcbn07XG5cbmNvbnN0IHNldEZ1bmN0aW9uTGlzdCA9IChvOiBhbnksIGZuczogYW55KSA9PiB7XG4gIG8uZkxpc3QgPSBmbnM7XG4gIG9bZkxpc3RTeW1ib2xdID0gMTtcbiAgcmV0dXJuIG87XG59O1xuXG4vLyBpcypOb2RlU3RyZWFtIGZ1bmN0aW9ucyB0YWtlbiBmcm9tIGh0dHBzOi8vZ2l0aHViLmNvbS9ub2RlanMvbm9kZS9ibG9iL21hc3Rlci9saWIvaW50ZXJuYWwvc3RyZWFtcy91dGlscy5qc1xuY29uc3QgaXNSZWFkYWJsZU5vZGVTdHJlYW0gPSAob2JqOiBhbnkpID0+XG4gIG9iaiAmJlxuICB0eXBlb2Ygb2JqLnBpcGUgPT09IFwiZnVuY3Rpb25cIiAmJlxuICB0eXBlb2Ygb2JqLm9uID09PSBcImZ1bmN0aW9uXCIgJiZcbiAgKCFvYmouX3dyaXRhYmxlU3RhdGUgfHwgKHR5cGVvZiBvYmouX3JlYWRhYmxlU3RhdGUgPT09IFwib2JqZWN0XCIgPyBvYmouX3JlYWRhYmxlU3RhdGUucmVhZGFibGUgOiBudWxsKSAhPT0gZmFsc2UpICYmIC8vIER1cGxleFxuICAoIW9iai5fd3JpdGFibGVTdGF0ZSB8fCBvYmouX3JlYWRhYmxlU3RhdGUpOyAvLyBXcml0YWJsZSBoYXMgLnBpcGUuXG5cbmNvbnN0IGlzV3JpdGFibGVOb2RlU3RyZWFtID0gKG9iajogYW55KSA9PlxuICBvYmogJiZcbiAgdHlwZW9mIG9iai53cml0ZSA9PT0gXCJmdW5jdGlvblwiICYmXG4gIHR5cGVvZiBvYmoub24gPT09IFwiZnVuY3Rpb25cIiAmJlxuICAoIW9iai5fcmVhZGFibGVTdGF0ZSB8fCAodHlwZW9mIG9iai5fd3JpdGFibGVTdGF0ZSA9PT0gXCJvYmplY3RcIiA/IG9iai5fd3JpdGFibGVTdGF0ZS53cml0YWJsZSA6IG51bGwpICE9PSBmYWxzZSk7IC8vIER1cGxleFxuXG5jb25zdCBpc0R1cGxleE5vZGVTdHJlYW0gPSAob2JqOiBhbnkpID0+XG4gIG9iaiAmJlxuICB0eXBlb2Ygb2JqLnBpcGUgPT09IFwiZnVuY3Rpb25cIiAmJlxuICBvYmouX3JlYWRhYmxlU3RhdGUgJiZcbiAgdHlwZW9mIG9iai5vbiA9PT0gXCJmdW5jdGlvblwiICYmXG4gIHR5cGVvZiBvYmoud3JpdGUgPT09IFwiZnVuY3Rpb25cIjtcblxuY29uc3QgaXNSZWFkYWJsZVdlYlN0cmVhbSA9IChvYmo6IGFueSkgPT4gb2JqICYmIGdsb2JhbFRoaXMuUmVhZGFibGVTdHJlYW0gJiYgb2JqIGluc3RhbmNlb2YgZ2xvYmFsVGhpcy5SZWFkYWJsZVN0cmVhbTtcblxuY29uc3QgaXNXcml0YWJsZVdlYlN0cmVhbSA9IChvYmo6IGFueSkgPT4gb2JqICYmIGdsb2JhbFRoaXMuV3JpdGFibGVTdHJlYW0gJiYgb2JqIGluc3RhbmNlb2YgZ2xvYmFsVGhpcy5Xcml0YWJsZVN0cmVhbTtcblxuY29uc3QgaXNEdXBsZXhXZWJTdHJlYW0gPSAob2JqOiBhbnkpID0+XG4gIG9iaiAmJlxuICBnbG9iYWxUaGlzLlJlYWRhYmxlU3RyZWFtICYmXG4gIG9iai5yZWFkYWJsZSBpbnN0YW5jZW9mIGdsb2JhbFRoaXMuUmVhZGFibGVTdHJlYW0gJiZcbiAgZ2xvYmFsVGhpcy5Xcml0YWJsZVN0cmVhbSAmJlxuICBvYmoud3JpdGFibGUgaW5zdGFuY2VvZiBnbG9iYWxUaGlzLldyaXRhYmxlU3RyZWFtO1xuXG5jb25zdCBncm91cEZ1bmN0aW9ucyA9IChvdXRwdXQ6IGFueSwgZm46IGFueSwgaW5kZXg6IGFueSwgZm5zOiBhbnkpID0+IHtcbiAgaWYgKFxuICAgIGlzRHVwbGV4Tm9kZVN0cmVhbShmbikgfHxcbiAgICAoIWluZGV4ICYmIGlzUmVhZGFibGVOb2RlU3RyZWFtKGZuKSkgfHxcbiAgICAoaW5kZXggPT09IGZucy5sZW5ndGggLSAxICYmIGlzV3JpdGFibGVOb2RlU3RyZWFtKGZuKSlcbiAgKSB7XG4gICAgb3V0cHV0LnB1c2goZm4pO1xuICAgIHJldHVybiBvdXRwdXQ7XG4gIH1cbiAgaWYgKGlzRHVwbGV4V2ViU3RyZWFtKGZuKSkge1xuICAgIG91dHB1dC5wdXNoKER1cGxleC5mcm9tV2ViKGZuLCB7IG9iamVjdE1vZGU6IHRydWUgfSkpO1xuICAgIHJldHVybiBvdXRwdXQ7XG4gIH1cbiAgaWYgKCFpbmRleCAmJiBpc1JlYWRhYmxlV2ViU3RyZWFtKGZuKSkge1xuICAgIG91dHB1dC5wdXNoKFJlYWRhYmxlLmZyb21XZWIoZm4sIHsgb2JqZWN0TW9kZTogdHJ1ZSB9KSk7XG4gICAgcmV0dXJuIG91dHB1dDtcbiAgfVxuICBpZiAoaW5kZXggPT09IGZucy5sZW5ndGggLSAxICYmIGlzV3JpdGFibGVXZWJTdHJlYW0oZm4pKSB7XG4gICAgb3V0cHV0LnB1c2goV3JpdGFibGUuZnJvbVdlYihmbiwgeyBvYmplY3RNb2RlOiB0cnVlIH0pKTtcbiAgICByZXR1cm4gb3V0cHV0O1xuICB9XG4gIGlmICh0eXBlb2YgZm4gIT0gXCJmdW5jdGlvblwiKSB0aHJvdyBUeXBlRXJyb3IoXCJJdGVtICNcIiArIGluZGV4ICsgXCIgaXMgbm90IGEgcHJvcGVyIHN0cmVhbSwgbm9yIGEgZnVuY3Rpb24uXCIpO1xuICBpZiAoIW91dHB1dC5sZW5ndGgpIG91dHB1dC5wdXNoKFtdKTtcbiAgY29uc3QgbGFzdCA9IG91dHB1dFtvdXRwdXQubGVuZ3RoIC0gMV07XG4gIGlmIChBcnJheS5pc0FycmF5KGxhc3QpKSB7XG4gICAgbGFzdC5wdXNoKGZuKTtcbiAgfSBlbHNlIHtcbiAgICBvdXRwdXQucHVzaChbZm5dKTtcbiAgfVxuICByZXR1cm4gb3V0cHV0O1xufTtcblxuY2xhc3MgU3RvcCBleHRlbmRzIEVycm9yIHt9XG5cbmV4cG9ydCBjb25zdCBhc1N0cmVhbSA9IChmbjogYW55KSA9PiB7XG4gIGlmICh0eXBlb2YgZm4gIT0gXCJmdW5jdGlvblwiKSB0aHJvdyBUeXBlRXJyb3IoXCJPbmx5IGEgZnVuY3Rpb24gaXMgYWNjZXB0ZWQgYXMgdGhlIGZpcnN0IGFyZ3VtZW50XCIpO1xuXG4gIC8vIHB1bXAgdmFyaWFibGVzXG4gIGxldCBwYXVzZWQgPSBQcm9taXNlLnJlc29sdmUoKTtcbiAgbGV0IHJlc29sdmVQYXVzZWQ6ICgodmFsdWU6IHZvaWQgfCBQcm9taXNlTGlrZTx2b2lkPikgPT4gdm9pZCkgfCBudWxsID0gbnVsbDtcbiAgY29uc3QgcXVldWU6IGFueVtdID0gW107XG5cbiAgLy8gcGF1c2UvcmVzdW1lXG4gIGNvbnN0IHJlc3VtZTogYW55ID0gKCkgPT4ge1xuICAgIGlmICghcmVzb2x2ZVBhdXNlZCkgcmV0dXJuO1xuICAgIHJlc29sdmVQYXVzZWQoKTtcbiAgICByZXNvbHZlUGF1c2VkID0gbnVsbDtcbiAgICBwYXVzZWQgPSBQcm9taXNlLnJlc29sdmUoKTtcbiAgfTtcbiAgY29uc3QgcGF1c2U6IGFueSA9ICgpID0+IHtcbiAgICBpZiAocmVzb2x2ZVBhdXNlZCkgcmV0dXJuO1xuICAgIHBhdXNlZCA9IG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiAocmVzb2x2ZVBhdXNlZCA9IHJlc29sdmUpKTtcbiAgfTtcblxuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcHJlZmVyLWNvbnN0XG4gIGxldCBzdHJlYW06IER1cGxleDsgLy8gd2lsbCBiZSBhc3NpZ25lZCBsYXRlclxuXG4gIC8vIGRhdGEgcHJvY2Vzc2luZ1xuICBjb25zdCBwdXNoUmVzdWx0czogYW55ID0gKHZhbHVlczogYW55KSA9PiB7XG4gICAgaWYgKHZhbHVlcyAmJiB0eXBlb2YgdmFsdWVzLm5leHQgPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAvLyBnZW5lcmF0b3JcbiAgICAgIHF1ZXVlLnB1c2godmFsdWVzKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgLy8gYXJyYXlcbiAgICBxdWV1ZS5wdXNoKHZhbHVlc1tTeW1ib2wuaXRlcmF0b3JdKCkpO1xuICB9O1xuICBjb25zdCBwdW1wOiBhbnkgPSBhc3luYyAoKSA9PiB7XG4gICAgd2hpbGUgKHF1ZXVlLmxlbmd0aCkge1xuICAgICAgYXdhaXQgcGF1c2VkO1xuICAgICAgY29uc3QgZ2VuID0gcXVldWVbcXVldWUubGVuZ3RoIC0gMV07XG4gICAgICBsZXQgcmVzdWx0ID0gZ2VuLm5leHQoKTtcbiAgICAgIGlmIChyZXN1bHQgJiYgdHlwZW9mIHJlc3VsdC50aGVuID09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICByZXN1bHQgPSBhd2FpdCByZXN1bHQ7XG4gICAgICB9XG4gICAgICBpZiAocmVzdWx0LmRvbmUpIHtcbiAgICAgICAgcXVldWUucG9wKCk7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgICAgbGV0IHZhbHVlID0gcmVzdWx0LnZhbHVlO1xuICAgICAgaWYgKHZhbHVlICYmIHR5cGVvZiB2YWx1ZS50aGVuID09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICB2YWx1ZSA9IGF3YWl0IHZhbHVlO1xuICAgICAgfVxuICAgICAgYXdhaXQgc2FuaXRpemUodmFsdWUpO1xuICAgIH1cbiAgfTtcbiAgY29uc3Qgc2FuaXRpemU6IGFueSA9IGFzeW5jICh2YWx1ZTogYW55KSA9PiB7XG4gICAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQgfHwgdmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09IG5vbmUpIHJldHVybjtcbiAgICBpZiAodmFsdWUgPT09IHN0b3ApIHRocm93IG5ldyBTdG9wKCk7XG5cbiAgICBpZiAoaXNNYW55KHZhbHVlKSkge1xuICAgICAgcHVzaFJlc3VsdHMoZ2V0TWFueVZhbHVlcyh2YWx1ZSkpO1xuICAgICAgcmV0dXJuIHB1bXAoKTtcbiAgICB9XG5cbiAgICBpZiAoaXNGaW5hbFZhbHVlKHZhbHVlKSkge1xuICAgICAgLy8gYSBmaW5hbCB2YWx1ZSBpcyBub3Qgc3VwcG9ydGVkLCBpdCBpcyB0cmVhdGVkIGFzIGEgcmVndWxhciB2YWx1ZVxuICAgICAgdmFsdWUgPSBnZXRGaW5hbFZhbHVlKHZhbHVlKTtcbiAgICAgIHJldHVybiBwcm9jZXNzVmFsdWUodmFsdWUpO1xuICAgIH1cblxuICAgIGlmICghc3RyZWFtLnB1c2godmFsdWUpKSB7XG4gICAgICBwYXVzZSgpO1xuICAgIH1cbiAgfTtcbiAgY29uc3QgcHJvY2Vzc0NodW5rOiBhbnkgPSBhc3luYyAoY2h1bms6IGFueSwgZW5jb2Rpbmc6IGFueSkgPT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB2YWx1ZSA9IGZuKGNodW5rLCBlbmNvZGluZyk7XG4gICAgICBhd2FpdCBwcm9jZXNzVmFsdWUodmFsdWUpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBTdG9wKSB7XG4gICAgICAgIHN0cmVhbS5wdXNoKG51bGwpO1xuICAgICAgICBzdHJlYW0uZGVzdHJveSgpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gIH07XG4gIGNvbnN0IHByb2Nlc3NWYWx1ZTogYW55ID0gYXN5bmMgKHZhbHVlOiBhbnkpID0+IHtcbiAgICBpZiAodmFsdWUgJiYgdHlwZW9mIHZhbHVlLnRoZW4gPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAvLyB0aGVuYWJsZVxuICAgICAgcmV0dXJuIHZhbHVlLnRoZW4oKHZhbHVlOiBhbnkpID0+IHByb2Nlc3NWYWx1ZSh2YWx1ZSkpO1xuICAgIH1cbiAgICBpZiAodmFsdWUgJiYgdHlwZW9mIHZhbHVlLm5leHQgPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAvLyBnZW5lcmF0b3JcbiAgICAgIHB1c2hSZXN1bHRzKHZhbHVlKTtcbiAgICAgIHJldHVybiBwdW1wKCk7XG4gICAgfVxuICAgIHJldHVybiBzYW5pdGl6ZSh2YWx1ZSk7XG4gIH07XG5cbiAgc3RyZWFtID0gbmV3IER1cGxleChcbiAgICBPYmplY3QuYXNzaWduKHsgd3JpdGFibGVPYmplY3RNb2RlOiB0cnVlLCByZWFkYWJsZU9iamVjdE1vZGU6IHRydWUgfSwgdW5kZWZpbmVkLCB7XG4gICAgICB3cml0ZShjaHVuazogYW55LCBlbmNvZGluZzogYW55LCBjYWxsYmFjazogYW55KSB7XG4gICAgICAgIHByb2Nlc3NDaHVuayhjaHVuaywgZW5jb2RpbmcpLnRoZW4oXG4gICAgICAgICAgKCkgPT4gY2FsbGJhY2sobnVsbCksXG4gICAgICAgICAgKGVycm9yOiBhbnkpID0+IGNhbGxiYWNrKGVycm9yKSxcbiAgICAgICAgKTtcbiAgICAgIH0sXG4gICAgICBmaW5hbChjYWxsYmFjazogYW55KSB7XG4gICAgICAgIGlmICghaXNGbHVzaGFibGUoZm4pKSB7XG4gICAgICAgICAgc3RyZWFtLnB1c2gobnVsbCk7XG4gICAgICAgICAgY2FsbGJhY2sobnVsbCk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHByb2Nlc3NDaHVuayhub25lLCBudWxsKS50aGVuKFxuICAgICAgICAgICgpID0+IChzdHJlYW0ucHVzaChudWxsKSwgY2FsbGJhY2sobnVsbCkpLFxuICAgICAgICAgIChlcnJvcjogYW55KSA9PiBjYWxsYmFjayhlcnJvciksXG4gICAgICAgICk7XG4gICAgICB9LFxuICAgICAgcmVhZCgpIHtcbiAgICAgICAgcmVzdW1lKCk7XG4gICAgICB9LFxuICAgIH0pLFxuICApO1xuXG4gIHJldHVybiBzdHJlYW07XG59O1xuXG5jb25zdCBwcm9kdWNlU3RyZWFtcyA9IChpdGVtOiBhbnkpID0+IHtcbiAgaWYgKEFycmF5LmlzQXJyYXkoaXRlbSkpIHtcbiAgICBpZiAoIWl0ZW0ubGVuZ3RoKSByZXR1cm4gbnVsbDtcbiAgICBpZiAoaXRlbS5sZW5ndGggPT0gMSkgcmV0dXJuIGl0ZW1bMF0gJiYgYXNTdHJlYW0oaXRlbVswXSk7XG4gICAgcmV0dXJuIGFzU3RyZWFtKGdlbiguLi5pdGVtKSk7XG4gIH1cbiAgcmV0dXJuIGl0ZW07XG59O1xuXG5jb25zdCBuZXh0OiBhbnkgPSBhc3luYyBmdW5jdGlvbiogKHZhbHVlOiBhbnksIGZuczogYW55LCBpbmRleDogYW55KSB7XG4gIGZvciAobGV0IGkgPSBpbmRleDsgaSA8PSBmbnMubGVuZ3RoOyArK2kpIHtcbiAgICBpZiAodmFsdWUgJiYgdHlwZW9mIHZhbHVlLnRoZW4gPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAvLyB0aGVuYWJsZVxuICAgICAgdmFsdWUgPSBhd2FpdCB2YWx1ZTtcbiAgICB9XG4gICAgaWYgKHZhbHVlID09PSBub25lKSBicmVhaztcbiAgICBpZiAodmFsdWUgPT09IHN0b3ApIHRocm93IG5ldyBTdG9wKCk7XG4gICAgaWYgKGlzRmluYWxWYWx1ZSh2YWx1ZSkpIHtcbiAgICAgIHlpZWxkIGdldEZpbmFsVmFsdWUodmFsdWUpO1xuICAgICAgYnJlYWs7XG4gICAgfVxuICAgIGlmIChpc01hbnkodmFsdWUpKSB7XG4gICAgICBjb25zdCB2YWx1ZXMgPSBnZXRNYW55VmFsdWVzKHZhbHVlKTtcbiAgICAgIGlmIChpID09IGZucy5sZW5ndGgpIHtcbiAgICAgICAgeWllbGQqIHZhbHVlcztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgdmFsdWVzLmxlbmd0aDsgKytqKSB7XG4gICAgICAgICAgeWllbGQqIG5leHQodmFsdWVzW2pdLCBmbnMsIGkpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBicmVhaztcbiAgICB9XG4gICAgaWYgKHZhbHVlICYmIHR5cGVvZiB2YWx1ZS5uZXh0ID09IFwiZnVuY3Rpb25cIikge1xuICAgICAgLy8gZ2VuZXJhdG9yXG4gICAgICBmb3IgKDs7KSB7XG4gICAgICAgIGxldCBkYXRhID0gdmFsdWUubmV4dCgpO1xuICAgICAgICBpZiAoZGF0YSAmJiB0eXBlb2YgZGF0YS50aGVuID09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgIGRhdGEgPSBhd2FpdCBkYXRhO1xuICAgICAgICB9XG4gICAgICAgIGlmIChkYXRhLmRvbmUpIGJyZWFrO1xuICAgICAgICBpZiAoaSA9PSBmbnMubGVuZ3RoKSB7XG4gICAgICAgICAgeWllbGQgZGF0YS52YWx1ZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB5aWVsZCogbmV4dChkYXRhLnZhbHVlLCBmbnMsIGkpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBicmVhaztcbiAgICB9XG4gICAgaWYgKGkgPT0gZm5zLmxlbmd0aCkge1xuICAgICAgeWllbGQgdmFsdWU7XG4gICAgICBicmVhaztcbiAgICB9XG4gICAgY29uc3QgZiA9IGZuc1tpXTtcbiAgICB2YWx1ZSA9IGYodmFsdWUpO1xuICB9XG59O1xuXG5leHBvcnQgY29uc3QgZ2VuID0gKC4uLmZuczogYW55KSA9PiB7XG4gIGZucyA9IGZuc1xuICAgIC5maWx0ZXIoKGZuOiBhbnkpID0+IGZuKVxuICAgIC5mbGF0KEluZmluaXR5KVxuICAgIC5tYXAoKGZuOiBhbnkpID0+IChpc0Z1bmN0aW9uTGlzdChmbikgPyBnZXRGdW5jdGlvbkxpc3QoZm4pIDogZm4pKVxuICAgIC5mbGF0KEluZmluaXR5KTtcbiAgaWYgKCFmbnMubGVuZ3RoKSB7XG4gICAgZm5zID0gWyh4OiBhbnkpID0+IHhdO1xuICB9XG4gIGxldCBmbHVzaGVkID0gZmFsc2U7XG4gIGxldCBnID0gYXN5bmMgZnVuY3Rpb24qICh2YWx1ZTogYW55KSB7XG4gICAgaWYgKGZsdXNoZWQpIHRocm93IEVycm9yKFwiQ2FsbCB0byBhIGZsdXNoZWQgcGlwZS5cIik7XG4gICAgaWYgKHZhbHVlICE9PSBub25lKSB7XG4gICAgICB5aWVsZCogbmV4dCh2YWx1ZSwgZm5zLCAwKTtcbiAgICB9IGVsc2Uge1xuICAgICAgZmx1c2hlZCA9IHRydWU7XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGZucy5sZW5ndGg7ICsraSkge1xuICAgICAgICBjb25zdCBmID0gZm5zW2ldO1xuICAgICAgICBpZiAoaXNGbHVzaGFibGUoZikpIHtcbiAgICAgICAgICB5aWVsZCogbmV4dChmKG5vbmUpLCBmbnMsIGkgKyAxKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfTtcbiAgY29uc3QgbmVlZFRvRmx1c2ggPSBmbnMuc29tZSgoZm46IGFueSkgPT4gaXNGbHVzaGFibGUoZm4pKTtcbiAgaWYgKG5lZWRUb0ZsdXNoKSBnID0gZmx1c2hhYmxlKGcpO1xuICByZXR1cm4gc2V0RnVuY3Rpb25MaXN0KGcsIGZucyk7XG59O1xuXG5jb25zdCB3cml0ZSA9IChpbnB1dDogYW55LCBjaHVuazogYW55LCBlbmNvZGluZzogYW55LCBjYWxsYmFjazogYW55KSA9PiB7XG4gIGxldCBlcnJvcjogYW55ID0gbnVsbDtcbiAgdHJ5IHtcbiAgICBpbnB1dC53cml0ZShjaHVuaywgZW5jb2RpbmcsIChlOiBhbnkpID0+IGNhbGxiYWNrKGUgfHwgZXJyb3IpKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIGVycm9yID0gZTtcbiAgfVxufTtcblxuY29uc3QgZmluYWwgPSAoaW5wdXQ6IGFueSwgY2FsbGJhY2s6IGFueSkgPT4ge1xuICBsZXQgZXJyb3I6IGFueSA9IG51bGw7XG4gIHRyeSB7XG4gICAgaW5wdXQuZW5kKG51bGwsIG51bGwsIChlOiBhbnkpID0+IGNhbGxiYWNrKGUgfHwgZXJyb3IpKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIGVycm9yID0gZTtcbiAgfVxufTtcblxuY29uc3QgcmVhZCA9IChvdXRwdXQ6IGFueSkgPT4ge1xuICBvdXRwdXQucmVzdW1lKCk7XG59O1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBjaGFpbihmbnM6IGFueSkge1xuICBmbnMgPSBmbnMuZmxhdChJbmZpbml0eSkuZmlsdGVyKChmbjogYW55KSA9PiBmbik7XG5cbiAgY29uc3Qgc3RyZWFtcyA9IGZuc1xuICAgICAgLm1hcCgoZm46IGFueSkgPT4gKGlzRnVuY3Rpb25MaXN0KGZuKSA/IGdldEZ1bmN0aW9uTGlzdChmbikgOiBmbikpXG4gICAgICAuZmxhdChJbmZpbml0eSlcbiAgICAgIC5yZWR1Y2UoZ3JvdXBGdW5jdGlvbnMsIFtdKVxuICAgICAgLm1hcChwcm9kdWNlU3RyZWFtcylcbiAgICAgIC5maWx0ZXIoKHM6IGFueSkgPT4gcyksXG4gICAgaW5wdXQgPSBzdHJlYW1zWzBdLFxuICAgIG91dHB1dCA9IHN0cmVhbXMucmVkdWNlKChvdXRwdXQ6IGFueSwgaXRlbTogYW55KSA9PiAob3V0cHV0ICYmIG91dHB1dC5waXBlKGl0ZW0pKSB8fCBpdGVtKTtcblxuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcHJlZmVyLWNvbnN0XG4gIGxldCBzdHJlYW06IER1cGxleDsgLy8gd2lsbCBiZSBhc3NpZ25lZCBsYXRlclxuXG4gIGxldCB3cml0ZU1ldGhvZCA9IChjaHVuazogYW55LCBlbmNvZGluZzogYW55LCBjYWxsYmFjazogYW55KSA9PiB3cml0ZShpbnB1dCwgY2h1bmssIGVuY29kaW5nLCBjYWxsYmFjayksXG4gICAgZmluYWxNZXRob2QgPSAoY2FsbGJhY2s6IGFueSkgPT4gZmluYWwoaW5wdXQsIGNhbGxiYWNrKSxcbiAgICByZWFkTWV0aG9kID0gKCkgPT4gcmVhZChvdXRwdXQpO1xuXG4gIGlmICghaXNXcml0YWJsZU5vZGVTdHJlYW0oaW5wdXQpKSB7XG4gICAgd3JpdGVNZXRob2QgPSAoXzEsIF8yLCBjYWxsYmFjaykgPT4gY2FsbGJhY2sobnVsbCk7XG4gICAgZmluYWxNZXRob2QgPSAoY2FsbGJhY2spID0+IGNhbGxiYWNrKG51bGwpO1xuICAgIGlucHV0Lm9uKFwiZW5kXCIsICgpID0+IHN0cmVhbS5lbmQoKSk7XG4gIH1cblxuICBpZiAoaXNSZWFkYWJsZU5vZGVTdHJlYW0ob3V0cHV0KSkge1xuICAgIG91dHB1dC5vbihcImRhdGFcIiwgKGNodW5rOiBhbnkpID0+ICFzdHJlYW0ucHVzaChjaHVuaykgJiYgb3V0cHV0LnBhdXNlKCkpO1xuICAgIG91dHB1dC5vbihcImVuZFwiLCAoKSA9PiBzdHJlYW0ucHVzaChudWxsKSk7XG4gIH0gZWxzZSB7XG4gICAgcmVhZE1ldGhvZCA9ICgpID0+IHt9OyAvLyBub3BcbiAgICBvdXRwdXQub24oXCJmaW5pc2hcIiwgKCkgPT4gc3RyZWFtLnB1c2gobnVsbCkpO1xuICB9XG5cbiAgc3RyZWFtID0gbmV3IER1cGxleChcbiAgICBPYmplY3QuYXNzaWduKFxuICAgICAgeyB3cml0YWJsZU9iamVjdE1vZGU6IHRydWUsIHJlYWRhYmxlT2JqZWN0TW9kZTogdHJ1ZSB9LFxuICAgICAge1xuICAgICAgICByZWFkYWJsZTogaXNSZWFkYWJsZU5vZGVTdHJlYW0ob3V0cHV0KSxcbiAgICAgICAgd3JpdGFibGU6IGlzV3JpdGFibGVOb2RlU3RyZWFtKGlucHV0KSxcbiAgICAgICAgd3JpdGU6IHdyaXRlTWV0aG9kLFxuICAgICAgICBmaW5hbDogZmluYWxNZXRob2QsXG4gICAgICAgIHJlYWQ6IHJlYWRNZXRob2QsXG4gICAgICB9LFxuICAgICksXG4gICk7XG4gIC8vIEB0cy1pZ25vcmVcbiAgc3RyZWFtLnN0cmVhbXMgPSBzdHJlYW1zO1xuICAvLyBAdHMtaWdub3JlXG4gIHN0cmVhbS5pbnB1dCA9IGlucHV0O1xuICAvLyBAdHMtaWdub3JlXG4gIHN0cmVhbS5vdXRwdXQgPSBvdXRwdXQ7XG5cbiAgaWYgKCFpc1JlYWRhYmxlTm9kZVN0cmVhbShvdXRwdXQpKSB7XG4gICAgc3RyZWFtLnJlc3VtZSgpO1xuICB9XG5cbiAgLy8gY29ubmVjdCBldmVudHNcbiAgc3RyZWFtcy5mb3JFYWNoKChpdGVtOiBhbnkpID0+IGl0ZW0ub24oXCJlcnJvclwiLCAoZXJyb3I6IGFueSkgPT4gc3RyZWFtLmVtaXQoXCJlcnJvclwiLCBlcnJvcikpKTtcblxuICByZXR1cm4gc3RyZWFtO1xufVxuIiwgIi8qIGVzbGludC1kaXNhYmxlIEB0eXBlc2NyaXB0LWVzbGludC9iYW4tdHMtY29tbWVudCAqL1xuLyogZXNsaW50LWRpc2FibGUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueSAqL1xuLyogZXNsaW50LWRpc2FibGUgbm8tY29udHJvbC1yZWdleCAqL1xuLyogZXNsaW50LWRpc2FibGUgbm8tdXNlbGVzcy1lc2NhcGUgKi9cbmltcG9ydCB7IGZsdXNoYWJsZSwgZ2VuLCBtYW55LCBub25lLCBjb21iaW5lTWFueU11dCB9IGZyb20gXCIuL3N0cmVhbS1jaGFpblwiO1xuaW1wb3J0IHsgU3RyaW5nRGVjb2RlciB9IGZyb20gXCJub2RlOnN0cmluZ19kZWNvZGVyXCI7XG5pbXBvcnQgRXZlbnRFbWl0dGVyIGZyb20gXCJub2RlOmV2ZW50c1wiO1xuXG5jb25zdCBmaXhVdGY4U3RyZWFtID0gKCkgPT4ge1xuICBjb25zdCBzdHJpbmdEZWNvZGVyID0gbmV3IFN0cmluZ0RlY29kZXIoKTtcbiAgbGV0IGlucHV0ID0gXCJcIjtcbiAgcmV0dXJuIGZsdXNoYWJsZSgoY2h1bms6IGFueSkgPT4ge1xuICAgIGlmIChjaHVuayA9PT0gbm9uZSkge1xuICAgICAgY29uc3QgcmVzdWx0ID0gaW5wdXQgKyBzdHJpbmdEZWNvZGVyLmVuZCgpO1xuICAgICAgaW5wdXQgPSBcIlwiO1xuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiBjaHVuayA9PSBcInN0cmluZ1wiKSB7XG4gICAgICBpZiAoIWlucHV0KSByZXR1cm4gY2h1bms7XG4gICAgICBjb25zdCByZXN1bHQgPSBpbnB1dCArIGNodW5rO1xuICAgICAgaW5wdXQgPSBcIlwiO1xuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4gICAgaWYgKGNodW5rIGluc3RhbmNlb2YgQnVmZmVyKSB7XG4gICAgICBjb25zdCByZXN1bHQgPSBpbnB1dCArIHN0cmluZ0RlY29kZXIud3JpdGUoY2h1bmspO1xuICAgICAgaW5wdXQgPSBcIlwiO1xuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkV4cGVjdGVkIGEgc3RyaW5nIG9yIGEgQnVmZmVyXCIpO1xuICB9KTtcbn07XG5cbmNvbnN0IHBhdHRlcm5zID0ge1xuICB2YWx1ZTE6IC9bXFxcIlxce1xcW1xcXVxcLVxcZF18dHJ1ZVxcYnxmYWxzZVxcYnxudWxsXFxifFxcc3sxLDI1Nn0veSxcbiAgc3RyaW5nOiAvW15cXHgwMC1cXHgxZlxcXCJcXFxcXXsxLDI1Nn18XFxcXFtiZm5ydFxcXCJcXFxcXFwvXXxcXFxcdVtcXGRhLWZBLUZdezR9fFxcXCIveSxcbiAga2V5MTogL1tcXFwiXFx9XXxcXHN7MSwyNTZ9L3ksXG4gIGNvbG9uOiAvXFw6fFxcc3sxLDI1Nn0veSxcbiAgY29tbWE6IC9bXFwsXFxdXFx9XXxcXHN7MSwyNTZ9L3ksXG4gIHdzOiAvXFxzezEsMjU2fS95LFxuICBudW1iZXJTdGFydDogL1xcZC95LFxuICBudW1iZXJEaWdpdDogL1xcZHswLDI1Nn0veSxcbiAgbnVtYmVyRnJhY3Rpb246IC9bXFwuZUVdL3ksXG4gIG51bWJlckV4cG9uZW50OiAvW2VFXS95LFxuICBudW1iZXJFeHBTaWduOiAvWy0rXS95LFxufTtcbmNvbnN0IE1BWF9QQVRURVJOX1NJWkUgPSAxNjtcblxuY29uc3QgdmFsdWVzOiB7IFtrZXk6IHN0cmluZ106IGFueSB9ID0geyB0cnVlOiB0cnVlLCBmYWxzZTogZmFsc2UsIG51bGw6IG51bGwgfSxcbiAgZXhwZWN0ZWQ6IHsgW2tleTogc3RyaW5nXTogc3RyaW5nIH0gPSB7IG9iamVjdDogXCJvYmplY3RTdG9wXCIsIGFycmF5OiBcImFycmF5U3RvcFwiLCBcIlwiOiBcImRvbmVcIiB9O1xuXG4vLyBsb25nIGhleGFkZWNpbWFsIGNvZGVzOiBcXHVYWFhYXG5jb25zdCBmcm9tSGV4ID0gKHM6IHN0cmluZykgPT4gU3RyaW5nLmZyb21DaGFyQ29kZShwYXJzZUludChzLnNsaWNlKDIpLCAxNikpO1xuXG4vLyBzaG9ydCBjb2RlczogXFxiIFxcZiBcXG4gXFxyIFxcdCBcXFwiIFxcXFwgXFwvXG5jb25zdCBjb2RlczogeyBba2V5OiBzdHJpbmddOiBzdHJpbmcgfSA9IHtcbiAgYjogXCJcXGJcIixcbiAgZjogXCJcXGZcIixcbiAgbjogXCJcXG5cIixcbiAgcjogXCJcXHJcIixcbiAgdDogXCJcXHRcIixcbiAgJ1wiJzogJ1wiJyxcbiAgXCJcXFxcXCI6IFwiXFxcXFwiLFxuICBcIi9cIjogXCIvXCIsXG59O1xuXG5jb25zdCBqc29uUGFyc2VyID0gKG9wdGlvbnM/OiBhbnkpID0+IHtcbiAgbGV0IHBhY2tLZXlzID0gdHJ1ZSxcbiAgICBwYWNrU3RyaW5ncyA9IHRydWUsXG4gICAgcGFja051bWJlcnMgPSB0cnVlLFxuICAgIHN0cmVhbUtleXMgPSB0cnVlLFxuICAgIHN0cmVhbVN0cmluZ3MgPSB0cnVlLFxuICAgIHN0cmVhbU51bWJlcnMgPSB0cnVlLFxuICAgIGpzb25TdHJlYW1pbmcgPSBmYWxzZTtcblxuICBpZiAob3B0aW9ucykge1xuICAgIFwicGFja1ZhbHVlc1wiIGluIG9wdGlvbnMgJiYgKHBhY2tLZXlzID0gcGFja1N0cmluZ3MgPSBwYWNrTnVtYmVycyA9IG9wdGlvbnMucGFja1ZhbHVlcyk7XG4gICAgXCJwYWNrS2V5c1wiIGluIG9wdGlvbnMgJiYgKHBhY2tLZXlzID0gb3B0aW9ucy5wYWNrS2V5cyk7XG4gICAgXCJwYWNrU3RyaW5nc1wiIGluIG9wdGlvbnMgJiYgKHBhY2tTdHJpbmdzID0gb3B0aW9ucy5wYWNrU3RyaW5ncyk7XG4gICAgXCJwYWNrTnVtYmVyc1wiIGluIG9wdGlvbnMgJiYgKHBhY2tOdW1iZXJzID0gb3B0aW9ucy5wYWNrTnVtYmVycyk7XG4gICAgXCJzdHJlYW1WYWx1ZXNcIiBpbiBvcHRpb25zICYmIChzdHJlYW1LZXlzID0gc3RyZWFtU3RyaW5ncyA9IHN0cmVhbU51bWJlcnMgPSBvcHRpb25zLnN0cmVhbVZhbHVlcyk7XG4gICAgXCJzdHJlYW1LZXlzXCIgaW4gb3B0aW9ucyAmJiAoc3RyZWFtS2V5cyA9IG9wdGlvbnMuc3RyZWFtS2V5cyk7XG4gICAgXCJzdHJlYW1TdHJpbmdzXCIgaW4gb3B0aW9ucyAmJiAoc3RyZWFtU3RyaW5ncyA9IG9wdGlvbnMuc3RyZWFtU3RyaW5ncyk7XG4gICAgXCJzdHJlYW1OdW1iZXJzXCIgaW4gb3B0aW9ucyAmJiAoc3RyZWFtTnVtYmVycyA9IG9wdGlvbnMuc3RyZWFtTnVtYmVycyk7XG4gICAganNvblN0cmVhbWluZyA9IG9wdGlvbnMuanNvblN0cmVhbWluZztcbiAgfVxuXG4gICFwYWNrS2V5cyAmJiAoc3RyZWFtS2V5cyA9IHRydWUpO1xuICAhcGFja1N0cmluZ3MgJiYgKHN0cmVhbVN0cmluZ3MgPSB0cnVlKTtcbiAgIXBhY2tOdW1iZXJzICYmIChzdHJlYW1OdW1iZXJzID0gdHJ1ZSk7XG5cbiAgbGV0IGRvbmUgPSBmYWxzZSxcbiAgICBleHBlY3QgPSBqc29uU3RyZWFtaW5nID8gXCJkb25lXCIgOiBcInZhbHVlXCIsXG4gICAgcGFyZW50ID0gXCJcIixcbiAgICBvcGVuTnVtYmVyID0gZmFsc2UsXG4gICAgYWNjdW11bGF0b3IgPSBcIlwiLFxuICAgIGJ1ZmZlciA9IFwiXCI7XG5cbiAgY29uc3Qgc3RhY2s6IGFueVtdID0gW107XG5cbiAgcmV0dXJuIGZsdXNoYWJsZSgoYnVmOiBhbnkpID0+IHtcbiAgICBjb25zdCB0b2tlbnM6IGFueVtdID0gW107XG5cbiAgICBpZiAoYnVmID09PSBub25lKSB7XG4gICAgICBkb25lID0gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgYnVmZmVyICs9IGJ1ZjtcbiAgICB9XG5cbiAgICBsZXQgbWF0Y2g6IGFueTtcbiAgICBsZXQgdmFsdWU6IGFueTtcbiAgICBsZXQgaW5kZXggPSAwO1xuXG4gICAgbWFpbjogZm9yICg7Oykge1xuICAgICAgc3dpdGNoIChleHBlY3QpIHtcbiAgICAgICAgY2FzZSBcInZhbHVlMVwiOlxuICAgICAgICBjYXNlIFwidmFsdWVcIjpcbiAgICAgICAgICBwYXR0ZXJucy52YWx1ZTEubGFzdEluZGV4ID0gaW5kZXg7XG4gICAgICAgICAgbWF0Y2ggPSBwYXR0ZXJucy52YWx1ZTEuZXhlYyhidWZmZXIpO1xuICAgICAgICAgIGlmICghbWF0Y2gpIHtcbiAgICAgICAgICAgIGlmIChkb25lIHx8IGluZGV4ICsgTUFYX1BBVFRFUk5fU0laRSA8IGJ1ZmZlci5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgaWYgKGluZGV4IDwgYnVmZmVyLmxlbmd0aCkgdGhyb3cgbmV3IEVycm9yKFwiUGFyc2VyIGNhbm5vdCBwYXJzZSBpbnB1dDogZXhwZWN0ZWQgYSB2YWx1ZVwiKTtcbiAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiUGFyc2VyIGhhcyBleHBlY3RlZCBhIHZhbHVlXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYnJlYWsgbWFpbjsgLy8gd2FpdCBmb3IgbW9yZSBpbnB1dFxuICAgICAgICAgIH1cbiAgICAgICAgICB2YWx1ZSA9IG1hdGNoWzBdO1xuICAgICAgICAgIHN3aXRjaCAodmFsdWUpIHtcbiAgICAgICAgICAgIGNhc2UgJ1wiJzpcbiAgICAgICAgICAgICAgaWYgKHN0cmVhbVN0cmluZ3MpIHRva2Vucy5wdXNoKHsgbmFtZTogXCJzdGFydFN0cmluZ1wiIH0pO1xuICAgICAgICAgICAgICBleHBlY3QgPSBcInN0cmluZ1wiO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJ7XCI6XG4gICAgICAgICAgICAgIHRva2Vucy5wdXNoKHsgbmFtZTogXCJzdGFydE9iamVjdFwiIH0pO1xuICAgICAgICAgICAgICBzdGFjay5wdXNoKHBhcmVudCk7XG4gICAgICAgICAgICAgIHBhcmVudCA9IFwib2JqZWN0XCI7XG4gICAgICAgICAgICAgIGV4cGVjdCA9IFwia2V5MVwiO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJbXCI6XG4gICAgICAgICAgICAgIHRva2Vucy5wdXNoKHsgbmFtZTogXCJzdGFydEFycmF5XCIgfSk7XG4gICAgICAgICAgICAgIHN0YWNrLnB1c2gocGFyZW50KTtcbiAgICAgICAgICAgICAgcGFyZW50ID0gXCJhcnJheVwiO1xuICAgICAgICAgICAgICBleHBlY3QgPSBcInZhbHVlMVwiO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJdXCI6XG4gICAgICAgICAgICAgIGlmIChleHBlY3QgIT09IFwidmFsdWUxXCIpIHRocm93IG5ldyBFcnJvcihcIlBhcnNlciBjYW5ub3QgcGFyc2UgaW5wdXQ6IHVuZXhwZWN0ZWQgdG9rZW4gJ10nXCIpO1xuICAgICAgICAgICAgICBpZiAob3Blbk51bWJlcikge1xuICAgICAgICAgICAgICAgIGlmIChzdHJlYW1OdW1iZXJzKSB0b2tlbnMucHVzaCh7IG5hbWU6IFwiZW5kTnVtYmVyXCIgfSk7XG4gICAgICAgICAgICAgICAgb3Blbk51bWJlciA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGlmIChwYWNrTnVtYmVycykge1xuICAgICAgICAgICAgICAgICAgdG9rZW5zLnB1c2goeyBuYW1lOiBcIm51bWJlclZhbHVlXCIsIHZhbHVlOiBhY2N1bXVsYXRvciB9KTtcbiAgICAgICAgICAgICAgICAgIGFjY3VtdWxhdG9yID0gXCJcIjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgdG9rZW5zLnB1c2goeyBuYW1lOiBcImVuZEFycmF5XCIgfSk7XG4gICAgICAgICAgICAgIHBhcmVudCA9IHN0YWNrLnBvcCgpO1xuICAgICAgICAgICAgICBleHBlY3QgPSBleHBlY3RlZFtwYXJlbnRdO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCItXCI6XG4gICAgICAgICAgICAgIG9wZW5OdW1iZXIgPSB0cnVlO1xuICAgICAgICAgICAgICBpZiAoc3RyZWFtTnVtYmVycykge1xuICAgICAgICAgICAgICAgIHRva2Vucy5wdXNoKHsgbmFtZTogXCJzdGFydE51bWJlclwiIH0sIHsgbmFtZTogXCJudW1iZXJDaHVua1wiLCB2YWx1ZTogXCItXCIgfSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgcGFja051bWJlcnMgJiYgKGFjY3VtdWxhdG9yID0gXCItXCIpO1xuICAgICAgICAgICAgICBleHBlY3QgPSBcIm51bWJlclN0YXJ0XCI7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcIjBcIjpcbiAgICAgICAgICAgICAgb3Blbk51bWJlciA9IHRydWU7XG4gICAgICAgICAgICAgIGlmIChzdHJlYW1OdW1iZXJzKSB7XG4gICAgICAgICAgICAgICAgdG9rZW5zLnB1c2goeyBuYW1lOiBcInN0YXJ0TnVtYmVyXCIgfSwgeyBuYW1lOiBcIm51bWJlckNodW5rXCIsIHZhbHVlOiBcIjBcIiB9KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBwYWNrTnVtYmVycyAmJiAoYWNjdW11bGF0b3IgPSBcIjBcIik7XG4gICAgICAgICAgICAgIGV4cGVjdCA9IFwibnVtYmVyRnJhY3Rpb25cIjtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiMVwiOlxuICAgICAgICAgICAgY2FzZSBcIjJcIjpcbiAgICAgICAgICAgIGNhc2UgXCIzXCI6XG4gICAgICAgICAgICBjYXNlIFwiNFwiOlxuICAgICAgICAgICAgY2FzZSBcIjVcIjpcbiAgICAgICAgICAgIGNhc2UgXCI2XCI6XG4gICAgICAgICAgICBjYXNlIFwiN1wiOlxuICAgICAgICAgICAgY2FzZSBcIjhcIjpcbiAgICAgICAgICAgIGNhc2UgXCI5XCI6XG4gICAgICAgICAgICAgIG9wZW5OdW1iZXIgPSB0cnVlO1xuICAgICAgICAgICAgICBpZiAoc3RyZWFtTnVtYmVycykge1xuICAgICAgICAgICAgICAgIHRva2Vucy5wdXNoKHsgbmFtZTogXCJzdGFydE51bWJlclwiIH0sIHsgbmFtZTogXCJudW1iZXJDaHVua1wiLCB2YWx1ZTogdmFsdWUgfSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgcGFja051bWJlcnMgJiYgKGFjY3VtdWxhdG9yID0gdmFsdWUpO1xuICAgICAgICAgICAgICBleHBlY3QgPSBcIm51bWJlckRpZ2l0XCI7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcInRydWVcIjpcbiAgICAgICAgICAgIGNhc2UgXCJmYWxzZVwiOlxuICAgICAgICAgICAgY2FzZSBcIm51bGxcIjpcbiAgICAgICAgICAgICAgaWYgKGJ1ZmZlci5sZW5ndGggLSBpbmRleCA9PT0gdmFsdWUubGVuZ3RoICYmICFkb25lKSBicmVhayBtYWluOyAvLyB3YWl0IGZvciBtb3JlIGlucHV0XG4gICAgICAgICAgICAgIHRva2Vucy5wdXNoKHsgbmFtZTogdmFsdWUgKyBcIlZhbHVlXCIsIHZhbHVlOiB2YWx1ZXNbdmFsdWVdIH0pO1xuICAgICAgICAgICAgICBleHBlY3QgPSBleHBlY3RlZFtwYXJlbnRdO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIC8vIGRlZmF1bHQ6IC8vIHdzXG4gICAgICAgICAgfVxuICAgICAgICAgIGluZGV4ICs9IHZhbHVlLmxlbmd0aDtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBcImtleVZhbFwiOlxuICAgICAgICBjYXNlIFwic3RyaW5nXCI6XG4gICAgICAgICAgcGF0dGVybnMuc3RyaW5nLmxhc3RJbmRleCA9IGluZGV4O1xuICAgICAgICAgIG1hdGNoID0gcGF0dGVybnMuc3RyaW5nLmV4ZWMoYnVmZmVyKTtcbiAgICAgICAgICBpZiAoIW1hdGNoKSB7XG4gICAgICAgICAgICBpZiAoaW5kZXggPCBidWZmZXIubGVuZ3RoICYmIChkb25lIHx8IGJ1ZmZlci5sZW5ndGggLSBpbmRleCA+PSA2KSlcbiAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiUGFyc2VyIGNhbm5vdCBwYXJzZSBpbnB1dDogZXNjYXBlZCBjaGFyYWN0ZXJzXCIpO1xuICAgICAgICAgICAgaWYgKGRvbmUpIHRocm93IG5ldyBFcnJvcihcIlBhcnNlciBoYXMgZXhwZWN0ZWQgYSBzdHJpbmcgdmFsdWVcIik7XG4gICAgICAgICAgICBicmVhayBtYWluOyAvLyB3YWl0IGZvciBtb3JlIGlucHV0XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhbHVlID0gbWF0Y2hbMF07XG4gICAgICAgICAgaWYgKHZhbHVlID09PSAnXCInKSB7XG4gICAgICAgICAgICBpZiAoZXhwZWN0ID09PSBcImtleVZhbFwiKSB7XG4gICAgICAgICAgICAgIGlmIChzdHJlYW1LZXlzKSB0b2tlbnMucHVzaCh7IG5hbWU6IFwiZW5kS2V5XCIgfSk7XG4gICAgICAgICAgICAgIGlmIChwYWNrS2V5cykge1xuICAgICAgICAgICAgICAgIHRva2Vucy5wdXNoKHsgbmFtZTogXCJrZXlWYWx1ZVwiLCB2YWx1ZTogYWNjdW11bGF0b3IgfSk7XG4gICAgICAgICAgICAgICAgYWNjdW11bGF0b3IgPSBcIlwiO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGV4cGVjdCA9IFwiY29sb25cIjtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGlmIChzdHJlYW1TdHJpbmdzKSB0b2tlbnMucHVzaCh7IG5hbWU6IFwiZW5kU3RyaW5nXCIgfSk7XG4gICAgICAgICAgICAgIGlmIChwYWNrU3RyaW5ncykge1xuICAgICAgICAgICAgICAgIHRva2Vucy5wdXNoKHsgbmFtZTogXCJzdHJpbmdWYWx1ZVwiLCB2YWx1ZTogYWNjdW11bGF0b3IgfSk7XG4gICAgICAgICAgICAgICAgYWNjdW11bGF0b3IgPSBcIlwiO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGV4cGVjdCA9IGV4cGVjdGVkW3BhcmVudF07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIGlmICh2YWx1ZS5sZW5ndGggPiAxICYmIHZhbHVlLmNoYXJBdCgwKSA9PT0gXCJcXFxcXCIpIHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSB2YWx1ZS5sZW5ndGggPT0gMiA/IGNvZGVzW3ZhbHVlLmNoYXJBdCgxKV0gOiBmcm9tSGV4KHZhbHVlKTtcbiAgICAgICAgICAgIGlmIChleHBlY3QgPT09IFwia2V5VmFsXCIgPyBzdHJlYW1LZXlzIDogc3RyZWFtU3RyaW5ncykge1xuICAgICAgICAgICAgICB0b2tlbnMucHVzaCh7IG5hbWU6IFwic3RyaW5nQ2h1bmtcIiwgdmFsdWU6IHQgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZXhwZWN0ID09PSBcImtleVZhbFwiID8gcGFja0tleXMgOiBwYWNrU3RyaW5ncykge1xuICAgICAgICAgICAgICBhY2N1bXVsYXRvciArPSB0O1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAoZXhwZWN0ID09PSBcImtleVZhbFwiID8gc3RyZWFtS2V5cyA6IHN0cmVhbVN0cmluZ3MpIHtcbiAgICAgICAgICAgICAgdG9rZW5zLnB1c2goeyBuYW1lOiBcInN0cmluZ0NodW5rXCIsIHZhbHVlOiB2YWx1ZSB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChleHBlY3QgPT09IFwia2V5VmFsXCIgPyBwYWNrS2V5cyA6IHBhY2tTdHJpbmdzKSB7XG4gICAgICAgICAgICAgIGFjY3VtdWxhdG9yICs9IHZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICBpbmRleCArPSB2YWx1ZS5sZW5ndGg7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgXCJrZXkxXCI6XG4gICAgICAgIGNhc2UgXCJrZXlcIjpcbiAgICAgICAgICBwYXR0ZXJucy5rZXkxLmxhc3RJbmRleCA9IGluZGV4O1xuICAgICAgICAgIG1hdGNoID0gcGF0dGVybnMua2V5MS5leGVjKGJ1ZmZlcik7XG4gICAgICAgICAgaWYgKCFtYXRjaCkge1xuICAgICAgICAgICAgaWYgKGluZGV4IDwgYnVmZmVyLmxlbmd0aCB8fCBkb25lKSB0aHJvdyBuZXcgRXJyb3IoXCJQYXJzZXIgY2Fubm90IHBhcnNlIGlucHV0OiBleHBlY3RlZCBhbiBvYmplY3Qga2V5XCIpO1xuICAgICAgICAgICAgYnJlYWsgbWFpbjsgLy8gd2FpdCBmb3IgbW9yZSBpbnB1dFxuICAgICAgICAgIH1cbiAgICAgICAgICB2YWx1ZSA9IG1hdGNoWzBdO1xuICAgICAgICAgIGlmICh2YWx1ZSA9PT0gJ1wiJykge1xuICAgICAgICAgICAgaWYgKHN0cmVhbUtleXMpIHRva2Vucy5wdXNoKHsgbmFtZTogXCJzdGFydEtleVwiIH0pO1xuICAgICAgICAgICAgZXhwZWN0ID0gXCJrZXlWYWxcIjtcbiAgICAgICAgICB9IGVsc2UgaWYgKHZhbHVlID09PSBcIn1cIikge1xuICAgICAgICAgICAgaWYgKGV4cGVjdCAhPT0gXCJrZXkxXCIpIHRocm93IG5ldyBFcnJvcihcIlBhcnNlciBjYW5ub3QgcGFyc2UgaW5wdXQ6IHVuZXhwZWN0ZWQgdG9rZW4gJ30nXCIpO1xuICAgICAgICAgICAgdG9rZW5zLnB1c2goeyBuYW1lOiBcImVuZE9iamVjdFwiIH0pO1xuICAgICAgICAgICAgcGFyZW50ID0gc3RhY2sucG9wKCk7XG4gICAgICAgICAgICBleHBlY3QgPSBleHBlY3RlZFtwYXJlbnRdO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpbmRleCArPSB2YWx1ZS5sZW5ndGg7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgXCJjb2xvblwiOlxuICAgICAgICAgIHBhdHRlcm5zLmNvbG9uLmxhc3RJbmRleCA9IGluZGV4O1xuICAgICAgICAgIG1hdGNoID0gcGF0dGVybnMuY29sb24uZXhlYyhidWZmZXIpO1xuICAgICAgICAgIGlmICghbWF0Y2gpIHtcbiAgICAgICAgICAgIGlmIChpbmRleCA8IGJ1ZmZlci5sZW5ndGggfHwgZG9uZSkgdGhyb3cgbmV3IEVycm9yKFwiUGFyc2VyIGNhbm5vdCBwYXJzZSBpbnB1dDogZXhwZWN0ZWQgJzonXCIpO1xuICAgICAgICAgICAgYnJlYWsgbWFpbjsgLy8gd2FpdCBmb3IgbW9yZSBpbnB1dFxuICAgICAgICAgIH1cbiAgICAgICAgICB2YWx1ZSA9IG1hdGNoWzBdO1xuICAgICAgICAgIHZhbHVlID09PSBcIjpcIiAmJiAoZXhwZWN0ID0gXCJ2YWx1ZVwiKTtcbiAgICAgICAgICBpbmRleCArPSB2YWx1ZS5sZW5ndGg7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgXCJhcnJheVN0b3BcIjpcbiAgICAgICAgY2FzZSBcIm9iamVjdFN0b3BcIjpcbiAgICAgICAgICBwYXR0ZXJucy5jb21tYS5sYXN0SW5kZXggPSBpbmRleDtcbiAgICAgICAgICBtYXRjaCA9IHBhdHRlcm5zLmNvbW1hLmV4ZWMoYnVmZmVyKTtcbiAgICAgICAgICBpZiAoIW1hdGNoKSB7XG4gICAgICAgICAgICBpZiAoaW5kZXggPCBidWZmZXIubGVuZ3RoIHx8IGRvbmUpIHRocm93IG5ldyBFcnJvcihcIlBhcnNlciBjYW5ub3QgcGFyc2UgaW5wdXQ6IGV4cGVjdGVkICcsJ1wiKTtcbiAgICAgICAgICAgIGJyZWFrIG1haW47IC8vIHdhaXQgZm9yIG1vcmUgaW5wdXRcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKG9wZW5OdW1iZXIpIHtcbiAgICAgICAgICAgIGlmIChzdHJlYW1OdW1iZXJzKSB0b2tlbnMucHVzaCh7IG5hbWU6IFwiZW5kTnVtYmVyXCIgfSk7XG4gICAgICAgICAgICBvcGVuTnVtYmVyID0gZmFsc2U7XG4gICAgICAgICAgICBpZiAocGFja051bWJlcnMpIHtcbiAgICAgICAgICAgICAgdG9rZW5zLnB1c2goeyBuYW1lOiBcIm51bWJlclZhbHVlXCIsIHZhbHVlOiBhY2N1bXVsYXRvciB9KTtcbiAgICAgICAgICAgICAgYWNjdW11bGF0b3IgPSBcIlwiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICB2YWx1ZSA9IG1hdGNoWzBdO1xuICAgICAgICAgIGlmICh2YWx1ZSA9PT0gXCIsXCIpIHtcbiAgICAgICAgICAgIGV4cGVjdCA9IGV4cGVjdCA9PT0gXCJhcnJheVN0b3BcIiA/IFwidmFsdWVcIiA6IFwia2V5XCI7XG4gICAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSA9PT0gXCJ9XCIgfHwgdmFsdWUgPT09IFwiXVwiKSB7XG4gICAgICAgICAgICBpZiAodmFsdWUgPT09IFwifVwiID8gZXhwZWN0ID09PSBcImFycmF5U3RvcFwiIDogZXhwZWN0ICE9PSBcImFycmF5U3RvcFwiKSB7XG4gICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlBhcnNlciBjYW5ub3QgcGFyc2UgaW5wdXQ6IGV4cGVjdGVkICdcIiArIChleHBlY3QgPT09IFwiYXJyYXlTdG9wXCIgPyBcIl1cIiA6IFwifVwiKSArIFwiJ1wiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRva2Vucy5wdXNoKHsgbmFtZTogdmFsdWUgPT09IFwifVwiID8gXCJlbmRPYmplY3RcIiA6IFwiZW5kQXJyYXlcIiB9KTtcbiAgICAgICAgICAgIHBhcmVudCA9IHN0YWNrLnBvcCgpO1xuICAgICAgICAgICAgZXhwZWN0ID0gZXhwZWN0ZWRbcGFyZW50XTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaW5kZXggKz0gdmFsdWUubGVuZ3RoO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICAvLyBudW1iZXIgY2h1bmtzXG4gICAgICAgIGNhc2UgXCJudW1iZXJTdGFydFwiOiAvLyBbMC05XVxuICAgICAgICAgIHBhdHRlcm5zLm51bWJlclN0YXJ0Lmxhc3RJbmRleCA9IGluZGV4O1xuICAgICAgICAgIG1hdGNoID0gcGF0dGVybnMubnVtYmVyU3RhcnQuZXhlYyhidWZmZXIpO1xuICAgICAgICAgIGlmICghbWF0Y2gpIHtcbiAgICAgICAgICAgIGlmIChpbmRleCA8IGJ1ZmZlci5sZW5ndGggfHwgZG9uZSkgdGhyb3cgbmV3IEVycm9yKFwiUGFyc2VyIGNhbm5vdCBwYXJzZSBpbnB1dDogZXhwZWN0ZWQgYSBzdGFydGluZyBkaWdpdFwiKTtcbiAgICAgICAgICAgIGJyZWFrIG1haW47IC8vIHdhaXQgZm9yIG1vcmUgaW5wdXRcbiAgICAgICAgICB9XG4gICAgICAgICAgdmFsdWUgPSBtYXRjaFswXTtcbiAgICAgICAgICBpZiAoc3RyZWFtTnVtYmVycykgdG9rZW5zLnB1c2goeyBuYW1lOiBcIm51bWJlckNodW5rXCIsIHZhbHVlOiB2YWx1ZSB9KTtcbiAgICAgICAgICBwYWNrTnVtYmVycyAmJiAoYWNjdW11bGF0b3IgKz0gdmFsdWUpO1xuICAgICAgICAgIGV4cGVjdCA9IHZhbHVlID09PSBcIjBcIiA/IFwibnVtYmVyRnJhY3Rpb25cIiA6IFwibnVtYmVyRGlnaXRcIjtcbiAgICAgICAgICBpbmRleCArPSB2YWx1ZS5sZW5ndGg7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgXCJudW1iZXJEaWdpdFwiOiAvLyBbMC05XSpcbiAgICAgICAgICBwYXR0ZXJucy5udW1iZXJEaWdpdC5sYXN0SW5kZXggPSBpbmRleDtcbiAgICAgICAgICBtYXRjaCA9IHBhdHRlcm5zLm51bWJlckRpZ2l0LmV4ZWMoYnVmZmVyKTtcbiAgICAgICAgICBpZiAoIW1hdGNoKSB7XG4gICAgICAgICAgICBpZiAoaW5kZXggPCBidWZmZXIubGVuZ3RoIHx8IGRvbmUpIHRocm93IG5ldyBFcnJvcihcIlBhcnNlciBjYW5ub3QgcGFyc2UgaW5wdXQ6IGV4cGVjdGVkIGEgZGlnaXRcIik7XG4gICAgICAgICAgICBicmVhayBtYWluOyAvLyB3YWl0IGZvciBtb3JlIGlucHV0XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhbHVlID0gbWF0Y2hbMF07XG4gICAgICAgICAgaWYgKHZhbHVlKSB7XG4gICAgICAgICAgICBpZiAoc3RyZWFtTnVtYmVycykgdG9rZW5zLnB1c2goeyBuYW1lOiBcIm51bWJlckNodW5rXCIsIHZhbHVlOiB2YWx1ZSB9KTtcbiAgICAgICAgICAgIHBhY2tOdW1iZXJzICYmIChhY2N1bXVsYXRvciArPSB2YWx1ZSk7XG4gICAgICAgICAgICBpbmRleCArPSB2YWx1ZS5sZW5ndGg7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmIChpbmRleCA8IGJ1ZmZlci5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgZXhwZWN0ID0gXCJudW1iZXJGcmFjdGlvblwiO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChkb25lKSB7XG4gICAgICAgICAgICAgIGV4cGVjdCA9IGV4cGVjdGVkW3BhcmVudF07XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYnJlYWsgbWFpbjsgLy8gd2FpdCBmb3IgbW9yZSBpbnB1dFxuICAgICAgICAgIH1cbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBcIm51bWJlckZyYWN0aW9uXCI6IC8vIFtcXC5lRV0/XG4gICAgICAgICAgcGF0dGVybnMubnVtYmVyRnJhY3Rpb24ubGFzdEluZGV4ID0gaW5kZXg7XG4gICAgICAgICAgbWF0Y2ggPSBwYXR0ZXJucy5udW1iZXJGcmFjdGlvbi5leGVjKGJ1ZmZlcik7XG4gICAgICAgICAgaWYgKCFtYXRjaCkge1xuICAgICAgICAgICAgaWYgKGluZGV4IDwgYnVmZmVyLmxlbmd0aCB8fCBkb25lKSB7XG4gICAgICAgICAgICAgIGV4cGVjdCA9IGV4cGVjdGVkW3BhcmVudF07XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYnJlYWsgbWFpbjsgLy8gd2FpdCBmb3IgbW9yZSBpbnB1dFxuICAgICAgICAgIH1cbiAgICAgICAgICB2YWx1ZSA9IG1hdGNoWzBdO1xuICAgICAgICAgIGlmIChzdHJlYW1OdW1iZXJzKSB0b2tlbnMucHVzaCh7IG5hbWU6IFwibnVtYmVyQ2h1bmtcIiwgdmFsdWU6IHZhbHVlIH0pO1xuICAgICAgICAgIHBhY2tOdW1iZXJzICYmIChhY2N1bXVsYXRvciArPSB2YWx1ZSk7XG4gICAgICAgICAgZXhwZWN0ID0gdmFsdWUgPT09IFwiLlwiID8gXCJudW1iZXJGcmFjU3RhcnRcIiA6IFwibnVtYmVyRXhwU2lnblwiO1xuICAgICAgICAgIGluZGV4ICs9IHZhbHVlLmxlbmd0aDtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBcIm51bWJlckZyYWNTdGFydFwiOiAvLyBbMC05XVxuICAgICAgICAgIHBhdHRlcm5zLm51bWJlclN0YXJ0Lmxhc3RJbmRleCA9IGluZGV4O1xuICAgICAgICAgIG1hdGNoID0gcGF0dGVybnMubnVtYmVyU3RhcnQuZXhlYyhidWZmZXIpO1xuICAgICAgICAgIGlmICghbWF0Y2gpIHtcbiAgICAgICAgICAgIGlmIChpbmRleCA8IGJ1ZmZlci5sZW5ndGggfHwgZG9uZSlcbiAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiUGFyc2VyIGNhbm5vdCBwYXJzZSBpbnB1dDogZXhwZWN0ZWQgYSBmcmFjdGlvbmFsIHBhcnQgb2YgYSBudW1iZXJcIik7XG4gICAgICAgICAgICBicmVhayBtYWluOyAvLyB3YWl0IGZvciBtb3JlIGlucHV0XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhbHVlID0gbWF0Y2hbMF07XG4gICAgICAgICAgaWYgKHN0cmVhbU51bWJlcnMpIHRva2Vucy5wdXNoKHsgbmFtZTogXCJudW1iZXJDaHVua1wiLCB2YWx1ZTogdmFsdWUgfSk7XG4gICAgICAgICAgcGFja051bWJlcnMgJiYgKGFjY3VtdWxhdG9yICs9IHZhbHVlKTtcbiAgICAgICAgICBleHBlY3QgPSBcIm51bWJlckZyYWNEaWdpdFwiO1xuICAgICAgICAgIGluZGV4ICs9IHZhbHVlLmxlbmd0aDtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBcIm51bWJlckZyYWNEaWdpdFwiOiAvLyBbMC05XSpcbiAgICAgICAgICBwYXR0ZXJucy5udW1iZXJEaWdpdC5sYXN0SW5kZXggPSBpbmRleDtcbiAgICAgICAgICBtYXRjaCA9IHBhdHRlcm5zLm51bWJlckRpZ2l0LmV4ZWMoYnVmZmVyKTtcbiAgICAgICAgICB2YWx1ZSA9IG1hdGNoWzBdO1xuICAgICAgICAgIGlmICh2YWx1ZSkge1xuICAgICAgICAgICAgaWYgKHN0cmVhbU51bWJlcnMpIHRva2Vucy5wdXNoKHsgbmFtZTogXCJudW1iZXJDaHVua1wiLCB2YWx1ZTogdmFsdWUgfSk7XG4gICAgICAgICAgICBwYWNrTnVtYmVycyAmJiAoYWNjdW11bGF0b3IgKz0gdmFsdWUpO1xuICAgICAgICAgICAgaW5kZXggKz0gdmFsdWUubGVuZ3RoO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAoaW5kZXggPCBidWZmZXIubGVuZ3RoKSB7XG4gICAgICAgICAgICAgIGV4cGVjdCA9IFwibnVtYmVyRXhwb25lbnRcIjtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZG9uZSkge1xuICAgICAgICAgICAgICBleHBlY3QgPSBleHBlY3RlZFtwYXJlbnRdO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGJyZWFrIG1haW47IC8vIHdhaXQgZm9yIG1vcmUgaW5wdXRcbiAgICAgICAgICB9XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgXCJudW1iZXJFeHBvbmVudFwiOiAvLyBbZUVdP1xuICAgICAgICAgIHBhdHRlcm5zLm51bWJlckV4cG9uZW50Lmxhc3RJbmRleCA9IGluZGV4O1xuICAgICAgICAgIG1hdGNoID0gcGF0dGVybnMubnVtYmVyRXhwb25lbnQuZXhlYyhidWZmZXIpO1xuICAgICAgICAgIGlmICghbWF0Y2gpIHtcbiAgICAgICAgICAgIGlmIChpbmRleCA8IGJ1ZmZlci5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgZXhwZWN0ID0gZXhwZWN0ZWRbcGFyZW50XTtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZG9uZSkge1xuICAgICAgICAgICAgICBleHBlY3QgPSBcImRvbmVcIjtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBicmVhayBtYWluOyAvLyB3YWl0IGZvciBtb3JlIGlucHV0XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhbHVlID0gbWF0Y2hbMF07XG4gICAgICAgICAgaWYgKHN0cmVhbU51bWJlcnMpIHRva2Vucy5wdXNoKHsgbmFtZTogXCJudW1iZXJDaHVua1wiLCB2YWx1ZTogdmFsdWUgfSk7XG4gICAgICAgICAgcGFja051bWJlcnMgJiYgKGFjY3VtdWxhdG9yICs9IHZhbHVlKTtcbiAgICAgICAgICBleHBlY3QgPSBcIm51bWJlckV4cFNpZ25cIjtcbiAgICAgICAgICBpbmRleCArPSB2YWx1ZS5sZW5ndGg7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgXCJudW1iZXJFeHBTaWduXCI6IC8vIFstK10/XG4gICAgICAgICAgcGF0dGVybnMubnVtYmVyRXhwU2lnbi5sYXN0SW5kZXggPSBpbmRleDtcbiAgICAgICAgICBtYXRjaCA9IHBhdHRlcm5zLm51bWJlckV4cFNpZ24uZXhlYyhidWZmZXIpO1xuICAgICAgICAgIGlmICghbWF0Y2gpIHtcbiAgICAgICAgICAgIGlmIChpbmRleCA8IGJ1ZmZlci5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgZXhwZWN0ID0gXCJudW1iZXJFeHBTdGFydFwiO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChkb25lKSB0aHJvdyBuZXcgRXJyb3IoXCJQYXJzZXIgaGFzIGV4cGVjdGVkIGFuIGV4cG9uZW50IHZhbHVlIG9mIGEgbnVtYmVyXCIpO1xuICAgICAgICAgICAgYnJlYWsgbWFpbjsgLy8gd2FpdCBmb3IgbW9yZSBpbnB1dFxuICAgICAgICAgIH1cbiAgICAgICAgICB2YWx1ZSA9IG1hdGNoWzBdO1xuICAgICAgICAgIGlmIChzdHJlYW1OdW1iZXJzKSB0b2tlbnMucHVzaCh7IG5hbWU6IFwibnVtYmVyQ2h1bmtcIiwgdmFsdWU6IHZhbHVlIH0pO1xuICAgICAgICAgIHBhY2tOdW1iZXJzICYmIChhY2N1bXVsYXRvciArPSB2YWx1ZSk7XG4gICAgICAgICAgZXhwZWN0ID0gXCJudW1iZXJFeHBTdGFydFwiO1xuICAgICAgICAgIGluZGV4ICs9IHZhbHVlLmxlbmd0aDtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBcIm51bWJlckV4cFN0YXJ0XCI6IC8vIFswLTldXG4gICAgICAgICAgcGF0dGVybnMubnVtYmVyU3RhcnQubGFzdEluZGV4ID0gaW5kZXg7XG4gICAgICAgICAgbWF0Y2ggPSBwYXR0ZXJucy5udW1iZXJTdGFydC5leGVjKGJ1ZmZlcik7XG4gICAgICAgICAgaWYgKCFtYXRjaCkge1xuICAgICAgICAgICAgaWYgKGluZGV4IDwgYnVmZmVyLmxlbmd0aCB8fCBkb25lKVxuICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJQYXJzZXIgY2Fubm90IHBhcnNlIGlucHV0OiBleHBlY3RlZCBhbiBleHBvbmVudCBwYXJ0IG9mIGEgbnVtYmVyXCIpO1xuICAgICAgICAgICAgYnJlYWsgbWFpbjsgLy8gd2FpdCBmb3IgbW9yZSBpbnB1dFxuICAgICAgICAgIH1cbiAgICAgICAgICB2YWx1ZSA9IG1hdGNoWzBdO1xuICAgICAgICAgIGlmIChzdHJlYW1OdW1iZXJzKSB0b2tlbnMucHVzaCh7IG5hbWU6IFwibnVtYmVyQ2h1bmtcIiwgdmFsdWU6IHZhbHVlIH0pO1xuICAgICAgICAgIHBhY2tOdW1iZXJzICYmIChhY2N1bXVsYXRvciArPSB2YWx1ZSk7XG4gICAgICAgICAgZXhwZWN0ID0gXCJudW1iZXJFeHBEaWdpdFwiO1xuICAgICAgICAgIGluZGV4ICs9IHZhbHVlLmxlbmd0aDtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBcIm51bWJlckV4cERpZ2l0XCI6IC8vIFswLTldKlxuICAgICAgICAgIHBhdHRlcm5zLm51bWJlckRpZ2l0Lmxhc3RJbmRleCA9IGluZGV4O1xuICAgICAgICAgIG1hdGNoID0gcGF0dGVybnMubnVtYmVyRGlnaXQuZXhlYyhidWZmZXIpO1xuICAgICAgICAgIHZhbHVlID0gbWF0Y2hbMF07XG4gICAgICAgICAgaWYgKHZhbHVlKSB7XG4gICAgICAgICAgICBpZiAoc3RyZWFtTnVtYmVycykgdG9rZW5zLnB1c2goeyBuYW1lOiBcIm51bWJlckNodW5rXCIsIHZhbHVlOiB2YWx1ZSB9KTtcbiAgICAgICAgICAgIHBhY2tOdW1iZXJzICYmIChhY2N1bXVsYXRvciArPSB2YWx1ZSk7XG4gICAgICAgICAgICBpbmRleCArPSB2YWx1ZS5sZW5ndGg7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmIChpbmRleCA8IGJ1ZmZlci5sZW5ndGggfHwgZG9uZSkge1xuICAgICAgICAgICAgICBleHBlY3QgPSBleHBlY3RlZFtwYXJlbnRdO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGJyZWFrIG1haW47IC8vIHdhaXQgZm9yIG1vcmUgaW5wdXRcbiAgICAgICAgICB9XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgXCJkb25lXCI6XG4gICAgICAgICAgcGF0dGVybnMud3MubGFzdEluZGV4ID0gaW5kZXg7XG4gICAgICAgICAgbWF0Y2ggPSBwYXR0ZXJucy53cy5leGVjKGJ1ZmZlcik7XG4gICAgICAgICAgaWYgKCFtYXRjaCkge1xuICAgICAgICAgICAgaWYgKGluZGV4IDwgYnVmZmVyLmxlbmd0aCkge1xuICAgICAgICAgICAgICBpZiAoanNvblN0cmVhbWluZykge1xuICAgICAgICAgICAgICAgIGV4cGVjdCA9IFwidmFsdWVcIjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJQYXJzZXIgY2Fubm90IHBhcnNlIGlucHV0OiB1bmV4cGVjdGVkIGNoYXJhY3RlcnNcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBicmVhayBtYWluOyAvLyB3YWl0IGZvciBtb3JlIGlucHV0XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhbHVlID0gbWF0Y2hbMF07XG4gICAgICAgICAgaWYgKG9wZW5OdW1iZXIpIHtcbiAgICAgICAgICAgIGlmIChzdHJlYW1OdW1iZXJzKSB0b2tlbnMucHVzaCh7IG5hbWU6IFwiZW5kTnVtYmVyXCIgfSk7XG4gICAgICAgICAgICBvcGVuTnVtYmVyID0gZmFsc2U7XG4gICAgICAgICAgICBpZiAocGFja051bWJlcnMpIHtcbiAgICAgICAgICAgICAgdG9rZW5zLnB1c2goeyBuYW1lOiBcIm51bWJlclZhbHVlXCIsIHZhbHVlOiBhY2N1bXVsYXRvciB9KTtcbiAgICAgICAgICAgICAgYWNjdW11bGF0b3IgPSBcIlwiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICBpbmRleCArPSB2YWx1ZS5sZW5ndGg7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChkb25lICYmIG9wZW5OdW1iZXIpIHtcbiAgICAgIGlmIChzdHJlYW1OdW1iZXJzKSB0b2tlbnMucHVzaCh7IG5hbWU6IFwiZW5kTnVtYmVyXCIgfSk7XG4gICAgICBvcGVuTnVtYmVyID0gZmFsc2U7XG4gICAgICBpZiAocGFja051bWJlcnMpIHtcbiAgICAgICAgdG9rZW5zLnB1c2goeyBuYW1lOiBcIm51bWJlclZhbHVlXCIsIHZhbHVlOiBhY2N1bXVsYXRvciB9KTtcbiAgICAgICAgYWNjdW11bGF0b3IgPSBcIlwiO1xuICAgICAgfVxuICAgIH1cbiAgICBidWZmZXIgPSBidWZmZXIuc2xpY2UoaW5kZXgpO1xuICAgIHJldHVybiB0b2tlbnMubGVuZ3RoID8gbWFueSh0b2tlbnMpIDogbm9uZTtcbiAgfSk7XG59O1xuXG5leHBvcnQgY29uc3QgcGFyc2VyID0gKG9wdGlvbnM/OiBhbnkpID0+IGdlbihmaXhVdGY4U3RyZWFtKCksIGpzb25QYXJzZXIob3B0aW9ucykpO1xuXG5jb25zdCB3aXRoUGFyc2VyID0gKGZuOiBhbnksIG9wdGlvbnM/OiBhbnkpID0+IGdlbihwYXJzZXIob3B0aW9ucyksIGZuKG9wdGlvbnMpKTtcblxuY29uc3QgY2hlY2thYmxlVG9rZW5zID0ge1xuICAgIHN0YXJ0T2JqZWN0OiAxLFxuICAgIHN0YXJ0QXJyYXk6IDEsXG4gICAgc3RhcnRTdHJpbmc6IDEsXG4gICAgc3RhcnROdW1iZXI6IDEsXG4gICAgbnVsbFZhbHVlOiAxLFxuICAgIHRydWVWYWx1ZTogMSxcbiAgICBmYWxzZVZhbHVlOiAxLFxuICAgIHN0cmluZ1ZhbHVlOiAxLFxuICAgIG51bWJlclZhbHVlOiAxLFxuICB9LFxuICBzdG9wVG9rZW5zID0ge1xuICAgIHN0YXJ0T2JqZWN0OiBcImVuZE9iamVjdFwiLFxuICAgIHN0YXJ0QXJyYXk6IFwiZW5kQXJyYXlcIixcbiAgICBzdGFydFN0cmluZzogXCJlbmRTdHJpbmdcIixcbiAgICBzdGFydE51bWJlcjogXCJlbmROdW1iZXJcIixcbiAgfSxcbiAgb3B0aW9uYWxUb2tlbnMgPSB7IGVuZFN0cmluZzogXCJzdHJpbmdWYWx1ZVwiLCBlbmROdW1iZXI6IFwibnVtYmVyVmFsdWVcIiB9O1xuXG5jb25zdCBkZWZhdWx0RmlsdGVyID0gKF9zdGFjazogc3RyaW5nW10sIF9hOiBhbnkpID0+IHRydWU7XG5cbmNvbnN0IHN0cmluZ0ZpbHRlciA9IChzdHJpbmc6IHN0cmluZywgc2VwYXJhdG9yOiBzdHJpbmcpID0+IHtcbiAgY29uc3Qgc3RyaW5nV2l0aFNlcGFyYXRvciA9IHN0cmluZyArIHNlcGFyYXRvcjtcbiAgcmV0dXJuIChzdGFjazogc3RyaW5nW10sIF9hOiBhbnkpID0+IHtcbiAgICBjb25zdCBwYXRoID0gc3RhY2suam9pbihzZXBhcmF0b3IpO1xuICAgIHJldHVybiBwYXRoID09PSBzdHJpbmcgfHwgcGF0aC5zdGFydHNXaXRoKHN0cmluZ1dpdGhTZXBhcmF0b3IpO1xuICB9O1xufTtcblxuY29uc3QgcmVnRXhwRmlsdGVyID0gKHJlZ0V4cDogUmVnRXhwLCBzZXBhcmF0b3I6IHN0cmluZykgPT4ge1xuICByZXR1cm4gKHN0YWNrOiBzdHJpbmdbXSwgX2E6IGFueSkgPT4gcmVnRXhwLnRlc3Qoc3RhY2suam9pbihzZXBhcmF0b3IpKTtcbn07XG5cbmNvbnN0IGZpbHRlckJhc2UgPVxuICAoe1xuICAgIHNwZWNpYWxBY3Rpb24gPSBcImFjY2VwdFwiLFxuICAgIGRlZmF1bHRBY3Rpb24gPSBcImlnbm9yZVwiLFxuICAgIG5vbkNoZWNrYWJsZUFjdGlvbiA9IFwicHJvY2Vzcy1rZXlcIixcbiAgICB0cmFuc2l0aW9uID0gdW5kZWZpbmVkIGFzIGFueSxcbiAgfSA9IHt9KSA9PlxuICAob3B0aW9uczogYW55KSA9PiB7XG4gICAgY29uc3Qgb25jZSA9IG9wdGlvbnM/Lm9uY2UsXG4gICAgICBzZXBhcmF0b3IgPSBvcHRpb25zPy5wYXRoU2VwYXJhdG9yIHx8IFwiLlwiO1xuICAgIGxldCBmaWx0ZXIgPSBkZWZhdWx0RmlsdGVyLFxuICAgICAgc3RyZWFtS2V5cyA9IHRydWU7XG4gICAgaWYgKG9wdGlvbnMpIHtcbiAgICAgIGlmICh0eXBlb2Ygb3B0aW9ucy5maWx0ZXIgPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgIGZpbHRlciA9IG9wdGlvbnMuZmlsdGVyO1xuICAgICAgfSBlbHNlIGlmICh0eXBlb2Ygb3B0aW9ucy5maWx0ZXIgPT0gXCJzdHJpbmdcIikge1xuICAgICAgICBmaWx0ZXIgPSBzdHJpbmdGaWx0ZXIob3B0aW9ucy5maWx0ZXIsIHNlcGFyYXRvcik7XG4gICAgICB9IGVsc2UgaWYgKG9wdGlvbnMuZmlsdGVyIGluc3RhbmNlb2YgUmVnRXhwKSB7XG4gICAgICAgIGZpbHRlciA9IHJlZ0V4cEZpbHRlcihvcHRpb25zLmZpbHRlciwgc2VwYXJhdG9yKTtcbiAgICAgIH1cbiAgICAgIGlmIChcInN0cmVhbVZhbHVlc1wiIGluIG9wdGlvbnMpIHN0cmVhbUtleXMgPSBvcHRpb25zLnN0cmVhbVZhbHVlcztcbiAgICAgIGlmIChcInN0cmVhbUtleXNcIiBpbiBvcHRpb25zKSBzdHJlYW1LZXlzID0gb3B0aW9ucy5zdHJlYW1LZXlzO1xuICAgIH1cbiAgICBjb25zdCBzYW5pdGl6ZWRPcHRpb25zID0gT2JqZWN0LmFzc2lnbih7fSwgb3B0aW9ucywgeyBmaWx0ZXIsIHN0cmVhbUtleXMsIHNlcGFyYXRvciB9KTtcbiAgICBsZXQgc3RhdGUgPSBcImNoZWNrXCI7XG4gICAgY29uc3Qgc3RhY2s6IGFueVtdID0gW107XG4gICAgbGV0IGRlcHRoID0gMCxcbiAgICAgIHByZXZpb3VzVG9rZW4gPSBcIlwiLFxuICAgICAgZW5kVG9rZW4gPSBcIlwiLFxuICAgICAgb3B0aW9uYWxUb2tlbiA9IFwiXCIsXG4gICAgICBzdGFydFRyYW5zaXRpb24gPSBmYWxzZTtcbiAgICByZXR1cm4gZmx1c2hhYmxlKChjaHVuaykgPT4ge1xuICAgICAgLy8gdGhlIGZsdXNoXG4gICAgICBpZiAoY2h1bmsgPT09IG5vbmUpIHJldHVybiB0cmFuc2l0aW9uID8gdHJhbnNpdGlvbihbXSwgbnVsbCwgXCJmbHVzaFwiLCBzYW5pdGl6ZWRPcHRpb25zKSA6IG5vbmU7XG5cbiAgICAgIC8vIHByb2Nlc3MgdGhlIG9wdGlvbmFsIHZhbHVlIHRva2VuICh1bmZpbmlzaGVkKVxuICAgICAgaWYgKG9wdGlvbmFsVG9rZW4pIHtcbiAgICAgICAgaWYgKG9wdGlvbmFsVG9rZW4gPT09IGNodW5rLm5hbWUpIHtcbiAgICAgICAgICBsZXQgcmV0dXJuVG9rZW4gPSBub25lO1xuICAgICAgICAgIHN3aXRjaCAoc3RhdGUpIHtcbiAgICAgICAgICAgIGNhc2UgXCJwcm9jZXNzLWtleVwiOlxuICAgICAgICAgICAgICBzdGFja1tzdGFjay5sZW5ndGggLSAxXSA9IGNodW5rLnZhbHVlO1xuICAgICAgICAgICAgICBzdGF0ZSA9IFwiY2hlY2tcIjtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiYWNjZXB0LXZhbHVlXCI6XG4gICAgICAgICAgICAgIHJldHVyblRva2VuID0gY2h1bms7XG4gICAgICAgICAgICAgIHN0YXRlID0gb25jZSA/IFwicGFzc1wiIDogXCJjaGVja1wiO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgIHN0YXRlID0gb25jZSA/IFwiYWxsXCIgOiBcImNoZWNrXCI7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBvcHRpb25hbFRva2VuID0gXCJcIjtcbiAgICAgICAgICByZXR1cm4gcmV0dXJuVG9rZW47XG4gICAgICAgIH1cbiAgICAgICAgb3B0aW9uYWxUb2tlbiA9IFwiXCI7XG4gICAgICAgIHN0YXRlID0gb25jZSAmJiBzdGF0ZSAhPT0gXCJwcm9jZXNzLWtleVwiID8gXCJwYXNzXCIgOiBcImNoZWNrXCI7XG4gICAgICB9XG5cbiAgICAgIGxldCByZXR1cm5Ub2tlbjogYW55ID0gbm9uZTtcblxuICAgICAgcmVjaGVjazogZm9yICg7Oykge1xuICAgICAgICAvLyBhY2NlcHQvcmVqZWN0IHRva2Vuc1xuICAgICAgICBzd2l0Y2ggKHN0YXRlKSB7XG4gICAgICAgICAgY2FzZSBcInByb2Nlc3Mta2V5XCI6XG4gICAgICAgICAgICBpZiAoY2h1bmsubmFtZSA9PT0gXCJlbmRLZXlcIikgb3B0aW9uYWxUb2tlbiA9IFwia2V5VmFsdWVcIjtcbiAgICAgICAgICAgIHJldHVybiBub25lO1xuICAgICAgICAgIGNhc2UgXCJwYXNzXCI6XG4gICAgICAgICAgICByZXR1cm4gbm9uZTtcbiAgICAgICAgICBjYXNlIFwiYWxsXCI6XG4gICAgICAgICAgICByZXR1cm4gY2h1bms7XG4gICAgICAgICAgY2FzZSBcImFjY2VwdFwiOlxuICAgICAgICAgIGNhc2UgXCJyZWplY3RcIjpcbiAgICAgICAgICAgIGlmIChzdGFydFRyYW5zaXRpb24pIHtcbiAgICAgICAgICAgICAgc3RhcnRUcmFuc2l0aW9uID0gZmFsc2U7XG4gICAgICAgICAgICAgIHJldHVyblRva2VuID0gdHJhbnNpdGlvbihzdGFjaywgY2h1bmssIHN0YXRlLCBzYW5pdGl6ZWRPcHRpb25zKSB8fCBub25lO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc3dpdGNoIChjaHVuay5uYW1lKSB7XG4gICAgICAgICAgICAgIGNhc2UgXCJzdGFydE9iamVjdFwiOlxuICAgICAgICAgICAgICBjYXNlIFwic3RhcnRBcnJheVwiOlxuICAgICAgICAgICAgICAgICsrZGVwdGg7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgIGNhc2UgXCJlbmRPYmplY3RcIjpcbiAgICAgICAgICAgICAgY2FzZSBcImVuZEFycmF5XCI6XG4gICAgICAgICAgICAgICAgLS1kZXB0aDtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChzdGF0ZSA9PT0gXCJhY2NlcHRcIikge1xuICAgICAgICAgICAgICByZXR1cm5Ub2tlbiA9IGNvbWJpbmVNYW55TXV0KHJldHVyblRva2VuLCBjaHVuayk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIWRlcHRoKSB7XG4gICAgICAgICAgICAgIGlmIChvbmNlKSB7XG4gICAgICAgICAgICAgICAgc3RhdGUgPSBzdGF0ZSA9PT0gXCJhY2NlcHRcIiA/IFwicGFzc1wiIDogXCJhbGxcIjtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBzdGF0ZSA9IFwiY2hlY2tcIjtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJldHVyblRva2VuO1xuICAgICAgICAgIGNhc2UgXCJhY2NlcHQtdmFsdWVcIjpcbiAgICAgICAgICBjYXNlIFwicmVqZWN0LXZhbHVlXCI6XG4gICAgICAgICAgICBpZiAoc3RhcnRUcmFuc2l0aW9uKSB7XG4gICAgICAgICAgICAgIHN0YXJ0VHJhbnNpdGlvbiA9IGZhbHNlO1xuICAgICAgICAgICAgICByZXR1cm5Ub2tlbiA9IHRyYW5zaXRpb24oc3RhY2ssIGNodW5rLCBzdGF0ZSwgc2FuaXRpemVkT3B0aW9ucykgfHwgbm9uZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChzdGF0ZSA9PT0gXCJhY2NlcHQtdmFsdWVcIikge1xuICAgICAgICAgICAgICByZXR1cm5Ub2tlbiA9IGNvbWJpbmVNYW55TXV0KHJldHVyblRva2VuLCBjaHVuayk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoY2h1bmsubmFtZSA9PT0gZW5kVG9rZW4pIHtcbiAgICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgICBvcHRpb25hbFRva2VuID0gb3B0aW9uYWxUb2tlbnNbZW5kVG9rZW5dIHx8IFwiXCI7XG4gICAgICAgICAgICAgIGVuZFRva2VuID0gXCJcIjtcbiAgICAgICAgICAgICAgaWYgKCFvcHRpb25hbFRva2VuKSB7XG4gICAgICAgICAgICAgICAgaWYgKG9uY2UpIHtcbiAgICAgICAgICAgICAgICAgIHN0YXRlID0gc3RhdGUgPT09IFwiYWNjZXB0LXZhbHVlXCIgPyBcInBhc3NcIiA6IFwiYWxsXCI7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgIHN0YXRlID0gXCJjaGVja1wiO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJldHVyblRva2VuO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gdXBkYXRlIHRoZSBsYXN0IGluZGV4IGluIHRoZSBzdGFja1xuICAgICAgICBpZiAodHlwZW9mIHN0YWNrW3N0YWNrLmxlbmd0aCAtIDFdID09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgICAvLyBhcnJheVxuICAgICAgICAgIHN3aXRjaCAoY2h1bmsubmFtZSkge1xuICAgICAgICAgICAgY2FzZSBcInN0YXJ0T2JqZWN0XCI6XG4gICAgICAgICAgICBjYXNlIFwic3RhcnRBcnJheVwiOlxuICAgICAgICAgICAgY2FzZSBcInN0YXJ0U3RyaW5nXCI6XG4gICAgICAgICAgICBjYXNlIFwic3RhcnROdW1iZXJcIjpcbiAgICAgICAgICAgIGNhc2UgXCJudWxsVmFsdWVcIjpcbiAgICAgICAgICAgIGNhc2UgXCJ0cnVlVmFsdWVcIjpcbiAgICAgICAgICAgIGNhc2UgXCJmYWxzZVZhbHVlXCI6XG4gICAgICAgICAgICAgICsrc3RhY2tbc3RhY2subGVuZ3RoIC0gMV07XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcIm51bWJlclZhbHVlXCI6XG4gICAgICAgICAgICAgIGlmIChwcmV2aW91c1Rva2VuICE9PSBcImVuZE51bWJlclwiKSArK3N0YWNrW3N0YWNrLmxlbmd0aCAtIDFdO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJzdHJpbmdWYWx1ZVwiOlxuICAgICAgICAgICAgICBpZiAocHJldmlvdXNUb2tlbiAhPT0gXCJlbmRTdHJpbmdcIikgKytzdGFja1tzdGFjay5sZW5ndGggLSAxXTtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlmIChjaHVuay5uYW1lID09PSBcImtleVZhbHVlXCIpIHN0YWNrW3N0YWNrLmxlbmd0aCAtIDFdID0gY2h1bmsudmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgcHJldmlvdXNUb2tlbiA9IGNodW5rLm5hbWU7XG5cbiAgICAgICAgLy8gY2hlY2sgdGhlIHRva2VuXG4gICAgICAgIGNvbnN0IGFjdGlvbiA9XG4gICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgIGNoZWNrYWJsZVRva2Vuc1tjaHVuay5uYW1lXSAhPT0gMSA/IG5vbkNoZWNrYWJsZUFjdGlvbiA6IGZpbHRlcihzdGFjaywgY2h1bmspID8gc3BlY2lhbEFjdGlvbiA6IGRlZmF1bHRBY3Rpb247XG5cbiAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICBlbmRUb2tlbiA9IHN0b3BUb2tlbnNbY2h1bmsubmFtZV0gfHwgXCJcIjtcbiAgICAgICAgc3dpdGNoIChhY3Rpb24pIHtcbiAgICAgICAgICBjYXNlIFwicHJvY2Vzcy1rZXlcIjpcbiAgICAgICAgICAgIGlmIChjaHVuay5uYW1lID09PSBcInN0YXJ0S2V5XCIpIHtcbiAgICAgICAgICAgICAgc3RhdGUgPSBcInByb2Nlc3Mta2V5XCI7XG4gICAgICAgICAgICAgIGNvbnRpbnVlIHJlY2hlY2s7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlIFwiYWNjZXB0LXRva2VuXCI6XG4gICAgICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgICAgICBpZiAoZW5kVG9rZW4gJiYgb3B0aW9uYWxUb2tlbnNbZW5kVG9rZW5dKSB7XG4gICAgICAgICAgICAgIHN0YXRlID0gXCJhY2NlcHQtdmFsdWVcIjtcbiAgICAgICAgICAgICAgc3RhcnRUcmFuc2l0aW9uID0gISF0cmFuc2l0aW9uO1xuICAgICAgICAgICAgICBjb250aW51ZSByZWNoZWNrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRyYW5zaXRpb24pIHJldHVyblRva2VuID0gdHJhbnNpdGlvbihzdGFjaywgY2h1bmssIGFjdGlvbiwgc2FuaXRpemVkT3B0aW9ucyk7XG4gICAgICAgICAgICByZXR1cm5Ub2tlbiA9IGNvbWJpbmVNYW55TXV0KHJldHVyblRva2VuLCBjaHVuayk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlIFwiYWNjZXB0XCI6XG4gICAgICAgICAgICBpZiAoZW5kVG9rZW4pIHtcbiAgICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgICBzdGF0ZSA9IG9wdGlvbmFsVG9rZW5zW2VuZFRva2VuXSA/IFwiYWNjZXB0LXZhbHVlXCIgOiBcImFjY2VwdFwiO1xuICAgICAgICAgICAgICBzdGFydFRyYW5zaXRpb24gPSAhIXRyYW5zaXRpb247XG4gICAgICAgICAgICAgIGNvbnRpbnVlIHJlY2hlY2s7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodHJhbnNpdGlvbikgcmV0dXJuVG9rZW4gPSB0cmFuc2l0aW9uKHN0YWNrLCBjaHVuaywgYWN0aW9uLCBzYW5pdGl6ZWRPcHRpb25zKTtcbiAgICAgICAgICAgIHJldHVyblRva2VuID0gY29tYmluZU1hbnlNdXQocmV0dXJuVG9rZW4sIGNodW5rKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGNhc2UgXCJyZWplY3RcIjpcbiAgICAgICAgICAgIGlmIChlbmRUb2tlbikge1xuICAgICAgICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgICAgICAgIHN0YXRlID0gb3B0aW9uYWxUb2tlbnNbZW5kVG9rZW5dID8gXCJyZWplY3QtdmFsdWVcIiA6IFwicmVqZWN0XCI7XG4gICAgICAgICAgICAgIHN0YXJ0VHJhbnNpdGlvbiA9ICEhdHJhbnNpdGlvbjtcbiAgICAgICAgICAgICAgY29udGludWUgcmVjaGVjaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0cmFuc2l0aW9uKSByZXR1cm5Ub2tlbiA9IHRyYW5zaXRpb24oc3RhY2ssIGNodW5rLCBhY3Rpb24sIHNhbml0aXplZE9wdGlvbnMpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgY2FzZSBcInBhc3NcIjpcbiAgICAgICAgICAgIHN0YXRlID0gXCJwYXNzXCI7XG4gICAgICAgICAgICBjb250aW51ZSByZWNoZWNrO1xuICAgICAgICB9XG5cbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG5cbiAgICAgIC8vIHVwZGF0ZSB0aGUgc3RhY2tcbiAgICAgIHN3aXRjaCAoY2h1bmsubmFtZSkge1xuICAgICAgICBjYXNlIFwic3RhcnRPYmplY3RcIjpcbiAgICAgICAgICBzdGFjay5wdXNoKG51bGwpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIFwic3RhcnRBcnJheVwiOlxuICAgICAgICAgIHN0YWNrLnB1c2goLTEpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIFwiZW5kT2JqZWN0XCI6XG4gICAgICAgIGNhc2UgXCJlbmRBcnJheVwiOlxuICAgICAgICAgIHN0YWNrLnBvcCgpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gcmV0dXJuVG9rZW47XG4gICAgfSk7XG4gIH07XG5cbmV4cG9ydCBjb25zdCBQaWNrUGFyc2VyID0gKG9wdGlvbnM/OiBhbnkpID0+IHdpdGhQYXJzZXIoZmlsdGVyQmFzZSgpLCBPYmplY3QuYXNzaWduKHsgcGFja0tleXM6IHRydWUgfSwgb3B0aW9ucykpO1xuXG5jbGFzcyBDb3VudGVyIHtcbiAgZGVwdGg6IG51bWJlcjtcbiAgY29uc3RydWN0b3IoaW5pdGlhbERlcHRoOiBudW1iZXIpIHtcbiAgICB0aGlzLmRlcHRoID0gaW5pdGlhbERlcHRoO1xuICB9XG4gIHN0YXJ0T2JqZWN0KCkge1xuICAgICsrdGhpcy5kZXB0aDtcbiAgfVxuICBlbmRPYmplY3QoKSB7XG4gICAgLS10aGlzLmRlcHRoO1xuICB9XG4gIHN0YXJ0QXJyYXkoKSB7XG4gICAgKyt0aGlzLmRlcHRoO1xuICB9XG4gIGVuZEFycmF5KCkge1xuICAgIC0tdGhpcy5kZXB0aDtcbiAgfVxufVxuXG5jbGFzcyBBc3NlbWJsZXIgZXh0ZW5kcyBFdmVudEVtaXR0ZXIge1xuICBzdGF0aWMgY29ubmVjdFRvKHN0cmVhbTogYW55LCBvcHRpb25zOiBhbnkpIHtcbiAgICByZXR1cm4gbmV3IEFzc2VtYmxlcihvcHRpb25zKS5jb25uZWN0VG8oc3RyZWFtKTtcbiAgfVxuXG4gIHN0YWNrOiBhbnk7XG4gIGN1cnJlbnQ6IGFueTtcbiAga2V5OiBhbnk7XG4gIGRvbmU6IGJvb2xlYW47XG4gIHJldml2ZXI6IGFueTtcbiAgLy8gQHRzLWlnbm9yZVxuICBzdHJpbmdWYWx1ZTogKHZhbHVlOiBzdHJpbmcpID0+IHZvaWQ7XG4gIHRhcENoYWluOiAoY2h1bms6IGFueSkgPT4gYW55O1xuXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnM6IGFueSkge1xuICAgIHN1cGVyKCk7XG4gICAgdGhpcy5zdGFjayA9IFtdO1xuICAgIHRoaXMuY3VycmVudCA9IHRoaXMua2V5ID0gbnVsbDtcbiAgICB0aGlzLmRvbmUgPSB0cnVlO1xuICAgIGlmIChvcHRpb25zKSB7XG4gICAgICB0aGlzLnJldml2ZXIgPSB0eXBlb2Ygb3B0aW9ucy5yZXZpdmVyID09IFwiZnVuY3Rpb25cIiAmJiBvcHRpb25zLnJldml2ZXI7XG4gICAgICBpZiAodGhpcy5yZXZpdmVyKSB7XG4gICAgICAgIHRoaXMuc3RyaW5nVmFsdWUgPSB0aGlzLl9zYXZlVmFsdWUgPSB0aGlzLl9zYXZlVmFsdWVXaXRoUmV2aXZlcjtcbiAgICAgIH1cbiAgICAgIGlmIChvcHRpb25zLm51bWJlckFzU3RyaW5nKSB7XG4gICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgdGhpcy5udW1iZXJWYWx1ZSA9IHRoaXMuc3RyaW5nVmFsdWU7XG4gICAgICB9XG4gICAgfVxuXG4gICAgdGhpcy50YXBDaGFpbiA9IChjaHVuaykgPT4ge1xuICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgaWYgKHRoaXNbY2h1bmsubmFtZV0pIHtcbiAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICB0aGlzW2NodW5rLm5hbWVdKGNodW5rLnZhbHVlKTtcbiAgICAgICAgaWYgKHRoaXMuZG9uZSkgcmV0dXJuIHRoaXMuY3VycmVudDtcbiAgICAgIH1cbiAgICAgIHJldHVybiBub25lO1xuICAgIH07XG5cbiAgICB0aGlzLnN0cmluZ1ZhbHVlID0gdGhpcy5fc2F2ZVZhbHVlO1xuICB9XG5cbiAgY29ubmVjdFRvKHN0cmVhbTogYW55KSB7XG4gICAgc3RyZWFtLm9uKFwiZGF0YVwiLCAoY2h1bms6IGFueSkgPT4ge1xuICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgaWYgKHRoaXNbY2h1bmsubmFtZV0pIHtcbiAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICB0aGlzW2NodW5rLm5hbWVdKGNodW5rLnZhbHVlKTtcbiAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICBpZiAodGhpcy5kb25lKSB0aGlzLmVtaXQoXCJkb25lXCIsIHRoaXMpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgZ2V0IGRlcHRoKCkge1xuICAgIHJldHVybiAodGhpcy5zdGFjay5sZW5ndGggPj4gMSkgKyAodGhpcy5kb25lID8gMCA6IDEpO1xuICB9XG5cbiAgZ2V0IHBhdGgoKSB7XG4gICAgY29uc3QgcGF0aDogYW55W10gPSBbXTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuc3RhY2subGVuZ3RoOyBpICs9IDIpIHtcbiAgICAgIGNvbnN0IGtleSA9IHRoaXMuc3RhY2tbaSArIDFdO1xuICAgICAgcGF0aC5wdXNoKGtleSA9PT0gbnVsbCA/IHRoaXMuc3RhY2tbaV0ubGVuZ3RoIDoga2V5KTtcbiAgICB9XG4gICAgcmV0dXJuIHBhdGg7XG4gIH1cblxuICBkcm9wVG9MZXZlbChsZXZlbDogYW55KSB7XG4gICAgaWYgKGxldmVsIDwgdGhpcy5kZXB0aCkge1xuICAgICAgaWYgKGxldmVsID4gMCkge1xuICAgICAgICBjb25zdCBpbmRleCA9IChsZXZlbCAtIDEpIDw8IDE7XG4gICAgICAgIHRoaXMuY3VycmVudCA9IHRoaXMuc3RhY2tbaW5kZXhdO1xuICAgICAgICB0aGlzLmtleSA9IHRoaXMuc3RhY2tbaW5kZXggKyAxXTtcbiAgICAgICAgdGhpcy5zdGFjay5zcGxpY2UoaW5kZXgpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5zdGFjayA9IFtdO1xuICAgICAgICB0aGlzLmN1cnJlbnQgPSB0aGlzLmtleSA9IG51bGw7XG4gICAgICAgIHRoaXMuZG9uZSA9IHRydWU7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgY29uc3VtZShjaHVuazogYW55KSB7XG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIHRoaXNbY2h1bmsubmFtZV0gJiYgdGhpc1tjaHVuay5uYW1lXShjaHVuay52YWx1ZSk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICBrZXlWYWx1ZSh2YWx1ZTogYW55KSB7XG4gICAgdGhpcy5rZXkgPSB2YWx1ZTtcbiAgfVxuXG4gIC8vc3RyaW5nVmFsdWUoKSAtIGFsaWFzZWQgYmVsb3cgdG8gX3NhdmVWYWx1ZSgpXG5cbiAgbnVtYmVyVmFsdWUodmFsdWU6IGFueSkge1xuICAgIHRoaXMuX3NhdmVWYWx1ZShwYXJzZUZsb2F0KHZhbHVlKSk7XG4gIH1cbiAgbnVsbFZhbHVlKCkge1xuICAgIHRoaXMuX3NhdmVWYWx1ZShudWxsKTtcbiAgfVxuICB0cnVlVmFsdWUoKSB7XG4gICAgdGhpcy5fc2F2ZVZhbHVlKHRydWUpO1xuICB9XG4gIGZhbHNlVmFsdWUoKSB7XG4gICAgdGhpcy5fc2F2ZVZhbHVlKGZhbHNlKTtcbiAgfVxuXG4gIHN0YXJ0T2JqZWN0KCkge1xuICAgIGlmICh0aGlzLmRvbmUpIHtcbiAgICAgIHRoaXMuZG9uZSA9IGZhbHNlO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnN0YWNrLnB1c2godGhpcy5jdXJyZW50LCB0aGlzLmtleSk7XG4gICAgfVxuICAgIHRoaXMuY3VycmVudCA9IG5ldyBPYmplY3QoKTtcbiAgICB0aGlzLmtleSA9IG51bGw7XG4gIH1cblxuICBlbmRPYmplY3QoKSB7XG4gICAgaWYgKHRoaXMuc3RhY2subGVuZ3RoKSB7XG4gICAgICBjb25zdCB2YWx1ZSA9IHRoaXMuY3VycmVudDtcbiAgICAgIHRoaXMua2V5ID0gdGhpcy5zdGFjay5wb3AoKTtcbiAgICAgIHRoaXMuY3VycmVudCA9IHRoaXMuc3RhY2sucG9wKCk7XG4gICAgICB0aGlzLl9zYXZlVmFsdWUodmFsdWUpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmRvbmUgPSB0cnVlO1xuICAgIH1cbiAgfVxuXG4gIHN0YXJ0QXJyYXkoKSB7XG4gICAgaWYgKHRoaXMuZG9uZSkge1xuICAgICAgdGhpcy5kb25lID0gZmFsc2U7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuc3RhY2sucHVzaCh0aGlzLmN1cnJlbnQsIHRoaXMua2V5KTtcbiAgICB9XG4gICAgdGhpcy5jdXJyZW50ID0gW107XG4gICAgdGhpcy5rZXkgPSBudWxsO1xuICB9XG5cbiAgZW5kQXJyYXkoKSB7XG4gICAgaWYgKHRoaXMuc3RhY2subGVuZ3RoKSB7XG4gICAgICBjb25zdCB2YWx1ZSA9IHRoaXMuY3VycmVudDtcbiAgICAgIHRoaXMua2V5ID0gdGhpcy5zdGFjay5wb3AoKTtcbiAgICAgIHRoaXMuY3VycmVudCA9IHRoaXMuc3RhY2sucG9wKCk7XG4gICAgICB0aGlzLl9zYXZlVmFsdWUodmFsdWUpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmRvbmUgPSB0cnVlO1xuICAgIH1cbiAgfVxuXG4gIF9zYXZlVmFsdWUodmFsdWU6IGFueSkge1xuICAgIGlmICh0aGlzLmRvbmUpIHtcbiAgICAgIHRoaXMuY3VycmVudCA9IHZhbHVlO1xuICAgIH0gZWxzZSB7XG4gICAgICBpZiAodGhpcy5jdXJyZW50IGluc3RhbmNlb2YgQXJyYXkpIHtcbiAgICAgICAgdGhpcy5jdXJyZW50LnB1c2godmFsdWUpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5jdXJyZW50W3RoaXMua2V5XSA9IHZhbHVlO1xuICAgICAgICB0aGlzLmtleSA9IG51bGw7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIF9zYXZlVmFsdWVXaXRoUmV2aXZlcih2YWx1ZTogYW55KSB7XG4gICAgaWYgKHRoaXMuZG9uZSkge1xuICAgICAgdGhpcy5jdXJyZW50ID0gdGhpcy5yZXZpdmVyKFwiXCIsIHZhbHVlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKHRoaXMuY3VycmVudCBpbnN0YW5jZW9mIEFycmF5KSB7XG4gICAgICAgIHZhbHVlID0gdGhpcy5yZXZpdmVyKFwiXCIgKyB0aGlzLmN1cnJlbnQubGVuZ3RoLCB2YWx1ZSk7XG4gICAgICAgIHRoaXMuY3VycmVudC5wdXNoKHZhbHVlKTtcbiAgICAgICAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICBkZWxldGUgdGhpcy5jdXJyZW50W3RoaXMuY3VycmVudC5sZW5ndGggLSAxXTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdmFsdWUgPSB0aGlzLnJldml2ZXIodGhpcy5rZXksIHZhbHVlKTtcbiAgICAgICAgaWYgKHZhbHVlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICB0aGlzLmN1cnJlbnRbdGhpcy5rZXldID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5rZXkgPSBudWxsO1xuICAgICAgfVxuICAgIH1cbiAgfVxufVxuXG5jb25zdCBzdHJlYW1CYXNlID1cbiAgKHsgcHVzaCwgZmlyc3QsIGxldmVsIH06IGFueSkgPT5cbiAgKG9wdGlvbnMgPSB7fSBhcyBhbnkpID0+IHtcbiAgICBjb25zdCB7IG9iamVjdEZpbHRlciwgaW5jbHVkZVVuZGVjaWRlZCB9ID0gb3B0aW9ucztcbiAgICBsZXQgYXNtID0gbmV3IEFzc2VtYmxlcihvcHRpb25zKSBhcyBhbnksXG4gICAgICBzdGF0ZSA9IGZpcnN0ID8gXCJmaXJzdFwiIDogXCJjaGVja1wiLFxuICAgICAgc2F2ZWRBc20gPSBudWxsIGFzIGFueTtcblxuICAgIGlmICh0eXBlb2Ygb2JqZWN0RmlsdGVyICE9IFwiZnVuY3Rpb25cIikge1xuICAgICAgLy8gbm8gb2JqZWN0IGZpbHRlciArIG5vIGZpcnN0IGNoZWNrXG4gICAgICBpZiAoc3RhdGUgPT09IFwiY2hlY2tcIilcbiAgICAgICAgcmV0dXJuIChjaHVuazogYW55KSA9PiB7XG4gICAgICAgICAgaWYgKGFzbVtjaHVuay5uYW1lXSkge1xuICAgICAgICAgICAgYXNtW2NodW5rLm5hbWVdKGNodW5rLnZhbHVlKTtcbiAgICAgICAgICAgIGlmIChhc20uZGVwdGggPT09IGxldmVsKSB7XG4gICAgICAgICAgICAgIHJldHVybiBwdXNoKGFzbSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBub25lO1xuICAgICAgICB9O1xuICAgICAgLy8gbm8gb2JqZWN0IGZpbHRlclxuICAgICAgcmV0dXJuIChjaHVuazogYW55KSA9PiB7XG4gICAgICAgIHN3aXRjaCAoc3RhdGUpIHtcbiAgICAgICAgICBjYXNlIFwiZmlyc3RcIjpcbiAgICAgICAgICAgIGZpcnN0KGNodW5rKTtcbiAgICAgICAgICAgIHN0YXRlID0gXCJhY2NlcHRcIjtcbiAgICAgICAgICAvLyBmYWxsIHRocm91Z2hcbiAgICAgICAgICBjYXNlIFwiYWNjZXB0XCI6XG4gICAgICAgICAgICBpZiAoYXNtW2NodW5rLm5hbWVdKSB7XG4gICAgICAgICAgICAgIGFzbVtjaHVuay5uYW1lXShjaHVuay52YWx1ZSk7XG4gICAgICAgICAgICAgIGlmIChhc20uZGVwdGggPT09IGxldmVsKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHB1c2goYXNtKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5vbmU7XG4gICAgICB9O1xuICAgIH1cblxuICAgIC8vIG9iamVjdCBmaWx0ZXIgKyBhIHBvc3NpYmxlIGZpcnN0IGNoZWNrXG4gICAgcmV0dXJuIChjaHVuazogYW55KSA9PiB7XG4gICAgICBzd2l0Y2ggKHN0YXRlKSB7XG4gICAgICAgIGNhc2UgXCJmaXJzdFwiOlxuICAgICAgICAgIGZpcnN0KGNodW5rKTtcbiAgICAgICAgICBzdGF0ZSA9IFwiY2hlY2tcIjtcbiAgICAgICAgLy8gZmFsbCB0aHJvdWdoXG4gICAgICAgIGNhc2UgXCJjaGVja1wiOlxuICAgICAgICAgIGlmIChhc21bY2h1bmsubmFtZV0pIHtcbiAgICAgICAgICAgIGFzbVtjaHVuay5uYW1lXShjaHVuay52YWx1ZSk7XG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBvYmplY3RGaWx0ZXIoYXNtKTtcbiAgICAgICAgICAgIGlmIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgc3RhdGUgPSBcImFjY2VwdFwiO1xuICAgICAgICAgICAgICBpZiAoYXNtLmRlcHRoID09PSBsZXZlbCkgcmV0dXJuIHB1c2goYXNtKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzdWx0ID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICBpZiAoYXNtLmRlcHRoID09PSBsZXZlbCkgcmV0dXJuIHB1c2goYXNtLCB0cnVlKTtcbiAgICAgICAgICAgICAgc3RhdGUgPSBcInJlamVjdFwiO1xuICAgICAgICAgICAgICBzYXZlZEFzbSA9IGFzbTtcbiAgICAgICAgICAgICAgYXNtID0gbmV3IENvdW50ZXIoc2F2ZWRBc20uZGVwdGgpO1xuICAgICAgICAgICAgICBzYXZlZEFzbS5kcm9wVG9MZXZlbChsZXZlbCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBpZiAoYXNtLmRlcHRoID09PSBsZXZlbCkgcmV0dXJuIHB1c2goYXNtLCAhaW5jbHVkZVVuZGVjaWRlZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIFwiYWNjZXB0XCI6XG4gICAgICAgICAgaWYgKGFzbVtjaHVuay5uYW1lXSkge1xuICAgICAgICAgICAgYXNtW2NodW5rLm5hbWVdKGNodW5rLnZhbHVlKTtcbiAgICAgICAgICAgIGlmIChhc20uZGVwdGggPT09IGxldmVsKSB7XG4gICAgICAgICAgICAgIHN0YXRlID0gXCJjaGVja1wiO1xuICAgICAgICAgICAgICByZXR1cm4gcHVzaChhc20pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBcInJlamVjdFwiOlxuICAgICAgICAgIGlmIChhc21bY2h1bmsubmFtZV0pIHtcbiAgICAgICAgICAgIGFzbVtjaHVuay5uYW1lXShjaHVuay52YWx1ZSk7XG4gICAgICAgICAgICBpZiAoYXNtLmRlcHRoID09PSBsZXZlbCkge1xuICAgICAgICAgICAgICBzdGF0ZSA9IFwiY2hlY2tcIjtcbiAgICAgICAgICAgICAgYXNtID0gc2F2ZWRBc207XG4gICAgICAgICAgICAgIHNhdmVkQXNtID0gbnVsbDtcbiAgICAgICAgICAgICAgcmV0dXJuIHB1c2goYXNtLCB0cnVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICByZXR1cm4gbm9uZTtcbiAgICB9O1xuICB9O1xuXG5leHBvcnQgY29uc3QgU3RyZWFtQXJyYXkgPSAob3B0aW9ucz86IGFueSkgPT4ge1xuICBsZXQga2V5ID0gMDtcbiAgcmV0dXJuIHN0cmVhbUJhc2Uoe1xuICAgIGxldmVsOiAxLFxuXG4gICAgZmlyc3QoY2h1bms6IGFueSkge1xuICAgICAgaWYgKGNodW5rLm5hbWUgIT09IFwic3RhcnRBcnJheVwiKSB0aHJvdyBuZXcgRXJyb3IoXCJUb3AtbGV2ZWwgb2JqZWN0IHNob3VsZCBiZSBhbiBhcnJheS5cIik7XG4gICAgfSxcblxuICAgIHB1c2goYXNtOiBhbnksIGRpc2NhcmQ6IGFueSkge1xuICAgICAgaWYgKGFzbS5jdXJyZW50Lmxlbmd0aCkge1xuICAgICAgICBpZiAoZGlzY2FyZCkge1xuICAgICAgICAgICsra2V5O1xuICAgICAgICAgIGFzbS5jdXJyZW50LnBvcCgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiB7IGtleToga2V5KyssIHZhbHVlOiBhc20uY3VycmVudC5wb3AoKSB9O1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gbm9uZTtcbiAgICB9LFxuICB9KShvcHRpb25zKTtcbn07XG4iLCAiaW1wb3J0IHsgTGlzdCwgTWVudUJhckV4dHJhLCBJY29uLCBvcGVuLCBMYXVuY2hUeXBlLCBlbnZpcm9ubWVudCwgQWN0aW9uUGFuZWwsIEFjdGlvbiB9IGZyb20gXCJAcmF5Y2FzdC9hcGlcIjtcbmltcG9ydCB7IGV4aXN0c1N5bmMgfSBmcm9tIFwibm9kZTpmc1wiO1xuaW1wb3J0IG9zIGZyb20gXCJub2RlOm9zXCI7XG5pbXBvcnQgeyB1c2VSZWYsIHVzZVN0YXRlLCB1c2VDYWxsYmFjaywgdXNlTWVtbyB9IGZyb20gXCJyZWFjdFwiO1xuaW1wb3J0IHsgdXNlUHJvbWlzZSwgUHJvbWlzZU9wdGlvbnMgfSBmcm9tIFwiLi91c2VQcm9taXNlXCI7XG5pbXBvcnQgeyB1c2VMYXRlc3QgfSBmcm9tIFwiLi91c2VMYXRlc3RcIjtcbmltcG9ydCB7IHNob3dGYWlsdXJlVG9hc3QgfSBmcm9tIFwiLi9zaG93RmFpbHVyZVRvYXN0XCI7XG5pbXBvcnQgeyBiYXNlRXhlY3V0ZVNRTCwgUGVybWlzc2lvbkVycm9yLCBpc1Blcm1pc3Npb25FcnJvciB9IGZyb20gXCIuL3NxbC11dGlsc1wiO1xuXG4vKipcbiAqIEV4ZWN1dGVzIGEgcXVlcnkgb24gYSBsb2NhbCBTUUwgZGF0YWJhc2UgYW5kIHJldHVybnMgdGhlIHtAbGluayBBc3luY1N0YXRlfSBjb3JyZXNwb25kaW5nIHRvIHRoZSBxdWVyeSBvZiB0aGUgY29tbWFuZC4gVGhlIGxhc3QgdmFsdWUgd2lsbCBiZSBrZXB0IGJldHdlZW4gY29tbWFuZCBydW5zLlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGBcbiAqIGltcG9ydCB7IHVzZVNRTCB9IGZyb20gXCJAcmF5Y2FzdC91dGlsc1wiO1xuICogaW1wb3J0IHsgcmVzb2x2ZSB9IGZyb20gXCJwYXRoXCI7XG4gKiBpbXBvcnQgeyBob21lZGlyIH0gZnJvbSBcIm9zXCI7XG4gKlxuICogY29uc3QgTk9URVNfREIgPSByZXNvbHZlKGhvbWVkaXIoKSwgXCJMaWJyYXJ5L0dyb3VwIENvbnRhaW5lcnMvZ3JvdXAuY29tLmFwcGxlLm5vdGVzL05vdGVTdG9yZS5zcWxpdGVcIik7XG4gKiBjb25zdCBub3Rlc1F1ZXJ5ID0gYFNFTEVDVCBpZCwgdGl0bGUgRlJPTSAuLi5gO1xuICogdHlwZSBOb3RlSXRlbSA9IHtcbiAqICAgaWQ6IHN0cmluZztcbiAqICAgdGl0bGU6IHN0cmluZztcbiAqIH07XG4gKlxuICogZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gQ29tbWFuZCgpIHtcbiAqICAgY29uc3QgeyBpc0xvYWRpbmcsIGRhdGEsIHBlcm1pc3Npb25WaWV3IH0gPSB1c2VTUUw8Tm90ZUl0ZW0+KE5PVEVTX0RCLCBub3Rlc1F1ZXJ5KTtcbiAqXG4gKiAgIGlmIChwZXJtaXNzaW9uVmlldykge1xuICogICAgIHJldHVybiBwZXJtaXNzaW9uVmlldztcbiAqICAgfVxuICpcbiAqICAgcmV0dXJuIChcbiAqICAgICA8TGlzdCBpc0xvYWRpbmc9e2lzTG9hZGluZ30+XG4gKiAgICAgICB7KGRhdGEgfHwgW10pLm1hcCgoaXRlbSkgPT4gKFxuICogICAgICAgICA8TGlzdC5JdGVtIGtleT17aXRlbS5pZH0gdGl0bGU9e2l0ZW0udGl0bGV9IC8+XG4gKiAgICAgICApKX1cbiAqICAgICA8L0xpc3Q+XG4gKiAgKTtcbiAqIH07XG4gKiBgYGBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHVzZVNRTDxUID0gdW5rbm93bj4oXG4gIGRhdGFiYXNlUGF0aDogc3RyaW5nLFxuICBxdWVyeTogc3RyaW5nLFxuICBvcHRpb25zPzoge1xuICAgIC8qKiBBIHN0cmluZyBleHBsYWluaW5nIHdoeSB0aGUgZXh0ZW5zaW9uIG5lZWRzIGZ1bGwgZGlzayBhY2Nlc3MuIEZvciBleGFtcGxlLCB0aGUgQXBwbGUgTm90ZXMgZXh0ZW5zaW9uIHVzZXMgYFwiVGhpcyBpcyByZXF1aXJlZCB0byBzZWFyY2ggeW91ciBBcHBsZSBOb3Rlcy5cImAuIFdoaWxlIGl0IGlzIG9wdGlvbmFsLCB3ZSByZWNvbW1lbmQgc2V0dGluZyBpdCB0byBoZWxwIHVzZXJzIHVuZGVyc3RhbmQuICovXG4gICAgcGVybWlzc2lvblByaW1pbmc/OiBzdHJpbmc7XG4gIH0gJiBPbWl0PFByb21pc2VPcHRpb25zPChkYXRhYmFzZTogc3RyaW5nLCBxdWVyeTogc3RyaW5nKSA9PiBQcm9taXNlPFRbXT4+LCBcImFib3J0YWJsZVwiPixcbikge1xuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVudXNlZC12YXJzXG4gIGNvbnN0IHsgcGVybWlzc2lvblByaW1pbmcsIC4uLnVzZVByb21pc2VPcHRpb25zIH0gPSBvcHRpb25zIHx8IHt9O1xuXG4gIGNvbnN0IFtwZXJtaXNzaW9uVmlldywgc2V0UGVybWlzc2lvblZpZXddID0gdXNlU3RhdGU8UmVhY3QuSlNYLkVsZW1lbnQgfCBudWxsPihudWxsKTtcbiAgY29uc3QgbGF0ZXN0T3B0aW9ucyA9IHVzZUxhdGVzdChvcHRpb25zIHx8IHt9KTtcbiAgY29uc3QgYWJvcnRhYmxlID0gdXNlUmVmPEFib3J0Q29udHJvbGxlcj4obnVsbCk7XG5cbiAgY29uc3QgaGFuZGxlRXJyb3IgPSB1c2VDYWxsYmFjayhcbiAgICAoX2Vycm9yOiBFcnJvcikgPT4ge1xuICAgICAgY29uc29sZS5lcnJvcihfZXJyb3IpO1xuICAgICAgY29uc3QgZXJyb3IgPVxuICAgICAgICBfZXJyb3IgaW5zdGFuY2VvZiBFcnJvciAmJiBfZXJyb3IubWVzc2FnZS5pbmNsdWRlcyhcImF1dGhvcml6YXRpb24gZGVuaWVkXCIpXG4gICAgICAgICAgPyBuZXcgUGVybWlzc2lvbkVycm9yKFwiWW91IGRvIG5vdCBoYXZlIHBlcm1pc3Npb24gdG8gYWNjZXNzIHRoZSBkYXRhYmFzZS5cIilcbiAgICAgICAgICA6IChfZXJyb3IgYXMgRXJyb3IpO1xuXG4gICAgICBpZiAoaXNQZXJtaXNzaW9uRXJyb3IoZXJyb3IpKSB7XG4gICAgICAgIHNldFBlcm1pc3Npb25WaWV3KDxQZXJtaXNzaW9uRXJyb3JTY3JlZW4gcHJpbWluZz17bGF0ZXN0T3B0aW9ucy5jdXJyZW50LnBlcm1pc3Npb25QcmltaW5nfSAvPik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAobGF0ZXN0T3B0aW9ucy5jdXJyZW50Lm9uRXJyb3IpIHtcbiAgICAgICAgICBsYXRlc3RPcHRpb25zLmN1cnJlbnQub25FcnJvcihlcnJvcik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaWYgKGVudmlyb25tZW50LmxhdW5jaFR5cGUgIT09IExhdW5jaFR5cGUuQmFja2dyb3VuZCkge1xuICAgICAgICAgICAgc2hvd0ZhaWx1cmVUb2FzdChlcnJvciwge1xuICAgICAgICAgICAgICB0aXRsZTogXCJDYW5ub3QgcXVlcnkgdGhlIGRhdGFcIixcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sXG4gICAgW2xhdGVzdE9wdGlvbnNdLFxuICApO1xuXG4gIGNvbnN0IGZuID0gdXNlTWVtbygoKSA9PiB7XG4gICAgaWYgKCFleGlzdHNTeW5jKGRhdGFiYXNlUGF0aCkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIlRoZSBkYXRhYmFzZSBkb2VzIG5vdCBleGlzdFwiKTtcbiAgICB9XG5cbiAgICByZXR1cm4gYXN5bmMgKGRhdGFiYXNlUGF0aDogc3RyaW5nLCBxdWVyeTogc3RyaW5nKSA9PiB7XG4gICAgICBjb25zdCBhYm9ydFNpZ25hbCA9IGFib3J0YWJsZS5jdXJyZW50Py5zaWduYWw7XG4gICAgICByZXR1cm4gYmFzZUV4ZWN1dGVTUUw8VD4oZGF0YWJhc2VQYXRoLCBxdWVyeSwgeyBzaWduYWw6IGFib3J0U2lnbmFsIH0pO1xuICAgIH07XG4gIH0sIFtkYXRhYmFzZVBhdGhdKTtcblxuICByZXR1cm4ge1xuICAgIC4uLnVzZVByb21pc2UoZm4sIFtkYXRhYmFzZVBhdGgsIHF1ZXJ5XSwgeyAuLi51c2VQcm9taXNlT3B0aW9ucywgb25FcnJvcjogaGFuZGxlRXJyb3IgfSksXG4gICAgcGVybWlzc2lvblZpZXcsXG4gIH07XG59XG5cbmZ1bmN0aW9uIFBlcm1pc3Npb25FcnJvclNjcmVlbihwcm9wczogeyBwcmltaW5nPzogc3RyaW5nIH0pIHtcbiAgY29uc3QgbWFjb3NWZW50dXJhQW5kTGF0ZXIgPSBwYXJzZUludChvcy5yZWxlYXNlKCkuc3BsaXQoXCIuXCIpWzBdKSA+PSAyMjtcbiAgY29uc3QgcHJlZmVyZW5jZXNTdHJpbmcgPSBtYWNvc1ZlbnR1cmFBbmRMYXRlciA/IFwiU2V0dGluZ3NcIiA6IFwiUHJlZmVyZW5jZXNcIjtcblxuICBjb25zdCBhY3Rpb24gPSBtYWNvc1ZlbnR1cmFBbmRMYXRlclxuICAgID8ge1xuICAgICAgICB0aXRsZTogXCJPcGVuIFN5c3RlbSBTZXR0aW5ncyAtPiBQcml2YWN5XCIsXG4gICAgICAgIHRhcmdldDogXCJ4LWFwcGxlLnN5c3RlbXByZWZlcmVuY2VzOmNvbS5hcHBsZS5wcmVmZXJlbmNlLnNlY3VyaXR5P1ByaXZhY3lfQWxsRmlsZXNcIixcbiAgICAgIH1cbiAgICA6IHtcbiAgICAgICAgdGl0bGU6IFwiT3BlbiBTeXN0ZW0gUHJlZmVyZW5jZXMgLT4gU2VjdXJpdHlcIixcbiAgICAgICAgdGFyZ2V0OiBcIngtYXBwbGUuc3lzdGVtcHJlZmVyZW5jZXM6Y29tLmFwcGxlLnByZWZlcmVuY2Uuc2VjdXJpdHk/UHJpdmFjeV9BbGxGaWxlc1wiLFxuICAgICAgfTtcblxuICBpZiAoZW52aXJvbm1lbnQuY29tbWFuZE1vZGUgPT09IFwibWVudS1iYXJcIikge1xuICAgIHJldHVybiAoXG4gICAgICA8TWVudUJhckV4dHJhIGljb249e0ljb24uV2FybmluZ30gdGl0bGU9e2Vudmlyb25tZW50LmNvbW1hbmROYW1lfT5cbiAgICAgICAgPE1lbnVCYXJFeHRyYS5JdGVtXG4gICAgICAgICAgdGl0bGU9XCJSYXljYXN0IG5lZWRzIGZ1bGwgZGlzayBhY2Nlc3NcIlxuICAgICAgICAgIHRvb2x0aXA9e2BZb3UgY2FuIHJldmVydCB0aGlzIGFjY2VzcyBpbiAke3ByZWZlcmVuY2VzU3RyaW5nfSB3aGVuZXZlciB5b3Ugd2FudGB9XG4gICAgICAgIC8+XG4gICAgICAgIHtwcm9wcy5wcmltaW5nID8gKFxuICAgICAgICAgIDxNZW51QmFyRXh0cmEuSXRlbVxuICAgICAgICAgICAgdGl0bGU9e3Byb3BzLnByaW1pbmd9XG4gICAgICAgICAgICB0b29sdGlwPXtgWW91IGNhbiByZXZlcnQgdGhpcyBhY2Nlc3MgaW4gJHtwcmVmZXJlbmNlc1N0cmluZ30gd2hlbmV2ZXIgeW91IHdhbnRgfVxuICAgICAgICAgIC8+XG4gICAgICAgICkgOiBudWxsfVxuICAgICAgICA8TWVudUJhckV4dHJhLlNlcGFyYXRvciAvPlxuICAgICAgICA8TWVudUJhckV4dHJhLkl0ZW0gdGl0bGU9e2FjdGlvbi50aXRsZX0gb25BY3Rpb249eygpID0+IG9wZW4oYWN0aW9uLnRhcmdldCl9IC8+XG4gICAgICA8L01lbnVCYXJFeHRyYT5cbiAgICApO1xuICB9XG5cbiAgcmV0dXJuIChcbiAgICA8TGlzdD5cbiAgICAgIDxMaXN0LkVtcHR5Vmlld1xuICAgICAgICBpY29uPXt7XG4gICAgICAgICAgc291cmNlOiB7XG4gICAgICAgICAgICBsaWdodDogXCJodHRwczovL3JheWNhc3QuY29tL3VwbG9hZHMvZXh0ZW5zaW9ucy11dGlscy1zZWN1cml0eS1wZXJtaXNzaW9ucy1saWdodC5wbmdcIixcbiAgICAgICAgICAgIGRhcms6IFwiaHR0cHM6Ly9yYXljYXN0LmNvbS91cGxvYWRzL2V4dGVuc2lvbnMtdXRpbHMtc2VjdXJpdHktcGVybWlzc2lvbnMtZGFyay5wbmdcIixcbiAgICAgICAgICB9LFxuICAgICAgICB9fVxuICAgICAgICB0aXRsZT1cIlJheWNhc3QgbmVlZHMgZnVsbCBkaXNrIGFjY2Vzcy5cIlxuICAgICAgICBkZXNjcmlwdGlvbj17YCR7XG4gICAgICAgICAgcHJvcHMucHJpbWluZyA/IHByb3BzLnByaW1pbmcgKyBcIlxcblwiIDogXCJcIlxuICAgICAgICB9WW91IGNhbiByZXZlcnQgdGhpcyBhY2Nlc3MgaW4gJHtwcmVmZXJlbmNlc1N0cmluZ30gd2hlbmV2ZXIgeW91IHdhbnQuYH1cbiAgICAgICAgYWN0aW9ucz17XG4gICAgICAgICAgPEFjdGlvblBhbmVsPlxuICAgICAgICAgICAgPEFjdGlvbi5PcGVuIHsuLi5hY3Rpb259IC8+XG4gICAgICAgICAgPC9BY3Rpb25QYW5lbD5cbiAgICAgICAgfVxuICAgICAgLz5cbiAgICA8L0xpc3Q+XG4gICk7XG59XG4iLCAiaW1wb3J0IHsgZXhpc3RzU3luYyB9IGZyb20gXCJub2RlOmZzXCI7XG5pbXBvcnQgeyBjb3B5RmlsZSwgbWtkaXIsIHdyaXRlRmlsZSB9IGZyb20gXCJub2RlOmZzL3Byb21pc2VzXCI7XG5pbXBvcnQgb3MgZnJvbSBcIm5vZGU6b3NcIjtcbmltcG9ydCBjaGlsZFByb2Nlc3MgZnJvbSBcIm5vZGU6Y2hpbGRfcHJvY2Vzc1wiO1xuaW1wb3J0IHBhdGggZnJvbSBcIm5vZGU6cGF0aFwiO1xuaW1wb3J0IHsgZ2V0U3Bhd25lZFByb21pc2UsIGdldFNwYXduZWRSZXN1bHQgfSBmcm9tIFwiLi9leGVjLXV0aWxzXCI7XG5pbXBvcnQgeyBoYXNoIH0gZnJvbSBcIi4vaGVscGVyc1wiO1xuXG5leHBvcnQgY2xhc3MgUGVybWlzc2lvbkVycm9yIGV4dGVuZHMgRXJyb3Ige1xuICBjb25zdHJ1Y3RvcihtZXNzYWdlOiBzdHJpbmcpIHtcbiAgICBzdXBlcihtZXNzYWdlKTtcbiAgICB0aGlzLm5hbWUgPSBcIlBlcm1pc3Npb25FcnJvclwiO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc1Blcm1pc3Npb25FcnJvcihlcnJvcjogdW5rbm93bik6IGVycm9yIGlzIFBlcm1pc3Npb25FcnJvciB7XG4gIHJldHVybiBlcnJvciBpbnN0YW5jZW9mIEVycm9yICYmIGVycm9yLm5hbWUgPT09IFwiUGVybWlzc2lvbkVycm9yXCI7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBiYXNlRXhlY3V0ZVNRTDxUID0gdW5rbm93bj4oXG4gIGRhdGFiYXNlUGF0aDogc3RyaW5nLFxuICBxdWVyeTogc3RyaW5nLFxuICBvcHRpb25zPzoge1xuICAgIHNpZ25hbD86IEFib3J0U2lnbmFsO1xuICB9LFxuKTogUHJvbWlzZTxUW10+IHtcbiAgaWYgKCFleGlzdHNTeW5jKGRhdGFiYXNlUGF0aCkpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJUaGUgZGF0YWJhc2UgZG9lcyBub3QgZXhpc3RcIik7XG4gIH1cblxuICBsZXQgc3FsaXRlMzogdHlwZW9mIGltcG9ydChcIm5vZGU6c3FsaXRlXCIpO1xuICB0cnkge1xuICAgIC8vIHRoaXMgaXMgYSBiaXQgdWdseSBidXQgd2UgY2FuJ3QgZGlyZWN0bHkgaW1wb3J0IFwibm9kZTpzcWxpdGVcIiBoZXJlIGJlY2F1c2UgcGFyY2VsIHdpbGwgaG9pc3QgaXQgYW55d2F5IGFuZCBpdCB3aWxsIGJyZWFrIHdoZW4gaXQncyBub3QgYXZhaWxhYmxlXG4gICAgY29uc3QgZHluYW1pY0ltcG9ydCA9IChtb2R1bGU6IHN0cmluZykgPT4gaW1wb3J0KG1vZHVsZSk7XG4gICAgc3FsaXRlMyA9IGF3YWl0IGR5bmFtaWNJbXBvcnQoXCJub2RlOnNxbGl0ZVwiKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAvLyBJZiBzcWxpdGUzIGlzIG5vdCBhdmFpbGFibGUsIHdlIGZhbGxiYWNrIHRvIHVzaW5nIHRoZSBzcWxpdGUzIENMSSAoYXZhaWxhYmxlIG9uIG1hY09TIGFuZCBMaW51eCBieSBkZWZhdWx0KS5cbiAgICByZXR1cm4gc3FsaXRlRmFsbGJhY2s8VD4oZGF0YWJhc2VQYXRoLCBxdWVyeSwgb3B0aW9ucyk7XG4gIH1cblxuICBsZXQgZGIgPSBuZXcgc3FsaXRlMy5EYXRhYmFzZVN5bmMoZGF0YWJhc2VQYXRoLCB7IG9wZW46IGZhbHNlLCByZWFkT25seTogdHJ1ZSB9KTtcblxuICBjb25zdCBhYm9ydFNpZ25hbCA9IG9wdGlvbnM/LnNpZ25hbDtcblxuICB0cnkge1xuICAgIGRiLm9wZW4oKTtcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgIGNvbnNvbGUubG9nKGVycm9yKTtcbiAgICBpZiAoZXJyb3IubWVzc2FnZS5tYXRjaChcIig1KVwiKSB8fCBlcnJvci5tZXNzYWdlLm1hdGNoKFwiKDE0KVwiKSkge1xuICAgICAgLy8gVGhhdCBtZWFucyB0aGF0IHRoZSBEQiBpcyBidXN5IGJlY2F1c2Ugb2YgYW5vdGhlciBhcHAgaXMgbG9ja2luZyBpdFxuICAgICAgLy8gVGhpcyBoYXBwZW5zIHdoZW4gQ2hyb21lIG9yIEFyYyBpcyBvcGVuZWQ6IHRoZXkgbG9jayB0aGUgSGlzdG9yeSBkYi5cbiAgICAgIC8vIEFzIGFuIHVnbHkgd29ya2Fyb3VuZCwgd2UgZHVwbGljYXRlIHRoZSBmaWxlIGFuZCByZWFkIHRoYXQgaW5zdGVhZFxuICAgICAgLy8gKHdpdGggdmZzIHVuaXggLSBub25lIHRvIGp1c3Qgbm90IGNhcmUgYWJvdXQgbG9ja3MpXG4gICAgICBsZXQgd29ya2Fyb3VuZENvcGllZERiOiBzdHJpbmcgfCB1bmRlZmluZWQ7XG4gICAgICBpZiAoIXdvcmthcm91bmRDb3BpZWREYikge1xuICAgICAgICBjb25zdCB0ZW1wRm9sZGVyID0gcGF0aC5qb2luKG9zLnRtcGRpcigpLCBcInVzZVNRTFwiLCBoYXNoKGRhdGFiYXNlUGF0aCkpO1xuICAgICAgICBhd2FpdCBta2Rpcih0ZW1wRm9sZGVyLCB7IHJlY3Vyc2l2ZTogdHJ1ZSB9KTtcbiAgICAgICAgY2hlY2tBYm9ydGVkKGFib3J0U2lnbmFsKTtcblxuICAgICAgICB3b3JrYXJvdW5kQ29waWVkRGIgPSBwYXRoLmpvaW4odGVtcEZvbGRlciwgXCJkYi5kYlwiKTtcbiAgICAgICAgYXdhaXQgY29weUZpbGUoZGF0YWJhc2VQYXRoLCB3b3JrYXJvdW5kQ29waWVkRGIpO1xuXG4gICAgICAgIGF3YWl0IHdyaXRlRmlsZSh3b3JrYXJvdW5kQ29waWVkRGIgKyBcIi1zaG1cIiwgXCJcIik7XG4gICAgICAgIGF3YWl0IHdyaXRlRmlsZSh3b3JrYXJvdW5kQ29waWVkRGIgKyBcIi13YWxcIiwgXCJcIik7XG5cbiAgICAgICAgY2hlY2tBYm9ydGVkKGFib3J0U2lnbmFsKTtcbiAgICAgIH1cblxuICAgICAgZGIgPSBuZXcgc3FsaXRlMy5EYXRhYmFzZVN5bmMod29ya2Fyb3VuZENvcGllZERiLCB7IG9wZW46IGZhbHNlLCByZWFkT25seTogdHJ1ZSB9KTtcbiAgICAgIGRiLm9wZW4oKTtcbiAgICAgIGNoZWNrQWJvcnRlZChhYm9ydFNpZ25hbCk7XG4gICAgfVxuICB9XG5cbiAgY29uc3Qgc3RhdGVtZW50ID0gZGIucHJlcGFyZShxdWVyeSk7XG4gIGNoZWNrQWJvcnRlZChhYm9ydFNpZ25hbCk7XG5cbiAgY29uc3QgcmVzdWx0ID0gc3RhdGVtZW50LmFsbCgpO1xuXG4gIGRiLmNsb3NlKCk7XG5cbiAgcmV0dXJuIHJlc3VsdCBhcyBUW107XG59XG5cbmFzeW5jIGZ1bmN0aW9uIHNxbGl0ZUZhbGxiYWNrPFQgPSB1bmtub3duPihcbiAgZGF0YWJhc2VQYXRoOiBzdHJpbmcsXG4gIHF1ZXJ5OiBzdHJpbmcsXG4gIG9wdGlvbnM/OiB7XG4gICAgc2lnbmFsPzogQWJvcnRTaWduYWw7XG4gIH0sXG4pOiBQcm9taXNlPFRbXT4ge1xuICBjb25zdCBhYm9ydFNpZ25hbCA9IG9wdGlvbnM/LnNpZ25hbDtcblxuICBsZXQgc3Bhd25lZCA9IGNoaWxkUHJvY2Vzcy5zcGF3bihcInNxbGl0ZTNcIiwgW1wiLS1qc29uXCIsIFwiLS1yZWFkb25seVwiLCBkYXRhYmFzZVBhdGgsIHF1ZXJ5XSwgeyBzaWduYWw6IGFib3J0U2lnbmFsIH0pO1xuICBsZXQgc3Bhd25lZFByb21pc2UgPSBnZXRTcGF3bmVkUHJvbWlzZShzcGF3bmVkKTtcbiAgbGV0IFt7IGVycm9yLCBleGl0Q29kZSwgc2lnbmFsIH0sIHN0ZG91dFJlc3VsdCwgc3RkZXJyUmVzdWx0XSA9IGF3YWl0IGdldFNwYXduZWRSZXN1bHQ8c3RyaW5nPihcbiAgICBzcGF3bmVkLFxuICAgIHsgZW5jb2Rpbmc6IFwidXRmLThcIiB9LFxuICAgIHNwYXduZWRQcm9taXNlLFxuICApO1xuICBjaGVja0Fib3J0ZWQoYWJvcnRTaWduYWwpO1xuXG4gIGlmIChzdGRlcnJSZXN1bHQubWF0Y2goXCIoNSlcIikgfHwgc3RkZXJyUmVzdWx0Lm1hdGNoKFwiKDE0KVwiKSkge1xuICAgIC8vIFRoYXQgbWVhbnMgdGhhdCB0aGUgREIgaXMgYnVzeSBiZWNhdXNlIG9mIGFub3RoZXIgYXBwIGlzIGxvY2tpbmcgaXRcbiAgICAvLyBUaGlzIGhhcHBlbnMgd2hlbiBDaHJvbWUgb3IgQXJjIGlzIG9wZW5lZDogdGhleSBsb2NrIHRoZSBIaXN0b3J5IGRiLlxuICAgIC8vIEFzIGFuIHVnbHkgd29ya2Fyb3VuZCwgd2UgZHVwbGljYXRlIHRoZSBmaWxlIGFuZCByZWFkIHRoYXQgaW5zdGVhZFxuICAgIC8vICh3aXRoIHZmcyB1bml4IC0gbm9uZSB0byBqdXN0IG5vdCBjYXJlIGFib3V0IGxvY2tzKVxuICAgIGxldCB3b3JrYXJvdW5kQ29waWVkRGI6IHN0cmluZyB8IHVuZGVmaW5lZDtcbiAgICBpZiAoIXdvcmthcm91bmRDb3BpZWREYikge1xuICAgICAgY29uc3QgdGVtcEZvbGRlciA9IHBhdGguam9pbihvcy50bXBkaXIoKSwgXCJ1c2VTUUxcIiwgaGFzaChkYXRhYmFzZVBhdGgpKTtcbiAgICAgIGF3YWl0IG1rZGlyKHRlbXBGb2xkZXIsIHsgcmVjdXJzaXZlOiB0cnVlIH0pO1xuICAgICAgY2hlY2tBYm9ydGVkKGFib3J0U2lnbmFsKTtcblxuICAgICAgd29ya2Fyb3VuZENvcGllZERiID0gcGF0aC5qb2luKHRlbXBGb2xkZXIsIFwiZGIuZGJcIik7XG4gICAgICBhd2FpdCBjb3B5RmlsZShkYXRhYmFzZVBhdGgsIHdvcmthcm91bmRDb3BpZWREYik7XG5cbiAgICAgIGF3YWl0IHdyaXRlRmlsZSh3b3JrYXJvdW5kQ29waWVkRGIgKyBcIi1zaG1cIiwgXCJcIik7XG4gICAgICBhd2FpdCB3cml0ZUZpbGUod29ya2Fyb3VuZENvcGllZERiICsgXCItd2FsXCIsIFwiXCIpO1xuXG4gICAgICBjaGVja0Fib3J0ZWQoYWJvcnRTaWduYWwpO1xuICAgIH1cblxuICAgIHNwYXduZWQgPSBjaGlsZFByb2Nlc3Muc3Bhd24oXCJzcWxpdGUzXCIsIFtcIi0tanNvblwiLCBcIi0tcmVhZG9ubHlcIiwgXCItLXZmc1wiLCBcInVuaXgtbm9uZVwiLCB3b3JrYXJvdW5kQ29waWVkRGIsIHF1ZXJ5XSwge1xuICAgICAgc2lnbmFsOiBhYm9ydFNpZ25hbCxcbiAgICB9KTtcbiAgICBzcGF3bmVkUHJvbWlzZSA9IGdldFNwYXduZWRQcm9taXNlKHNwYXduZWQpO1xuICAgIFt7IGVycm9yLCBleGl0Q29kZSwgc2lnbmFsIH0sIHN0ZG91dFJlc3VsdCwgc3RkZXJyUmVzdWx0XSA9IGF3YWl0IGdldFNwYXduZWRSZXN1bHQ8c3RyaW5nPihcbiAgICAgIHNwYXduZWQsXG4gICAgICB7IGVuY29kaW5nOiBcInV0Zi04XCIgfSxcbiAgICAgIHNwYXduZWRQcm9taXNlLFxuICAgICk7XG4gICAgY2hlY2tBYm9ydGVkKGFib3J0U2lnbmFsKTtcbiAgfVxuXG4gIGlmIChlcnJvciB8fCBleGl0Q29kZSAhPT0gMCB8fCBzaWduYWwgIT09IG51bGwpIHtcbiAgICBpZiAoc3RkZXJyUmVzdWx0LmluY2x1ZGVzKFwiYXV0aG9yaXphdGlvbiBkZW5pZWRcIikpIHtcbiAgICAgIHRocm93IG5ldyBQZXJtaXNzaW9uRXJyb3IoXCJZb3UgZG8gbm90IGhhdmUgcGVybWlzc2lvbiB0byBhY2Nlc3MgdGhlIGRhdGFiYXNlLlwiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKHN0ZGVyclJlc3VsdCB8fCBcIlVua25vd24gZXJyb3JcIik7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIEpTT04ucGFyc2Uoc3Rkb3V0UmVzdWx0LnRyaW0oKSB8fCBcIltdXCIpIGFzIFRbXTtcbn1cblxuZnVuY3Rpb24gY2hlY2tBYm9ydGVkKHNpZ25hbD86IEFib3J0U2lnbmFsKSB7XG4gIGlmIChzaWduYWw/LmFib3J0ZWQpIHtcbiAgICBjb25zdCBlcnJvciA9IG5ldyBFcnJvcihcImFib3J0ZWRcIik7XG4gICAgZXJyb3IubmFtZSA9IFwiQWJvcnRFcnJvclwiO1xuICAgIHRocm93IGVycm9yO1xuICB9XG59XG4iLCAiaW1wb3J0IHsgRm9ybSB9IGZyb20gXCJAcmF5Y2FzdC9hcGlcIjtcbmltcG9ydCB7IHVzZVN0YXRlLCB1c2VDYWxsYmFjaywgdXNlTWVtbywgdXNlUmVmLCBTZXRTdGF0ZUFjdGlvbiB9IGZyb20gXCJyZWFjdFwiO1xuaW1wb3J0IHsgdXNlTGF0ZXN0IH0gZnJvbSBcIi4vdXNlTGF0ZXN0XCI7XG5cbi8qKlxuICogU2hvcnRoYW5kcyBmb3IgY29tbW9uIHZhbGlkYXRpb24gY2FzZXNcbiAqL1xuZXhwb3J0IGVudW0gRm9ybVZhbGlkYXRpb24ge1xuICAvKiogU2hvdyBhbiBlcnJvciB3aGVuIHRoZSB2YWx1ZSBvZiB0aGUgaXRlbSBpcyBlbXB0eSAqL1xuICBSZXF1aXJlZCA9IFwicmVxdWlyZWRcIixcbn1cblxudHlwZSBWYWxpZGF0aW9uRXJyb3IgPSBzdHJpbmcgfCB1bmRlZmluZWQgfCBudWxsO1xudHlwZSBWYWxpZGF0b3I8VmFsdWVUeXBlPiA9ICgodmFsdWU6IFZhbHVlVHlwZSB8IHVuZGVmaW5lZCkgPT4gVmFsaWRhdGlvbkVycm9yKSB8IEZvcm1WYWxpZGF0aW9uO1xuXG5mdW5jdGlvbiB2YWxpZGF0aW9uRXJyb3I8VmFsdWVUeXBlPihcbiAgdmFsaWRhdGlvbjogVmFsaWRhdG9yPFZhbHVlVHlwZT4gfCB1bmRlZmluZWQsXG4gIHZhbHVlOiBWYWx1ZVR5cGUgfCB1bmRlZmluZWQsXG4pOiBWYWxpZGF0aW9uRXJyb3Ige1xuICBpZiAodmFsaWRhdGlvbikge1xuICAgIGlmICh0eXBlb2YgdmFsaWRhdGlvbiA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICByZXR1cm4gdmFsaWRhdGlvbih2YWx1ZSk7XG4gICAgfSBlbHNlIGlmICh2YWxpZGF0aW9uID09PSBGb3JtVmFsaWRhdGlvbi5SZXF1aXJlZCkge1xuICAgICAgbGV0IHZhbHVlSXNWYWxpZCA9IHR5cGVvZiB2YWx1ZSAhPT0gXCJ1bmRlZmluZWRcIiAmJiB2YWx1ZSAhPT0gbnVsbDtcbiAgICAgIGlmICh2YWx1ZUlzVmFsaWQpIHtcbiAgICAgICAgc3dpdGNoICh0eXBlb2YgdmFsdWUpIHtcbiAgICAgICAgICBjYXNlIFwic3RyaW5nXCI6XG4gICAgICAgICAgICB2YWx1ZUlzVmFsaWQgPSB2YWx1ZS5sZW5ndGggPiAwO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgY2FzZSBcIm9iamVjdFwiOlxuICAgICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkodmFsdWUpKSB7XG4gICAgICAgICAgICAgIHZhbHVlSXNWYWxpZCA9IHZhbHVlLmxlbmd0aCA+IDA7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHZhbHVlIGluc3RhbmNlb2YgRGF0ZSkge1xuICAgICAgICAgICAgICB2YWx1ZUlzVmFsaWQgPSB2YWx1ZS5nZXRUaW1lKCkgPiAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoIXZhbHVlSXNWYWxpZCkge1xuICAgICAgICByZXR1cm4gXCJUaGUgaXRlbSBpcyByZXF1aXJlZFwiO1xuICAgICAgfVxuICAgIH1cbiAgfVxufVxuXG50eXBlIFZhbGlkYXRpb248VCBleHRlbmRzIEZvcm0uVmFsdWVzPiA9IHsgW2lkIGluIGtleW9mIFRdPzogVmFsaWRhdG9yPFRbaWRdPiB9O1xuXG5pbnRlcmZhY2UgRm9ybVByb3BzPFQgZXh0ZW5kcyBGb3JtLlZhbHVlcz4ge1xuICAvKiogRnVuY3Rpb24gdG8gcGFzcyB0byB0aGUgYG9uU3VibWl0YCBwcm9wIG9mIHRoZSBgPEFjdGlvbi5TdWJtaXRGb3JtPmAgZWxlbWVudC4gSXQgd3JhcHMgdGhlIGluaXRpYWwgYG9uU3VibWl0YCBhcmd1bWVudCB3aXRoIHNvbWUgZ29vZGllcyByZWxhdGVkIHRvIHRoZSB2YWxpZGF0aW9uLiAqL1xuICBoYW5kbGVTdWJtaXQ6ICh2YWx1ZXM6IFQpID0+IHZvaWQgfCBib29sZWFuIHwgUHJvbWlzZTx2b2lkIHwgYm9vbGVhbj47XG4gIC8qKiBUaGUgcHJvcHMgdGhhdCBtdXN0IGJlIHBhc3NlZCB0byB0aGUgYDxGb3JtLkl0ZW0+YCBlbGVtZW50cyB0byBoYW5kbGUgdGhlIHZhbGlkYXRpb25zLiAqL1xuICBpdGVtUHJvcHM6IHtcbiAgICBbaWQgaW4ga2V5b2YgUmVxdWlyZWQ8VD5dOiBQYXJ0aWFsPEZvcm0uSXRlbVByb3BzPFRbaWRdPj4gJiB7XG4gICAgICBpZDogc3RyaW5nO1xuICAgIH07XG4gIH07XG4gIC8qKiBGdW5jdGlvbiB0aGF0IGNhbiBiZSB1c2VkIHRvIHByb2dyYW1tYXRpY2FsbHkgc2V0IHRoZSB2YWxpZGF0aW9uIG9mIGEgc3BlY2lmaWMgZmllbGQuICovXG4gIHNldFZhbGlkYXRpb25FcnJvcjogKGlkOiBrZXlvZiBULCBlcnJvcjogVmFsaWRhdGlvbkVycm9yKSA9PiB2b2lkO1xuICAvKiogRnVuY3Rpb24gdGhhdCBjYW4gYmUgdXNlZCB0byBwcm9ncmFtbWF0aWNhbGx5IHNldCB0aGUgdmFsdWUgb2YgYSBzcGVjaWZpYyBmaWVsZC4gKi9cbiAgc2V0VmFsdWU6IDxLIGV4dGVuZHMga2V5b2YgVD4oaWQ6IEssIHZhbHVlOiBTZXRTdGF0ZUFjdGlvbjxUW0tdPikgPT4gdm9pZDtcbiAgLyoqIFRoZSBjdXJyZW50IHZhbHVlcyBvZiB0aGUgZm9ybS4gKi9cbiAgdmFsdWVzOiBUO1xuICAvKiogRnVuY3Rpb24gdGhhdCBjYW4gYmUgdXNlZCB0byBwcm9ncmFtbWF0aWNhbGx5IGZvY3VzIGEgc3BlY2lmaWMgZmllbGQuICovXG4gIGZvY3VzOiAoaWQ6IGtleW9mIFQpID0+IHZvaWQ7XG4gIC8qKiBGdW5jdGlvbiB0aGF0IGNhbiBiZSB1c2VkIHRvIHJlc2V0IHRoZSB2YWx1ZXMgb2YgdGhlIEZvcm0uICovXG4gIHJlc2V0OiAoaW5pdGlhbFZhbHVlcz86IFBhcnRpYWw8VD4pID0+IHZvaWQ7XG59XG5cbi8qKlxuICogSG9vayB0aGF0IHByb3ZpZGVzIGEgaGlnaC1sZXZlbCBpbnRlcmZhY2UgdG8gd29yayB3aXRoIEZvcm1zLCBhbmQgbW9yZSBwYXJ0aWN1bGFybHksIHdpdGggRm9ybSB2YWxpZGF0aW9ucy4gSXQgaW5jb3Jwb3JhdGVzIGFsbCB0aGUgZ29vZCBwcmFjdGljZXMgdG8gcHJvdmlkZSBhIGdyZWF0IFVzZXIgRXhwZXJpZW5jZSBmb3IgeW91ciBGb3Jtcy5cbiAqXG4gKiBAcmV0dXJucyBhbiBvYmplY3Qgd2hpY2ggY29udGFpbnMgdGhlIG5lY2Vzc2FyeSBtZXRob2RzIGFuZCBwcm9wcyB0byBwcm92aWRlIGEgZ29vZCBVc2VyIEV4cGVyaWVuY2UgaW4geW91ciBGb3JtLlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGBcbiAqIGltcG9ydCB7IEFjdGlvbiwgQWN0aW9uUGFuZWwsIEZvcm0sIHNob3dUb2FzdCwgVG9hc3QgfSBmcm9tIFwiQHJheWNhc3QvYXBpXCI7XG4gKiBpbXBvcnQgeyB1c2VGb3JtLCBGb3JtVmFsaWRhdGlvbiB9IGZyb20gXCJAcmF5Y2FzdC91dGlsc1wiO1xuICpcbiAqIGludGVyZmFjZSBTaWduVXBGb3JtVmFsdWVzIHtcbiAqICAgbmlja25hbWU6IHN0cmluZztcbiAqICAgcGFzc3dvcmQ6IHN0cmluZztcbiAqIH1cbiAqXG4gKiBleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBDb21tYW5kKCkge1xuICogICBjb25zdCB7IGhhbmRsZVN1Ym1pdCwgaXRlbVByb3BzIH0gPSB1c2VGb3JtPFNpZ25VcEZvcm1WYWx1ZXM+KHtcbiAqICAgICBvblN1Ym1pdCh2YWx1ZXMpIHtcbiAqICAgICAgIHNob3dUb2FzdChUb2FzdC5TdHlsZS5TdWNjZXNzLCBcIllheSFcIiwgYCR7dmFsdWVzLm5pY2tuYW1lfSBhY2NvdW50IGNyZWF0ZWRgKTtcbiAqICAgICB9LFxuICogICAgIHZhbGlkYXRpb246IHtcbiAqICAgICAgIG5pY2tuYW1lOiBGb3JtVmFsaWRhdGlvbi5SZXF1aXJlZCxcbiAqICAgICAgIHBhc3N3b3JkOiAodmFsdWUpID0+IHtcbiAqICAgICAgICAgaWYgKHZhbHVlICYmIHZhbHVlLmxlbmd0aCA8IDgpIHtcbiAqICAgICAgICAgICByZXR1cm4gXCJQYXNzd29yZCBtdXN0IGJlIGF0IGxlYXN0IDggc3ltYm9sc1wiO1xuICogICAgICAgICB9IGVsc2UgaWYgKCF2YWx1ZSkge1xuICogICAgICAgICAgIHJldHVybiBcIlRoZSBpdGVtIGlzIHJlcXVpcmVkXCI7XG4gKiAgICAgICAgIH1cbiAqICAgICAgIH0sXG4gKiAgICAgfSxcbiAqICAgfSk7XG4gKlxuICogICByZXR1cm4gKFxuICogICAgIDxGb3JtXG4gKiAgICAgICBhY3Rpb25zPXtcbiAqICAgICAgICAgPEFjdGlvblBhbmVsPlxuICogICAgICAgICAgIDxBY3Rpb24uU3VibWl0Rm9ybSB0aXRsZT1cIlN1Ym1pdFwiIG9uU3VibWl0PXtoYW5kbGVTdWJtaXR9IC8+XG4gKiAgICAgICAgIDwvQWN0aW9uUGFuZWw+XG4gKiAgICAgICB9XG4gKiAgICAgPlxuICogICAgICAgPEZvcm0uVGV4dEZpZWxkIHRpdGxlPVwiTmlja25hbWVcIiBwbGFjZWhvbGRlcj1cIkVudGVyIHlvdXIgbmlja25hbWVcIiB7Li4uaXRlbVByb3BzLm5pY2tuYW1lfSAvPlxuICogICAgICAgPEZvcm0uUGFzc3dvcmRGaWVsZFxuICogICAgICAgICB0aXRsZT1cIlBhc3N3b3JkXCJcbiAqICAgICAgICAgcGxhY2Vob2xkZXI9XCJFbnRlciBwYXNzd29yZCBhdCBsZWFzdCA4IGNoYXJhY3RlcnMgbG9uZ1wiXG4gKiAgICAgICAgIHsuLi5pdGVtUHJvcHMucGFzc3dvcmR9XG4gKiAgICAgICAvPlxuICogICAgIDwvRm9ybT5cbiAqICAgKTtcbiAqIH1cbiAqIGBgYFxuICovXG5leHBvcnQgZnVuY3Rpb24gdXNlRm9ybTxUIGV4dGVuZHMgRm9ybS5WYWx1ZXM+KHByb3BzOiB7XG4gIC8qKiBDYWxsYmFjayB0aGF0IHdpbGwgYmUgY2FsbGVkIHdoZW4gdGhlIGZvcm0gaXMgc3VibWl0dGVkIGFuZCBhbGwgdmFsaWRhdGlvbnMgcGFzcy4gKi9cbiAgb25TdWJtaXQ6ICh2YWx1ZXM6IFQpID0+IHZvaWQgfCBib29sZWFuIHwgUHJvbWlzZTx2b2lkIHwgYm9vbGVhbj47XG4gIC8qKiBUaGUgaW5pdGlhbCB2YWx1ZXMgdG8gc2V0IHdoZW4gdGhlIEZvcm0gaXMgZmlyc3QgcmVuZGVyZWQuICovXG4gIGluaXRpYWxWYWx1ZXM/OiBQYXJ0aWFsPFQ+O1xuICAvKiogVGhlIHZhbGlkYXRpb24gcnVsZXMgZm9yIHRoZSBGb3JtLiBBIHZhbGlkYXRpb24gZm9yIGEgRm9ybSBpdGVtIGlzIGEgZnVuY3Rpb24gdGhhdCB0YWtlcyB0aGUgY3VycmVudCB2YWx1ZSBvZiB0aGUgaXRlbSBhcyBhbiBhcmd1bWVudCBhbmQgbXVzdCByZXR1cm4gYSBzdHJpbmcgd2hlbiB0aGUgdmFsaWRhdGlvbiBpcyBmYWlsaW5nLlxuICAgKlxuICAgKiBUaGVyZSBhcmUgYWxzbyBzb21lIHNob3J0aGFuZHMgZm9yIGNvbW1vbiBjYXNlcywgc2VlIHtAbGluayBGb3JtVmFsaWRhdGlvbn0uXG4gICAqICovXG4gIHZhbGlkYXRpb24/OiBWYWxpZGF0aW9uPFQ+O1xufSk6IEZvcm1Qcm9wczxUPiB7XG4gIGNvbnN0IHsgb25TdWJtaXQ6IF9vblN1Ym1pdCwgdmFsaWRhdGlvbiwgaW5pdGlhbFZhbHVlcyA9IHt9IH0gPSBwcm9wcztcblxuICAvLyBAdHMtZXhwZWN0LWVycm9yIGl0J3MgZmluZSBpZiB3ZSBkb24ndCBzcGVjaWZ5IGFsbCB0aGUgdmFsdWVzXG4gIGNvbnN0IFt2YWx1ZXMsIHNldFZhbHVlc10gPSB1c2VTdGF0ZTxUPihpbml0aWFsVmFsdWVzKTtcbiAgY29uc3QgW2Vycm9ycywgc2V0RXJyb3JzXSA9IHVzZVN0YXRlPHsgW2lkIGluIGtleW9mIFRdPzogVmFsaWRhdGlvbkVycm9yIH0+KHt9KTtcbiAgY29uc3QgcmVmcyA9IHVzZVJlZjx7IFtpZCBpbiBrZXlvZiBUXT86IEZvcm0uSXRlbVJlZmVyZW5jZSB9Pih7fSk7XG5cbiAgY29uc3QgbGF0ZXN0VmFsaWRhdGlvbiA9IHVzZUxhdGVzdDxWYWxpZGF0aW9uPFQ+Pih2YWxpZGF0aW9uIHx8IHt9KTtcbiAgY29uc3QgbGF0ZXN0T25TdWJtaXQgPSB1c2VMYXRlc3QoX29uU3VibWl0KTtcblxuICBjb25zdCBmb2N1cyA9IHVzZUNhbGxiYWNrKFxuICAgIChpZDoga2V5b2YgVCkgPT4ge1xuICAgICAgcmVmcy5jdXJyZW50W2lkXT8uZm9jdXMoKTtcbiAgICB9LFxuICAgIFtyZWZzXSxcbiAgKTtcblxuICBjb25zdCBoYW5kbGVTdWJtaXQgPSB1c2VDYWxsYmFjayhcbiAgICBhc3luYyAodmFsdWVzOiBUKTogUHJvbWlzZTxib29sZWFuPiA9PiB7XG4gICAgICBsZXQgdmFsaWRhdGlvbkVycm9yczogZmFsc2UgfCB7IFtrZXkgaW4ga2V5b2YgVF0/OiBWYWxpZGF0aW9uRXJyb3IgfSA9IGZhbHNlO1xuICAgICAgZm9yIChjb25zdCBbaWQsIHZhbGlkYXRpb25dIG9mIE9iamVjdC5lbnRyaWVzKGxhdGVzdFZhbGlkYXRpb24uY3VycmVudCkpIHtcbiAgICAgICAgY29uc3QgZXJyb3IgPSB2YWxpZGF0aW9uRXJyb3IodmFsaWRhdGlvbiwgdmFsdWVzW2lkXSk7XG4gICAgICAgIGlmIChlcnJvcikge1xuICAgICAgICAgIGlmICghdmFsaWRhdGlvbkVycm9ycykge1xuICAgICAgICAgICAgdmFsaWRhdGlvbkVycm9ycyA9IHt9O1xuICAgICAgICAgICAgLy8gd2UgZm9jdXMgdGhlIGZpcnN0IGl0ZW0gdGhhdCBoYXMgYW4gZXJyb3JcbiAgICAgICAgICAgIGZvY3VzKGlkKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdmFsaWRhdGlvbkVycm9yc1tpZCBhcyBrZXlvZiBUXSA9IGVycm9yO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAodmFsaWRhdGlvbkVycm9ycykge1xuICAgICAgICBzZXRFcnJvcnModmFsaWRhdGlvbkVycm9ycyk7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGxhdGVzdE9uU3VibWl0LmN1cnJlbnQodmFsdWVzKTtcbiAgICAgIHJldHVybiB0eXBlb2YgcmVzdWx0ID09PSBcImJvb2xlYW5cIiA/IHJlc3VsdCA6IHRydWU7XG4gICAgfSxcbiAgICBbbGF0ZXN0VmFsaWRhdGlvbiwgbGF0ZXN0T25TdWJtaXQsIGZvY3VzXSxcbiAgKTtcblxuICBjb25zdCBzZXRWYWxpZGF0aW9uRXJyb3IgPSB1c2VDYWxsYmFjayhcbiAgICAoaWQ6IGtleW9mIFQsIGVycm9yOiBWYWxpZGF0aW9uRXJyb3IpID0+IHtcbiAgICAgIHNldEVycm9ycygoZXJyb3JzKSA9PiAoeyAuLi5lcnJvcnMsIFtpZF06IGVycm9yIH0pKTtcbiAgICB9LFxuICAgIFtzZXRFcnJvcnNdLFxuICApO1xuXG4gIGNvbnN0IHNldFZhbHVlID0gdXNlQ2FsbGJhY2soXG4gICAgZnVuY3Rpb24gPEsgZXh0ZW5kcyBrZXlvZiBUPihpZDogSywgdmFsdWU6IFNldFN0YXRlQWN0aW9uPFRbS10+KSB7XG4gICAgICAvLyBAdHMtZXhwZWN0LWVycm9yIFRTIGlzIGFsd2F5cyBjb25mdXNlZCBhYm91dCBTZXRTdGF0ZUFjdGlvbiwgYnV0IGl0J3MgZmluZSBoZXJlXG4gICAgICBzZXRWYWx1ZXMoKHZhbHVlcykgPT4gKHsgLi4udmFsdWVzLCBbaWRdOiB0eXBlb2YgdmFsdWUgPT09IFwiZnVuY3Rpb25cIiA/IHZhbHVlKHZhbHVlc1tpZF0pIDogdmFsdWUgfSkpO1xuICAgIH0sXG4gICAgW3NldFZhbHVlc10sXG4gICk7XG5cbiAgY29uc3QgaXRlbVByb3BzID0gdXNlTWVtbzx7IFtpZCBpbiBrZXlvZiBSZXF1aXJlZDxUPl06IFBhcnRpYWw8Rm9ybS5JdGVtUHJvcHM8VFtpZF0+PiAmIHsgaWQ6IHN0cmluZyB9IH0+KCgpID0+IHtcbiAgICAvLyB3ZSBoYXZlIHRvIHVzZSBhIHByb3h5IGJlY2F1c2Ugd2UgZG9uJ3QgYWN0dWFsbHkgaGF2ZSBhbnkgb2JqZWN0IHRvIGl0ZXJhdGUgdGhyb3VnaFxuICAgIC8vIHNvIGluc3RlYWQgd2UgZHluYW1pY2FsbHkgY3JlYXRlIHRoZSBwcm9wcyB3aGVuIHJlcXVpcmVkXG4gICAgcmV0dXJuIG5ldyBQcm94eTx7IFtpZCBpbiBrZXlvZiBSZXF1aXJlZDxUPl06IFBhcnRpYWw8Rm9ybS5JdGVtUHJvcHM8VFtpZF0+PiAmIHsgaWQ6IHN0cmluZyB9IH0+KFxuICAgICAgLy8gQHRzLWV4cGVjdC1lcnJvciB0aGUgd2hvbGUgcG9pbnQgb2YgYSBwcm94eS4uLlxuICAgICAge30sXG4gICAgICB7XG4gICAgICAgIGdldCh0YXJnZXQsIGlkOiBrZXlvZiBUKSB7XG4gICAgICAgICAgY29uc3QgdmFsaWRhdGlvbiA9IGxhdGVzdFZhbGlkYXRpb24uY3VycmVudFtpZF07XG4gICAgICAgICAgY29uc3QgdmFsdWUgPSB2YWx1ZXNbaWRdO1xuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBvbkNoYW5nZSh2YWx1ZSkge1xuICAgICAgICAgICAgICBpZiAoZXJyb3JzW2lkXSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGVycm9yID0gdmFsaWRhdGlvbkVycm9yKHZhbGlkYXRpb24sIHZhbHVlKTtcbiAgICAgICAgICAgICAgICBpZiAoIWVycm9yKSB7XG4gICAgICAgICAgICAgICAgICBzZXRWYWxpZGF0aW9uRXJyb3IoaWQsIHVuZGVmaW5lZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIHNldFZhbHVlKGlkLCB2YWx1ZSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgb25CbHVyKGV2ZW50KSB7XG4gICAgICAgICAgICAgIGNvbnN0IGVycm9yID0gdmFsaWRhdGlvbkVycm9yKHZhbGlkYXRpb24sIGV2ZW50LnRhcmdldC52YWx1ZSk7XG4gICAgICAgICAgICAgIGlmIChlcnJvcikge1xuICAgICAgICAgICAgICAgIHNldFZhbGlkYXRpb25FcnJvcihpZCwgZXJyb3IpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZXJyb3I6IGVycm9yc1tpZF0sXG4gICAgICAgICAgICBpZCxcbiAgICAgICAgICAgIC8vIHdlIHNob3VsZG4ndCByZXR1cm4gYHVuZGVmaW5lZGAgb3RoZXJ3aXNlIGl0IHdpbGwgYmUgYW4gdW5jb250cm9sbGVkIGNvbXBvbmVudFxuICAgICAgICAgICAgdmFsdWU6IHR5cGVvZiB2YWx1ZSA9PT0gXCJ1bmRlZmluZWRcIiA/IG51bGwgOiB2YWx1ZSxcbiAgICAgICAgICAgIHJlZjogKGluc3RhbmNlOiBGb3JtLkl0ZW1SZWZlcmVuY2UpID0+IHtcbiAgICAgICAgICAgICAgcmVmcy5jdXJyZW50W2lkXSA9IGluc3RhbmNlO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9IGFzIFBhcnRpYWw8Rm9ybS5JdGVtUHJvcHM8VFtrZXlvZiBUXT4+ICYgeyBpZDogc3RyaW5nIH07XG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICk7XG4gIH0sIFtlcnJvcnMsIGxhdGVzdFZhbGlkYXRpb24sIHNldFZhbGlkYXRpb25FcnJvciwgdmFsdWVzLCByZWZzLCBzZXRWYWx1ZV0pO1xuXG4gIGNvbnN0IHJlc2V0ID0gdXNlQ2FsbGJhY2soXG4gICAgKHZhbHVlcz86IFBhcnRpYWw8VD4pID0+IHtcbiAgICAgIHNldEVycm9ycyh7fSk7XG4gICAgICBPYmplY3QuZW50cmllcyhyZWZzLmN1cnJlbnQpLmZvckVhY2goKFtpZCwgcmVmXSkgPT4ge1xuICAgICAgICBpZiAoIXZhbHVlcz8uW2lkXSkge1xuICAgICAgICAgIHJlZj8ucmVzZXQoKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICBpZiAodmFsdWVzKSB7XG4gICAgICAgIC8vIEB0cy1leHBlY3QtZXJyb3IgaXQncyBmaW5lIGlmIHdlIGRvbid0IHNwZWNpZnkgYWxsIHRoZSB2YWx1ZXNcbiAgICAgICAgc2V0VmFsdWVzKHZhbHVlcyk7XG4gICAgICB9XG4gICAgfSxcbiAgICBbc2V0VmFsdWVzLCBzZXRFcnJvcnMsIHJlZnNdLFxuICApO1xuXG4gIHJldHVybiB7IGhhbmRsZVN1Ym1pdCwgc2V0VmFsaWRhdGlvbkVycm9yLCBzZXRWYWx1ZSwgdmFsdWVzLCBpdGVtUHJvcHMsIGZvY3VzLCByZXNldCB9O1xufVxuIiwgImltcG9ydCB7IHVzZVJlZiwgdXNlU3RhdGUgfSBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCB7IEFJIH0gZnJvbSBcIkByYXljYXN0L2FwaVwiO1xuaW1wb3J0IHsgUHJvbWlzZU9wdGlvbnMsIHVzZVByb21pc2UgfSBmcm9tIFwiLi91c2VQcm9taXNlXCI7XG5pbXBvcnQgeyBGdW5jdGlvblJldHVybmluZ1Byb21pc2UgfSBmcm9tIFwiLi90eXBlc1wiO1xuXG4vKipcbiAqIFN0cmVhbSBhIHByb21wdCBjb21wbGV0aW9uLlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGB0eXBlc2NyaXB0XG4gKiBpbXBvcnQgeyBEZXRhaWwsIExhdW5jaFByb3BzIH0gZnJvbSBcIkByYXljYXN0L2FwaVwiO1xuICogaW1wb3J0IHsgdXNlIEFJIH0gZnJvbSBcIkByYXljYXN0L3V0aWxzXCI7XG4gKlxuICogZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gQ29tbWFuZChwcm9wczogTGF1bmNoUHJvcHM8eyBhcmd1bWVudHM6IHsgcHJvbXB0OiBzdHJpbmcgfSB9Pikge1xuICogICBjb25zdCB7IGlzTG9hZGluZywgZGF0YSB9ID0gdXNlQUkocHJvcHMuYXJndW1lbnRzLnByb21wdCk7XG4gKlxuICogICByZXR1cm4gPERldGFpbCBpc0xvYWRpbmc9e2lzTG9hZGluZ30gbWFya2Rvd249e2RhdGF9IC8+O1xuICogfVxuICogYGBgXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB1c2VBSShcbiAgcHJvbXB0OiBzdHJpbmcsXG4gIG9wdGlvbnM6IHtcbiAgICAvKipcbiAgICAgKiBDb25jcmV0ZSB0YXNrcywgc3VjaCBhcyBmaXhpbmcgZ3JhbW1hciwgcmVxdWlyZSBsZXNzIGNyZWF0aXZpdHkgd2hpbGUgb3Blbi1lbmRlZCBxdWVzdGlvbnMsIHN1Y2ggYXMgZ2VuZXJhdGluZyBpZGVhcywgcmVxdWlyZSBtb3JlLlxuICAgICAqIElmIGEgbnVtYmVyIGlzIHBhc3NlZCwgaXQgbmVlZHMgdG8gYmUgaW4gdGhlIHJhbmdlIDAtMi4gRm9yIGxhcmdlciB2YWx1ZXMsIDIgd2lsbCBiZSB1c2VkLiBGb3IgbG93ZXIgdmFsdWVzLCAwIHdpbGwgYmUgdXNlZC5cbiAgICAgKi9cbiAgICBjcmVhdGl2aXR5PzogQUkuQ3JlYXRpdml0eTtcbiAgICAvKipcbiAgICAgKiBUaGUgQUkgbW9kZWwgdG8gdXNlIHRvIGFuc3dlciB0byB0aGUgcHJvbXB0LlxuICAgICAqL1xuICAgIG1vZGVsPzogQUkuTW9kZWw7XG4gICAgLyoqXG4gICAgICogV2hldGhlciB0byBzdHJlYW0gdGhlIGFuc3dlciBvciBvbmx5IHVwZGF0ZSB0aGUgZGF0YSB3aGVuIHRoZSBlbnRpcmUgYW5zd2VyIGhhcyBiZWVuIHJlY2VpdmVkLlxuICAgICAqL1xuICAgIHN0cmVhbT86IGJvb2xlYW47XG4gIH0gJiBPbWl0PFByb21pc2VPcHRpb25zPEZ1bmN0aW9uUmV0dXJuaW5nUHJvbWlzZT4sIFwiYWJvcnRhYmxlXCI+ID0ge30sXG4pIHtcbiAgY29uc3QgeyBjcmVhdGl2aXR5LCBzdHJlYW0sIG1vZGVsLCAuLi51c2VQcm9taXNlT3B0aW9ucyB9ID0gb3B0aW9ucztcbiAgY29uc3QgW2RhdGEsIHNldERhdGFdID0gdXNlU3RhdGUoXCJcIik7XG4gIGNvbnN0IGFib3J0YWJsZSA9IHVzZVJlZjxBYm9ydENvbnRyb2xsZXI+KG51bGwpO1xuICBjb25zdCB7IGlzTG9hZGluZywgZXJyb3IsIHJldmFsaWRhdGUgfSA9IHVzZVByb21pc2UoXG4gICAgYXN5bmMgKHByb21wdDogc3RyaW5nLCBjcmVhdGl2aXR5PzogQUkuQ3JlYXRpdml0eSwgc2hvdWxkU3RyZWFtPzogYm9vbGVhbikgPT4ge1xuICAgICAgc2V0RGF0YShcIlwiKTtcbiAgICAgIGNvbnN0IHN0cmVhbSA9IEFJLmFzayhwcm9tcHQsIHsgY3JlYXRpdml0eSwgbW9kZWwsIHNpZ25hbDogYWJvcnRhYmxlLmN1cnJlbnQ/LnNpZ25hbCB9KTtcbiAgICAgIGlmIChzaG91bGRTdHJlYW0gPT09IGZhbHNlKSB7XG4gICAgICAgIHNldERhdGEoYXdhaXQgc3RyZWFtKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHN0cmVhbS5vbihcImRhdGFcIiwgKGRhdGEpID0+IHtcbiAgICAgICAgICBzZXREYXRhKCh4KSA9PiB4ICsgZGF0YSk7XG4gICAgICAgIH0pO1xuICAgICAgICBhd2FpdCBzdHJlYW07XG4gICAgICB9XG4gICAgfSxcbiAgICBbcHJvbXB0LCBjcmVhdGl2aXR5LCBzdHJlYW1dLFxuICAgIHsgLi4udXNlUHJvbWlzZU9wdGlvbnMsIGFib3J0YWJsZSB9LFxuICApO1xuXG4gIHJldHVybiB7IGlzTG9hZGluZywgZGF0YSwgZXJyb3IsIHJldmFsaWRhdGUgfTtcbn1cbiIsICJpbXBvcnQgeyB1c2VNZW1vLCB1c2VDYWxsYmFjayB9IGZyb20gXCJyZWFjdFwiO1xuaW1wb3J0IHsgdXNlTGF0ZXN0IH0gZnJvbSBcIi4vdXNlTGF0ZXN0XCI7XG5pbXBvcnQgeyB1c2VDYWNoZWRTdGF0ZSB9IGZyb20gXCIuL3VzZUNhY2hlZFN0YXRlXCI7XG5cbi8vIFRoZSBhbGdvcml0aG0gYmVsb3cgaXMgaW5zcGlyZWQgYnkgdGhlIG9uZSB1c2VkIGJ5IEZpcmVmb3g6XG4vLyBodHRwczovL3dpa2kubW96aWxsYS5vcmcvVXNlcjpKZXNzZS9OZXdGcmVjZW5jeVxuXG50eXBlIEZyZWNlbmN5ID0ge1xuICBsYXN0VmlzaXRlZDogbnVtYmVyO1xuICBmcmVjZW5jeTogbnVtYmVyO1xufTtcblxuY29uc3QgSEFMRl9MSUZFX0RBWVMgPSAxMDtcblxuY29uc3QgTVNfUEVSX0RBWSA9IDI0ICogNjAgKiA2MCAqIDEwMDA7XG5cbmNvbnN0IFZJU0lUX1RZUEVfUE9JTlRTID0ge1xuICBEZWZhdWx0OiAxMDAsXG4gIEVtYmVkOiAwLFxuICBCb29rbWFyazogMTQwLFxufTtcblxuZnVuY3Rpb24gZ2V0TmV3RnJlY2VuY3koaXRlbT86IEZyZWNlbmN5KTogRnJlY2VuY3kge1xuICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xuICBjb25zdCBsYXN0VmlzaXRlZCA9IGl0ZW0gPyBpdGVtLmxhc3RWaXNpdGVkIDogMDtcbiAgY29uc3QgZnJlY2VuY3kgPSBpdGVtID8gaXRlbS5mcmVjZW5jeSA6IDA7XG5cbiAgY29uc3QgdmlzaXRBZ2VJbkRheXMgPSAobm93IC0gbGFzdFZpc2l0ZWQpIC8gTVNfUEVSX0RBWTtcbiAgY29uc3QgREVDQVlfUkFURV9DT05TVEFOVCA9IE1hdGgubG9nKDIpIC8gKEhBTEZfTElGRV9EQVlTICogTVNfUEVSX0RBWSk7XG4gIGNvbnN0IGN1cnJlbnRWaXNpdFZhbHVlID0gVklTSVRfVFlQRV9QT0lOVFMuRGVmYXVsdCAqIE1hdGguZXhwKC1ERUNBWV9SQVRFX0NPTlNUQU5UICogdmlzaXRBZ2VJbkRheXMpO1xuICBjb25zdCB0b3RhbFZpc2l0VmFsdWUgPSBmcmVjZW5jeSArIGN1cnJlbnRWaXNpdFZhbHVlO1xuXG4gIHJldHVybiB7XG4gICAgbGFzdFZpc2l0ZWQ6IG5vdyxcbiAgICBmcmVjZW5jeTogdG90YWxWaXNpdFZhbHVlLFxuICB9O1xufVxuXG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuY29uc3QgZGVmYXVsdEtleSA9IChpdGVtOiBhbnkpOiBzdHJpbmcgPT4ge1xuICBpZiAoXG4gICAgcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiICYmXG4gICAgKHR5cGVvZiBpdGVtICE9PSBcIm9iamVjdFwiIHx8ICFpdGVtIHx8ICEoXCJpZFwiIGluIGl0ZW0pIHx8IHR5cGVvZiBpdGVtLmlkICE9IFwic3RyaW5nXCIpXG4gICkge1xuICAgIHRocm93IG5ldyBFcnJvcihcIlNwZWNpZnkgYSBrZXkgZnVuY3Rpb24gb3IgbWFrZSBzdXJlIHlvdXIgaXRlbXMgaGF2ZSBhbiAnaWQnIHByb3BlcnR5XCIpO1xuICB9XG4gIHJldHVybiBpdGVtLmlkO1xufTtcblxuLyoqXG4gKiBTb3J0IGFuIGFycmF5IGJ5IGl0cyBmcmVjZW5jeSBhbmQgcHJvdmlkZSBtZXRob2RzIHRvIHVwZGF0ZSB0aGUgZnJlY2VuY3kgb2YgaXRzIGl0ZW1zLlxuICogRnJlY2VuY3kgaXMgYSBtZWFzdXJlIHRoYXQgY29tYmluZXMgZnJlcXVlbmN5IGFuZCByZWNlbmN5LiBUaGUgbW9yZSBvZnRlbiBhbiBpdGVtIGlzIHZpc2l0ZWQvdXNlZCwgYW5kIHRoZSBtb3JlIHJlY2VudGx5IGFuIGl0ZW0gaXMgdmlzaXRlZC91c2VkLCB0aGUgaGlnaGVyIGl0IHdpbGwgcmFuay5cbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgXG4gKiBpbXBvcnQgeyBMaXN0LCBBY3Rpb25QYW5lbCwgQWN0aW9uLCBJY29uIH0gZnJvbSBcIkByYXljYXN0L2FwaVwiO1xuICogaW1wb3J0IHsgdXNlRmV0Y2gsIHVzZUZyZWNlbmN5U29ydGluZyB9IGZyb20gXCJAcmF5Y2FzdC91dGlsc1wiO1xuICpcbiAqIGV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIENvbW1hbmQoKSB7XG4gKiAgIGNvbnN0IHsgaXNMb2FkaW5nLCBkYXRhIH0gPSB1c2VGZXRjaChcImh0dHBzOi8vYXBpLmV4YW1wbGVcIik7XG4gKiAgIGNvbnN0IHsgZGF0YTogc29ydGVkRGF0YSwgdmlzaXRJdGVtLCByZXNldFJhbmtpbmcgfSA9IHVzZUZyZWNlbmN5U29ydGluZyhkYXRhKTtcbiAqXG4gKiAgIHJldHVybiAoXG4gKiAgICAgPExpc3QgaXNMb2FkaW5nPXtpc0xvYWRpbmd9PlxuICogICAgICAge3NvcnRlZERhdGEubWFwKChpdGVtKSA9PiAoXG4gKiAgICAgICAgIDxMaXN0Lkl0ZW1cbiAqICAgICAgICAgICBrZXk9e2l0ZW0uaWR9XG4gKiAgICAgICAgICAgdGl0bGU9e2l0ZW0udGl0bGV9XG4gKiAgICAgICAgICAgYWN0aW9ucz17XG4gKiAgICAgICAgICAgICA8QWN0aW9uUGFuZWw+XG4gKiAgICAgICAgICAgICAgIDxBY3Rpb24uT3BlbkluQnJvd3NlciB1cmw9e2l0ZW0udXJsfSBvbk9wZW49eygpID0+IHZpc2l0SXRlbShpdGVtKX0gLz5cbiAqICAgICAgICAgICAgICAgPEFjdGlvbi5Db3B5VG9DbGlwYm9hcmQgdGl0bGU9XCJDb3B5IExpbmtcIiBjb250ZW50PXtpdGVtLnVybH0gb25Db3B5PXsoKSA9PiB2aXNpdEl0ZW0oaXRlbSl9IC8+XG4gKiAgICAgICAgICAgICAgIDxBY3Rpb24gdGl0bGU9XCJSZXNldCBSYW5raW5nXCIgaWNvbj17SWNvbi5BcnJvd0NvdW50ZXJDbG9ja3dpc2V9IG9uQWN0aW9uPXsoKSA9PiByZXNldFJhbmtpbmcoaXRlbSl9IC8+XG4gKiAgICAgICAgICAgICA8L0FjdGlvblBhbmVsPlxuICogICAgICAgICAgIH1cbiAqICAgICAgICAgLz5cbiAqICAgICAgICkpfVxuICogICAgIDwvTGlzdD5cbiAqICAgKTtcbiAqIH07XG4gKiBgYGBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHVzZUZyZWNlbmN5U29ydGluZzxUIGV4dGVuZHMgeyBpZDogc3RyaW5nIH0+KFxuICBkYXRhPzogVFtdLFxuICBvcHRpb25zPzogeyBuYW1lc3BhY2U/OiBzdHJpbmc7IGtleT86IChpdGVtOiBUKSA9PiBzdHJpbmc7IHNvcnRVbnZpc2l0ZWQ/OiAoYTogVCwgYjogVCkgPT4gbnVtYmVyIH0sXG4pOiB7XG4gIGRhdGE6IFRbXTtcbiAgdmlzaXRJdGVtOiAoaXRlbTogVCkgPT4gUHJvbWlzZTx2b2lkPjtcbiAgcmVzZXRSYW5raW5nOiAoaXRlbTogVCkgPT4gUHJvbWlzZTx2b2lkPjtcbn07XG5leHBvcnQgZnVuY3Rpb24gdXNlRnJlY2VuY3lTb3J0aW5nPFQ+KFxuICBkYXRhOiBUW10gfCB1bmRlZmluZWQsXG4gIG9wdGlvbnM6IHsgbmFtZXNwYWNlPzogc3RyaW5nOyBrZXk6IChpdGVtOiBUKSA9PiBzdHJpbmc7IHNvcnRVbnZpc2l0ZWQ/OiAoYTogVCwgYjogVCkgPT4gbnVtYmVyIH0sXG4pOiB7XG4gIGRhdGE6IFRbXTtcbiAgdmlzaXRJdGVtOiAoaXRlbTogVCkgPT4gUHJvbWlzZTx2b2lkPjtcbiAgcmVzZXRSYW5raW5nOiAoaXRlbTogVCkgPT4gUHJvbWlzZTx2b2lkPjtcbn07XG5leHBvcnQgZnVuY3Rpb24gdXNlRnJlY2VuY3lTb3J0aW5nPFQ+KFxuICBkYXRhPzogVFtdLFxuICBvcHRpb25zPzogeyBuYW1lc3BhY2U/OiBzdHJpbmc7IGtleT86IChpdGVtOiBUKSA9PiBzdHJpbmc7IHNvcnRVbnZpc2l0ZWQ/OiAoYTogVCwgYjogVCkgPT4gbnVtYmVyIH0sXG4pOiB7XG4gIGRhdGE6IFRbXTtcbiAgdmlzaXRJdGVtOiAoaXRlbTogVCkgPT4gUHJvbWlzZTx2b2lkPjtcbiAgcmVzZXRSYW5raW5nOiAoaXRlbTogVCkgPT4gUHJvbWlzZTx2b2lkPjtcbn0ge1xuICBjb25zdCBrZXlSZWYgPSB1c2VMYXRlc3Qob3B0aW9ucz8ua2V5IHx8IGRlZmF1bHRLZXkpO1xuICBjb25zdCBzb3J0VW52aXNpdGVkUmVmID0gdXNlTGF0ZXN0KG9wdGlvbnM/LnNvcnRVbnZpc2l0ZWQpO1xuXG4gIGNvbnN0IFtzdG9yZWRGcmVjZW5jaWVzLCBzZXRTdG9yZWRGcmVjZW5jaWVzXSA9IHVzZUNhY2hlZFN0YXRlPFJlY29yZDxzdHJpbmcsIEZyZWNlbmN5IHwgdW5kZWZpbmVkPj4oXG4gICAgYHJheWNhc3RfZnJlY2VuY3lfJHtvcHRpb25zPy5uYW1lc3BhY2V9YCxcbiAgICB7fSxcbiAgKTtcblxuICBjb25zdCB2aXNpdEl0ZW0gPSB1c2VDYWxsYmFjayhcbiAgICBhc3luYyBmdW5jdGlvbiB1cGRhdGVGcmVjZW5jeShpdGVtOiBUKSB7XG4gICAgICBjb25zdCBpdGVtS2V5ID0ga2V5UmVmLmN1cnJlbnQoaXRlbSk7XG5cbiAgICAgIHNldFN0b3JlZEZyZWNlbmNpZXMoKHN0b3JlZEZyZWNlbmNpZXMpID0+IHtcbiAgICAgICAgY29uc3QgZnJlY2VuY3kgPSBzdG9yZWRGcmVjZW5jaWVzW2l0ZW1LZXldO1xuICAgICAgICBjb25zdCBuZXdGcmVjZW5jeSA9IGdldE5ld0ZyZWNlbmN5KGZyZWNlbmN5KTtcblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIC4uLnN0b3JlZEZyZWNlbmNpZXMsXG4gICAgICAgICAgW2l0ZW1LZXldOiBuZXdGcmVjZW5jeSxcbiAgICAgICAgfTtcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgW2tleVJlZiwgc2V0U3RvcmVkRnJlY2VuY2llc10sXG4gICk7XG5cbiAgY29uc3QgcmVzZXRSYW5raW5nID0gdXNlQ2FsbGJhY2soXG4gICAgYXN5bmMgZnVuY3Rpb24gcmVtb3ZlRnJlY2VuY3koaXRlbTogVCkge1xuICAgICAgY29uc3QgaXRlbUtleSA9IGtleVJlZi5jdXJyZW50KGl0ZW0pO1xuXG4gICAgICBzZXRTdG9yZWRGcmVjZW5jaWVzKChzdG9yZWRGcmVjZW5jaWVzKSA9PiB7XG4gICAgICAgIGNvbnN0IG5ld0ZyZW5jZW5jaWVzID0geyAuLi5zdG9yZWRGcmVjZW5jaWVzIH07XG4gICAgICAgIGRlbGV0ZSBuZXdGcmVuY2VuY2llc1tpdGVtS2V5XTtcblxuICAgICAgICByZXR1cm4gbmV3RnJlbmNlbmNpZXM7XG4gICAgICB9KTtcbiAgICB9LFxuICAgIFtrZXlSZWYsIHNldFN0b3JlZEZyZWNlbmNpZXNdLFxuICApO1xuXG4gIGNvbnN0IHNvcnRlZERhdGEgPSB1c2VNZW1vKCgpID0+IHtcbiAgICBpZiAoIWRhdGEpIHtcbiAgICAgIHJldHVybiBbXTtcbiAgICB9XG5cbiAgICByZXR1cm4gZGF0YS5zb3J0KChhLCBiKSA9PiB7XG4gICAgICBjb25zdCBmcmVjZW5jeUEgPSBzdG9yZWRGcmVjZW5jaWVzW2tleVJlZi5jdXJyZW50KGEpXTtcbiAgICAgIGNvbnN0IGZyZWNlbmN5QiA9IHN0b3JlZEZyZWNlbmNpZXNba2V5UmVmLmN1cnJlbnQoYildO1xuXG4gICAgICAvLyBJZiBhIGhhcyBhIGZyZWNlbmN5LCBidXQgYiBkb2Vzbid0LCBhIHNob3VsZCBjb21lIGZpcnN0XG4gICAgICBpZiAoZnJlY2VuY3lBICYmICFmcmVjZW5jeUIpIHtcbiAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgfVxuXG4gICAgICAvLyBJZiBiIGhhcyBhIGZyZWNlbmN5LCBidXQgYSBkb2Vzbid0LCBiIHNob3VsZCBjb21lIGZpcnN0XG4gICAgICBpZiAoIWZyZWNlbmN5QSAmJiBmcmVjZW5jeUIpIHtcbiAgICAgICAgcmV0dXJuIDE7XG4gICAgICB9XG5cbiAgICAgIC8vIElmIGJvdGggZnJlY2VuY2llcyBhcmUgZGVmaW5lZCxwdXQgdGhlIG9uZSB3aXRoIHRoZSBoaWdoZXIgZnJlY2VuY3kgZmlyc3RcbiAgICAgIGlmIChmcmVjZW5jeUEgJiYgZnJlY2VuY3lCKSB7XG4gICAgICAgIHJldHVybiBmcmVjZW5jeUIuZnJlY2VuY3kgLSBmcmVjZW5jeUEuZnJlY2VuY3k7XG4gICAgICB9XG5cbiAgICAgIC8vIElmIGJvdGggZnJlY2VuY2llcyBhcmUgdW5kZWZpbmVkLCBrZWVwIHRoZSBvcmlnaW5hbCBvcmRlclxuICAgICAgcmV0dXJuIHNvcnRVbnZpc2l0ZWRSZWYuY3VycmVudCA/IHNvcnRVbnZpc2l0ZWRSZWYuY3VycmVudChhLCBiKSA6IDA7XG4gICAgfSk7XG4gIH0sIFtzdG9yZWRGcmVjZW5jaWVzLCBkYXRhLCBrZXlSZWYsIHNvcnRVbnZpc2l0ZWRSZWZdKTtcblxuICByZXR1cm4geyBkYXRhOiBzb3J0ZWREYXRhLCB2aXNpdEl0ZW0sIHJlc2V0UmFua2luZyB9O1xufVxuIiwgImltcG9ydCB7IExvY2FsU3RvcmFnZSB9IGZyb20gXCJAcmF5Y2FzdC9hcGlcIjtcbmltcG9ydCB7IHNob3dGYWlsdXJlVG9hc3QgfSBmcm9tIFwiLi9zaG93RmFpbHVyZVRvYXN0XCI7XG5pbXBvcnQgeyByZXBsYWNlciwgcmV2aXZlciB9IGZyb20gXCIuL2hlbHBlcnNcIjtcbmltcG9ydCB7IHVzZVByb21pc2UgfSBmcm9tIFwiLi91c2VQcm9taXNlXCI7XG5cbi8qKlxuICogQSBob29rIHRvIG1hbmFnZSBhIHZhbHVlIGluIHRoZSBsb2NhbCBzdG9yYWdlLlxuICpcbiAqIEByZW1hcmsgVGhlIHZhbHVlIGlzIHN0b3JlZCBhcyBhIEpTT04gc3RyaW5nIGluIHRoZSBsb2NhbCBzdG9yYWdlLlxuICpcbiAqIEBwYXJhbSBrZXkgLSBUaGUga2V5IHRvIHVzZSBmb3IgdGhlIHZhbHVlIGluIHRoZSBsb2NhbCBzdG9yYWdlLlxuICogQHBhcmFtIGluaXRpYWxWYWx1ZSAtIFRoZSBpbml0aWFsIHZhbHVlIHRvIHVzZSBpZiB0aGUga2V5IGRvZXNuJ3QgZXhpc3QgaW4gdGhlIGxvY2FsIHN0b3JhZ2UuXG4gKiBAcmV0dXJucyBBbiBvYmplY3Qgd2l0aCB0aGUgZm9sbG93aW5nIHByb3BlcnRpZXM6XG4gKiAtIGB2YWx1ZWA6IFRoZSB2YWx1ZSBmcm9tIHRoZSBsb2NhbCBzdG9yYWdlIG9yIHRoZSBpbml0aWFsIHZhbHVlIGlmIHRoZSBrZXkgZG9lc24ndCBleGlzdC5cbiAqIC0gYHNldFZhbHVlYDogQSBmdW5jdGlvbiB0byB1cGRhdGUgdGhlIHZhbHVlIGluIHRoZSBsb2NhbCBzdG9yYWdlLlxuICogLSBgcmVtb3ZlVmFsdWVgOiBBIGZ1bmN0aW9uIHRvIHJlbW92ZSB0aGUgdmFsdWUgZnJvbSB0aGUgbG9jYWwgc3RvcmFnZS5cbiAqIC0gYGlzTG9hZGluZ2A6IEEgYm9vbGVhbiBpbmRpY2F0aW5nIGlmIHRoZSB2YWx1ZSBpcyBsb2FkaW5nLlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGBcbiAqIGNvbnN0IHsgdmFsdWUsIHNldFZhbHVlIH0gPSB1c2VMb2NhbFN0b3JhZ2U8c3RyaW5nPihcIm15LWtleVwiKTtcbiAqIGNvbnN0IHsgdmFsdWUsIHNldFZhbHVlIH0gPSB1c2VMb2NhbFN0b3JhZ2U8c3RyaW5nPihcIm15LWtleVwiLCBcImRlZmF1bHQgdmFsdWVcIik7XG4gKiBgYGBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHVzZUxvY2FsU3RvcmFnZTxUPihrZXk6IHN0cmluZywgaW5pdGlhbFZhbHVlPzogVCkge1xuICBjb25zdCB7XG4gICAgZGF0YTogdmFsdWUsXG4gICAgaXNMb2FkaW5nLFxuICAgIG11dGF0ZSxcbiAgfSA9IHVzZVByb21pc2UoXG4gICAgYXN5bmMgKHN0b3JhZ2VLZXk6IHN0cmluZykgPT4ge1xuICAgICAgY29uc3QgaXRlbSA9IGF3YWl0IExvY2FsU3RvcmFnZS5nZXRJdGVtPHN0cmluZz4oc3RvcmFnZUtleSk7XG5cbiAgICAgIHJldHVybiB0eXBlb2YgaXRlbSAhPT0gXCJ1bmRlZmluZWRcIiA/IChKU09OLnBhcnNlKGl0ZW0sIHJldml2ZXIpIGFzIFQpIDogaW5pdGlhbFZhbHVlO1xuICAgIH0sXG4gICAgW2tleV0sXG4gICk7XG5cbiAgYXN5bmMgZnVuY3Rpb24gc2V0VmFsdWUodmFsdWU6IFQpIHtcbiAgICB0cnkge1xuICAgICAgYXdhaXQgbXV0YXRlKExvY2FsU3RvcmFnZS5zZXRJdGVtKGtleSwgSlNPTi5zdHJpbmdpZnkodmFsdWUsIHJlcGxhY2VyKSksIHtcbiAgICAgICAgb3B0aW1pc3RpY1VwZGF0ZSh2YWx1ZSkge1xuICAgICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBhd2FpdCBzaG93RmFpbHVyZVRvYXN0KGVycm9yLCB7IHRpdGxlOiBcIkZhaWxlZCB0byBzZXQgdmFsdWUgaW4gbG9jYWwgc3RvcmFnZVwiIH0pO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGZ1bmN0aW9uIHJlbW92ZVZhbHVlKCkge1xuICAgIHRyeSB7XG4gICAgICBhd2FpdCBtdXRhdGUoTG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oa2V5KSwge1xuICAgICAgICBvcHRpbWlzdGljVXBkYXRlKCkge1xuICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgIH0sXG4gICAgICB9KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgYXdhaXQgc2hvd0ZhaWx1cmVUb2FzdChlcnJvciwgeyB0aXRsZTogXCJGYWlsZWQgdG8gcmVtb3ZlIHZhbHVlIGZyb20gbG9jYWwgc3RvcmFnZVwiIH0pO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiB7IHZhbHVlLCBzZXRWYWx1ZSwgcmVtb3ZlVmFsdWUsIGlzTG9hZGluZyB9O1xufVxuIiwgImV4cG9ydCB7IGdldEF2YXRhckljb24gfSBmcm9tIFwiLi9hdmF0YXJcIjtcbmV4cG9ydCB7IGdldEZhdmljb24gfSBmcm9tIFwiLi9mYXZpY29uXCI7XG5leHBvcnQgeyBnZXRQcm9ncmVzc0ljb24gfSBmcm9tIFwiLi9wcm9ncmVzc1wiO1xuIiwgImltcG9ydCB0eXBlIHsgSW1hZ2UgfSBmcm9tIFwiQHJheWNhc3QvYXBpXCI7XG5pbXBvcnQgeyBzbGlnaHRseUxpZ2h0ZXJDb2xvciwgc2xpZ2h0bHlEYXJrZXJDb2xvciB9IGZyb20gXCIuL2NvbG9yXCI7XG5cbmZ1bmN0aW9uIGdldFdob2xlQ2hhckFuZEkoc3RyOiBzdHJpbmcsIGk6IG51bWJlcik6IFtzdHJpbmcsIG51bWJlcl0ge1xuICBjb25zdCBjb2RlID0gc3RyLmNoYXJDb2RlQXQoaSk7XG5cbiAgaWYgKE51bWJlci5pc05hTihjb2RlKSkge1xuICAgIHJldHVybiBbXCJcIiwgaV07XG4gIH1cbiAgaWYgKGNvZGUgPCAweGQ4MDAgfHwgY29kZSA+IDB4ZGZmZikge1xuICAgIHJldHVybiBbc3RyLmNoYXJBdChpKSwgaV07IC8vIE5vcm1hbCBjaGFyYWN0ZXIsIGtlZXBpbmcgJ2knIHRoZSBzYW1lXG4gIH1cblxuICAvLyBIaWdoIHN1cnJvZ2F0ZSAoY291bGQgY2hhbmdlIGxhc3QgaGV4IHRvIDB4REI3RiB0byB0cmVhdCBoaWdoIHByaXZhdGVcbiAgLy8gc3Vycm9nYXRlcyBhcyBzaW5nbGUgY2hhcmFjdGVycylcbiAgaWYgKDB4ZDgwMCA8PSBjb2RlICYmIGNvZGUgPD0gMHhkYmZmKSB7XG4gICAgaWYgKHN0ci5sZW5ndGggPD0gaSArIDEpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIkhpZ2ggc3Vycm9nYXRlIHdpdGhvdXQgZm9sbG93aW5nIGxvdyBzdXJyb2dhdGVcIik7XG4gICAgfVxuICAgIGNvbnN0IG5leHQgPSBzdHIuY2hhckNvZGVBdChpICsgMSk7XG4gICAgaWYgKDB4ZGMwMCA+IG5leHQgfHwgbmV4dCA+IDB4ZGZmZikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSGlnaCBzdXJyb2dhdGUgd2l0aG91dCBmb2xsb3dpbmcgbG93IHN1cnJvZ2F0ZVwiKTtcbiAgICB9XG4gICAgcmV0dXJuIFtzdHIuY2hhckF0KGkpICsgc3RyLmNoYXJBdChpICsgMSksIGkgKyAxXTtcbiAgfVxuXG4gIC8vIExvdyBzdXJyb2dhdGUgKDB4REMwMCA8PSBjb2RlICYmIGNvZGUgPD0gMHhERkZGKVxuICBpZiAoaSA9PT0gMCkge1xuICAgIHRocm93IG5ldyBFcnJvcihcIkxvdyBzdXJyb2dhdGUgd2l0aG91dCBwcmVjZWRpbmcgaGlnaCBzdXJyb2dhdGVcIik7XG4gIH1cblxuICBjb25zdCBwcmV2ID0gc3RyLmNoYXJDb2RlQXQoaSAtIDEpO1xuXG4gIC8vIChjb3VsZCBjaGFuZ2UgbGFzdCBoZXggdG8gMHhEQjdGIHRvIHRyZWF0IGhpZ2ggcHJpdmF0ZSBzdXJyb2dhdGVzXG4gIC8vIGFzIHNpbmdsZSBjaGFyYWN0ZXJzKVxuICBpZiAoMHhkODAwID4gcHJldiB8fCBwcmV2ID4gMHhkYmZmKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiTG93IHN1cnJvZ2F0ZSB3aXRob3V0IHByZWNlZGluZyBoaWdoIHN1cnJvZ2F0ZVwiKTtcbiAgfVxuXG4gIC8vIFJldHVybiB0aGUgbmV4dCBjaGFyYWN0ZXIgaW5zdGVhZCAoYW5kIGluY3JlbWVudClcbiAgcmV0dXJuIFtzdHIuY2hhckF0KGkgKyAxKSwgaSArIDFdO1xufVxuXG5jb25zdCBhdmF0YXJDb2xvclNldCA9IFtcbiAgXCIjREM4MjlBXCIsIC8vIFBpbmtcbiAgXCIjRDY0ODU0XCIsIC8vIFJlZFxuICBcIiNENDc2MDBcIiwgLy8gWWVsbG93T3JhbmdlXG4gIFwiI0QzNkNERFwiLCAvLyBNYWdlbnRhXG4gIFwiIzUyQTlFNFwiLCAvLyBBcXVhXG4gIFwiIzc4NzFFOFwiLCAvLyBJbmRpZ29cbiAgXCIjNzA5MjBGXCIsIC8vIFllbGxvd0dyZWVuXG4gIFwiIzQzQjkzQVwiLCAvLyBHcmVlblxuICBcIiNFQjZCM0VcIiwgLy8gT3JhbmdlXG4gIFwiIzI2Qjc5NVwiLCAvLyBCbHVlR3JlZW5cbiAgXCIjRDg1QTlCXCIsIC8vIEhvdFBpbmtcbiAgXCIjQTA2N0RDXCIsIC8vIFB1cnBsZVxuICBcIiNCRDk1MDBcIiwgLy8gWWVsbG93XG4gIFwiIzUzODVEOVwiLCAvLyBCbHVlXG5dO1xuXG4vKipcbiAqIEljb24gdG8gcmVwcmVzZW50IGFuIGF2YXRhciB3aGVuIHlvdSBkb24ndCBoYXZlIG9uZS4gVGhlIGdlbmVyYXRlZCBhdmF0YXJcbiAqIHdpbGwgYmUgZ2VuZXJhdGVkIGZyb20gdGhlIGluaXRpYWxzIG9mIHRoZSBuYW1lIGFuZCBoYXZlIGEgY29sb3JmdWwgYnV0IGNvbnNpc3RlbnQgYmFja2dyb3VuZC5cbiAqXG4gKiBAcmV0dXJucyBhbiBJbWFnZSB0aGF0IGNhbiBiZSB1c2VkIHdoZXJlIFJheWNhc3QgZXhwZWN0cyB0aGVtLlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGBcbiAqIDxMaXN0Lkl0ZW0gaWNvbj17Z2V0QXZhdGFySWNvbignTWF0aGlldSBEdXRvdXInKX0gdGl0bGU9XCJQcm9qZWN0XCIgLz5cbiAqIGBgYFxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0QXZhdGFySWNvbihcbiAgbmFtZTogc3RyaW5nLFxuICBvcHRpb25zPzoge1xuICAgIC8qKlxuICAgICAqIEN1c3RvbSBiYWNrZ3JvdW5kIGNvbG9yXG4gICAgICovXG4gICAgYmFja2dyb3VuZD86IHN0cmluZztcbiAgICAvKipcbiAgICAgKiBXaGV0aGVyIHRvIHVzZSBhIGdyYWRpZW50IGZvciB0aGUgYmFja2dyb3VuZCBvciBub3QuXG4gICAgICogQGRlZmF1bHQgdHJ1ZVxuICAgICAqL1xuICAgIGdyYWRpZW50PzogYm9vbGVhbjtcbiAgfSxcbik6IEltYWdlLkFzc2V0IHtcbiAgY29uc3Qgd29yZHMgPSBuYW1lLnRyaW0oKS5zcGxpdChcIiBcIik7XG4gIGxldCBpbml0aWFsczogc3RyaW5nO1xuICBpZiAod29yZHMubGVuZ3RoID09IDEgJiYgZ2V0V2hvbGVDaGFyQW5kSSh3b3Jkc1swXSwgMClbMF0pIHtcbiAgICBpbml0aWFscyA9IGdldFdob2xlQ2hhckFuZEkod29yZHNbMF0sIDApWzBdO1xuICB9IGVsc2UgaWYgKHdvcmRzLmxlbmd0aCA+IDEpIHtcbiAgICBjb25zdCBmaXJzdFdvcmRGaXJzdExldHRlciA9IGdldFdob2xlQ2hhckFuZEkod29yZHNbMF0sIDApWzBdIHx8IFwiXCI7XG4gICAgY29uc3QgbGFzdFdvcmRGaXJzdExldHRlciA9IGdldFdob2xlQ2hhckFuZEkod29yZHNbd29yZHMubGVuZ3RoIC0gMV0sIDApWzBdID8/IFwiXCI7XG4gICAgaW5pdGlhbHMgPSBmaXJzdFdvcmRGaXJzdExldHRlciArIGxhc3RXb3JkRmlyc3RMZXR0ZXI7XG4gIH0gZWxzZSB7XG4gICAgaW5pdGlhbHMgPSBcIlwiO1xuICB9XG5cbiAgbGV0IGJhY2tncm91bmRDb2xvcjogc3RyaW5nO1xuXG4gIGlmIChvcHRpb25zPy5iYWNrZ3JvdW5kKSB7XG4gICAgYmFja2dyb3VuZENvbG9yID0gb3B0aW9ucz8uYmFja2dyb3VuZDtcbiAgfSBlbHNlIHtcbiAgICBsZXQgaW5pdGlhbHNDaGFySW5kZXggPSAwO1xuICAgIGxldCBbY2hhciwgaV0gPSBnZXRXaG9sZUNoYXJBbmRJKGluaXRpYWxzLCAwKTtcbiAgICB3aGlsZSAoY2hhcikge1xuICAgICAgaW5pdGlhbHNDaGFySW5kZXggKz0gY2hhci5jaGFyQ29kZUF0KDApO1xuICAgICAgW2NoYXIsIGldID0gZ2V0V2hvbGVDaGFyQW5kSShpbml0aWFscywgaSArIDEpO1xuICAgIH1cblxuICAgIGNvbnN0IGNvbG9ySW5kZXggPSBpbml0aWFsc0NoYXJJbmRleCAlIGF2YXRhckNvbG9yU2V0Lmxlbmd0aDtcbiAgICBiYWNrZ3JvdW5kQ29sb3IgPSBhdmF0YXJDb2xvclNldFtjb2xvckluZGV4XTtcbiAgfVxuXG4gIGNvbnN0IHBhZGRpbmcgPSAwO1xuICBjb25zdCByYWRpdXMgPSA1MCAtIHBhZGRpbmc7XG5cbiAgY29uc3Qgc3ZnID0gYDxzdmcgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHdpZHRoPVwiMTAwcHhcIiBoZWlnaHQ9XCIxMDBweFwiPlxuICAke1xuICAgIG9wdGlvbnM/LmdyYWRpZW50ICE9PSBmYWxzZVxuICAgICAgPyBgPGRlZnM+XG4gICAgICA8bGluZWFyR3JhZGllbnQgaWQ9XCJHcmFkaWVudFwiIHgxPVwiMC4yNVwiIHgyPVwiMC43NVwiIHkxPVwiMFwiIHkyPVwiMVwiPlxuICAgICAgICA8c3RvcCBvZmZzZXQ9XCIwJVwiIHN0b3AtY29sb3I9XCIke3NsaWdodGx5TGlnaHRlckNvbG9yKGJhY2tncm91bmRDb2xvcil9XCIvPlxuICAgICAgICA8c3RvcCBvZmZzZXQ9XCI1MCVcIiBzdG9wLWNvbG9yPVwiJHtiYWNrZ3JvdW5kQ29sb3J9XCIvPlxuICAgICAgICA8c3RvcCBvZmZzZXQ9XCIxMDAlXCIgc3RvcC1jb2xvcj1cIiR7c2xpZ2h0bHlEYXJrZXJDb2xvcihiYWNrZ3JvdW5kQ29sb3IpfVwiLz5cbiAgICAgIDwvbGluZWFyR3JhZGllbnQ+XG4gIDwvZGVmcz5gXG4gICAgICA6IFwiXCJcbiAgfVxuICAgICAgPGNpcmNsZSBjeD1cIjUwXCIgY3k9XCI1MFwiIHI9XCIke3JhZGl1c31cIiBmaWxsPVwiJHtcbiAgICAgICAgb3B0aW9ucz8uZ3JhZGllbnQgIT09IGZhbHNlID8gXCJ1cmwoI0dyYWRpZW50KVwiIDogYmFja2dyb3VuZENvbG9yXG4gICAgICB9XCIgLz5cbiAgICAgICR7XG4gICAgICAgIGluaXRpYWxzXG4gICAgICAgICAgPyBgPHRleHQgeD1cIjUwXCIgeT1cIjgwXCIgZm9udC1zaXplPVwiJHtcbiAgICAgICAgICAgICAgcmFkaXVzIC0gMVxuICAgICAgICAgICAgfVwiIGZvbnQtZmFtaWx5PVwiSW50ZXIsIHNhbnMtc2VyaWZcIiB0ZXh0LWFuY2hvcj1cIm1pZGRsZVwiIGZpbGw9XCJ3aGl0ZVwiPiR7aW5pdGlhbHMudG9VcHBlckNhc2UoKX08L3RleHQ+YFxuICAgICAgICAgIDogXCJcIlxuICAgICAgfVxuICAgIDwvc3ZnPlxuICBgLnJlcGxhY2VBbGwoXCJcXG5cIiwgXCJcIik7XG4gIHJldHVybiBgZGF0YTppbWFnZS9zdmcreG1sLCR7ZW5jb2RlVVJJQ29tcG9uZW50KHN2Zyl9YDtcbn1cbiIsICJmdW5jdGlvbiBoZXhUb1JHQihoZXg6IHN0cmluZykge1xuICBsZXQgciA9IDA7XG4gIGxldCBnID0gMDtcbiAgbGV0IGIgPSAwO1xuXG4gIC8vIDMgZGlnaXRzXG4gIGlmIChoZXgubGVuZ3RoID09PSA0KSB7XG4gICAgciA9IHBhcnNlSW50KGAke2hleFsxXX0ke2hleFsxXX1gLCAxNik7XG4gICAgZyA9IHBhcnNlSW50KGAke2hleFsyXX0ke2hleFsyXX1gLCAxNik7XG4gICAgYiA9IHBhcnNlSW50KGAke2hleFszXX0ke2hleFszXX1gLCAxNik7XG5cbiAgICAvLyA2IGRpZ2l0c1xuICB9IGVsc2UgaWYgKGhleC5sZW5ndGggPT09IDcpIHtcbiAgICByID0gcGFyc2VJbnQoYCR7aGV4WzFdfSR7aGV4WzJdfWAsIDE2KTtcbiAgICBnID0gcGFyc2VJbnQoYCR7aGV4WzNdfSR7aGV4WzRdfWAsIDE2KTtcbiAgICBiID0gcGFyc2VJbnQoYCR7aGV4WzVdfSR7aGV4WzZdfWAsIDE2KTtcbiAgfSBlbHNlIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYE1hbGZvcm1lZCBoZXggY29sb3I6ICR7aGV4fWApO1xuICB9XG5cbiAgcmV0dXJuIHsgciwgZywgYiB9O1xufVxuXG5mdW5jdGlvbiByZ2JUb0hleCh7IHIsIGcsIGIgfTogeyByOiBudW1iZXI7IGc6IG51bWJlcjsgYjogbnVtYmVyIH0pIHtcbiAgbGV0IHJTdHJpbmcgPSByLnRvU3RyaW5nKDE2KTtcbiAgbGV0IGdTdHJpbmcgPSBnLnRvU3RyaW5nKDE2KTtcbiAgbGV0IGJTdHJpbmcgPSBiLnRvU3RyaW5nKDE2KTtcblxuICBpZiAoclN0cmluZy5sZW5ndGggPT09IDEpIHtcbiAgICByU3RyaW5nID0gYDAke3JTdHJpbmd9YDtcbiAgfVxuICBpZiAoZ1N0cmluZy5sZW5ndGggPT09IDEpIHtcbiAgICBnU3RyaW5nID0gYDAke2dTdHJpbmd9YDtcbiAgfVxuICBpZiAoYlN0cmluZy5sZW5ndGggPT09IDEpIHtcbiAgICBiU3RyaW5nID0gYDAke2JTdHJpbmd9YDtcbiAgfVxuXG4gIHJldHVybiBgIyR7clN0cmluZ30ke2dTdHJpbmd9JHtiU3RyaW5nfWA7XG59XG5cbmZ1bmN0aW9uIHJnYlRvSFNMKHsgciwgZywgYiB9OiB7IHI6IG51bWJlcjsgZzogbnVtYmVyOyBiOiBudW1iZXIgfSkge1xuICAvLyBNYWtlIHIsIGcsIGFuZCBiIGZyYWN0aW9ucyBvZiAxXG4gIHIgLz0gMjU1O1xuICBnIC89IDI1NTtcbiAgYiAvPSAyNTU7XG5cbiAgLy8gRmluZCBncmVhdGVzdCBhbmQgc21hbGxlc3QgY2hhbm5lbCB2YWx1ZXNcbiAgY29uc3QgY21pbiA9IE1hdGgubWluKHIsIGcsIGIpO1xuICBjb25zdCBjbWF4ID0gTWF0aC5tYXgociwgZywgYik7XG4gIGNvbnN0IGRlbHRhID0gY21heCAtIGNtaW47XG4gIGxldCBoID0gMDtcbiAgbGV0IHMgPSAwO1xuICBsZXQgbCA9IDA7XG5cbiAgLy8gQ2FsY3VsYXRlIGh1ZVxuICAvLyBObyBkaWZmZXJlbmNlXG4gIGlmIChkZWx0YSA9PT0gMCkge1xuICAgIGggPSAwO1xuICB9XG4gIC8vIFJlZCBpcyBtYXhcbiAgZWxzZSBpZiAoY21heCA9PT0gcikge1xuICAgIGggPSAoKGcgLSBiKSAvIGRlbHRhKSAlIDY7XG4gIH1cbiAgLy8gR3JlZW4gaXMgbWF4XG4gIGVsc2UgaWYgKGNtYXggPT09IGcpIHtcbiAgICBoID0gKGIgLSByKSAvIGRlbHRhICsgMjtcbiAgfVxuICAvLyBCbHVlIGlzIG1heFxuICBlbHNlIHtcbiAgICBoID0gKHIgLSBnKSAvIGRlbHRhICsgNDtcbiAgfVxuXG4gIGggPSBNYXRoLnJvdW5kKGggKiA2MCk7XG5cbiAgLy8gTWFrZSBuZWdhdGl2ZSBodWVzIHBvc2l0aXZlIGJlaGluZCAzNjDCsFxuICBpZiAoaCA8IDApIHtcbiAgICBoICs9IDM2MDtcbiAgfVxuXG4gIC8vIENhbGN1bGF0ZSBsaWdodG5lc3NcbiAgbCA9IChjbWF4ICsgY21pbikgLyAyO1xuXG4gIC8vIENhbGN1bGF0ZSBzYXR1cmF0aW9uXG4gIHMgPSBkZWx0YSA9PT0gMCA/IDAgOiBkZWx0YSAvICgxIC0gTWF0aC5hYnMoMiAqIGwgLSAxKSk7XG5cbiAgLy8gTXVsdGlwbHkgbCBhbmQgcyBieSAxMDBcbiAgcyA9ICsocyAqIDEwMCkudG9GaXhlZCgxKTtcbiAgbCA9ICsobCAqIDEwMCkudG9GaXhlZCgxKTtcblxuICByZXR1cm4geyBoLCBzLCBsIH07XG59XG5cbmZ1bmN0aW9uIGhzbFRvUkdCKHsgaCwgcywgbCB9OiB7IGg6IG51bWJlcjsgczogbnVtYmVyOyBsOiBudW1iZXIgfSkge1xuICAvLyBNdXN0IGJlIGZyYWN0aW9ucyBvZiAxXG4gIHMgLz0gMTAwO1xuICBsIC89IDEwMDtcblxuICBjb25zdCBjID0gKDEgLSBNYXRoLmFicygyICogbCAtIDEpKSAqIHM7XG4gIGNvbnN0IHggPSBjICogKDEgLSBNYXRoLmFicygoKGggLyA2MCkgJSAyKSAtIDEpKTtcbiAgY29uc3QgbSA9IGwgLSBjIC8gMjtcbiAgbGV0IHIgPSAwO1xuICBsZXQgZyA9IDA7XG4gIGxldCBiID0gMDtcblxuICBpZiAoaCA+PSAwICYmIGggPCA2MCkge1xuICAgIHIgPSBjO1xuICAgIGcgPSB4O1xuICAgIGIgPSAwO1xuICB9IGVsc2UgaWYgKGggPj0gNjAgJiYgaCA8IDEyMCkge1xuICAgIHIgPSB4O1xuICAgIGcgPSBjO1xuICAgIGIgPSAwO1xuICB9IGVsc2UgaWYgKGggPj0gMTIwICYmIGggPCAxODApIHtcbiAgICByID0gMDtcbiAgICBnID0gYztcbiAgICBiID0geDtcbiAgfSBlbHNlIGlmIChoID49IDE4MCAmJiBoIDwgMjQwKSB7XG4gICAgciA9IDA7XG4gICAgZyA9IHg7XG4gICAgYiA9IGM7XG4gIH0gZWxzZSBpZiAoaCA+PSAyNDAgJiYgaCA8IDMwMCkge1xuICAgIHIgPSB4O1xuICAgIGcgPSAwO1xuICAgIGIgPSBjO1xuICB9IGVsc2UgaWYgKGggPj0gMzAwICYmIGggPCAzNjApIHtcbiAgICByID0gYztcbiAgICBnID0gMDtcbiAgICBiID0geDtcbiAgfVxuICByID0gTWF0aC5yb3VuZCgociArIG0pICogMjU1KTtcbiAgZyA9IE1hdGgucm91bmQoKGcgKyBtKSAqIDI1NSk7XG4gIGIgPSBNYXRoLnJvdW5kKChiICsgbSkgKiAyNTUpO1xuXG4gIHJldHVybiB7IHIsIGcsIGIgfTtcbn1cblxuZnVuY3Rpb24gaGV4VG9IU0woaGV4OiBzdHJpbmcpIHtcbiAgcmV0dXJuIHJnYlRvSFNMKGhleFRvUkdCKGhleCkpO1xufVxuXG5mdW5jdGlvbiBoc2xUb0hleChoc2w6IHsgaDogbnVtYmVyOyBzOiBudW1iZXI7IGw6IG51bWJlciB9KSB7XG4gIHJldHVybiByZ2JUb0hleChoc2xUb1JHQihoc2wpKTtcbn1cblxuZnVuY3Rpb24gY2xhbXAodmFsdWU6IG51bWJlciwgbWluOiBudW1iZXIsIG1heDogbnVtYmVyKSB7XG4gIHJldHVybiBtaW4gPCBtYXggPyAodmFsdWUgPCBtaW4gPyBtaW4gOiB2YWx1ZSA+IG1heCA/IG1heCA6IHZhbHVlKSA6IHZhbHVlIDwgbWF4ID8gbWF4IDogdmFsdWUgPiBtaW4gPyBtaW4gOiB2YWx1ZTtcbn1cblxuY29uc3Qgb2Zmc2V0ID0gMTI7XG5cbmV4cG9ydCBmdW5jdGlvbiBzbGlnaHRseURhcmtlckNvbG9yKGhleDogc3RyaW5nKSB7XG4gIGNvbnN0IGhzbCA9IGhleFRvSFNMKGhleCk7XG5cbiAgcmV0dXJuIGhzbFRvSGV4KHtcbiAgICBoOiBoc2wuaCxcbiAgICBzOiBoc2wucyxcbiAgICBsOiBjbGFtcChoc2wubCAtIG9mZnNldCwgMCwgMTAwKSxcbiAgfSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzbGlnaHRseUxpZ2h0ZXJDb2xvcihoZXg6IHN0cmluZykge1xuICBjb25zdCBoc2wgPSBoZXhUb0hTTChoZXgpO1xuXG4gIHJldHVybiBoc2xUb0hleCh7XG4gICAgaDogaHNsLmgsXG4gICAgczogaHNsLnMsXG4gICAgbDogY2xhbXAoaHNsLmwgKyBvZmZzZXQsIDAsIDEwMCksXG4gIH0pO1xufVxuIiwgImltcG9ydCB7IEljb24sIEltYWdlIH0gZnJvbSBcIkByYXljYXN0L2FwaVwiO1xuaW1wb3J0IHsgVVJMIH0gZnJvbSBcIm5vZGU6dXJsXCI7XG5cbi8qKlxuICogSWNvbiBzaG93aW5nIHRoZSBmYXZpY29uIG9mIGEgd2Vic2l0ZS5cbiAqXG4gKiBBIGZhdmljb24gKGZhdm9yaXRlIGljb24pIGlzIGEgdGlueSBpY29uIGluY2x1ZGVkIGFsb25nIHdpdGggYSB3ZWJzaXRlLCB3aGljaCBpcyBkaXNwbGF5ZWQgaW4gcGxhY2VzIGxpa2UgdGhlIGJyb3dzZXIncyBhZGRyZXNzIGJhciwgcGFnZSB0YWJzLCBhbmQgYm9va21hcmtzIG1lbnUuXG4gKlxuICogQHBhcmFtIHVybCBUaGUgVVJMIG9mIHRoZSB3ZWJzaXRlIHRvIHJlcHJlc2VudC5cbiAqXG4gKiBAcmV0dXJucyBhbiBJbWFnZSB0aGF0IGNhbiBiZSB1c2VkIHdoZXJlIFJheWNhc3QgZXhwZWN0cyB0aGVtLlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGBcbiAqIDxMaXN0Lkl0ZW0gaWNvbj17Z2V0RmF2aWNvbihcImh0dHBzOi8vcmF5Y2FzdC5jb21cIil9IHRpdGxlPVwiUmF5Y2FzdCBXZWJzaXRlXCIgLz5cbiAqIGBgYFxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0RmF2aWNvbihcbiAgdXJsOiBzdHJpbmcgfCBVUkwsXG4gIG9wdGlvbnM/OiB7XG4gICAgLyoqXG4gICAgICogU2l6ZSBvZiB0aGUgRmF2aWNvblxuICAgICAqIEBkZWZhdWx0IDY0XG4gICAgICovXG4gICAgc2l6ZT86IG51bWJlcjtcbiAgICAvKipcbiAgICAgKiBGYWxsYmFjayBpY29uIGluIGNhc2UgdGhlIEZhdmljb24gaXMgbm90IGZvdW5kLlxuICAgICAqIEBkZWZhdWx0IEljb24uTGlua1xuICAgICAqL1xuICAgIGZhbGxiYWNrPzogSW1hZ2UuRmFsbGJhY2s7XG4gICAgLyoqXG4gICAgICogQSB7QGxpbmsgSW1hZ2UuTWFza30gdG8gYXBwbHkgdG8gdGhlIEZhdmljb24uXG4gICAgICovXG4gICAgbWFzaz86IEltYWdlLk1hc2s7XG4gIH0sXG4pOiBJbWFnZS5JbWFnZUxpa2Uge1xuICB0cnkge1xuICAgIC8vIGEgZnVuYyBhZGRpbmcgaHR0cHM6Ly8gdG8gdGhlIFVSTFxuICAgIC8vIGZvciBjYXNlcyB3aGVyZSB0aGUgVVJMIGlzIG5vdCBhIGZ1bGwgVVJMXG4gICAgLy8gZS5nLiBcInJheWNhc3QuY29tXCJcbiAgICBjb25zdCBzYW5pdGl6ZSA9ICh1cmw6IHN0cmluZykgPT4ge1xuICAgICAgaWYgKCF1cmwuc3RhcnRzV2l0aChcImh0dHBcIikpIHtcbiAgICAgICAgcmV0dXJuIGBodHRwczovLyR7dXJsfWA7XG4gICAgICB9XG4gICAgICByZXR1cm4gdXJsO1xuICAgIH07XG5cbiAgICBjb25zdCB1cmxPYmogPSB0eXBlb2YgdXJsID09PSBcInN0cmluZ1wiID8gbmV3IFVSTChzYW5pdGl6ZSh1cmwpKSA6IHVybDtcbiAgICBjb25zdCBob3N0bmFtZSA9IHVybE9iai5ob3N0bmFtZTtcblxuICAgIGNvbnN0IGZhdmljb25Qcm92aWRlcjogXCJub25lXCIgfCBcInJheWNhc3RcIiB8IFwiYXBwbGVcIiB8IFwiZ29vZ2xlXCIgfCBcImR1Y2tEdWNrR29cIiB8IFwiZHVja2R1Y2tnb1wiIHwgXCJsZWdhY3lcIiA9XG4gICAgICAocHJvY2Vzcy5lbnYuRkFWSUNPTl9QUk9WSURFUiBhcyBhbnkpID8/IFwicmF5Y2FzdFwiO1xuXG4gICAgc3dpdGNoIChmYXZpY29uUHJvdmlkZXIpIHtcbiAgICAgIGNhc2UgXCJub25lXCI6XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgc291cmNlOiBvcHRpb25zPy5mYWxsYmFjayA/PyBJY29uLkxpbmssXG4gICAgICAgICAgbWFzazogb3B0aW9ucz8ubWFzayxcbiAgICAgICAgfTtcbiAgICAgIGNhc2UgXCJhcHBsZVwiOlxuICAgICAgICAvLyB3ZSBjYW4ndCBzdXBwb3J0IGFwcGxlIGZhdmljb25zIGFzIGl0J3MgYSBuYXRpdmUgQVBJXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgc291cmNlOiBvcHRpb25zPy5mYWxsYmFjayA/PyBJY29uLkxpbmssXG4gICAgICAgICAgbWFzazogb3B0aW9ucz8ubWFzayxcbiAgICAgICAgfTtcbiAgICAgIGNhc2UgXCJkdWNrZHVja2dvXCI6XG4gICAgICBjYXNlIFwiZHVja0R1Y2tHb1wiOlxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHNvdXJjZTogYGh0dHBzOi8vaWNvbnMuZHVja2R1Y2tnby5jb20vaXAzLyR7aG9zdG5hbWV9Lmljb2AsXG4gICAgICAgICAgZmFsbGJhY2s6IG9wdGlvbnM/LmZhbGxiYWNrID8/IEljb24uTGluayxcbiAgICAgICAgICBtYXNrOiBvcHRpb25zPy5tYXNrLFxuICAgICAgICB9O1xuICAgICAgY2FzZSBcImdvb2dsZVwiOlxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHNvdXJjZTogYGh0dHBzOi8vd3d3Lmdvb2dsZS5jb20vczIvZmF2aWNvbnM/c3o9JHtvcHRpb25zPy5zaXplID8/IDY0fSZkb21haW49JHtob3N0bmFtZX1gLFxuICAgICAgICAgIGZhbGxiYWNrOiBvcHRpb25zPy5mYWxsYmFjayA/PyBJY29uLkxpbmssXG4gICAgICAgICAgbWFzazogb3B0aW9ucz8ubWFzayxcbiAgICAgICAgfTtcbiAgICAgIGNhc2UgXCJsZWdhY3lcIjpcbiAgICAgIGNhc2UgXCJyYXljYXN0XCI6XG4gICAgICBkZWZhdWx0OlxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHNvdXJjZTogYGh0dHBzOi8vYXBpLnJheS5zby9mYXZpY29uP3VybD0ke2hvc3RuYW1lfSZzaXplPSR7b3B0aW9ucz8uc2l6ZSA/PyA2NH1gLFxuICAgICAgICAgIGZhbGxiYWNrOiBvcHRpb25zPy5mYWxsYmFjayA/PyBJY29uLkxpbmssXG4gICAgICAgICAgbWFzazogb3B0aW9ucz8ubWFzayxcbiAgICAgICAgfTtcbiAgICB9XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBjb25zb2xlLmVycm9yKGUpO1xuICAgIHJldHVybiBJY29uLkxpbms7XG4gIH1cbn1cbiIsICJpbXBvcnQgeyBlbnZpcm9ubWVudCwgQ29sb3IgfSBmcm9tIFwiQHJheWNhc3QvYXBpXCI7XG5pbXBvcnQgdHlwZSB7IEltYWdlIH0gZnJvbSBcIkByYXljYXN0L2FwaVwiO1xuXG5mdW5jdGlvbiBwb2xhclRvQ2FydGVzaWFuKGNlbnRlclg6IG51bWJlciwgY2VudGVyWTogbnVtYmVyLCByYWRpdXM6IG51bWJlciwgYW5nbGVJbkRlZ3JlZXM6IG51bWJlcikge1xuICBjb25zdCBhbmdsZUluUmFkaWFucyA9ICgoYW5nbGVJbkRlZ3JlZXMgLSA5MCkgKiBNYXRoLlBJKSAvIDE4MC4wO1xuXG4gIHJldHVybiB7XG4gICAgeDogY2VudGVyWCArIHJhZGl1cyAqIE1hdGguY29zKGFuZ2xlSW5SYWRpYW5zKSxcbiAgICB5OiBjZW50ZXJZICsgcmFkaXVzICogTWF0aC5zaW4oYW5nbGVJblJhZGlhbnMpLFxuICB9O1xufVxuXG5mdW5jdGlvbiBkZXNjcmliZUFyYyh4OiBudW1iZXIsIHk6IG51bWJlciwgcmFkaXVzOiBudW1iZXIsIHN0YXJ0QW5nbGU6IG51bWJlciwgZW5kQW5nbGU6IG51bWJlcikge1xuICBjb25zdCBzdGFydCA9IHBvbGFyVG9DYXJ0ZXNpYW4oeCwgeSwgcmFkaXVzLCBlbmRBbmdsZSk7XG4gIGNvbnN0IGVuZCA9IHBvbGFyVG9DYXJ0ZXNpYW4oeCwgeSwgcmFkaXVzLCBzdGFydEFuZ2xlKTtcblxuICBjb25zdCBsYXJnZUFyY0ZsYWcgPSBlbmRBbmdsZSAtIHN0YXJ0QW5nbGUgPD0gMTgwID8gXCIwXCIgOiBcIjFcIjtcblxuICBjb25zdCBkID0gW1wiTVwiLCBzdGFydC54LCBzdGFydC55LCBcIkFcIiwgcmFkaXVzLCByYWRpdXMsIDAsIGxhcmdlQXJjRmxhZywgMCwgZW5kLngsIGVuZC55XS5qb2luKFwiIFwiKTtcblxuICByZXR1cm4gZDtcbn1cblxuLyoqXG4gKiBJY29uIHRvIHJlcHJlc2VudCB0aGUgcHJvZ3Jlc3Mgb2YgX3NvbWV0aGluZ18uXG4gKlxuICogQHBhcmFtIHByb2dyZXNzIE51bWJlciBiZXR3ZWVuIDAgYW5kIDEuXG4gKiBAcGFyYW0gY29sb3IgSGV4IGNvbG9yIChkZWZhdWx0IGBcIiNGRjYzNjNcImApIG9yIENvbG9yLlxuICpcbiAqIEByZXR1cm5zIGFuIEltYWdlIHRoYXQgY2FuIGJlIHVzZWQgd2hlcmUgUmF5Y2FzdCBleHBlY3RzIHRoZW0uXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYFxuICogPExpc3QuSXRlbSBpY29uPXtnZXRQcm9ncmVzc0ljb24oMC4xKX0gdGl0bGU9XCJQcm9qZWN0XCIgLz5cbiAqIGBgYFxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0UHJvZ3Jlc3NJY29uKFxuICBwcm9ncmVzczogbnVtYmVyLFxuICBjb2xvcjogQ29sb3IgfCBzdHJpbmcgPSBDb2xvci5SZWQsXG4gIG9wdGlvbnM/OiB7IGJhY2tncm91bmQ/OiBDb2xvciB8IHN0cmluZzsgYmFja2dyb3VuZE9wYWNpdHk/OiBudW1iZXIgfSxcbik6IEltYWdlLkFzc2V0IHtcbiAgY29uc3QgYmFja2dyb3VuZCA9IG9wdGlvbnM/LmJhY2tncm91bmQgfHwgKGVudmlyb25tZW50LmFwcGVhcmFuY2UgPT09IFwibGlnaHRcIiA/IFwiYmxhY2tcIiA6IFwid2hpdGVcIik7XG4gIGNvbnN0IGJhY2tncm91bmRPcGFjaXR5ID0gb3B0aW9ucz8uYmFja2dyb3VuZE9wYWNpdHkgfHwgMC4xO1xuXG4gIGNvbnN0IHN0cm9rZSA9IDEwO1xuICBjb25zdCBwYWRkaW5nID0gNTtcbiAgY29uc3QgcmFkaXVzID0gNTAgLSBwYWRkaW5nIC0gc3Ryb2tlIC8gMjtcblxuICBjb25zdCBzdmcgPSBgPHN2ZyB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgd2lkdGg9XCIxMDBweFwiIGhlaWdodD1cIjEwMHB4XCI+XG4gICAgICA8Y2lyY2xlIGN4PVwiNTBcIiBjeT1cIjUwXCIgcj1cIiR7cmFkaXVzfVwiIHN0cm9rZS13aWR0aD1cIiR7c3Ryb2tlfVwiIHN0cm9rZT1cIiR7XG4gICAgICAgIHByb2dyZXNzIDwgMSA/IGJhY2tncm91bmQgOiBjb2xvclxuICAgICAgfVwiIG9wYWNpdHk9XCIke3Byb2dyZXNzIDwgMSA/IGJhY2tncm91bmRPcGFjaXR5IDogXCIxXCJ9XCIgZmlsbD1cIm5vbmVcIiAvPlxuICAgICAgJHtcbiAgICAgICAgcHJvZ3Jlc3MgPiAwICYmIHByb2dyZXNzIDwgMVxuICAgICAgICAgID8gYDxwYXRoIGQ9XCIke2Rlc2NyaWJlQXJjKFxuICAgICAgICAgICAgICA1MCxcbiAgICAgICAgICAgICAgNTAsXG4gICAgICAgICAgICAgIHJhZGl1cyxcbiAgICAgICAgICAgICAgMCxcbiAgICAgICAgICAgICAgcHJvZ3Jlc3MgKiAzNjAsXG4gICAgICAgICAgICApfVwiIHN0cm9rZT1cIiR7Y29sb3J9XCIgc3Ryb2tlLXdpZHRoPVwiJHtzdHJva2V9XCIgZmlsbD1cIm5vbmVcIiAvPmBcbiAgICAgICAgICA6IFwiXCJcbiAgICAgIH1cbiAgICA8L3N2Zz5cbiAgYC5yZXBsYWNlQWxsKFwiXFxuXCIsIFwiXCIpO1xuICByZXR1cm4gYGRhdGE6aW1hZ2Uvc3ZnK3htbCwke2VuY29kZVVSSUNvbXBvbmVudChzdmcpfWA7XG59XG4iLCAiZXhwb3J0IHsgT0F1dGhTZXJ2aWNlIH0gZnJvbSBcIi4vT0F1dGhTZXJ2aWNlXCI7XG5leHBvcnQgeyB3aXRoQWNjZXNzVG9rZW4sIGdldEFjY2Vzc1Rva2VuIH0gZnJvbSBcIi4vd2l0aEFjY2Vzc1Rva2VuXCI7XG5cbmV4cG9ydCB0eXBlIHsgV2l0aEFjY2Vzc1Rva2VuQ29tcG9uZW50T3JGbiB9IGZyb20gXCIuL3dpdGhBY2Nlc3NUb2tlblwiO1xuZXhwb3J0IHR5cGUge1xuICBPbkF1dGhvcml6ZVBhcmFtcyxcbiAgT0F1dGhTZXJ2aWNlT3B0aW9ucyxcbiAgUHJvdmlkZXJXaXRoRGVmYXVsdENsaWVudE9wdGlvbnMsXG4gIFByb3ZpZGVyT3B0aW9ucyxcbn0gZnJvbSBcIi4vdHlwZXNcIjtcbiIsICJpbXBvcnQgeyBDb2xvciwgT0F1dGggfSBmcm9tIFwiQHJheWNhc3QvYXBpXCI7XG5pbXBvcnQgeyBQUk9WSURFUl9DTElFTlRfSURTIH0gZnJvbSBcIi4vcHJvdmlkZXJzXCI7XG5pbXBvcnQgdHlwZSB7XG4gIE9BdXRoU2VydmljZU9wdGlvbnMsXG4gIE9uQXV0aG9yaXplUGFyYW1zLFxuICBQcm92aWRlck9wdGlvbnMsXG4gIFByb3ZpZGVyV2l0aERlZmF1bHRDbGllbnRPcHRpb25zLFxufSBmcm9tIFwiLi90eXBlc1wiO1xuXG4vKipcbiAqIENsYXNzIGFsbG93aW5nIHRvIGNyZWF0ZSBhbiBPQXV0aCBzZXJ2aWNlIHVzaW5nIHRoZSB0aGUgUEtDRSAoUHJvb2YgS2V5IGZvciBDb2RlIEV4Y2hhbmdlKSBmbG93LlxuICpcbiAqIFRoaXMgc2VydmljZSBpcyBjYXBhYmxlIG9mIHN0YXJ0aW5nIHRoZSBhdXRob3JpemF0aW9uIHByb2Nlc3MsIGZldGNoaW5nIGFuZCByZWZyZXNoaW5nIHRva2VucyxcbiAqIGFzIHdlbGwgYXMgbWFuYWdpbmcgdGhlIGF1dGhlbnRpY2F0aW9uIHN0YXRlLlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGB0eXBlc2NyaXB0XG4gKiBjb25zdCBvYXV0aENsaWVudCA9IG5ldyBPQXV0aC5QS0NFQ2xpZW50KHsgLi4uIH0pO1xuICogY29uc3Qgb2F1dGhTZXJ2aWNlID0gbmV3IE9BdXRoU2VydmljZSh7XG4gKiAgIGNsaWVudDogb2F1dGhDbGllbnQsXG4gKiAgIGNsaWVudElkOiAneW91ci1jbGllbnQtaWQnLFxuICogICBzY29wZTogJ3JlcXVpcmVkIHNjb3BlcycsXG4gKiAgIGF1dGhvcml6ZVVybDogJ2h0dHBzOi8vcHJvdmlkZXIuY29tL29hdXRoL2F1dGhvcml6ZScsXG4gKiAgIHRva2VuVXJsOiAnaHR0cHM6Ly9wcm92aWRlci5jb20vb2F1dGgvdG9rZW4nLFxuICogICByZWZyZXNoVG9rZW5Vcmw6ICdodHRwczovL3Byb3ZpZGVyLmNvbS9vYXV0aC90b2tlbicsXG4gKiAgIGV4dHJhUGFyYW1ldGVyczogeyAnYWRkaXRpb25hbF9wYXJhbSc6ICd2YWx1ZScgfVxuICogfSk7XG4gKiBgYGBcbiAqL1xuZXhwb3J0IGNsYXNzIE9BdXRoU2VydmljZSBpbXBsZW1lbnRzIE9BdXRoU2VydmljZU9wdGlvbnMge1xuICBwdWJsaWMgY2xpZW50SWQ6IHN0cmluZztcbiAgcHVibGljIHNjb3BlOiBzdHJpbmc7XG4gIHB1YmxpYyBjbGllbnQ6IE9BdXRoLlBLQ0VDbGllbnQ7XG4gIHB1YmxpYyBleHRyYVBhcmFtZXRlcnM/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+O1xuICBwdWJsaWMgYXV0aG9yaXplVXJsOiBzdHJpbmc7XG4gIHB1YmxpYyB0b2tlblVybDogc3RyaW5nO1xuICBwdWJsaWMgcmVmcmVzaFRva2VuVXJsPzogc3RyaW5nO1xuICBwdWJsaWMgYm9keUVuY29kaW5nPzogXCJqc29uXCIgfCBcInVybC1lbmNvZGVkXCI7XG4gIHB1YmxpYyBwZXJzb25hbEFjY2Vzc1Rva2VuPzogc3RyaW5nO1xuICBvbkF1dGhvcml6ZT86IChwYXJhbXM6IE9uQXV0aG9yaXplUGFyYW1zKSA9PiB2b2lkO1xuICB0b2tlblJlc3BvbnNlUGFyc2VyOiAocmVzcG9uc2U6IHVua25vd24pID0+IE9BdXRoLlRva2VuUmVzcG9uc2U7XG4gIHRva2VuUmVmcmVzaFJlc3BvbnNlUGFyc2VyOiAocmVzcG9uc2U6IHVua25vd24pID0+IE9BdXRoLlRva2VuUmVzcG9uc2U7XG5cbiAgY29uc3RydWN0b3Iob3B0aW9uczogT0F1dGhTZXJ2aWNlT3B0aW9ucykge1xuICAgIHRoaXMuY2xpZW50SWQgPSBvcHRpb25zLmNsaWVudElkO1xuICAgIHRoaXMuc2NvcGUgPSBBcnJheS5pc0FycmF5KG9wdGlvbnMuc2NvcGUpID8gb3B0aW9ucy5zY29wZS5qb2luKFwiIFwiKSA6IG9wdGlvbnMuc2NvcGU7XG4gICAgdGhpcy5wZXJzb25hbEFjY2Vzc1Rva2VuID0gb3B0aW9ucy5wZXJzb25hbEFjY2Vzc1Rva2VuO1xuICAgIHRoaXMuYm9keUVuY29kaW5nID0gb3B0aW9ucy5ib2R5RW5jb2Rpbmc7XG4gICAgdGhpcy5jbGllbnQgPSBvcHRpb25zLmNsaWVudDtcbiAgICB0aGlzLmV4dHJhUGFyYW1ldGVycyA9IG9wdGlvbnMuZXh0cmFQYXJhbWV0ZXJzO1xuICAgIHRoaXMuYXV0aG9yaXplVXJsID0gb3B0aW9ucy5hdXRob3JpemVVcmw7XG4gICAgdGhpcy50b2tlblVybCA9IG9wdGlvbnMudG9rZW5Vcmw7XG4gICAgdGhpcy5yZWZyZXNoVG9rZW5VcmwgPSBvcHRpb25zLnJlZnJlc2hUb2tlblVybDtcbiAgICB0aGlzLm9uQXV0aG9yaXplID0gb3B0aW9ucy5vbkF1dGhvcml6ZTtcbiAgICB0aGlzLnRva2VuUmVzcG9uc2VQYXJzZXIgPSBvcHRpb25zLnRva2VuUmVzcG9uc2VQYXJzZXIgPz8gKCh4KSA9PiB4IGFzIE9BdXRoLlRva2VuUmVzcG9uc2UpO1xuICAgIHRoaXMudG9rZW5SZWZyZXNoUmVzcG9uc2VQYXJzZXIgPSBvcHRpb25zLnRva2VuUmVmcmVzaFJlc3BvbnNlUGFyc2VyID8/ICgoeCkgPT4geCBhcyBPQXV0aC5Ub2tlblJlc3BvbnNlKTtcbiAgICB0aGlzLmF1dGhvcml6ZSA9IHRoaXMuYXV0aG9yaXplLmJpbmQodGhpcyk7XG4gIH1cblxuICAvKipcbiAgICogQXNhbmEgT0F1dGggc2VydmljZSBwcm92aWRlZCBvdXQgb2YgdGhlIGJveC5cbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogYGBgdHlwZXNjcmlwdFxuICAgKiBjb25zdCBhc2FuYSA9IE9BdXRoU2VydmljZS5hc2FuYSh7IHNjb3BlOiAnZGVmYXVsdCcgfSlcbiAgICogYGBgXG4gICAqL1xuICBwdWJsaWMgc3RhdGljIGFzYW5hKG9wdGlvbnM6IFByb3ZpZGVyV2l0aERlZmF1bHRDbGllbnRPcHRpb25zKSB7XG4gICAgcmV0dXJuIG5ldyBPQXV0aFNlcnZpY2Uoe1xuICAgICAgY2xpZW50OiBuZXcgT0F1dGguUEtDRUNsaWVudCh7XG4gICAgICAgIHJlZGlyZWN0TWV0aG9kOiBPQXV0aC5SZWRpcmVjdE1ldGhvZC5XZWIsXG4gICAgICAgIHByb3ZpZGVyTmFtZTogXCJBc2FuYVwiLFxuICAgICAgICBwcm92aWRlckljb246IGBkYXRhOmltYWdlL3N2Zyt4bWwsJHtlbmNvZGVVUklDb21wb25lbnQoXG4gICAgICAgICAgYDxzdmcgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHdpZHRoPVwiMjUxXCIgaGVpZ2h0PVwiMjMyXCIgZmlsbD1cIm5vbmVcIj48cGF0aCBmaWxsPVwiI0YwNkE2QVwiIGQ9XCJNMTc5LjM4MyA1NC4zNzNjMCAzMC4wMTctMjQuMzM3IDU0LjM3NC01NC4zNTQgNTQuMzc0LTMwLjAzNSAwLTU0LjM3My0yNC4zMzgtNTQuMzczLTU0LjM3NEM3MC42NTYgMjQuMzM4IDk0Ljk5MyAwIDEyNS4wMjkgMGMzMC4wMTcgMCA1NC4zNTQgMjQuMzM4IDU0LjM1NCA1NC4zNzNaTTU0LjM5MyAxMjIuMzNDMjQuMzc2IDEyMi4zMy4wMiAxNDYuNjY4LjAyIDE3Ni42ODVjMCAzMC4wMTcgMjQuMzM3IDU0LjM3MyA1NC4zNzMgNTQuMzczIDMwLjAzNSAwIDU0LjM3My0yNC4zMzggNTQuMzczLTU0LjM3MyAwLTMwLjAxNy0yNC4zMzgtNTQuMzU1LTU0LjM3My01NC4zNTVabTE0MS4yNTMgMGMtMzAuMDM1IDAtNTQuMzczIDI0LjMzOC01NC4zNzMgNTQuMzc0IDAgMzAuMDM1IDI0LjMzOCA1NC4zNzMgNTQuMzczIDU0LjM3MyAzMC4wMTcgMCA1NC4zNzQtMjQuMzM4IDU0LjM3NC01NC4zNzMgMC0zMC4wMzYtMjQuMzM4LTU0LjM3NC01NC4zNzQtNTQuMzc0WlwiLz48L3N2Zz5gLFxuICAgICAgICApfWAsXG4gICAgICAgIHByb3ZpZGVySWQ6IFwiYXNhbmFcIixcbiAgICAgICAgZGVzY3JpcHRpb246IFwiQ29ubmVjdCB5b3VyIEFzYW5hIGFjY291bnRcIixcbiAgICAgIH0pLFxuICAgICAgY2xpZW50SWQ6IG9wdGlvbnMuY2xpZW50SWQgPz8gUFJPVklERVJfQ0xJRU5UX0lEUy5hc2FuYSxcbiAgICAgIGF1dGhvcml6ZVVybDogb3B0aW9ucy5hdXRob3JpemVVcmwgPz8gXCJodHRwczovL2FzYW5hLm9hdXRoLnJheWNhc3QuY29tL2F1dGhvcml6ZVwiLFxuICAgICAgdG9rZW5Vcmw6IG9wdGlvbnMudG9rZW5VcmwgPz8gXCJodHRwczovL2FzYW5hLm9hdXRoLnJheWNhc3QuY29tL3Rva2VuXCIsXG4gICAgICByZWZyZXNoVG9rZW5Vcmw6IG9wdGlvbnMucmVmcmVzaFRva2VuVXJsID8/IFwiaHR0cHM6Ly9hc2FuYS5vYXV0aC5yYXljYXN0LmNvbS9yZWZyZXNoLXRva2VuXCIsXG4gICAgICBzY29wZTogb3B0aW9ucy5zY29wZSxcbiAgICAgIHBlcnNvbmFsQWNjZXNzVG9rZW46IG9wdGlvbnMucGVyc29uYWxBY2Nlc3NUb2tlbixcbiAgICAgIG9uQXV0aG9yaXplOiBvcHRpb25zLm9uQXV0aG9yaXplLFxuICAgICAgYm9keUVuY29kaW5nOiBvcHRpb25zLmJvZHlFbmNvZGluZyxcbiAgICAgIHRva2VuUmVmcmVzaFJlc3BvbnNlUGFyc2VyOiBvcHRpb25zLnRva2VuUmVmcmVzaFJlc3BvbnNlUGFyc2VyLFxuICAgICAgdG9rZW5SZXNwb25zZVBhcnNlcjogb3B0aW9ucy50b2tlblJlc3BvbnNlUGFyc2VyLFxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIEdpdEh1YiBPQXV0aCBzZXJ2aWNlIHByb3ZpZGVkIG91dCBvZiB0aGUgYm94LlxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiBgYGB0eXBlc2NyaXB0XG4gICAqIGNvbnN0IGdpdGh1YiA9IE9BdXRoU2VydmljZS5naXRodWIoeyBzY29wZTogJ3JlcG8gdXNlcicgfSlcbiAgICogYGBgXG4gICAqL1xuICBwdWJsaWMgc3RhdGljIGdpdGh1YihvcHRpb25zOiBQcm92aWRlcldpdGhEZWZhdWx0Q2xpZW50T3B0aW9ucykge1xuICAgIHJldHVybiBuZXcgT0F1dGhTZXJ2aWNlKHtcbiAgICAgIGNsaWVudDogbmV3IE9BdXRoLlBLQ0VDbGllbnQoe1xuICAgICAgICByZWRpcmVjdE1ldGhvZDogT0F1dGguUmVkaXJlY3RNZXRob2QuV2ViLFxuICAgICAgICBwcm92aWRlck5hbWU6IFwiR2l0SHViXCIsXG4gICAgICAgIHByb3ZpZGVySWNvbjoge1xuICAgICAgICAgIHNvdXJjZTogYGRhdGE6aW1hZ2Uvc3ZnK3htbCwke2VuY29kZVVSSUNvbXBvbmVudChcbiAgICAgICAgICAgIGA8c3ZnIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiB3aWR0aD1cIjY0XCIgaGVpZ2h0PVwiNjRcIiB2aWV3Qm94PVwiMCAwIDE2IDE2XCI+PHBhdGggZmlsbC1ydWxlPVwiZXZlbm9kZFwiIGQ9XCJNOCAwQzMuNTggMCAwIDMuNTggMCA4YzAgMy41NCAyLjI5IDYuNTMgNS40NyA3LjU5LjQuMDcuNTUtLjE3LjU1LS4zOCAwLS4xOS0uMDEtLjgyLS4wMS0xLjQ5LTIuMDEuMzctMi41My0uNDktMi42OS0uOTQtLjA5LS4yMy0uNDgtLjk0LS44Mi0xLjEzLS4yOC0uMTUtLjY4LS41Mi0uMDEtLjUzLjYzLS4wMSAxLjA4LjU4IDEuMjMuODIuNzIgMS4yMSAxLjg3Ljg3IDIuMzMuNjYuMDctLjUyLjI4LS44Ny41MS0xLjA3LTEuNzgtLjItMy42NC0uODktMy42NC0zLjk1IDAtLjg3LjMxLTEuNTkuODItMi4xNS0uMDgtLjItLjM2LTEuMDIuMDgtMi4xMiAwIDAgLjY3LS4yMSAyLjIuODIuNjQtLjE4IDEuMzItLjI3IDItLjI3LjY4IDAgMS4zNi4wOSAyIC4yNyAxLjUzLTEuMDQgMi4yLS44MiAyLjItLjgyLjQ0IDEuMS4xNiAxLjkyLjA4IDIuMTIuNTEuNTYuODIgMS4yNy44MiAyLjE1IDAgMy4wNy0xLjg3IDMuNzUtMy42NSAzLjk1LjI5LjI1LjU0LjczLjU0IDEuNDggMCAxLjA3LS4wMSAxLjkzLS4wMSAyLjIgMCAuMjEuMTUuNDYuNTUuMzhBOC4wMTMgOC4wMTMgMCAwIDAgMTYgOGMwLTQuNDItMy41OC04LTgtOHpcIi8+PC9zdmc+YCxcbiAgICAgICAgICApfWAsXG5cbiAgICAgICAgICB0aW50Q29sb3I6IENvbG9yLlByaW1hcnlUZXh0LFxuICAgICAgICB9LFxuICAgICAgICBwcm92aWRlcklkOiBcImdpdGh1YlwiLFxuICAgICAgICBkZXNjcmlwdGlvbjogXCJDb25uZWN0IHlvdXIgR2l0SHViIGFjY291bnRcIixcbiAgICAgIH0pLFxuICAgICAgY2xpZW50SWQ6IG9wdGlvbnMuY2xpZW50SWQgPz8gUFJPVklERVJfQ0xJRU5UX0lEUy5naXRodWIsXG4gICAgICBhdXRob3JpemVVcmw6IG9wdGlvbnMuYXV0aG9yaXplVXJsID8/IFwiaHR0cHM6Ly9naXRodWIub2F1dGgucmF5Y2FzdC5jb20vYXV0aG9yaXplXCIsXG4gICAgICB0b2tlblVybDogb3B0aW9ucy50b2tlblVybCA/PyBcImh0dHBzOi8vZ2l0aHViLm9hdXRoLnJheWNhc3QuY29tL3Rva2VuXCIsXG4gICAgICByZWZyZXNoVG9rZW5Vcmw6IG9wdGlvbnMucmVmcmVzaFRva2VuVXJsID8/IFwiaHR0cHM6Ly9naXRodWIub2F1dGgucmF5Y2FzdC5jb20vcmVmcmVzaC10b2tlblwiLFxuICAgICAgc2NvcGU6IG9wdGlvbnMuc2NvcGUsXG4gICAgICBwZXJzb25hbEFjY2Vzc1Rva2VuOiBvcHRpb25zLnBlcnNvbmFsQWNjZXNzVG9rZW4sXG4gICAgICBvbkF1dGhvcml6ZTogb3B0aW9ucy5vbkF1dGhvcml6ZSxcbiAgICAgIGJvZHlFbmNvZGluZzogb3B0aW9ucy5ib2R5RW5jb2RpbmcsXG4gICAgICB0b2tlblJlZnJlc2hSZXNwb25zZVBhcnNlcjogb3B0aW9ucy50b2tlblJlZnJlc2hSZXNwb25zZVBhcnNlcixcbiAgICAgIHRva2VuUmVzcG9uc2VQYXJzZXI6IG9wdGlvbnMudG9rZW5SZXNwb25zZVBhcnNlcixcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHb29nbGUgT0F1dGggc2VydmljZSBwcm92aWRlZCBvdXQgb2YgdGhlIGJveC5cbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogYGBgdHlwZXNjcmlwdFxuICAgKiBjb25zdCBnb29nbGUgPSBPQXV0aFNlcnZpY2UuZ29vZ2xlKHtcbiAgICogICBjbGllbnRJZDogJ2N1c3RvbS1jbGllbnQtaWQnLFxuICAgKiAgIGF1dGhvcml6ZVVybDogJ2h0dHBzOi8vYWNjb3VudHMuZ29vZ2xlLmNvbS9vL29hdXRoMi92Mi9hdXRoJyxcbiAgICogICB0b2tlblVybDogJ2h0dHBzOi8vb2F1dGgyLmdvb2dsZWFwaXMuY29tL3Rva2VuJyxcbiAgICogICBzY29wZTogJ2h0dHBzOi8vd3d3Lmdvb2dsZWFwaXMuY29tL2F1dGgvZHJpdmUucmVhZG9ubHknLFxuICAgKiB9KTtcbiAgICogYGBgXG4gICAqL1xuICBwdWJsaWMgc3RhdGljIGdvb2dsZShvcHRpb25zOiBQcm92aWRlck9wdGlvbnMpIHtcbiAgICByZXR1cm4gbmV3IE9BdXRoU2VydmljZSh7XG4gICAgICBjbGllbnQ6IG5ldyBPQXV0aC5QS0NFQ2xpZW50KHtcbiAgICAgICAgcmVkaXJlY3RNZXRob2Q6IE9BdXRoLlJlZGlyZWN0TWV0aG9kLkFwcFVSSSxcbiAgICAgICAgcHJvdmlkZXJOYW1lOiBcIkdvb2dsZVwiLFxuICAgICAgICBwcm92aWRlckljb246IGBkYXRhOmltYWdlL3N2Zyt4bWwsJHtlbmNvZGVVUklDb21wb25lbnQoXG4gICAgICAgICAgYDxzdmcgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHN0eWxlPVwiZGlzcGxheTpibG9ja1wiIHZpZXdCb3g9XCIwIDAgNDggNDhcIj48cGF0aCBmaWxsPVwiI0VBNDMzNVwiIGQ9XCJNMjQgOS41YzMuNTQgMCA2LjcxIDEuMjIgOS4yMSAzLjZsNi44NS02Ljg1QzM1LjkgMi4zOCAzMC40NyAwIDI0IDAgMTQuNjIgMCA2LjUxIDUuMzggMi41NiAxMy4yMmw3Ljk4IDYuMTlDMTIuNDMgMTMuNzIgMTcuNzQgOS41IDI0IDkuNXpcIi8+PHBhdGggZmlsbD1cIiM0Mjg1RjRcIiBkPVwiTTQ2Ljk4IDI0LjU1YzAtMS41Ny0uMTUtMy4wOS0uMzgtNC41NUgyNHY5LjAyaDEyLjk0Yy0uNTggMi45Ni0yLjI2IDUuNDgtNC43OCA3LjE4bDcuNzMgNmM0LjUxLTQuMTggNy4wOS0xMC4zNiA3LjA5LTE3LjY1elwiLz48cGF0aCBmaWxsPVwiI0ZCQkMwNVwiIGQ9XCJNMTAuNTMgMjguNTljLS40OC0xLjQ1LS43Ni0yLjk5LS43Ni00LjU5cy4yNy0zLjE0Ljc2LTQuNTlsLTcuOTgtNi4xOUMuOTIgMTYuNDYgMCAyMC4xMiAwIDI0YzAgMy44OC45MiA3LjU0IDIuNTYgMTAuNzhsNy45Ny02LjE5elwiLz48cGF0aCBmaWxsPVwiIzM0QTg1M1wiIGQ9XCJNMjQgNDhjNi40OCAwIDExLjkzLTIuMTMgMTUuODktNS44MWwtNy43My02Yy0yLjE1IDEuNDUtNC45MiAyLjMtOC4xNiAyLjMtNi4yNiAwLTExLjU3LTQuMjItMTMuNDctOS45MWwtNy45OCA2LjE5QzYuNTEgNDIuNjIgMTQuNjIgNDggMjQgNDh6XCIvPjxwYXRoIGZpbGw9XCJub25lXCIgZD1cIk0wIDBoNDh2NDhIMHpcIi8+PC9zdmc+YCxcbiAgICAgICAgKX1gLFxuICAgICAgICBwcm92aWRlcklkOiBcImdvb2dsZVwiLFxuICAgICAgICBkZXNjcmlwdGlvbjogXCJDb25uZWN0IHlvdXIgR29vZ2xlIGFjY291bnRcIixcbiAgICAgIH0pLFxuICAgICAgY2xpZW50SWQ6IG9wdGlvbnMuY2xpZW50SWQsXG4gICAgICBhdXRob3JpemVVcmw6IG9wdGlvbnMuYXV0aG9yaXplVXJsID8/IFwiaHR0cHM6Ly9hY2NvdW50cy5nb29nbGUuY29tL28vb2F1dGgyL3YyL2F1dGhcIixcbiAgICAgIHRva2VuVXJsOiBvcHRpb25zLnRva2VuVXJsID8/IFwiaHR0cHM6Ly9vYXV0aDIuZ29vZ2xlYXBpcy5jb20vdG9rZW5cIixcbiAgICAgIHJlZnJlc2hUb2tlblVybDogb3B0aW9ucy50b2tlblVybCxcbiAgICAgIHNjb3BlOiBvcHRpb25zLnNjb3BlLFxuICAgICAgcGVyc29uYWxBY2Nlc3NUb2tlbjogb3B0aW9ucy5wZXJzb25hbEFjY2Vzc1Rva2VuLFxuICAgICAgYm9keUVuY29kaW5nOiBvcHRpb25zLmJvZHlFbmNvZGluZyA/PyBcInVybC1lbmNvZGVkXCIsXG4gICAgICBvbkF1dGhvcml6ZTogb3B0aW9ucy5vbkF1dGhvcml6ZSxcbiAgICAgIHRva2VuUmVmcmVzaFJlc3BvbnNlUGFyc2VyOiBvcHRpb25zLnRva2VuUmVmcmVzaFJlc3BvbnNlUGFyc2VyLFxuICAgICAgdG9rZW5SZXNwb25zZVBhcnNlcjogb3B0aW9ucy50b2tlblJlc3BvbnNlUGFyc2VyLFxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIEppcmEgT0F1dGggc2VydmljZSBwcm92aWRlZCBvdXQgb2YgdGhlIGJveC5cbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogYGBgdHlwZXNjcmlwdFxuICAgKiBjb25zdCBqaXJhID0gT0F1dGhTZXJ2aWNlLmppcmEoe1xuICAgKiAgIGNsaWVudElkOiAnY3VzdG9tLWNsaWVudC1pZCcsXG4gICAqICAgYXV0aG9yaXplVXJsOiAnaHR0cHM6Ly9hdXRoLmF0bGFzc2lhbi5jb20vYXV0aG9yaXplJyxcbiAgICogICB0b2tlblVybDogJ2h0dHBzOi8vYXBpLmF0bGFzc2lhbi5jb20vb2F1dGgvdG9rZW4nLFxuICAgKiAgIHNjb3BlOiAncmVhZDpqaXJhLXVzZXIgcmVhZDpqaXJhLXdvcmsgb2ZmbGluZV9hY2Nlc3MnXG4gICAqIH0pO1xuICAgKiBgYGBcbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgamlyYShvcHRpb25zOiBQcm92aWRlck9wdGlvbnMpIHtcbiAgICByZXR1cm4gbmV3IE9BdXRoU2VydmljZSh7XG4gICAgICBjbGllbnQ6IG5ldyBPQXV0aC5QS0NFQ2xpZW50KHtcbiAgICAgICAgcmVkaXJlY3RNZXRob2Q6IE9BdXRoLlJlZGlyZWN0TWV0aG9kLldlYixcbiAgICAgICAgcHJvdmlkZXJOYW1lOiBcIkppcmFcIixcbiAgICAgICAgcHJvdmlkZXJJY29uOiBgZGF0YTppbWFnZS9zdmcreG1sLCR7ZW5jb2RlVVJJQ29tcG9uZW50KFxuICAgICAgICAgIGA8c3ZnIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiB4bWxuczp4bGluaz1cImh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmtcIiB3aWR0aD1cIjIzNjFcIiBoZWlnaHQ9XCIyNTAwXCIgdmlld0JveD1cIjIuNTkgMCAyMTQuMDkxIDIyNFwiPjxsaW5lYXJHcmFkaWVudCBpZD1cImFcIiB4MT1cIjEwMi40XCIgeDI9XCI1Ni4xNVwiIHkxPVwiMjE4LjYzXCIgeTI9XCIxNzIuMzlcIiBncmFkaWVudFRyYW5zZm9ybT1cIm1hdHJpeCgxIDAgMCAtMSAwIDI2NClcIiBncmFkaWVudFVuaXRzPVwidXNlclNwYWNlT25Vc2VcIj48c3RvcCBvZmZzZXQ9XCIuMThcIiBzdG9wLWNvbG9yPVwiIzAwNTJjY1wiLz48c3RvcCBvZmZzZXQ9XCIxXCIgc3RvcC1jb2xvcj1cIiMyNjg0ZmZcIi8+PC9saW5lYXJHcmFkaWVudD48bGluZWFyR3JhZGllbnQgeGxpbms6aHJlZj1cIiNhXCIgaWQ9XCJiXCIgeDE9XCIxMTQuNjVcIiB4Mj1cIjE2MC44MVwiIHkxPVwiODUuNzdcIiB5Mj1cIjEzMS45MlwiLz48cGF0aCBmaWxsPVwiIzI2ODRmZlwiIGQ9XCJNMjE0LjA2IDEwNS43MyAxMTcuNjcgOS4zNCAxMDguMzMgMCAzNS43NyA3Mi41NiAyLjU5IDEwNS43M2E4Ljg5IDguODkgMCAwIDAgMCAxMi41NGw2Ni4yOSA2Ni4yOUwxMDguMzMgMjI0bDcyLjU1LTcyLjU2IDEuMTMtMS4xMiAzMi4wNS0zMmE4Ljg3IDguODcgMCAwIDAgMC0xMi41OXptLTEwNS43MyAzOS4zOUw3NS4yMSAxMTJsMzMuMTItMzMuMTJMMTQxLjQ0IDExMnpcIi8+PHBhdGggZmlsbD1cInVybCgjYSlcIiBkPVwiTTEwOC4zMyA3OC44OGE1NS43NSA1NS43NSAwIDAgMS0uMjQtNzguNjFMMzUuNjIgNzIuNzFsMzkuNDQgMzkuNDR6XCIvPjxwYXRoIGZpbGw9XCJ1cmwoI2IpXCIgZD1cIm0xNDEuNTMgMTExLjkxLTMzLjIgMzMuMjFhNTUuNzcgNTUuNzcgMCAwIDEgMCA3OC44NkwxODEgMTUxLjM1elwiLz48L3N2Zz5gLFxuICAgICAgICApfWAsXG4gICAgICAgIHByb3ZpZGVySWQ6IFwiamlyYVwiLFxuICAgICAgICBkZXNjcmlwdGlvbjogXCJDb25uZWN0IHlvdXIgSmlyYSBhY2NvdW50XCIsXG4gICAgICB9KSxcbiAgICAgIGNsaWVudElkOiBvcHRpb25zLmNsaWVudElkLFxuICAgICAgYXV0aG9yaXplVXJsOiBvcHRpb25zLmF1dGhvcml6ZVVybCA/PyBcImh0dHBzOi8vYXV0aC5hdGxhc3NpYW4uY29tL2F1dGhvcml6ZVwiLFxuICAgICAgdG9rZW5Vcmw6IG9wdGlvbnMudG9rZW5VcmwgPz8gXCJodHRwczovL2F1dGguYXRsYXNzaWFuLmNvbS9vYXV0aC90b2tlblwiLFxuICAgICAgcmVmcmVzaFRva2VuVXJsOiBvcHRpb25zLnJlZnJlc2hUb2tlblVybCxcbiAgICAgIHNjb3BlOiBvcHRpb25zLnNjb3BlLFxuICAgICAgcGVyc29uYWxBY2Nlc3NUb2tlbjogb3B0aW9ucy5wZXJzb25hbEFjY2Vzc1Rva2VuLFxuICAgICAgb25BdXRob3JpemU6IG9wdGlvbnMub25BdXRob3JpemUsXG4gICAgICBib2R5RW5jb2Rpbmc6IG9wdGlvbnMuYm9keUVuY29kaW5nLFxuICAgICAgdG9rZW5SZWZyZXNoUmVzcG9uc2VQYXJzZXI6IG9wdGlvbnMudG9rZW5SZWZyZXNoUmVzcG9uc2VQYXJzZXIsXG4gICAgICB0b2tlblJlc3BvbnNlUGFyc2VyOiBvcHRpb25zLnRva2VuUmVzcG9uc2VQYXJzZXIsXG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogTGluZWFyIE9BdXRoIHNlcnZpY2UgcHJvdmlkZWQgb3V0IG9mIHRoZSBib3guXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqIGBgYHR5cGVzY3JpcHRcbiAgICogY29uc3QgbGluZWFyID0gT0F1dGhTZXJ2aWNlLmxpbmVhcih7IHNjb3BlOiAncmVhZCB3cml0ZScgfSlcbiAgICogYGBgXG4gICAqL1xuICBwdWJsaWMgc3RhdGljIGxpbmVhcihvcHRpb25zOiBQcm92aWRlcldpdGhEZWZhdWx0Q2xpZW50T3B0aW9ucykge1xuICAgIHJldHVybiBuZXcgT0F1dGhTZXJ2aWNlKHtcbiAgICAgIGNsaWVudDogbmV3IE9BdXRoLlBLQ0VDbGllbnQoe1xuICAgICAgICByZWRpcmVjdE1ldGhvZDogT0F1dGguUmVkaXJlY3RNZXRob2QuV2ViLFxuICAgICAgICBwcm92aWRlck5hbWU6IFwiTGluZWFyXCIsXG4gICAgICAgIHByb3ZpZGVySWNvbjoge1xuICAgICAgICAgIHNvdXJjZToge1xuICAgICAgICAgICAgbGlnaHQ6IGBkYXRhOmltYWdlL3N2Zyt4bWwsJHtlbmNvZGVVUklDb21wb25lbnQoXG4gICAgICAgICAgICAgIGA8c3ZnIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiBmaWxsPVwiIzIyMjMyNlwiIHdpZHRoPVwiMjAwXCIgaGVpZ2h0PVwiMjAwXCIgdmlld0JveD1cIjAgMCAxMDAgMTAwXCI+PHBhdGggZD1cIk0xLjIyNTQxIDYxLjUyMjhjLS4yMjI1LS45NDg1LjkwNzQ4LTEuNTQ1OSAxLjU5NjM4LS44NTdMMzkuMzM0MiA5Ny4xNzgyYy42ODg5LjY4ODkuMDkxNSAxLjgxODktLjg1NyAxLjU5NjRDMjAuMDUxNSA5NC40NTIyIDUuNTQ3NzkgNzkuOTQ4NSAxLjIyNTQxIDYxLjUyMjhaTS4wMDE4OTEzNSA0Ni44ODkxYy0uMDE3NjQzNzUuMjgzMy4wODg4NzIxNS41NTk5LjI4OTU3MTY1Ljc2MDZMNTIuMzUwMyA5OS43MDg1Yy4yMDA3LjIwMDcuNDc3My4zMDc1Ljc2MDYuMjg5NiAyLjM2OTItLjE0NzYgNC42OTM4LS40NiA2Ljk2MjQtLjkyNTkuNzY0NS0uMTU3IDEuMDMwMS0xLjA5NjMuNDc4Mi0xLjY0ODFMMi41NzU5NSAzOS40NDg1Yy0uNTUxODYtLjU1MTktMS40OTExNy0uMjg2My0xLjY0ODE3NC40NzgyLS40NjU5MTUgMi4yNjg2LS43NzgzMiA0LjU5MzItLjkyNTg4NDY1IDYuOTYyNFpNNC4yMTA5MyAyOS43MDU0Yy0uMTY2NDkuMzczOC0uMDgxNjkuODEwNi4yMDc2NSAxLjFsNjQuNzc2MDIgNjQuNzc2Yy4yODk0LjI4OTQuNzI2Mi4zNzQyIDEuMS4yMDc3IDEuNzg2MS0uNzk1NiAzLjUxNzEtMS42OTI3IDUuMTg1NS0yLjY4NC41NTIxLS4zMjguNjM3My0xLjA4NjcuMTgzMi0xLjU0MDdMOC40MzU2NiAyNC4zMzY3Yy0uNDU0MDktLjQ1NDEtMS4yMTI3MS0uMzY4OS0xLjU0MDc0LjE4MzItLjk5MTMyIDEuNjY4NC0xLjg4ODQzIDMuMzk5NC0yLjY4Mzk5IDUuMTg1NVpNMTIuNjU4NyAxOC4wNzRjLS4zNzAxLS4zNzAxLS4zOTMtLjk2MzctLjA0NDMtMS4zNTQxQzIxLjc3OTUgNi40NTkzMSAzNS4xMTE0IDAgNDkuOTUxOSAwIDc3LjU5MjcgMCAxMDAgMjIuNDA3MyAxMDAgNTAuMDQ4MWMwIDE0Ljg0MDUtNi40NTkzIDI4LjE3MjQtMTYuNzE5OSAzNy4zMzc1LS4zOTAzLjM0ODctLjk4NC4zMjU4LTEuMzU0Mi0uMDQ0M0wxMi42NTg3IDE4LjA3NFpcIi8+PC9zdmc+YCxcbiAgICAgICAgICAgICl9YCxcbiAgICAgICAgICAgIGRhcms6IGBkYXRhOmltYWdlL3N2Zyt4bWwsJHtlbmNvZGVVUklDb21wb25lbnQoXG4gICAgICAgICAgICAgIGA8c3ZnIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiBmaWxsPVwiI2ZmZlwiIHdpZHRoPVwiMjAwXCIgaGVpZ2h0PVwiMjAwXCIgdmlld0JveD1cIjAgMCAxMDAgMTAwXCI+PHBhdGggZD1cIk0xLjIyNTQxIDYxLjUyMjhjLS4yMjI1LS45NDg1LjkwNzQ4LTEuNTQ1OSAxLjU5NjM4LS44NTdMMzkuMzM0MiA5Ny4xNzgyYy42ODg5LjY4ODkuMDkxNSAxLjgxODktLjg1NyAxLjU5NjRDMjAuMDUxNSA5NC40NTIyIDUuNTQ3NzkgNzkuOTQ4NSAxLjIyNTQxIDYxLjUyMjhaTS4wMDE4OTEzNSA0Ni44ODkxYy0uMDE3NjQzNzUuMjgzMy4wODg4NzIxNS41NTk5LjI4OTU3MTY1Ljc2MDZMNTIuMzUwMyA5OS43MDg1Yy4yMDA3LjIwMDcuNDc3My4zMDc1Ljc2MDYuMjg5NiAyLjM2OTItLjE0NzYgNC42OTM4LS40NiA2Ljk2MjQtLjkyNTkuNzY0NS0uMTU3IDEuMDMwMS0xLjA5NjMuNDc4Mi0xLjY0ODFMMi41NzU5NSAzOS40NDg1Yy0uNTUxODYtLjU1MTktMS40OTExNy0uMjg2My0xLjY0ODE3NC40NzgyLS40NjU5MTUgMi4yNjg2LS43NzgzMiA0LjU5MzItLjkyNTg4NDY1IDYuOTYyNFpNNC4yMTA5MyAyOS43MDU0Yy0uMTY2NDkuMzczOC0uMDgxNjkuODEwNi4yMDc2NSAxLjFsNjQuNzc2MDIgNjQuNzc2Yy4yODk0LjI4OTQuNzI2Mi4zNzQyIDEuMS4yMDc3IDEuNzg2MS0uNzk1NiAzLjUxNzEtMS42OTI3IDUuMTg1NS0yLjY4NC41NTIxLS4zMjguNjM3My0xLjA4NjcuMTgzMi0xLjU0MDdMOC40MzU2NiAyNC4zMzY3Yy0uNDU0MDktLjQ1NDEtMS4yMTI3MS0uMzY4OS0xLjU0MDc0LjE4MzItLjk5MTMyIDEuNjY4NC0xLjg4ODQzIDMuMzk5NC0yLjY4Mzk5IDUuMTg1NVpNMTIuNjU4NyAxOC4wNzRjLS4zNzAxLS4zNzAxLS4zOTMtLjk2MzctLjA0NDMtMS4zNTQxQzIxLjc3OTUgNi40NTkzMSAzNS4xMTE0IDAgNDkuOTUxOSAwIDc3LjU5MjcgMCAxMDAgMjIuNDA3MyAxMDAgNTAuMDQ4MWMwIDE0Ljg0MDUtNi40NTkzIDI4LjE3MjQtMTYuNzE5OSAzNy4zMzc1LS4zOTAzLjM0ODctLjk4NC4zMjU4LTEuMzU0Mi0uMDQ0M0wxMi42NTg3IDE4LjA3NFpcIiAvPjwvc3ZnPmAsXG4gICAgICAgICAgICApfWAsXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAgcHJvdmlkZXJJZDogXCJsaW5lYXJcIixcbiAgICAgICAgZGVzY3JpcHRpb246IFwiQ29ubmVjdCB5b3VyIExpbmVhciBhY2NvdW50XCIsXG4gICAgICB9KSxcbiAgICAgIGNsaWVudElkOiBvcHRpb25zLmNsaWVudElkID8/IFBST1ZJREVSX0NMSUVOVF9JRFMubGluZWFyLFxuICAgICAgYXV0aG9yaXplVXJsOiBvcHRpb25zLmF1dGhvcml6ZVVybCA/PyBcImh0dHBzOi8vbGluZWFyLm9hdXRoLnJheWNhc3QuY29tL2F1dGhvcml6ZVwiLFxuICAgICAgdG9rZW5Vcmw6IG9wdGlvbnMudG9rZW5VcmwgPz8gXCJodHRwczovL2xpbmVhci5vYXV0aC5yYXljYXN0LmNvbS90b2tlblwiLFxuICAgICAgcmVmcmVzaFRva2VuVXJsOiBvcHRpb25zLnJlZnJlc2hUb2tlblVybCA/PyBcImh0dHBzOi8vbGluZWFyLm9hdXRoLnJheWNhc3QuY29tL3JlZnJlc2gtdG9rZW5cIixcbiAgICAgIHNjb3BlOiBvcHRpb25zLnNjb3BlLFxuICAgICAgZXh0cmFQYXJhbWV0ZXJzOiB7XG4gICAgICAgIGFjdG9yOiBcInVzZXJcIixcbiAgICAgIH0sXG4gICAgICBvbkF1dGhvcml6ZTogb3B0aW9ucy5vbkF1dGhvcml6ZSxcbiAgICAgIGJvZHlFbmNvZGluZzogb3B0aW9ucy5ib2R5RW5jb2RpbmcsXG4gICAgICB0b2tlblJlZnJlc2hSZXNwb25zZVBhcnNlcjogb3B0aW9ucy50b2tlblJlZnJlc2hSZXNwb25zZVBhcnNlcixcbiAgICAgIHRva2VuUmVzcG9uc2VQYXJzZXI6IG9wdGlvbnMudG9rZW5SZXNwb25zZVBhcnNlcixcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTbGFjayBPQXV0aCBzZXJ2aWNlIHByb3ZpZGVkIG91dCBvZiB0aGUgYm94LlxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiBgYGB0eXBlc2NyaXB0XG4gICAqIGNvbnN0IHNsYWNrID0gT0F1dGhTZXJ2aWNlLnNsYWNrKHsgc2NvcGU6ICdlbW9qaTpyZWFkJyB9KVxuICAgKiBgYGBcbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgc2xhY2sob3B0aW9uczogUHJvdmlkZXJXaXRoRGVmYXVsdENsaWVudE9wdGlvbnMpIHtcbiAgICByZXR1cm4gbmV3IE9BdXRoU2VydmljZSh7XG4gICAgICBjbGllbnQ6IG5ldyBPQXV0aC5QS0NFQ2xpZW50KHtcbiAgICAgICAgcmVkaXJlY3RNZXRob2Q6IE9BdXRoLlJlZGlyZWN0TWV0aG9kLldlYixcbiAgICAgICAgcHJvdmlkZXJOYW1lOiBcIlNsYWNrXCIsXG4gICAgICAgIHByb3ZpZGVySWNvbjogYGRhdGE6aW1hZ2Uvc3ZnK3htbCwke2VuY29kZVVSSUNvbXBvbmVudChcbiAgICAgICAgICBgPHN2ZyB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgdmlld0JveD1cIjczIDczIDEyNCAxMjRcIj48c3R5bGU+LnN0MHtmaWxsOiNlMDFlNWF9LnN0MXtmaWxsOiMzNmM1ZjB9LnN0MntmaWxsOiMyZWI2N2R9LnN0M3tmaWxsOiNlY2IyMmV9PC9zdHlsZT48cGF0aCBkPVwiTTk5LjQgMTUxLjJjMCA3LjEtNS44IDEyLjktMTIuOSAxMi45LTcuMSAwLTEyLjktNS44LTEyLjktMTIuOSAwLTcuMSA1LjgtMTIuOSAxMi45LTEyLjloMTIuOXYxMi45ek0xMDUuOSAxNTEuMmMwLTcuMSA1LjgtMTIuOSAxMi45LTEyLjlzMTIuOSA1LjggMTIuOSAxMi45djMyLjNjMCA3LjEtNS44IDEyLjktMTIuOSAxMi45cy0xMi45LTUuOC0xMi45LTEyLjl2LTMyLjN6XCIgY2xhc3M9XCJzdDBcIi8+PHBhdGggZD1cIk0xMTguOCA5OS40Yy03LjEgMC0xMi45LTUuOC0xMi45LTEyLjkgMC03LjEgNS44LTEyLjkgMTIuOS0xMi45czEyLjkgNS44IDEyLjkgMTIuOXYxMi45aC0xMi45ek0xMTguOCAxMDUuOWM3LjEgMCAxMi45IDUuOCAxMi45IDEyLjlzLTUuOCAxMi45LTEyLjkgMTIuOUg4Ni41Yy03LjEgMC0xMi45LTUuOC0xMi45LTEyLjlzNS44LTEyLjkgMTIuOS0xMi45aDMyLjN6XCIgY2xhc3M9XCJzdDFcIi8+PHBhdGggZD1cIk0xNzAuNiAxMTguOGMwLTcuMSA1LjgtMTIuOSAxMi45LTEyLjkgNy4xIDAgMTIuOSA1LjggMTIuOSAxMi45cy01LjggMTIuOS0xMi45IDEyLjloLTEyLjl2LTEyLjl6TTE2NC4xIDExOC44YzAgNy4xLTUuOCAxMi45LTEyLjkgMTIuOS03LjEgMC0xMi45LTUuOC0xMi45LTEyLjlWODYuNWMwLTcuMSA1LjgtMTIuOSAxMi45LTEyLjkgNy4xIDAgMTIuOSA1LjggMTIuOSAxMi45djMyLjN6XCIgY2xhc3M9XCJzdDJcIi8+PHBhdGggZD1cIk0xNTEuMiAxNzAuNmM3LjEgMCAxMi45IDUuOCAxMi45IDEyLjkgMCA3LjEtNS44IDEyLjktMTIuOSAxMi45LTcuMSAwLTEyLjktNS44LTEyLjktMTIuOXYtMTIuOWgxMi45ek0xNTEuMiAxNjQuMWMtNy4xIDAtMTIuOS01LjgtMTIuOS0xMi45IDAtNy4xIDUuOC0xMi45IDEyLjktMTIuOWgzMi4zYzcuMSAwIDEyLjkgNS44IDEyLjkgMTIuOSAwIDcuMS01LjggMTIuOS0xMi45IDEyLjloLTMyLjN6XCIgY2xhc3M9XCJzdDNcIi8+PC9zdmc+YCxcbiAgICAgICAgKX1gLFxuICAgICAgICBwcm92aWRlcklkOiBcInNsYWNrXCIsXG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIkNvbm5lY3QgeW91ciBTbGFjayBhY2NvdW50XCIsXG4gICAgICB9KSxcbiAgICAgIGNsaWVudElkOiBvcHRpb25zLmNsaWVudElkID8/IFBST1ZJREVSX0NMSUVOVF9JRFMuc2xhY2ssXG4gICAgICBhdXRob3JpemVVcmw6IG9wdGlvbnMuYXV0aG9yaXplVXJsID8/IFwiaHR0cHM6Ly9zbGFjay5vYXV0aC5yYXljYXN0LmNvbS9hdXRob3JpemVcIixcbiAgICAgIHRva2VuVXJsOiBvcHRpb25zLnRva2VuVXJsID8/IFwiaHR0cHM6Ly9zbGFjay5vYXV0aC5yYXljYXN0LmNvbS90b2tlblwiLFxuICAgICAgcmVmcmVzaFRva2VuVXJsOiBvcHRpb25zLnRva2VuVXJsID8/IFwiaHR0cHM6Ly9zbGFjay5vYXV0aC5yYXljYXN0LmNvbS9yZWZyZXNoLXRva2VuXCIsXG4gICAgICBzY29wZTogXCJcIixcbiAgICAgIGV4dHJhUGFyYW1ldGVyczoge1xuICAgICAgICB1c2VyX3Njb3BlOiBvcHRpb25zLnNjb3BlLFxuICAgICAgfSxcbiAgICAgIHBlcnNvbmFsQWNjZXNzVG9rZW46IG9wdGlvbnMucGVyc29uYWxBY2Nlc3NUb2tlbixcbiAgICAgIGJvZHlFbmNvZGluZzogb3B0aW9ucy50b2tlblVybCA/IG9wdGlvbnMuYm9keUVuY29kaW5nID8/IFwidXJsLWVuY29kZWRcIiA6IFwianNvblwiLFxuICAgICAgb25BdXRob3JpemU6IG9wdGlvbnMub25BdXRob3JpemUsXG4gICAgICB0b2tlblJlZnJlc2hSZXNwb25zZVBhcnNlcjogb3B0aW9ucy50b2tlblJlZnJlc2hSZXNwb25zZVBhcnNlcixcbiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICB0b2tlblJlc3BvbnNlUGFyc2VyOlxuICAgICAgICBvcHRpb25zLnRva2VuUmVzcG9uc2VQYXJzZXIgPz9cbiAgICAgICAgKChyZXNwb25zZTogYW55KSA9PiB7XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGFjY2Vzc190b2tlbjogcmVzcG9uc2UuYXV0aGVkX3VzZXIuYWNjZXNzX3Rva2VuLFxuICAgICAgICAgICAgc2NvcGU6IHJlc3BvbnNlLmF1dGhlZF91c2VyLnNjb3BlLFxuICAgICAgICAgIH07XG4gICAgICAgIH0pLFxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFpvb20gT0F1dGggc2VydmljZSBwcm92aWRlZCBvdXQgb2YgdGhlIGJveC5cbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogYGBgdHlwZXNjcmlwdFxuICAgKiBjb25zdCB6b29tID0gT0F1dGhTZXJ2aWNlLnpvb20oe1xuICAgKiAgIGNsaWVudElkOiAnY3VzdG9tLWNsaWVudC1pZCcsXG4gICAqICAgYXV0aG9yaXplVXJsOiAnaHR0cHM6Ly96b29tLnVzL29hdXRoL2F1dGhvcml6ZScsXG4gICAqICAgdG9rZW5Vcmw6ICdodHRwczovL3pvb20udXMvb2F1dGgvdG9rZW4nLFxuICAgKiAgIHNjb3BlOiAnbWVldGluZzp3cml0ZScsXG4gICAqICAgcGVyc29uYWxBY2Nlc3NUb2tlbjogJ3BlcnNvbmFsLWFjY2Vzcy10b2tlbicsXG4gICAqIH0pO1xuICAgKiBgYGBcbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgem9vbShvcHRpb25zOiBQcm92aWRlck9wdGlvbnMpIHtcbiAgICByZXR1cm4gbmV3IE9BdXRoU2VydmljZSh7XG4gICAgICBjbGllbnQ6IG5ldyBPQXV0aC5QS0NFQ2xpZW50KHtcbiAgICAgICAgcmVkaXJlY3RNZXRob2Q6IE9BdXRoLlJlZGlyZWN0TWV0aG9kLldlYixcbiAgICAgICAgcHJvdmlkZXJOYW1lOiBcIlpvb21cIixcbiAgICAgICAgcHJvdmlkZXJJY29uOiBgZGF0YTppbWFnZS9zdmcreG1sLCR7ZW5jb2RlVVJJQ29tcG9uZW50KFxuICAgICAgICAgIGA8c3ZnIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiB2aWV3Qm94PVwiMCAwIDM1MS44NDUgODBcIj48cGF0aCBkPVwiTTczLjc4NiA3OC44MzVIMTAuODhBMTAuODQyIDEwLjg0MiAwIDAgMSAuODMzIDcyLjEyMmExMC44NDEgMTAuODQxIDAgMCAxIDIuMzU3LTExLjg1TDQ2Ljc2NCAxNi43aC0zMS4yM0M2Ljk1NCAxNi42OTkgMCA5Ljc0NCAwIDEuMTY1aDU4LjAxNGM0LjQxNCAwIDguMzU3IDIuNjM0IDEwLjA0NiA2LjcxMmExMC44NDMgMTAuODQzIDAgMCAxLTIuMzU2IDExLjg1TDIyLjEzIDYzLjMwMmgzNi4xMjJjOC41OCAwIDE1LjUzNCA2Ljk1NSAxNS41MzQgMTUuNTM0Wm0yNzguMDU5LTQ4LjU0NEMzNTEuODQ1IDEzLjU4OCAzMzguMjU2IDAgMzIxLjU1MyAwYy04LjkzNCAwLTE2Ljk3NSAzLjg5LTIyLjUyNCAxMC4wNjNDMjkzLjQ4IDMuODkgMjg1LjQ0IDAgMjc2LjUwNSAwYy0xNi43MDMgMC0zMC4yOTEgMTMuNTg4LTMwLjI5MSAzMC4yOTF2NDguNTQ0YzguNTc5IDAgMTUuNTM0LTYuOTU1IDE1LjUzNC0xNS41MzR2LTMzLjAxYzAtOC4xMzcgNi42Mi0xNC43NTcgMTQuNzU3LTE0Ljc1N3MxNC43NTcgNi42MiAxNC43NTcgMTQuNzU3djMzLjAxYzAgOC41OCA2Ljk1NSAxNS41MzQgMTUuNTM0IDE1LjUzNFYzMC4yOTFjMC04LjEzNyA2LjYyLTE0Ljc1NyAxNC43NTctMTQuNzU3czE0Ljc1OCA2LjYyIDE0Ljc1OCAxNC43NTd2MzMuMDFjMCA4LjU4IDYuOTU0IDE1LjUzNCAxNS41MzQgMTUuNTM0VjMwLjI5MVpNMjM4LjQ0NyA0MGMwIDIyLjA5MS0xNy45MDkgNDAtNDAgNDBzLTQwLTE3LjkwOS00MC00MCAxNy45MDgtNDAgNDAtNDAgNDAgMTcuOTA5IDQwIDQwWm0tMTUuNTM0IDBjMC0xMy41MTItMTAuOTU0LTI0LjQ2Ni0yNC40NjYtMjQuNDY2UzE3My45OCAyNi40ODggMTczLjk4IDQwczEwLjk1MyAyNC40NjYgMjQuNDY2IDI0LjQ2NlMyMjIuOTEzIDUzLjUxMiAyMjIuOTEzIDQwWm0tNzAuNjggMGMwIDIyLjA5MS0xNy45MDkgNDAtNDAgNDBzLTQwLTE3LjkwOS00MC00MCAxNy45MDktNDAgNDAtNDAgNDAgMTcuOTA5IDQwIDQwWm0tMTUuNTM0IDBjMC0xMy41MTItMTAuOTU0LTI0LjQ2Ni0yNC40NjYtMjQuNDY2Uzg3Ljc2NyAyNi40ODggODcuNzY3IDQwczEwLjk1NCAyNC40NjYgMjQuNDY2IDI0LjQ2NlMxMzYuNjk5IDUzLjUxMiAxMzYuNjk5IDQwWlwiIHN0eWxlPVwiZmlsbDojMGI1Y2ZmXCIvPjwvc3ZnPmAsXG4gICAgICAgICl9YCxcbiAgICAgICAgcHJvdmlkZXJJZDogXCJ6b29tXCIsXG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIkNvbm5lY3QgeW91ciBab29tIGFjY291bnRcIixcbiAgICAgIH0pLFxuICAgICAgY2xpZW50SWQ6IG9wdGlvbnMuY2xpZW50SWQsXG4gICAgICBhdXRob3JpemVVcmw6IG9wdGlvbnMuYXV0aG9yaXplVXJsID8/IFwiaHR0cHM6Ly96b29tLnVzL29hdXRoL2F1dGhvcml6ZVwiLFxuICAgICAgdG9rZW5Vcmw6IG9wdGlvbnMudG9rZW5VcmwgPz8gXCJodHRwczovL3pvb20udXMvb2F1dGgvdG9rZW5cIixcbiAgICAgIHJlZnJlc2hUb2tlblVybDogb3B0aW9ucy5yZWZyZXNoVG9rZW5VcmwsXG4gICAgICBzY29wZTogb3B0aW9ucy5zY29wZSxcbiAgICAgIHBlcnNvbmFsQWNjZXNzVG9rZW46IG9wdGlvbnMucGVyc29uYWxBY2Nlc3NUb2tlbixcbiAgICAgIGJvZHlFbmNvZGluZzogb3B0aW9ucy5ib2R5RW5jb2RpbmcgPz8gXCJ1cmwtZW5jb2RlZFwiLFxuICAgICAgb25BdXRob3JpemU6IG9wdGlvbnMub25BdXRob3JpemUsXG4gICAgICB0b2tlblJlZnJlc2hSZXNwb25zZVBhcnNlcjogb3B0aW9ucy50b2tlblJlZnJlc2hSZXNwb25zZVBhcnNlcixcbiAgICAgIHRva2VuUmVzcG9uc2VQYXJzZXI6IG9wdGlvbnMudG9rZW5SZXNwb25zZVBhcnNlcixcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBJbml0aWF0ZXMgdGhlIE9BdXRoIGF1dGhvcml6YXRpb24gcHJvY2VzcyBvciByZWZyZXNoZXMgZXhpc3RpbmcgdG9rZW5zIGlmIG5lY2Vzc2FyeS5cbiAgICogSWYgdGhlIGN1cnJlbnQgdG9rZW4gc2V0IGhhcyBhIHJlZnJlc2ggdG9rZW4gYW5kIGl0IGlzIGV4cGlyZWQsIHRoZW4gdGhlIGZ1bmN0aW9uIHdpbGwgcmVmcmVzaCB0aGUgdG9rZW5zLlxuICAgKiBJZiBubyB0b2tlbnMgZXhpc3QsIGl0IHdpbGwgaW5pdGlhdGUgdGhlIE9BdXRoIGF1dGhvcml6YXRpb24gcHJvY2VzcyBhbmQgZmV0Y2ggdGhlIHRva2Vucy5cbiAgICpcbiAgICogQHJldHVybnMge1Byb21pc2U8c3RyaW5nPn0gQSBwcm9taXNlIHRoYXQgcmVzb2x2ZXMgd2l0aCB0aGUgYWNjZXNzIHRva2VuIG9idGFpbmVkIGZyb20gdGhlIGF1dGhvcml6YXRpb24gZmxvdywgb3IgbnVsbCBpZiB0aGUgdG9rZW4gY291bGQgbm90IGJlIG9idGFpbmVkLlxuICAgKi9cbiAgYXN5bmMgYXV0aG9yaXplKCkge1xuICAgIGNvbnN0IGN1cnJlbnRUb2tlblNldCA9IGF3YWl0IHRoaXMuY2xpZW50LmdldFRva2VucygpO1xuICAgIGlmIChjdXJyZW50VG9rZW5TZXQ/LmFjY2Vzc1Rva2VuKSB7XG4gICAgICBpZiAoY3VycmVudFRva2VuU2V0LnJlZnJlc2hUb2tlbiAmJiBjdXJyZW50VG9rZW5TZXQuaXNFeHBpcmVkKCkpIHtcbiAgICAgICAgY29uc3QgdG9rZW5zID0gYXdhaXQgdGhpcy5yZWZyZXNoVG9rZW5zKHtcbiAgICAgICAgICB0b2tlbjogY3VycmVudFRva2VuU2V0LnJlZnJlc2hUb2tlbixcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gSW4gdGhlIGNhc2Ugd2hlcmUgdGhlIHJlZnJlc2ggdG9rZW4gZmxvd3MgZmFpbHMsIG5vdGhpbmcgaXMgcmV0dXJuZWQgYW5kIHRoZSBhdXRob3JpemUgZnVuY3Rpb24gaXMgY2FsbGVkIGFnYWluLlxuICAgICAgICBpZiAodG9rZW5zKSB7XG4gICAgICAgICAgYXdhaXQgdGhpcy5jbGllbnQuc2V0VG9rZW5zKHRva2Vucyk7XG4gICAgICAgICAgcmV0dXJuIHRva2Vucy5hY2Nlc3NfdG9rZW47XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBjdXJyZW50VG9rZW5TZXQuYWNjZXNzVG9rZW47XG4gICAgfVxuXG4gICAgY29uc3QgYXV0aFJlcXVlc3QgPSBhd2FpdCB0aGlzLmNsaWVudC5hdXRob3JpemF0aW9uUmVxdWVzdCh7XG4gICAgICBlbmRwb2ludDogdGhpcy5hdXRob3JpemVVcmwsXG4gICAgICBjbGllbnRJZDogdGhpcy5jbGllbnRJZCxcbiAgICAgIHNjb3BlOiB0aGlzLnNjb3BlLFxuICAgICAgZXh0cmFQYXJhbWV0ZXJzOiB0aGlzLmV4dHJhUGFyYW1ldGVycyxcbiAgICB9KTtcblxuICAgIGNvbnN0IHsgYXV0aG9yaXphdGlvbkNvZGUgfSA9IGF3YWl0IHRoaXMuY2xpZW50LmF1dGhvcml6ZShhdXRoUmVxdWVzdCk7XG4gICAgY29uc3QgdG9rZW5zID0gYXdhaXQgdGhpcy5mZXRjaFRva2Vucyh7XG4gICAgICBhdXRoUmVxdWVzdCxcbiAgICAgIGF1dGhvcml6YXRpb25Db2RlLFxuICAgIH0pO1xuXG4gICAgYXdhaXQgdGhpcy5jbGllbnQuc2V0VG9rZW5zKHRva2Vucyk7XG5cbiAgICByZXR1cm4gdG9rZW5zLmFjY2Vzc190b2tlbjtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgZmV0Y2hUb2tlbnMoe1xuICAgIGF1dGhSZXF1ZXN0LFxuICAgIGF1dGhvcml6YXRpb25Db2RlLFxuICB9OiB7XG4gICAgYXV0aFJlcXVlc3Q6IE9BdXRoLkF1dGhvcml6YXRpb25SZXF1ZXN0O1xuICAgIGF1dGhvcml6YXRpb25Db2RlOiBzdHJpbmc7XG4gIH0pIHtcbiAgICBsZXQgb3B0aW9ucztcbiAgICBpZiAodGhpcy5ib2R5RW5jb2RpbmcgPT09IFwidXJsLWVuY29kZWRcIikge1xuICAgICAgY29uc3QgcGFyYW1zID0gbmV3IFVSTFNlYXJjaFBhcmFtcygpO1xuICAgICAgcGFyYW1zLmFwcGVuZChcImNsaWVudF9pZFwiLCB0aGlzLmNsaWVudElkKTtcbiAgICAgIHBhcmFtcy5hcHBlbmQoXCJjb2RlXCIsIGF1dGhvcml6YXRpb25Db2RlKTtcbiAgICAgIHBhcmFtcy5hcHBlbmQoXCJjb2RlX3ZlcmlmaWVyXCIsIGF1dGhSZXF1ZXN0LmNvZGVWZXJpZmllcik7XG4gICAgICBwYXJhbXMuYXBwZW5kKFwiZ3JhbnRfdHlwZVwiLCBcImF1dGhvcml6YXRpb25fY29kZVwiKTtcbiAgICAgIHBhcmFtcy5hcHBlbmQoXCJyZWRpcmVjdF91cmlcIiwgYXV0aFJlcXVlc3QucmVkaXJlY3RVUkkpO1xuXG4gICAgICBvcHRpb25zID0geyBib2R5OiBwYXJhbXMgfTtcbiAgICB9IGVsc2Uge1xuICAgICAgb3B0aW9ucyA9IHtcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgIGNsaWVudF9pZDogdGhpcy5jbGllbnRJZCxcbiAgICAgICAgICBjb2RlOiBhdXRob3JpemF0aW9uQ29kZSxcbiAgICAgICAgICBjb2RlX3ZlcmlmaWVyOiBhdXRoUmVxdWVzdC5jb2RlVmVyaWZpZXIsXG4gICAgICAgICAgZ3JhbnRfdHlwZTogXCJhdXRob3JpemF0aW9uX2NvZGVcIixcbiAgICAgICAgICByZWRpcmVjdF91cmk6IGF1dGhSZXF1ZXN0LnJlZGlyZWN0VVJJLFxuICAgICAgICB9KSxcbiAgICAgICAgaGVhZGVyczogeyBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIiB9LFxuICAgICAgfTtcbiAgICB9XG5cbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHRoaXMudG9rZW5VcmwsIHsgbWV0aG9kOiBcIlBPU1RcIiwgLi4ub3B0aW9ucyB9KTtcbiAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICBjb25zdCByZXNwb25zZVRleHQgPSBhd2FpdCByZXNwb25zZS50ZXh0KCk7XG4gICAgICBjb25zb2xlLmVycm9yKFwiZmV0Y2ggdG9rZW5zIGVycm9yOlwiLCByZXNwb25zZVRleHQpO1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBFcnJvciB3aGlsZSBmZXRjaGluZyB0b2tlbnM6ICR7cmVzcG9uc2Uuc3RhdHVzfSAoJHtyZXNwb25zZS5zdGF0dXNUZXh0fSlcXG4ke3Jlc3BvbnNlVGV4dH1gKTtcbiAgICB9XG4gICAgY29uc3QgdG9rZW5zID0gdGhpcy50b2tlblJlc3BvbnNlUGFyc2VyKGF3YWl0IHJlc3BvbnNlLmpzb24oKSk7XG5cbiAgICAvLyBTb21lIGNsaWVudHMgc3VjaCBhcyBMaW5lYXIgY2FuIHJldHVybiBhIHNjb3BlIGFycmF5IGluc3RlYWQgb2YgYSBzdHJpbmdcbiAgICByZXR1cm4gQXJyYXkuaXNBcnJheSh0b2tlbnMuc2NvcGUpID8geyAuLi50b2tlbnMsIHNjb3BlOiB0b2tlbnMuc2NvcGUuam9pbihcIiBcIikgfSA6IHRva2VucztcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgcmVmcmVzaFRva2Vucyh7IHRva2VuIH06IHsgdG9rZW46IHN0cmluZyB9KSB7XG4gICAgbGV0IG9wdGlvbnM7XG4gICAgaWYgKHRoaXMuYm9keUVuY29kaW5nID09PSBcInVybC1lbmNvZGVkXCIpIHtcbiAgICAgIGNvbnN0IHBhcmFtcyA9IG5ldyBVUkxTZWFyY2hQYXJhbXMoKTtcbiAgICAgIHBhcmFtcy5hcHBlbmQoXCJjbGllbnRfaWRcIiwgdGhpcy5jbGllbnRJZCk7XG4gICAgICBwYXJhbXMuYXBwZW5kKFwicmVmcmVzaF90b2tlblwiLCB0b2tlbik7XG4gICAgICBwYXJhbXMuYXBwZW5kKFwiZ3JhbnRfdHlwZVwiLCBcInJlZnJlc2hfdG9rZW5cIik7XG5cbiAgICAgIG9wdGlvbnMgPSB7IGJvZHk6IHBhcmFtcyB9O1xuICAgIH0gZWxzZSB7XG4gICAgICBvcHRpb25zID0ge1xuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgY2xpZW50X2lkOiB0aGlzLmNsaWVudElkLFxuICAgICAgICAgIHJlZnJlc2hfdG9rZW46IHRva2VuLFxuICAgICAgICAgIGdyYW50X3R5cGU6IFwicmVmcmVzaF90b2tlblwiLFxuICAgICAgICB9KSxcbiAgICAgICAgaGVhZGVyczogeyBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIiB9LFxuICAgICAgfTtcbiAgICB9XG5cbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHRoaXMucmVmcmVzaFRva2VuVXJsID8/IHRoaXMudG9rZW5VcmwsIHsgbWV0aG9kOiBcIlBPU1RcIiwgLi4ub3B0aW9ucyB9KTtcbiAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICBjb25zdCByZXNwb25zZVRleHQgPSBhd2FpdCByZXNwb25zZS50ZXh0KCk7XG4gICAgICBjb25zb2xlLmVycm9yKFwicmVmcmVzaCB0b2tlbnMgZXJyb3I6XCIsIHJlc3BvbnNlVGV4dCk7XG4gICAgICAvLyBJZiB0aGUgcmVmcmVzaCB0b2tlbiBpcyBpbnZhbGlkLCBzdG9wIHRoZSBmbG93IGhlcmUsIGxvZyBvdXQgdGhlIHVzZXIgYW5kIHByb21wdCB0aGVtIHRvIHJlLWF1dGhvcml6ZS5cbiAgICAgIHRoaXMuY2xpZW50LmRlc2NyaXB0aW9uID0gYCR7dGhpcy5jbGllbnQucHJvdmlkZXJOYW1lfSBuZWVkcyB5b3UgdG8gc2lnbi1pbiBhZ2Fpbi4gUHJlc3Mg4o+OIG9yIGNsaWNrIHRoZSBidXR0b24gYmVsb3cgdG8gY29udGludWUuYDtcbiAgICAgIGF3YWl0IHRoaXMuY2xpZW50LnJlbW92ZVRva2VucygpO1xuICAgICAgYXdhaXQgdGhpcy5hdXRob3JpemUoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3QgdG9rZW5SZXNwb25zZSA9IHRoaXMudG9rZW5SZWZyZXNoUmVzcG9uc2VQYXJzZXIoYXdhaXQgcmVzcG9uc2UuanNvbigpKTtcbiAgICAgIHRva2VuUmVzcG9uc2UucmVmcmVzaF90b2tlbiA9IHRva2VuUmVzcG9uc2UucmVmcmVzaF90b2tlbiA/PyB0b2tlbjtcbiAgICAgIHJldHVybiB0b2tlblJlc3BvbnNlO1xuICAgIH1cbiAgfVxufVxuIiwgImV4cG9ydCBjb25zdCBQUk9WSURFUl9DTElFTlRfSURTID0ge1xuICBhc2FuYTogXCIxMTkxMjAxNzQ1Njg0MzEyXCIsXG4gIGdpdGh1YjogXCI3MjM1ZmU4ZDQyMTU3ZjFmMzhjMFwiLFxuICBsaW5lYXI6IFwiYzhmZjM3YjkyMjVjM2M5YWVmZDdkNjZlYTBlNWI2ZjFcIixcbiAgc2xhY2s6IFwiODUxNzU2ODg0NjkyLjU1NDY5MjcyOTAyMTJcIixcbn07XG4iLCAiaW1wb3J0IFJlYWN0IGZyb20gXCJyZWFjdFwiO1xuaW1wb3J0IHsgZW52aXJvbm1lbnQsIE9BdXRoIH0gZnJvbSBcIkByYXljYXN0L2FwaVwiO1xuaW1wb3J0IHR5cGUgeyBPQXV0aFR5cGUsIE9uQXV0aG9yaXplUGFyYW1zIH0gZnJvbSBcIi4vdHlwZXNcIjtcblxubGV0IHRva2VuOiBzdHJpbmcgfCBudWxsID0gbnVsbDtcbmxldCB0eXBlOiBPQXV0aFR5cGUgfCBudWxsID0gbnVsbDtcbmxldCBhdXRob3JpemU6IFByb21pc2U8c3RyaW5nPiB8IG51bGwgPSBudWxsO1xubGV0IGdldElkVG9rZW46IFByb21pc2U8c3RyaW5nIHwgdW5kZWZpbmVkPiB8IG51bGwgPSBudWxsO1xubGV0IG9uQXV0aG9yaXplOiBQcm9taXNlPHZvaWQ+IHwgbnVsbCA9IG51bGw7XG5cbnR5cGUgV2l0aEFjY2Vzc1Rva2VuUGFyYW1ldGVycyA9IHtcbiAgLyoqXG4gICAqIEFuIG9wdGlvbmFsIGluc3RhbmNlIG9mIGEgUEtDRSBDbGllbnQgdGhhdCB5b3UgY2FuIGNyZWF0ZSB1c2luZyBSYXljYXN0IEFQSS5cbiAgICogVGhpcyBjbGllbnQgaXMgdXNlZCB0byByZXR1cm4gdGhlIGBpZFRva2VuYCBhcyBwYXJ0IG9mIHRoZSBgb25BdXRob3JpemVgIGNhbGxiYWNrLlxuICAgKi9cbiAgY2xpZW50PzogT0F1dGguUEtDRUNsaWVudDtcbiAgLyoqXG4gICAqIEEgZnVuY3Rpb24gdGhhdCBpbml0aWF0ZXMgdGhlIE9BdXRoIHRva2VuIHJldHJpZXZhbCBwcm9jZXNzXG4gICAqIEByZXR1cm5zIGEgcHJvbWlzZSB0aGF0IHJlc29sdmVzIHRvIGFuIGFjY2VzcyB0b2tlbi5cbiAgICovXG4gIGF1dGhvcml6ZTogKCkgPT4gUHJvbWlzZTxzdHJpbmc+O1xuICAvKipcbiAgICogQW4gb3B0aW9uYWwgc3RyaW5nIHRoYXQgcmVwcmVzZW50cyBhbiBhbHJlYWR5IG9idGFpbmVkIHBlcnNvbmFsIGFjY2VzcyB0b2tlblxuICAgKi9cbiAgcGVyc29uYWxBY2Nlc3NUb2tlbj86IHN0cmluZztcbiAgLyoqXG4gICAqIEFuIG9wdGlvbmFsIGNhbGxiYWNrIGZ1bmN0aW9uIHRoYXQgaXMgY2FsbGVkIG9uY2UgdGhlIHVzZXIgaGFzIGJlZW4gcHJvcGVybHkgbG9nZ2VkIGluIHRocm91Z2ggT0F1dGguXG4gICAqIEBwYXJhbSB7b2JqZWN0fSBwYXJhbXMgLSBQYXJhbWV0ZXJzIG9mIHRoZSBjYWxsYmFja1xuICAgKiBAcGFyYW0ge3N0cmluZ30gb3B0aW9ucy50b2tlbiAtIFRoZSByZXRyaWV2ZWQgYWNjZXNzIHRva2VuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBvcHRpb25zLnR5cGUgLSBUaGUgYWNjZXNzIHRva2VuJ3MgdHlwZSAoZWl0aGVyIGBvYXV0aGAgb3IgYHBlcnNvbmFsYClcbiAgICogQHBhcmFtIHtzdHJpbmd9IG9wdGlvbnMuaWRUb2tlbiAtIFRoZSBvcHRpb25hbCBpZCB0b2tlbi4gVGhlIGBpZFRva2VuYCBpcyByZXR1cm5lZCBpZiBgb3B0aW9ucy5jbGllbnRgIGlzIHByb3ZpZGVkIGFuZCBpZiBpdCdzIHJldHVybmVkIGluIHRoZSBpbml0aWFsIHRva2VuIHNldC5cbiAgICovXG4gIG9uQXV0aG9yaXplPzogKHBhcmFtczogT25BdXRob3JpemVQYXJhbXMpID0+IHZvaWQ7XG59O1xuXG4vKipcbiAqIFRoZSBjb21wb25lbnQgKGZvciBhIHZpZXcvbWVudS1iYXIgY29tbWFuZHMpIG9yIGZ1bmN0aW9uIChmb3IgYSBuby12aWV3IGNvbW1hbmQpIHRoYXQgaXMgcGFzc2VkIHRvIHdpdGhBY2Nlc3NUb2tlbi5cbiAqL1xuZXhwb3J0IHR5cGUgV2l0aEFjY2Vzc1Rva2VuQ29tcG9uZW50T3JGbjxUID0gYW55LCBVID0gYW55PiA9ICgocGFyYW1zOiBUKSA9PiBQcm9taXNlPFU+IHwgVSkgfCBSZWFjdC5Db21wb25lbnRUeXBlPFQ+O1xuXG4vKipcbiAqIEhpZ2hlci1vcmRlciBjb21wb25lbnQgdG8gd3JhcCBhIGdpdmVuIGNvbXBvbmVudCBvciBmdW5jdGlvbiBhbmQgc2V0IGFuIGFjY2VzcyB0b2tlbiBpbiBhIHNoYXJlZCBnbG9iYWwgdmFyaWFibGUuXG4gKlxuICogVGhlIGZ1bmN0aW9uIGludGVyY2VwdHMgdGhlIGNvbXBvbmVudCByZW5kZXJpbmcgcHJvY2VzcyB0byBlaXRoZXIgZmV0Y2ggYW4gT0F1dGggdG9rZW4gYXN5bmNocm9ub3VzbHlcbiAqIG9yIHVzZSBhIHByb3ZpZGVkIHBlcnNvbmFsIGFjY2VzcyB0b2tlbi4gQSBnbG9iYWwgdmFyaWFibGUgd2lsbCBiZSB0aGVuIHNldCB3aXRoIHRoZSByZWNlaXZlZCB0b2tlblxuICogdGhhdCB5b3UgY2FuIGdldCB3aXRoIHRoZSBgZ2V0QWNjZXNzVG9rZW5gIGZ1bmN0aW9uLlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGB0eXBlc2NyaXB0XG4gKiBpbXBvcnQgeyBEZXRhaWwgfSBmcm9tIFwiQHJheWNhc3QvYXBpXCI7XG4gKiBpbXBvcnQgeyBPQXV0aFNlcnZpY2UsIGdldEFjY2Vzc1Rva2VuLCB3aXRoQWNjZXNzVG9rZW4gfSBmcm9tIFwiQHJheWNhc3QvdXRpbHNcIjtcbiAqXG4gKiBjb25zdCBnaXRodWIgPSBPQXV0aFNlcnZpY2UuZ2l0aHViKHsgc2NvcGU6IFwibm90aWZpY2F0aW9ucyByZXBvIHJlYWQ6b3JnIHJlYWQ6dXNlciByZWFkOnByb2plY3RcIiB9KTtcbiAqXG4gKiBmdW5jdGlvbiBBdXRob3JpemVkQ29tcG9uZW50KCkge1xuICogIGNvbnN0IHsgdG9rZW4gfSA9IGdldEFjY2Vzc1Rva2VuKCk7XG4gKiAgLi4uXG4gKiB9XG4gKlxuICogZXhwb3J0IGRlZmF1bHQgd2l0aEFjY2Vzc1Rva2VuKGdpdGh1YikoQXV0aG9yaXplZENvbXBvbmVudCk7XG4gKiBgYGBcbiAqXG4gKiBAcmV0dXJucyB7UmVhY3QuQ29tcG9uZW50VHlwZTxUPn0gVGhlIHdyYXBwZWQgY29tcG9uZW50LlxuICovXG5leHBvcnQgZnVuY3Rpb24gd2l0aEFjY2Vzc1Rva2VuPFQgPSBhbnksIFUgPSBhbnk+KFxuICBvcHRpb25zOiBXaXRoQWNjZXNzVG9rZW5QYXJhbWV0ZXJzLFxuKTogPFYgZXh0ZW5kcyBXaXRoQWNjZXNzVG9rZW5Db21wb25lbnRPckZuPFQsIFU+PihcbiAgZm5PckNvbXBvbmVudDogVixcbikgPT4gViBleHRlbmRzIFJlYWN0LkNvbXBvbmVudFR5cGU8VD4gPyBSZWFjdC5GdW5jdGlvbkNvbXBvbmVudDxUPiA6IChwcm9wczogVCkgPT4gUHJvbWlzZTxVPjtcbmV4cG9ydCBmdW5jdGlvbiB3aXRoQWNjZXNzVG9rZW48VD4ob3B0aW9uczogV2l0aEFjY2Vzc1Rva2VuUGFyYW1ldGVycykge1xuICBpZiAoZW52aXJvbm1lbnQuY29tbWFuZE1vZGUgPT09IFwibm8tdmlld1wiKSB7XG4gICAgcmV0dXJuIChmbjogKHByb3BzOiBUKSA9PiBQcm9taXNlPHZvaWQ+IHwgKCgpID0+IHZvaWQpKSA9PiB7XG4gICAgICBjb25zdCBub1ZpZXdGbiA9IGFzeW5jIChwcm9wczogVCkgPT4ge1xuICAgICAgICBpZiAoIXRva2VuKSB7XG4gICAgICAgICAgdG9rZW4gPSBvcHRpb25zLnBlcnNvbmFsQWNjZXNzVG9rZW4gPz8gKGF3YWl0IG9wdGlvbnMuYXV0aG9yaXplKCkpO1xuICAgICAgICAgIHR5cGUgPSBvcHRpb25zLnBlcnNvbmFsQWNjZXNzVG9rZW4gPyBcInBlcnNvbmFsXCIgOiBcIm9hdXRoXCI7XG4gICAgICAgICAgY29uc3QgaWRUb2tlbiA9IChhd2FpdCBvcHRpb25zLmNsaWVudD8uZ2V0VG9rZW5zKCkpPy5pZFRva2VuO1xuXG4gICAgICAgICAgaWYgKG9wdGlvbnMub25BdXRob3JpemUpIHtcbiAgICAgICAgICAgIGF3YWl0IFByb21pc2UucmVzb2x2ZShvcHRpb25zLm9uQXV0aG9yaXplKHsgdG9rZW4sIHR5cGUsIGlkVG9rZW4gfSkpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBmbihwcm9wcyk7XG4gICAgICB9O1xuXG4gICAgICByZXR1cm4gbm9WaWV3Rm47XG4gICAgfTtcbiAgfVxuXG4gIHJldHVybiAoQ29tcG9uZW50OiBSZWFjdC5Db21wb25lbnRUeXBlPFQ+KSA9PiB7XG4gICAgY29uc3QgV3JhcHBlZENvbXBvbmVudDogUmVhY3QuQ29tcG9uZW50VHlwZTxUPiA9IChwcm9wcykgPT4ge1xuICAgICAgaWYgKG9wdGlvbnMucGVyc29uYWxBY2Nlc3NUb2tlbikge1xuICAgICAgICB0b2tlbiA9IG9wdGlvbnMucGVyc29uYWxBY2Nlc3NUb2tlbjtcbiAgICAgICAgdHlwZSA9IFwicGVyc29uYWxcIjtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmICghYXV0aG9yaXplKSB7XG4gICAgICAgICAgYXV0aG9yaXplID0gb3B0aW9ucy5hdXRob3JpemUoKTtcbiAgICAgICAgfVxuICAgICAgICB0b2tlbiA9IFJlYWN0LnVzZShhdXRob3JpemUpO1xuICAgICAgICB0eXBlID0gXCJvYXV0aFwiO1xuICAgICAgfVxuXG4gICAgICBsZXQgaWRUb2tlbjogc3RyaW5nIHwgdW5kZWZpbmVkO1xuICAgICAgaWYgKG9wdGlvbnMuY2xpZW50KSB7XG4gICAgICAgIGlmICghZ2V0SWRUb2tlbikge1xuICAgICAgICAgIGdldElkVG9rZW4gPSBvcHRpb25zLmNsaWVudD8uZ2V0VG9rZW5zKCkudGhlbigodG9rZW5zKSA9PiB0b2tlbnM/LmlkVG9rZW4pO1xuICAgICAgICB9XG4gICAgICAgIGlkVG9rZW4gPSBSZWFjdC51c2UoZ2V0SWRUb2tlbik7XG4gICAgICB9XG5cbiAgICAgIGlmIChvcHRpb25zLm9uQXV0aG9yaXplKSB7XG4gICAgICAgIGlmICghb25BdXRob3JpemUpIHtcbiAgICAgICAgICBvbkF1dGhvcml6ZSA9IFByb21pc2UucmVzb2x2ZShvcHRpb25zLm9uQXV0aG9yaXplKHsgdG9rZW46IHRva2VuISwgdHlwZSwgaWRUb2tlbiB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgUmVhY3QudXNlKG9uQXV0aG9yaXplKTtcbiAgICAgIH1cblxuICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9iYW4tdHMtY29tbWVudFxuICAgICAgLy8gQHRzLWlnbm9yZSB0b28gY29tcGxpY2F0ZWQgZm9yIFRTXG4gICAgICByZXR1cm4gPENvbXBvbmVudCB7Li4ucHJvcHN9IC8+O1xuICAgIH07XG5cbiAgICBXcmFwcGVkQ29tcG9uZW50LmRpc3BsYXlOYW1lID0gYHdpdGhBY2Nlc3NUb2tlbigke0NvbXBvbmVudC5kaXNwbGF5TmFtZSB8fCBDb21wb25lbnQubmFtZX0pYDtcblxuICAgIHJldHVybiBXcmFwcGVkQ29tcG9uZW50O1xuICB9O1xufVxuXG4vKipcbiAqIFJldHVybnMgdGhlIGFjY2VzcyB0b2tlbiBhbmQgaXRzIHR5cGUuIE5vdGUgdGhhdCB0aGlzIGZ1bmN0aW9uIG11c3QgYmUgY2FsbGVkIGluIGEgY29tcG9uZW50IHdyYXBwZWQgd2l0aCBgd2l0aEFjY2Vzc1Rva2VuYC5cbiAqXG4gKiBXaWxsIHRocm93IGFuIEVycm9yIGlmIGNhbGxlZCBvdXRzaWRlIG9mIGEgZnVuY3Rpb24gb3IgY29tcG9uZW50IHdyYXBwZWQgd2l0aCBgd2l0aEFjY2Vzc1Rva2VuYFxuICpcbiAqIEByZXR1cm5zIHt7IHRva2VuOiBzdHJpbmcsIHR5cGU6IFwib2F1dGhcIiB8IFwicGVyc29uYWxcIiB9fSBBbiBvYmplY3QgY29udGFpbmluZyB0aGUgYHRva2VuYFxuICogYW5kIGl0cyBgdHlwZWAsIHdoZXJlIHR5cGUgY2FuIGJlIGVpdGhlciAnb2F1dGgnIGZvciBPQXV0aCB0b2tlbnMgb3IgJ3BlcnNvbmFsJyBmb3IgYVxuICogcGVyc29uYWwgYWNjZXNzIHRva2VuLlxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0QWNjZXNzVG9rZW4oKToge1xuICB0b2tlbjogc3RyaW5nO1xuICAvKiogYG9hdXRoYCBmb3IgT0F1dGggdG9rZW5zIG9yIGBwZXJzb25hbGAgZm9yIHBlcnNvbmFsIGFjY2VzcyB0b2tlbiAqL1xuICB0eXBlOiBcIm9hdXRoXCIgfCBcInBlcnNvbmFsXCI7XG59IHtcbiAgaWYgKCF0b2tlbiB8fCAhdHlwZSkge1xuICAgIHRocm93IG5ldyBFcnJvcihcImdldEFjY2Vzc1Rva2VuIG11c3QgYmUgdXNlZCB3aGVuIGF1dGhlbnRpY2F0ZWQgKGVnLiB1c2VkIGluc2lkZSBgd2l0aEFjY2Vzc1Rva2VuYClcIik7XG4gIH1cblxuICByZXR1cm4geyB0b2tlbiwgdHlwZSB9O1xufVxuIiwgImltcG9ydCB7IGVudmlyb25tZW50LCBMYXVuY2hQcm9wcywgTGF1bmNoVHlwZSB9IGZyb20gXCJAcmF5Y2FzdC9hcGlcIjtcbmltcG9ydCBmcyBmcm9tIFwibm9kZTpmc1wiO1xuaW1wb3J0IHBhdGggZnJvbSBcIm5vZGU6cGF0aFwiO1xuXG5leHBvcnQgZW51bSBEZWVwbGlua1R5cGUge1xuICAvKiogQSBzY3JpcHQgY29tbWFuZCAqL1xuICBTY3JpcHRDb21tYW5kID0gXCJzY3JpcHQtY29tbWFuZFwiLFxuICAvKiogQW4gZXh0ZW5zaW9uIGNvbW1hbmQgKi9cbiAgRXh0ZW5zaW9uID0gXCJleHRlbnNpb25cIixcbn1cblxuLyoqXG4gKiBPcHRpb25zIGZvciBjcmVhdGluZyBhIGRlZXBsaW5rIHRvIGEgc2NyaXB0IGNvbW1hbmQuXG4gKi9cbmV4cG9ydCB0eXBlIENyZWF0ZVNjcmlwdENvbW1hbmREZWVwbGlua09wdGlvbnMgPSB7XG4gIC8qKlxuICAgKiBUaGUgdHlwZSBvZiBkZWVwbGluaywgd2hpY2ggc2hvdWxkIGJlIFwic2NyaXB0LWNvbW1hbmRcIi5cbiAgICovXG4gIHR5cGU6IERlZXBsaW5rVHlwZS5TY3JpcHRDb21tYW5kO1xuICAvKipcbiAgICogVGhlIG5hbWUgb2YgdGhlIGNvbW1hbmQuXG4gICAqL1xuICBjb21tYW5kOiBzdHJpbmc7XG4gIC8qKlxuICAgKiBJZiB0aGUgY29tbWFuZCBhY2NlcHRzIGFyZ3VtZW50cywgdGhleSBjYW4gYmUgcGFzc2VkIHVzaW5nIHRoaXMgcXVlcnkgcGFyYW1ldGVyLlxuICAgKi9cbiAgYXJndW1lbnRzPzogc3RyaW5nW107XG59O1xuXG4vKipcbiAqIEJhc2Ugb3B0aW9ucyBmb3IgY3JlYXRpbmcgYSBkZWVwbGluayB0byBhbiBleHRlbnNpb24uXG4gKi9cbmV4cG9ydCB0eXBlIENyZWF0ZUV4dGVuc2lvbkRlZXBsaW5rQmFzZU9wdGlvbnMgPSB7XG4gIC8qKlxuICAgKiBUaGUgdHlwZSBvZiBkZWVwbGluaywgd2hpY2ggc2hvdWxkIGJlIFwiZXh0ZW5zaW9uXCIuXG4gICAqL1xuICB0eXBlPzogRGVlcGxpbmtUeXBlLkV4dGVuc2lvbjtcbiAgLyoqXG4gICAqIFRoZSBjb21tYW5kIGFzc29jaWF0ZWQgd2l0aCB0aGUgZXh0ZW5zaW9uLlxuICAgKi9cbiAgY29tbWFuZDogc3RyaW5nO1xuICAvKipcbiAgICogRWl0aGVyIFwidXNlckluaXRpYXRlZFwiLCB3aGljaCBydW5zIHRoZSBjb21tYW5kIGluIHRoZSBmb3JlZ3JvdW5kLCBvciBcImJhY2tncm91bmRcIiwgd2hpY2ggc2tpcHMgYnJpbmdpbmcgUmF5Y2FzdCB0byB0aGUgZnJvbnQuXG4gICAqL1xuICBsYXVuY2hUeXBlPzogTGF1bmNoVHlwZTtcbiAgLyoqXG4gICAqIElmIHRoZSBjb21tYW5kIGFjY2VwdHMgYXJndW1lbnRzLCB0aGV5IGNhbiBiZSBwYXNzZWQgdXNpbmcgdGhpcyBxdWVyeSBwYXJhbWV0ZXIuXG4gICAqL1xuICBhcmd1bWVudHM/OiBMYXVuY2hQcm9wc1tcImFyZ3VtZW50c1wiXTtcbiAgLyoqXG4gICAqIElmIHRoZSBjb21tYW5kIG1ha2UgdXNlIG9mIExhdW5jaENvbnRleHQsIGl0IGNhbiBiZSBwYXNzZWQgdXNpbmcgdGhpcyBxdWVyeSBwYXJhbWV0ZXIuXG4gICAqL1xuICBjb250ZXh0PzogTGF1bmNoUHJvcHNbXCJsYXVuY2hDb250ZXh0XCJdO1xuICAvKipcbiAgICogU29tZSB0ZXh0IHRvIHByZWZpbGwgdGhlIHNlYXJjaCBiYXIgb3IgZmlyc3QgdGV4dCBpbnB1dCBvZiB0aGUgY29tbWFuZFxuICAgKi9cbiAgZmFsbGJhY2tUZXh0Pzogc3RyaW5nO1xufTtcblxuLyoqXG4gKiBPcHRpb25zIGZvciBjcmVhdGluZyBhIGRlZXBsaW5rIHRvIGFuIGV4dGVuc2lvbiBmcm9tIGFub3RoZXIgZXh0ZW5zaW9uLlxuICogUmVxdWlyZXMgYm90aCB0aGUgb3duZXJPckF1dGhvck5hbWUgYW5kIGV4dGVuc2lvbk5hbWUuXG4gKi9cbmV4cG9ydCB0eXBlIENyZWF0ZUludGVyRXh0ZW5zaW9uRGVlcGxpbmtPcHRpb25zID0gQ3JlYXRlRXh0ZW5zaW9uRGVlcGxpbmtCYXNlT3B0aW9ucyAmIHtcbiAgLyoqXG4gICAqIFRoZSBuYW1lIG9mIHRoZSBvd25lciBvciBhdXRob3Igb2YgdGhlIGV4dGVuc2lvbi5cbiAgICovXG4gIG93bmVyT3JBdXRob3JOYW1lOiBzdHJpbmc7XG4gIC8qKlxuICAgKiBUaGUgbmFtZSBvZiB0aGUgZXh0ZW5zaW9uLlxuICAgKi9cbiAgZXh0ZW5zaW9uTmFtZTogc3RyaW5nO1xufTtcblxuLyoqXG4gKiBPcHRpb25zIGZvciBjcmVhdGluZyBhIGRlZXBsaW5rIHRvIGFuIGV4dGVuc2lvbi5cbiAqL1xuZXhwb3J0IHR5cGUgQ3JlYXRlRXh0ZW5zaW9uRGVlcGxpbmtPcHRpb25zID0gQ3JlYXRlSW50ZXJFeHRlbnNpb25EZWVwbGlua09wdGlvbnMgfCBDcmVhdGVFeHRlbnNpb25EZWVwbGlua0Jhc2VPcHRpb25zO1xuXG4vKipcbiAqIE9wdGlvbnMgZm9yIGNyZWF0aW5nIGEgZGVlcGxpbmsuXG4gKi9cbmV4cG9ydCB0eXBlIENyZWF0ZURlZXBsaW5rT3B0aW9ucyA9IENyZWF0ZVNjcmlwdENvbW1hbmREZWVwbGlua09wdGlvbnMgfCBDcmVhdGVFeHRlbnNpb25EZWVwbGlua09wdGlvbnM7XG5cbmZ1bmN0aW9uIGdldFByb3RvY29sKCkge1xuICByZXR1cm4gZW52aXJvbm1lbnQucmF5Y2FzdFZlcnNpb24uaW5jbHVkZXMoXCJhbHBoYVwiKSA/IFwicmF5Y2FzdGludGVybmFsOi8vXCIgOiBcInJheWNhc3Q6Ly9cIjtcbn1cblxuZnVuY3Rpb24gZ2V0T3duZXJPckF1dGhvck5hbWUoKSB7XG4gIGNvbnN0IHBhY2thZ2VKU09OID0gSlNPTi5wYXJzZShmcy5yZWFkRmlsZVN5bmMocGF0aC5qb2luKGVudmlyb25tZW50LmFzc2V0c1BhdGgsIFwiLi5cIiwgXCJwYWNrYWdlLmpzb25cIiksIFwidXRmOFwiKSk7XG4gIHJldHVybiBwYWNrYWdlSlNPTi5vd25lciB8fCBwYWNrYWdlSlNPTi5hdXRob3I7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVTY3JpcHRDb21tYW5kRGVlcGxpbmsob3B0aW9uczogQ3JlYXRlU2NyaXB0Q29tbWFuZERlZXBsaW5rT3B0aW9ucyk6IHN0cmluZyB7XG4gIGxldCB1cmwgPSBgJHtnZXRQcm90b2NvbCgpfXNjcmlwdC1jb21tYW5kcy8ke29wdGlvbnMuY29tbWFuZH1gO1xuXG4gIGlmIChvcHRpb25zLmFyZ3VtZW50cykge1xuICAgIGxldCBwYXJhbXMgPSBcIlwiO1xuICAgIGZvciAoY29uc3QgYXJnIG9mIG9wdGlvbnMuYXJndW1lbnRzKSB7XG4gICAgICBwYXJhbXMgKz0gXCImYXJndW1lbnRzPVwiICsgZW5jb2RlVVJJQ29tcG9uZW50KGFyZyk7XG4gICAgfVxuICAgIHVybCArPSBcIj9cIiArIHBhcmFtcy5zdWJzdHJpbmcoMSk7XG4gIH1cblxuICByZXR1cm4gdXJsO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlRXh0ZW5zaW9uRGVlcGxpbmsob3B0aW9uczogQ3JlYXRlRXh0ZW5zaW9uRGVlcGxpbmtPcHRpb25zKTogc3RyaW5nIHtcbiAgbGV0IG93bmVyT3JBdXRob3JOYW1lID0gZ2V0T3duZXJPckF1dGhvck5hbWUoKTtcbiAgbGV0IGV4dGVuc2lvbk5hbWUgPSBlbnZpcm9ubWVudC5leHRlbnNpb25OYW1lO1xuXG4gIGlmIChcIm93bmVyT3JBdXRob3JOYW1lXCIgaW4gb3B0aW9ucyAmJiBcImV4dGVuc2lvbk5hbWVcIiBpbiBvcHRpb25zKSB7XG4gICAgb3duZXJPckF1dGhvck5hbWUgPSBvcHRpb25zLm93bmVyT3JBdXRob3JOYW1lO1xuICAgIGV4dGVuc2lvbk5hbWUgPSBvcHRpb25zLmV4dGVuc2lvbk5hbWU7XG4gIH1cblxuICBsZXQgdXJsID0gYCR7Z2V0UHJvdG9jb2woKX1leHRlbnNpb25zLyR7b3duZXJPckF1dGhvck5hbWV9LyR7ZXh0ZW5zaW9uTmFtZX0vJHtvcHRpb25zLmNvbW1hbmR9YDtcblxuICBsZXQgcGFyYW1zID0gXCJcIjtcbiAgaWYgKG9wdGlvbnMubGF1bmNoVHlwZSkge1xuICAgIHBhcmFtcyArPSBcIiZsYXVuY2hUeXBlPVwiICsgZW5jb2RlVVJJQ29tcG9uZW50KG9wdGlvbnMubGF1bmNoVHlwZSk7XG4gIH1cblxuICBpZiAob3B0aW9ucy5hcmd1bWVudHMpIHtcbiAgICBwYXJhbXMgKz0gXCImYXJndW1lbnRzPVwiICsgZW5jb2RlVVJJQ29tcG9uZW50KEpTT04uc3RyaW5naWZ5KG9wdGlvbnMuYXJndW1lbnRzKSk7XG4gIH1cblxuICBpZiAob3B0aW9ucy5jb250ZXh0KSB7XG4gICAgcGFyYW1zICs9IFwiJmNvbnRleHQ9XCIgKyBlbmNvZGVVUklDb21wb25lbnQoSlNPTi5zdHJpbmdpZnkob3B0aW9ucy5jb250ZXh0KSk7XG4gIH1cblxuICBpZiAob3B0aW9ucy5mYWxsYmFja1RleHQpIHtcbiAgICBwYXJhbXMgKz0gXCImZmFsbGJhY2tUZXh0PVwiICsgZW5jb2RlVVJJQ29tcG9uZW50KG9wdGlvbnMuZmFsbGJhY2tUZXh0KTtcbiAgfVxuXG4gIGlmIChwYXJhbXMpIHtcbiAgICB1cmwgKz0gXCI/XCIgKyBwYXJhbXMuc3Vic3RyaW5nKDEpO1xuICB9XG5cbiAgcmV0dXJuIHVybDtcbn1cblxuLyoqXG4gKiBDcmVhdGVzIGEgZGVlcGxpbmsgdG8gYSBzY3JpcHQgY29tbWFuZCBvciBleHRlbnNpb24uXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVEZWVwbGluayhvcHRpb25zOiBDcmVhdGVEZWVwbGlua09wdGlvbnMpOiBzdHJpbmcge1xuICBpZiAob3B0aW9ucy50eXBlID09PSBEZWVwbGlua1R5cGUuU2NyaXB0Q29tbWFuZCkge1xuICAgIHJldHVybiBjcmVhdGVTY3JpcHRDb21tYW5kRGVlcGxpbmsob3B0aW9ucyk7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIGNyZWF0ZUV4dGVuc2lvbkRlZXBsaW5rKG9wdGlvbnMpO1xuICB9XG59XG4iLCAiaW1wb3J0IHsgYmFzZUV4ZWN1dGVTUUwgfSBmcm9tIFwiLi9zcWwtdXRpbHNcIjtcblxuLyoqXG4gKiBFeGVjdXRlcyBhIFNRTCBxdWVyeSBvbiBhIGxvY2FsIFNRTGl0ZSBkYXRhYmFzZSBhbmQgcmV0dXJucyB0aGUgcXVlcnkgcmVzdWx0IGluIEpTT04gZm9ybWF0LlxuICpcbiAqIEBwYXJhbSBkYXRhYmFzZVBhdGggLSBUaGUgcGF0aCB0byB0aGUgU1FMaXRlIGRhdGFiYXNlIGZpbGUuXG4gKiBAcGFyYW0gcXVlcnkgLSBUaGUgU1FMIHF1ZXJ5IHRvIGV4ZWN1dGUuXG4gKiBAcmV0dXJucyBBIFByb21pc2UgdGhhdCByZXNvbHZlcyB0byBhbiBhcnJheSBvZiBvYmplY3RzIHJlcHJlc2VudGluZyB0aGUgcXVlcnkgcmVzdWx0cy5cbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgdHlwZXNjcmlwdFxuICogaW1wb3J0IHsgY2xvc2VNYWluV2luZG93LCBDbGlwYm9hcmQgfSBmcm9tIFwiQHJheWNhc3QvYXBpXCI7XG4gKiBpbXBvcnQgeyBleGVjdXRlU1FMIH0gZnJvbSBcIkByYXljYXN0L3V0aWxzXCI7XG4gKlxuICogdHlwZSBNZXNzYWdlID0geyBib2R5OiBzdHJpbmc7IGNvZGU6IHN0cmluZyB9O1xuICpcbiAqIGNvbnN0IERCX1BBVEggPSBcIi9wYXRoL3RvL2NoYXQuZGJcIjtcbiAqXG4gKiBleHBvcnQgZGVmYXVsdCBhc3luYyBmdW5jdGlvbiBDb21tYW5kKCkge1xuICogICBjb25zdCBxdWVyeSA9IGBTRUxFQ1QgYm9keSwgY29kZSBGUk9NIC4uLmBcbiAqXG4gKiAgIGNvbnN0IG1lc3NhZ2VzID0gYXdhaXQgZXhlY3V0ZVNRTDxNZXNzYWdlPihEQl9QQVRILCBxdWVyeSk7XG4gKlxuICogICBpZiAobWVzc2FnZXMubGVuZ3RoID4gMCkge1xuICogICAgIGNvbnN0IGxhdGVzdENvZGUgPSBtZXNzYWdlc1swXS5jb2RlO1xuICogICAgIGF3YWl0IENsaXBib2FyZC5wYXN0ZShsYXRlc3RDb2RlKTtcbiAqICAgICBhd2FpdCBjbG9zZU1haW5XaW5kb3coKTtcbiAqICAgfVxuICogfVxuICogYGBgXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBleGVjdXRlU1FMPFQgPSB1bmtub3duPihkYXRhYmFzZVBhdGg6IHN0cmluZywgcXVlcnk6IHN0cmluZykge1xuICByZXR1cm4gYmFzZUV4ZWN1dGVTUUw8VD4oZGF0YWJhc2VQYXRoLCBxdWVyeSk7XG59XG4iLCAiaW1wb3J0IGNoaWxkUHJvY2VzcyBmcm9tIFwibm9kZTpjaGlsZF9wcm9jZXNzXCI7XG5pbXBvcnQge1xuICBkZWZhdWx0UGFyc2luZyxcbiAgZ2V0U3Bhd25lZFByb21pc2UsXG4gIGdldFNwYXduZWRSZXN1bHQsXG4gIGhhbmRsZU91dHB1dCxcbiAgUGFyc2VFeGVjT3V0cHV0SGFuZGxlcixcbn0gZnJvbSBcIi4vZXhlYy11dGlsc1wiO1xuXG50eXBlIEFwcGxlU2NyaXB0T3B0aW9ucyA9IHtcbiAgLyoqXG4gICAqIEJ5IGRlZmF1bHQsIGBydW5BcHBsZVNjcmlwdGAgcmV0dXJucyBpdHMgcmVzdWx0cyBpbiBodW1hbi1yZWFkYWJsZSBmb3JtOiBzdHJpbmdzIGRvIG5vdCBoYXZlIHF1b3RlcyBhcm91bmQgdGhlbSwgY2hhcmFjdGVycyBhcmUgbm90IGVzY2FwZWQsIGJyYWNlcyBmb3IgbGlzdHMgYW5kIHJlY29yZHMgYXJlIG9taXR0ZWQsIGV0Yy4gVGhpcyBpcyBnZW5lcmFsbHkgbW9yZSB1c2VmdWwsIGJ1dCBjYW4gaW50cm9kdWNlIGFtYmlndWl0aWVzLiBGb3IgZXhhbXBsZSwgdGhlIGxpc3RzIGB7XCJmb29cIiwgXCJiYXJcIn1gIGFuZCBge3tcImZvb1wiLCB7XCJiYXJcIn19fWAgd291bGQgYm90aCBiZSBkaXNwbGF5ZWQgYXMg4oCYZm9vLCBiYXLigJkuIFRvIHNlZSB0aGUgcmVzdWx0cyBpbiBhbiB1bmFtYmlndW91cyBmb3JtIHRoYXQgY291bGQgYmUgcmVjb21waWxlZCBpbnRvIHRoZSBzYW1lIHZhbHVlLCBzZXQgYGh1bWFuUmVhZGFibGVPdXRwdXRgIHRvIGBmYWxzZWAuXG4gICAqXG4gICAqIEBkZWZhdWx0IHRydWVcbiAgICovXG4gIGh1bWFuUmVhZGFibGVPdXRwdXQ/OiBib29sZWFuO1xuICAvKipcbiAgICogV2hldGhlciB0aGUgc2NyaXB0IGlzIHVzaW5nIFtgQXBwbGVTY3JpcHRgXShodHRwczovL2RldmVsb3Blci5hcHBsZS5jb20vbGlicmFyeS9hcmNoaXZlL2RvY3VtZW50YXRpb24vQXBwbGVTY3JpcHQvQ29uY2VwdHVhbC9BcHBsZVNjcmlwdExhbmdHdWlkZS9pbnRyb2R1Y3Rpb24vQVNMUl9pbnRyby5odG1sIy8vYXBwbGVfcmVmL2RvYy91aWQvVFA0MDAwMDk4Mykgb3IgW2BKYXZhU2NyaXB0YF0oaHR0cHM6Ly9kZXZlbG9wZXIuYXBwbGUuY29tL2xpYnJhcnkvYXJjaGl2ZS9yZWxlYXNlbm90ZXMvSW50ZXJhcHBsaWNhdGlvbkNvbW11bmljYXRpb24vUk4tSmF2YVNjcmlwdEZvckF1dG9tYXRpb24vQXJ0aWNsZXMvSW50cm9kdWN0aW9uLmh0bWwjLy9hcHBsZV9yZWYvZG9jL3VpZC9UUDQwMDE0NTA4LUNIMTExLVNXMSkuXG4gICAqXG4gICAqIEBkZWZhdWx0IFwiQXBwbGVTY3JpcHRcIlxuICAgKi9cbiAgbGFuZ3VhZ2U/OiBcIkFwcGxlU2NyaXB0XCIgfCBcIkphdmFTY3JpcHRcIjtcbiAgLyoqXG4gICAqIEEgU2lnbmFsIG9iamVjdCB0aGF0IGFsbG93cyB5b3UgdG8gYWJvcnQgdGhlIHJlcXVlc3QgaWYgcmVxdWlyZWQgdmlhIGFuIEFib3J0Q29udHJvbGxlciBvYmplY3QuXG4gICAqL1xuICBzaWduYWw/OiBBYm9ydFNpZ25hbDtcbiAgLyoqIElmIHRpbWVvdXQgaXMgZ3JlYXRlciB0aGFuIGAwYCwgdGhlIHBhcmVudCB3aWxsIHNlbmQgdGhlIHNpZ25hbCBgU0lHVEVSTWAgaWYgdGhlIGNoaWxkIHJ1bnMgbG9uZ2VyIHRoYW4gdGltZW91dCBtaWxsaXNlY29uZHMuXG4gICAqXG4gICAqIEBkZWZhdWx0IDEwMDAwXG4gICAqL1xuICB0aW1lb3V0PzogbnVtYmVyO1xufTtcblxuLyoqXG4gKiBFeGVjdXRlcyBhbiBBcHBsZVNjcmlwdCBzY3JpcHQuXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYHR5cGVzY3JpcHRcbiAqIGltcG9ydCB7IHNob3dIVUQgfSBmcm9tIFwiQHJheWNhc3QvYXBpXCI7XG4gKiBpbXBvcnQgeyBydW5BcHBsZVNjcmlwdCwgc2hvd0ZhaWx1cmVUb2FzdCB9IGZyb20gXCJAcmF5Y2FzdC91dGlsc1wiO1xuICpcbiAqIGV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAqICAgdHJ5IHtcbiAqICAgICBjb25zdCByZXMgPSBhd2FpdCBydW5BcHBsZVNjcmlwdChcbiAqICAgICAgIGBcbiAqICAgICAgIG9uIHJ1biBhcmd2XG4gKiAgICAgICAgIHJldHVybiBcImhlbGxvLCBcIiAmIGl0ZW0gMSBvZiBhcmd2ICYgXCIuXCJcbiAqICAgICAgIGVuZCBydW5cbiAqICAgICAgIGAsXG4gKiAgICAgICBbXCJ3b3JsZFwiXVxuICogICAgICk7XG4gKiAgICAgYXdhaXQgc2hvd0hVRChyZXMpO1xuICogICB9IGNhdGNoIChlcnJvcikge1xuICogICAgIHNob3dGYWlsdXJlVG9hc3QoZXJyb3IsIHsgdGl0bGU6IFwiQ291bGQgbm90IHJ1biBBcHBsZVNjcmlwdFwiIH0pO1xuICogICB9XG4gKiB9XG4gKiBgYGBcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJ1bkFwcGxlU2NyaXB0PFQgPSBzdHJpbmc+KFxuICBzY3JpcHQ6IHN0cmluZyxcbiAgb3B0aW9ucz86IEFwcGxlU2NyaXB0T3B0aW9ucyAmIHtcbiAgICBwYXJzZU91dHB1dD86IFBhcnNlRXhlY091dHB1dEhhbmRsZXI8VCwgc3RyaW5nLCBBcHBsZVNjcmlwdE9wdGlvbnM+O1xuICB9LFxuKTogUHJvbWlzZTxzdHJpbmc+O1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJ1bkFwcGxlU2NyaXB0PFQgPSBzdHJpbmc+KFxuICBzY3JpcHQ6IHN0cmluZyxcbiAgLyoqXG4gICAqIFRoZSBhcmd1bWVudHMgdG8gcGFzcyB0byB0aGUgc2NyaXB0LlxuICAgKi9cbiAgYXJnczogc3RyaW5nW10sXG4gIG9wdGlvbnM/OiBBcHBsZVNjcmlwdE9wdGlvbnMgJiB7XG4gICAgcGFyc2VPdXRwdXQ/OiBQYXJzZUV4ZWNPdXRwdXRIYW5kbGVyPFQsIHN0cmluZywgQXBwbGVTY3JpcHRPcHRpb25zPjtcbiAgfSxcbik6IFByb21pc2U8c3RyaW5nPjtcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBydW5BcHBsZVNjcmlwdDxUID0gc3RyaW5nPihcbiAgc2NyaXB0OiBzdHJpbmcsXG4gIG9wdGlvbnNPckFyZ3M/OlxuICAgIHwgc3RyaW5nW11cbiAgICB8IChBcHBsZVNjcmlwdE9wdGlvbnMgJiB7XG4gICAgICAgIHBhcnNlT3V0cHV0PzogUGFyc2VFeGVjT3V0cHV0SGFuZGxlcjxULCBzdHJpbmcsIEFwcGxlU2NyaXB0T3B0aW9ucz47XG4gICAgICB9KSxcbiAgb3B0aW9ucz86IEFwcGxlU2NyaXB0T3B0aW9ucyAmIHtcbiAgICBwYXJzZU91dHB1dD86IFBhcnNlRXhlY091dHB1dEhhbmRsZXI8VCwgc3RyaW5nLCBBcHBsZVNjcmlwdE9wdGlvbnM+O1xuICB9LFxuKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgaWYgKHByb2Nlc3MucGxhdGZvcm0gIT09IFwiZGFyd2luXCIpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJBcHBsZVNjcmlwdCBpcyBvbmx5IHN1cHBvcnRlZCBvbiBtYWNPU1wiKTtcbiAgfVxuXG4gIGNvbnN0IHsgaHVtYW5SZWFkYWJsZU91dHB1dCwgbGFuZ3VhZ2UsIHRpbWVvdXQsIC4uLmV4ZWNPcHRpb25zIH0gPSBBcnJheS5pc0FycmF5KG9wdGlvbnNPckFyZ3MpXG4gICAgPyBvcHRpb25zIHx8IHt9XG4gICAgOiBvcHRpb25zT3JBcmdzIHx8IHt9O1xuXG4gIGNvbnN0IG91dHB1dEFyZ3VtZW50cyA9IGh1bWFuUmVhZGFibGVPdXRwdXQgIT09IGZhbHNlID8gW10gOiBbXCItc3NcIl07XG4gIGlmIChsYW5ndWFnZSA9PT0gXCJKYXZhU2NyaXB0XCIpIHtcbiAgICBvdXRwdXRBcmd1bWVudHMucHVzaChcIi1sXCIsIFwiSmF2YVNjcmlwdFwiKTtcbiAgfVxuICBpZiAoQXJyYXkuaXNBcnJheShvcHRpb25zT3JBcmdzKSkge1xuICAgIG91dHB1dEFyZ3VtZW50cy5wdXNoKFwiLVwiLCAuLi5vcHRpb25zT3JBcmdzKTtcbiAgfVxuXG4gIGNvbnN0IHNwYXduZWQgPSBjaGlsZFByb2Nlc3Muc3Bhd24oXCJvc2FzY3JpcHRcIiwgb3V0cHV0QXJndW1lbnRzLCB7XG4gICAgLi4uZXhlY09wdGlvbnMsXG4gICAgZW52OiB7IFBBVEg6IFwiL3Vzci9sb2NhbC9iaW46L3Vzci9iaW46L2JpbjovdXNyL3NiaW46L3NiaW5cIiB9LFxuICB9KTtcbiAgY29uc3Qgc3Bhd25lZFByb21pc2UgPSBnZXRTcGF3bmVkUHJvbWlzZShzcGF3bmVkLCB7IHRpbWVvdXQ6IHRpbWVvdXQgPz8gMTAwMDAgfSk7XG5cbiAgc3Bhd25lZC5zdGRpbi5lbmQoc2NyaXB0KTtcblxuICBjb25zdCBbeyBlcnJvciwgZXhpdENvZGUsIHNpZ25hbCwgdGltZWRPdXQgfSwgc3Rkb3V0UmVzdWx0LCBzdGRlcnJSZXN1bHRdID0gYXdhaXQgZ2V0U3Bhd25lZFJlc3VsdDxzdHJpbmc+KFxuICAgIHNwYXduZWQsXG4gICAgeyBlbmNvZGluZzogXCJ1dGY4XCIgfSxcbiAgICBzcGF3bmVkUHJvbWlzZSxcbiAgKTtcbiAgY29uc3Qgc3Rkb3V0ID0gaGFuZGxlT3V0cHV0KHsgc3RyaXBGaW5hbE5ld2xpbmU6IHRydWUgfSwgc3Rkb3V0UmVzdWx0KTtcbiAgY29uc3Qgc3RkZXJyID0gaGFuZGxlT3V0cHV0KHsgc3RyaXBGaW5hbE5ld2xpbmU6IHRydWUgfSwgc3RkZXJyUmVzdWx0KTtcblxuICByZXR1cm4gZGVmYXVsdFBhcnNpbmcoe1xuICAgIHN0ZG91dCxcbiAgICBzdGRlcnIsXG4gICAgZXJyb3IsXG4gICAgZXhpdENvZGUsXG4gICAgc2lnbmFsLFxuICAgIHRpbWVkT3V0LFxuICAgIGNvbW1hbmQ6IFwib3Nhc2NyaXB0XCIsXG4gICAgb3B0aW9ucyxcbiAgICBwYXJlbnRFcnJvcjogbmV3IEVycm9yKCksXG4gIH0pO1xufVxuIiwgImltcG9ydCBjaGlsZFByb2Nlc3MgZnJvbSBcIm5vZGU6Y2hpbGRfcHJvY2Vzc1wiO1xuaW1wb3J0IHtcbiAgZGVmYXVsdFBhcnNpbmcsXG4gIGdldFNwYXduZWRQcm9taXNlLFxuICBnZXRTcGF3bmVkUmVzdWx0LFxuICBoYW5kbGVPdXRwdXQsXG4gIFBhcnNlRXhlY091dHB1dEhhbmRsZXIsXG59IGZyb20gXCIuL2V4ZWMtdXRpbHNcIjtcblxudHlwZSBQb3dlclNoZWxsU2NyaXB0T3B0aW9ucyA9IHtcbiAgLyoqXG4gICAqIEEgU2lnbmFsIG9iamVjdCB0aGF0IGFsbG93cyB5b3UgdG8gYWJvcnQgdGhlIHJlcXVlc3QgaWYgcmVxdWlyZWQgdmlhIGFuIEFib3J0Q29udHJvbGxlciBvYmplY3QuXG4gICAqL1xuICBzaWduYWw/OiBBYm9ydFNpZ25hbDtcbiAgLyoqIElmIHRpbWVvdXQgaXMgZ3JlYXRlciB0aGFuIGAwYCwgdGhlIHBhcmVudCB3aWxsIHNlbmQgdGhlIHNpZ25hbCBgU0lHVEVSTWAgaWYgdGhlIGNoaWxkIHJ1bnMgbG9uZ2VyIHRoYW4gdGltZW91dCBtaWxsaXNlY29uZHMuXG4gICAqXG4gICAqIEBkZWZhdWx0IDEwMDAwXG4gICAqL1xuICB0aW1lb3V0PzogbnVtYmVyO1xufTtcblxuLyoqXG4gKiBFeGVjdXRlcyBhIFBvd2VyU2hlbGwgc2NyaXB0LlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGB0eXBlc2NyaXB0XG4gKiBpbXBvcnQgeyBzaG93SFVEIH0gZnJvbSBcIkByYXljYXN0L2FwaVwiO1xuICogaW1wb3J0IHsgcnVuUG93ZXJTaGVsbFNjcmlwdCwgc2hvd0ZhaWx1cmVUb2FzdCB9IGZyb20gXCJAcmF5Y2FzdC91dGlsc1wiO1xuICpcbiAqIGV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAqICAgdHJ5IHtcbiAqICAgICBjb25zdCByZXMgPSBhd2FpdCBydW5Qb3dlclNoZWxsU2NyaXB0KFxuICogICAgICAgYFxuICogICAgICAgV3JpdGUtSG9zdCBcImhlbGxvLCB3b3JsZC5cIlxuICogICAgICAgYCxcbiAqICAgICApO1xuICogICAgIGF3YWl0IHNob3dIVUQocmVzKTtcbiAqICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAqICAgICBzaG93RmFpbHVyZVRvYXN0KGVycm9yLCB7IHRpdGxlOiBcIkNvdWxkIG5vdCBydW4gUG93ZXJTaGVsbFwiIH0pO1xuICogICB9XG4gKiB9XG4gKiBgYGBcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJ1blBvd2VyU2hlbGxTY3JpcHQ8VCA9IHN0cmluZz4oXG4gIHNjcmlwdDogc3RyaW5nLFxuICBvcHRpb25zPzogUG93ZXJTaGVsbFNjcmlwdE9wdGlvbnMgJiB7XG4gICAgcGFyc2VPdXRwdXQ/OiBQYXJzZUV4ZWNPdXRwdXRIYW5kbGVyPFQsIHN0cmluZywgUG93ZXJTaGVsbFNjcmlwdE9wdGlvbnM+O1xuICB9LFxuKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgaWYgKHByb2Nlc3MucGxhdGZvcm0gIT09IFwid2luMzJcIikge1xuICAgIHRocm93IG5ldyBFcnJvcihcIlBvd2VyU2hlbGwgaXMgb25seSBzdXBwb3J0ZWQgb24gV2luZG93c1wiKTtcbiAgfVxuXG4gIGNvbnN0IHsgdGltZW91dCwgLi4uZXhlY09wdGlvbnMgfSA9IG9wdGlvbnMgfHwge307XG5cbiAgY29uc3Qgb3V0cHV0QXJndW1lbnRzID0gW1wiLU5vTG9nb1wiLCBcIi1Ob1Byb2ZpbGVcIiwgXCItTm9uSW50ZXJhY3RpdmVcIiwgXCItQ29tbWFuZFwiLCBcIi1cIl07XG5cbiAgY29uc3Qgc3Bhd25lZCA9IGNoaWxkUHJvY2Vzcy5zcGF3bihcInBvd2Vyc2hlbGwuZXhlXCIsIG91dHB1dEFyZ3VtZW50cywge1xuICAgIC4uLmV4ZWNPcHRpb25zLFxuICB9KTtcbiAgY29uc3Qgc3Bhd25lZFByb21pc2UgPSBnZXRTcGF3bmVkUHJvbWlzZShzcGF3bmVkLCB7IHRpbWVvdXQ6IHRpbWVvdXQgPz8gMTAwMDAgfSk7XG5cbiAgc3Bhd25lZC5zdGRpbi5lbmQoc2NyaXB0KTtcblxuICBjb25zdCBbeyBlcnJvciwgZXhpdENvZGUsIHNpZ25hbCwgdGltZWRPdXQgfSwgc3Rkb3V0UmVzdWx0LCBzdGRlcnJSZXN1bHRdID0gYXdhaXQgZ2V0U3Bhd25lZFJlc3VsdDxzdHJpbmc+KFxuICAgIHNwYXduZWQsXG4gICAgeyBlbmNvZGluZzogXCJ1dGY4XCIgfSxcbiAgICBzcGF3bmVkUHJvbWlzZSxcbiAgKTtcbiAgY29uc3Qgc3Rkb3V0ID0gaGFuZGxlT3V0cHV0KHsgc3RyaXBGaW5hbE5ld2xpbmU6IHRydWUgfSwgc3Rkb3V0UmVzdWx0KTtcbiAgY29uc3Qgc3RkZXJyID0gaGFuZGxlT3V0cHV0KHsgc3RyaXBGaW5hbE5ld2xpbmU6IHRydWUgfSwgc3RkZXJyUmVzdWx0KTtcblxuICByZXR1cm4gZGVmYXVsdFBhcnNpbmcoe1xuICAgIHN0ZG91dCxcbiAgICBzdGRlcnIsXG4gICAgZXJyb3IsXG4gICAgZXhpdENvZGUsXG4gICAgc2lnbmFsLFxuICAgIHRpbWVkT3V0LFxuICAgIGNvbW1hbmQ6IFwicG93ZXJzaGVsbC5leGVcIixcbiAgICBvcHRpb25zLFxuICAgIHBhcmVudEVycm9yOiBuZXcgRXJyb3IoKSxcbiAgfSk7XG59XG4iLCAiaW1wb3J0IHsgQ2FjaGUgfSBmcm9tIFwiQHJheWNhc3QvYXBpXCI7XG5pbXBvcnQgeyBoYXNoLCByZXBsYWNlciwgcmV2aXZlciB9IGZyb20gXCIuL2hlbHBlcnNcIjtcblxuLyoqXG4gKiBXcmFwcyBhIGZ1bmN0aW9uIHdpdGggY2FjaGluZyBmdW5jdGlvbmFsaXR5IHVzaW5nIFJheWNhc3QncyBDYWNoZSBBUEkuXG4gKiBBbGxvd3MgZm9yIGNhY2hpbmcgb2YgZXhwZW5zaXZlIGZ1bmN0aW9ucyBsaWtlIHBhZ2luYXRlZCBBUEkgY2FsbHMgdGhhdCByYXJlbHkgY2hhbmdlLlxuICpcbiAqIEBwYXJhbSBmbiAtIFRoZSBhc3luYyBmdW5jdGlvbiB0byBjYWNoZSByZXN1bHRzIGZyb21cbiAqIEBwYXJhbSBvcHRpb25zIC0gT3B0aW9uYWwgY29uZmlndXJhdGlvbiBmb3IgdGhlIGNhY2hlIGJlaGF2aW9yXG4gKiBAcGFyYW0gb3B0aW9ucy52YWxpZGF0ZSAtIE9wdGlvbmFsIHZhbGlkYXRpb24gZnVuY3Rpb24gZm9yIGNhY2hlZCBkYXRhXG4gKiBAcGFyYW0gb3B0aW9ucy5tYXhBZ2UgLSBNYXhpbXVtIGFnZSBvZiBjYWNoZWQgZGF0YSBpbiBtaWxsaXNlY29uZHNcbiAqIEByZXR1cm5zIEFuIGFzeW5jIGZ1bmN0aW9uIHRoYXQgcmV0dXJucyB0aGUgcmVzdWx0IG9mIHRoZSBmdW5jdGlvbiwgZWl0aGVyIGZyb20gY2FjaGUgb3IgZnJlc2ggZXhlY3V0aW9uXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYHRzXG4gKiBjb25zdCBjYWNoZWRGdW5jdGlvbiA9IHdpdGhDYWNoZShmZXRjaEV4cGVuc2l2ZURhdGEsIHtcbiAqICAgbWF4QWdlOiA1ICogNjAgKiAxMDAwIC8vIENhY2hlIGZvciA1IG1pbnV0ZXNcbiAqIH0pO1xuICpcbiAqIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNhY2hlZEZ1bmN0aW9uKHF1ZXJ5KTtcbiAqIGBgYFxuICovXG5leHBvcnQgZnVuY3Rpb24gd2l0aENhY2hlPEZuIGV4dGVuZHMgKC4uLmFyZ3M6IGFueSkgPT4gUHJvbWlzZTxhbnk+PihcbiAgZm46IEZuLFxuICBvcHRpb25zPzoge1xuICAgIC8qKiBmdW5jdGlvbiB0aGF0IHJlY2VpdmVzIHRoZSBjYWNoZWQgZGF0YSBhbmQgcmV0dXJucyBhIGJvb2xlYW4gZGVwZW5kaW5nIG9uIHdoZXRoZXIgdGhlIGRhdGEgaXMgc3RpbGwgdmFsaWQgb3Igbm90LiAqL1xuICAgIHZhbGlkYXRlPzogKGRhdGE6IEF3YWl0ZWQ8UmV0dXJuVHlwZTxGbj4+KSA9PiBib29sZWFuO1xuICAgIC8qKiBNYXhpbXVtIGFnZSBvZiBjYWNoZWQgZGF0YSBpbiBtaWxsaXNlY29uZHMgYWZ0ZXIgd2hpY2ggdGhlIGRhdGEgd2lsbCBiZSBjb25zaWRlcmVkIGludmFsaWQgKi9cbiAgICBtYXhBZ2U/OiBudW1iZXI7XG4gIH0sXG4pOiBGbiAmIHsgY2xlYXJDYWNoZTogKCkgPT4gdm9pZCB9IHtcbiAgY29uc3QgY2FjaGUgPSBuZXcgQ2FjaGUoeyBuYW1lc3BhY2U6IGhhc2goZm4pIH0pO1xuXG4gIGNvbnN0IHdyYXBwZWRGbiA9IGFzeW5jICguLi5hcmdzOiBQYXJhbWV0ZXJzPEZuPikgPT4ge1xuICAgIGNvbnN0IGtleSA9XG4gICAgICBoYXNoKGFyZ3MgfHwgW10pICsgKG9wdGlvbnMgYXMgdW5rbm93biBhcyB7IGludGVybmFsX2NhY2hlS2V5U3VmZml4Pzogc3RyaW5nIH0pPy5pbnRlcm5hbF9jYWNoZUtleVN1ZmZpeDtcbiAgICBjb25zdCBjYWNoZWQgPSBjYWNoZS5nZXQoa2V5KTtcbiAgICBpZiAoY2FjaGVkKSB7XG4gICAgICBjb25zdCB7IGRhdGEsIHRpbWVzdGFtcCB9ID0gSlNPTi5wYXJzZShjYWNoZWQsIHJldml2ZXIpO1xuICAgICAgY29uc3QgaXNFeHBpcmVkID0gb3B0aW9ucz8ubWF4QWdlICYmIERhdGUubm93KCkgLSB0aW1lc3RhbXAgPiBvcHRpb25zLm1heEFnZTtcbiAgICAgIGlmICghaXNFeHBpcmVkICYmICghb3B0aW9ucz8udmFsaWRhdGUgfHwgb3B0aW9ucy52YWxpZGF0ZShkYXRhKSkpIHtcbiAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9iYW4tdHMtY29tbWVudFxuICAgIC8vIEB0cy1pZ25vcmVcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBmbiguLi5hcmdzKTtcbiAgICBjYWNoZS5zZXQoXG4gICAgICBrZXksXG4gICAgICBKU09OLnN0cmluZ2lmeShcbiAgICAgICAge1xuICAgICAgICAgIGRhdGE6IHJlc3VsdCxcbiAgICAgICAgICB0aW1lc3RhbXA6IERhdGUubm93KCksXG4gICAgICAgIH0sXG4gICAgICAgIHJlcGxhY2VyLFxuICAgICAgKSxcbiAgICApO1xuICAgIHJldHVybiByZXN1bHQ7XG4gIH07XG5cbiAgd3JhcHBlZEZuLmNsZWFyQ2FjaGUgPSAoKSA9PiB7XG4gICAgY2FjaGUuY2xlYXIoKTtcbiAgfTtcblxuICAvLyBAdHMtZXhwZWN0LWVycm9yIHRvbyBjb21wbGV4IGZvciBUU1xuICByZXR1cm4gd3JhcHBlZEZuO1xufVxuIiwgImltcG9ydCB7IEJvb2ttYXJrRm9sZGVyLCBIaXN0b3J5RW50cnksIFRhYiB9IGZyb20gXCIuLi9pbnRlcmZhY2VzXCI7XG5pbXBvcnQgeyBSZWFjdEVsZW1lbnQgfSBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCB7IGdldEZhdmljb24gfSBmcm9tIFwiQHJheWNhc3QvdXRpbHNcIjtcbmltcG9ydCB7IEljb24sIExpc3QgfSBmcm9tIFwiQHJheWNhc3QvYXBpXCI7XG5pbXBvcnQgeyBCcmF2ZUFjdGlvbnMgfSBmcm9tIFwiLlwiO1xuXG5leHBvcnQgY2xhc3MgQnJhdmVMaXN0SXRlbXMge1xuICBwdWJsaWMgc3RhdGljIFRhYkxpc3QgPSBUYWJMaXN0SXRlbTtcbiAgcHVibGljIHN0YXRpYyBUYWJIaXN0b3J5ID0gSGlzdG9yeUl0ZW07XG4gIHB1YmxpYyBzdGF0aWMgQm9va21hcmtGb2xkZXIgPSBCb29rbWFya0ZvbGRlckl0ZW07XG59XG5cbmZ1bmN0aW9uIGlzVmFsaWRIdHRwVXJsKHVybDogc3RyaW5nKTogYm9vbGVhbiB7XG4gIHRyeSB7XG4gICAgY29uc3QgcGFyc2VkID0gbmV3IFVSTCh1cmwpO1xuICAgIHJldHVybiBwYXJzZWQucHJvdG9jb2wgPT09IFwiaHR0cDpcIiB8fCBwYXJzZWQucHJvdG9jb2wgPT09IFwiaHR0cHM6XCI7XG4gIH0gY2F0Y2gge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxufVxuXG5mdW5jdGlvbiBnZXRVcmxLZXl3b3Jkcyh1cmw6IHN0cmluZyk6IHN0cmluZ1tdIHtcbiAgdHJ5IHtcbiAgICBjb25zdCBwYXJzZWQgPSBuZXcgVVJMKHVybCk7XG4gICAgLy8gSW5jbHVkZSBob3N0bmFtZSBwYXJ0cyBhbmQgcGF0aG5hbWUgcGFydHMgYXMga2V5d29yZHNcbiAgICBjb25zdCBob3N0UGFydHMgPSBwYXJzZWQuaG9zdG5hbWUucmVwbGFjZShcInd3dy5cIiwgXCJcIikuc3BsaXQoXCIuXCIpO1xuICAgIGNvbnN0IHBhdGhQYXJ0cyA9IHBhcnNlZC5wYXRobmFtZS5zcGxpdChcIi9cIikuZmlsdGVyKChwKSA9PiBwLmxlbmd0aCA+IDApO1xuICAgIHJldHVybiBbLi4uaG9zdFBhcnRzLCAuLi5wYXRoUGFydHMsIHBhcnNlZC5ob3N0bmFtZSwgdXJsXTtcbiAgfSBjYXRjaCB7XG4gICAgcmV0dXJuIFt1cmxdO1xuICB9XG59XG5mdW5jdGlvbiBCb29rbWFya0ZvbGRlckl0ZW0oe1xuICBwcm9maWxlLFxuICBlbnRyeTogeyBuYW1lLCBjaGlsZHJlbiwgaWQgfSxcbn06IHtcbiAgZW50cnk6IEJvb2ttYXJrRm9sZGVyO1xuICBwcm9maWxlOiBzdHJpbmc7XG59KTogUmVhY3RFbGVtZW50IHtcbiAgY29uc3QgdXJscyA9IGNoaWxkcmVuLmZpbHRlcigoYykgPT4gYy50eXBlID09PSBcInVybFwiKS5tYXAoKGMpID0+IGMudXJsKTtcbiAgcmV0dXJuIChcbiAgICA8TGlzdC5JdGVtXG4gICAgICBpZD17YCR7cHJvZmlsZX0tJHtpZH1gfVxuICAgICAgdGl0bGU9e25hbWV9XG4gICAgICBzdWJ0aXRsZT17YCR7dXJscy5sZW5ndGh9IGJvb2ttYXJrc2B9XG4gICAgICBpY29uPXtJY29uLkZvbGRlcn1cbiAgICAgIGFjdGlvbnM9ezxCcmF2ZUFjdGlvbnMuT3BlbkFsbEJvb2ttYXJrc0luRm9sZGVyIHVybHM9e3VybHMgYXMgc3RyaW5nW119IHByb2ZpbGU9e3Byb2ZpbGV9IC8+fVxuICAgIC8+XG4gICk7XG59XG5cbmZ1bmN0aW9uIEhpc3RvcnlJdGVtKHsgcHJvZmlsZSwgZW50cnk6IHsgdXJsLCB0aXRsZSwgaWQgfSB9OiB7IGVudHJ5OiBIaXN0b3J5RW50cnk7IHByb2ZpbGU6IHN0cmluZyB9KTogUmVhY3RFbGVtZW50IHtcbiAgcmV0dXJuIChcbiAgICA8TGlzdC5JdGVtXG4gICAgICBpZD17YCR7cHJvZmlsZX0tJHtpZH1gfVxuICAgICAgdGl0bGU9e3RpdGxlfVxuICAgICAgc3VidGl0bGU9e3VybH1cbiAgICAgIGtleXdvcmRzPXtnZXRVcmxLZXl3b3Jkcyh1cmwpfVxuICAgICAgaWNvbj17aXNWYWxpZEh0dHBVcmwodXJsKSA/IGdldEZhdmljb24odXJsKSA6IEljb24uR2xvYmV9XG4gICAgICBhY3Rpb25zPXs8QnJhdmVBY3Rpb25zLlRhYkhpc3RvcnkgdGl0bGU9e3RpdGxlfSB1cmw9e3VybH0gcHJvZmlsZT17cHJvZmlsZX0gLz59XG4gICAgLz5cbiAgKTtcbn1cblxuZnVuY3Rpb24gVGFiTGlzdEl0ZW0ocHJvcHM6IHsgdGFiOiBUYWI7IHVzZU9yaWdpbmFsRmF2aWNvbjogYm9vbGVhbiB9KSB7XG4gIHJldHVybiAoXG4gICAgPExpc3QuSXRlbVxuICAgICAgdGl0bGU9e3Byb3BzLnRhYi50aXRsZX1cbiAgICAgIHN1YnRpdGxlPXtwcm9wcy50YWIudXJsV2l0aG91dFNjaGVtZSgpfVxuICAgICAga2V5d29yZHM9e2dldFVybEtleXdvcmRzKHByb3BzLnRhYi51cmwpfVxuICAgICAgYWN0aW9ucz17PEJyYXZlQWN0aW9ucy5UYWJMaXN0IHRhYj17cHJvcHMudGFifSAvPn1cbiAgICAgIGljb249e3Byb3BzLnVzZU9yaWdpbmFsRmF2aWNvbiA/IHByb3BzLnRhYi5mYXZpY29uIDogcHJvcHMudGFiLmdvb2dsZUZhdmljb24oKX1cbiAgICAvPlxuICApO1xufVxuIiwgImltcG9ydCB7IHVzZVN0YXRlIH0gZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgeyBBY3Rpb25QYW5lbCwgRGV0YWlsLCBzaG93VG9hc3QsIFRvYXN0IH0gZnJvbSBcIkByYXljYXN0L2FwaVwiO1xuaW1wb3J0IHsgZXhlY1N5bmMgfSBmcm9tIFwiY2hpbGRfcHJvY2Vzc1wiO1xuaW1wb3J0IHsgREVGQVVMVF9FUlJPUl9USVRMRSwgRG93bmxvYWRUZXh0IH0gZnJvbSBcIi4uLy4uL2NvbnN0YW50c1wiO1xuaW1wb3J0IHsgY3B1cyB9IGZyb20gXCJvc1wiO1xuaW1wb3J0IHsgam9pbiB9IGZyb20gXCJwYXRoXCI7XG5pbXBvcnQgeyBFeGVjRXJyb3IgfSBmcm9tIFwiLi4vLi4vaW50ZXJmYWNlc1wiO1xuXG5leHBvcnQgY29uc3QgYnJld1ByZWZpeDogc3RyaW5nID0gKCgpID0+IHtcbiAgdHJ5IHtcbiAgICByZXR1cm4gZXhlY1N5bmMoXCJicmV3IC0tcHJlZml4XCIsIHsgZW5jb2Rpbmc6IFwidXRmOFwiIH0pLnRyaW0oKTtcbiAgfSBjYXRjaCB7XG4gICAgcmV0dXJuIGNwdXMoKVswXS5tb2RlbC5pbmNsdWRlcyhcIkFwcGxlXCIpID8gXCIvb3B0L2hvbWVicmV3XCIgOiBcIi91c3IvbG9jYWxcIjtcbiAgfVxufSkoKTtcblxuZXhwb3J0IGZ1bmN0aW9uIGJyZXdFeGVjdXRhYmxlKCk6IHN0cmluZyB7XG4gIHJldHVybiBqb2luKGJyZXdQcmVmaXgsIFwiYmluL2JyZXdcIik7XG59XG5cbmZ1bmN0aW9uIGV4ZWNCcmV3KGNhc2s6IHN0cmluZykge1xuICB0cnkge1xuICAgIHJldHVybiBleGVjU3luYyhgJHticmV3RXhlY3V0YWJsZSgpfSBpbnN0YWxsIC0tY2FzayAke2Nhc2t9YCwgeyBtYXhCdWZmZXI6IDEwICogMTAyNCAqIDEwMjQgfSk7XG4gIH0gY2F0Y2ggKGVycikge1xuICAgIGNvbnN0IGV4ZWNFcnIgPSBlcnIgYXMgRXhlY0Vycm9yO1xuICAgIGlmIChleGVjRXJyICYmIGV4ZWNFcnIuY29kZSA9PT0gMTI3KSB7XG4gICAgICBleGVjRXJyLnN0ZGVyciA9IGBCcmV3IGV4ZWN1dGFibGUgbm90IGZvdW5kIGF0ICR7YnJld0V4ZWN1dGFibGUoKX1gO1xuICAgICAgdGhyb3cgZXhlY0VycjtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhyb3cgZXJyO1xuICAgIH1cbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gTm90SW5zdGFsbGVkRXJyb3IoKSB7XG4gIGNvbnN0IFtpc0xvYWRpbmcsIHNldElzTG9hZGluZ10gPSB1c2VTdGF0ZSh0cnVlKTtcbiAgcmV0dXJuIChcbiAgICA8RGV0YWlsXG4gICAgICBhY3Rpb25zPXtcbiAgICAgICAgPEFjdGlvblBhbmVsPlxuICAgICAgICAgIHtpc0xvYWRpbmcgJiYgKFxuICAgICAgICAgICAgPEFjdGlvblBhbmVsLkl0ZW1cbiAgICAgICAgICAgICAgdGl0bGU9XCJJbnN0YWxsIHdpdGggSG9tZWJyZXdcIlxuICAgICAgICAgICAgICBvbkFjdGlvbj17YXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGlmICghaXNMb2FkaW5nKSByZXR1cm47XG4gICAgICAgICAgICAgICAgY29uc3QgdG9hc3QgPSBuZXcgVG9hc3QoeyBzdHlsZTogVG9hc3QuU3R5bGUuQW5pbWF0ZWQsIHRpdGxlOiBcIkluc3RhbGxpbmcuLi5cIiB9KTtcbiAgICAgICAgICAgICAgICBhd2FpdCB0b2FzdC5zaG93KCk7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgIGV4ZWNCcmV3KFwiYnJhdmUtYnJvd3NlclwiKTtcbiAgICAgICAgICAgICAgICAgIGF3YWl0IHRvYXN0LmhpZGUoKTtcbiAgICAgICAgICAgICAgICB9IGNhdGNoIHtcbiAgICAgICAgICAgICAgICAgIGF3YWl0IHRvYXN0LmhpZGUoKTtcbiAgICAgICAgICAgICAgICAgIGF3YWl0IHNob3dUb2FzdChcbiAgICAgICAgICAgICAgICAgICAgVG9hc3QuU3R5bGUuRmFpbHVyZSxcbiAgICAgICAgICAgICAgICAgICAgREVGQVVMVF9FUlJPUl9USVRMRSxcbiAgICAgICAgICAgICAgICAgICAgXCJBbiB1bmtub3duIGVycm9yIG9jY3VycmVkIHdoaWxlIHRyeWluZyB0byBpbnN0YWxsXCIsXG4gICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0b2FzdC50aXRsZSA9IFwiSW5zdGFsbGVkISBQbGVhc2UgZ28gYmFjayBhbmQgdHJ5IGFnYWluLlwiO1xuICAgICAgICAgICAgICAgIHRvYXN0LnN0eWxlID0gVG9hc3QuU3R5bGUuU3VjY2VzcztcbiAgICAgICAgICAgICAgICBhd2FpdCB0b2FzdC5zaG93KCk7XG4gICAgICAgICAgICAgICAgc2V0SXNMb2FkaW5nKGZhbHNlKTtcbiAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgKX1cbiAgICAgICAgPC9BY3Rpb25QYW5lbD5cbiAgICAgIH1cbiAgICAgIG1hcmtkb3duPXtEb3dubG9hZFRleHR9XG4gICAgLz5cbiAgKTtcbn1cbiIsICJleHBvcnQgY29uc3QgZGVmYXVsdEJyYXZlUHJvZmlsZVBhdGggPSBbXCJBcHBsaWNhdGlvbiBTdXBwb3J0XCIsIFwiQnJhdmVTb2Z0d2FyZVwiLCBcIkJyYXZlLUJyb3dzZXJcIl07XG5leHBvcnQgY29uc3QgZGVmYXVsdEJyYXZlQmV0YVByb2ZpbGVQYXRoID0gW1wiQXBwbGljYXRpb24gU3VwcG9ydFwiLCBcIkJyYXZlU29mdHdhcmVcIiwgXCJCcmF2ZS1Ccm93c2VyLUJldGFcIl07XG5leHBvcnQgY29uc3QgZGVmYXVsdEJyYXZlTmlnaHRseVByb2ZpbGVQYXRoID0gW1wiQXBwbGljYXRpb24gU3VwcG9ydFwiLCBcIkJyYXZlU29mdHdhcmVcIiwgXCJCcmF2ZS1Ccm93c2VyLU5pZ2h0bHlcIl07XG5leHBvcnQgY29uc3QgZGVmYXVsdEJyYXZlU3RhdGVQYXRoID0gW1wiQXBwbGljYXRpb24gU3VwcG9ydFwiLCBcIkJyYXZlU29mdHdhcmVcIiwgXCJCcmF2ZS1Ccm93c2VyXCIsIFwiTG9jYWwgU3RhdGVcIl07XG5leHBvcnQgY29uc3QgREVGQVVMVF9CUkFWRV9QUk9GSUxFX0lEID0gXCJEZWZhdWx0XCI7XG5leHBvcnQgY29uc3QgQlJBVkVfUFJPRklMRV9LRVkgPSBcIkJSQVZFX1BST0ZJTEVfS0VZXCI7XG5leHBvcnQgY29uc3QgQlJBVkVfUFJPRklMRVNfS0VZID0gXCJCUkFWRV9QUk9GSUxFU19LRVlcIjtcblxuZXhwb3J0IGNvbnN0IERvd25sb2FkVGV4dCA9IGBcbiMgXHVEODNEXHVERUE4RXJyb3I6IEJyYXZlIGJyb3dzZXIgaXMgbm90IGluc3RhbGxlZFxuIyMgVGhpcyBleHRlbnNpb24gZGVwZW5kcyBvbiBCcmF2ZSBicm93c2VyLiBZb3UgbXVzdCBpbnN0YWxsIGl0IHRvIGNvbnRpbnVlLlxuICBcbklmIHlvdSBoYXZlIFtIb21lYnJld10oaHR0cHM6Ly9icmV3LnNoLykgaW5zdGFsbGVkIHRoZW4gcHJlc3MgXHUyM0NFIChFbnRlciBLZXkpIHRvIGluc3RhbGwgQnJhdmUgYnJvd3Nlci5cblxuW0NsaWNrIGhlcmVdKGh0dHBzOi8vYnJhdmUuY29tL2Rvd25sb2FkLykgaWYgeW91IHdhbnQgdG8gZG93bmxvYWQgbWFudWFsbHkuXG4gIFxuWyFbQnJhdmVdKGh0dHBzOi8vYnJhdmUuY29tL3N0YXRpYy1hc3NldHMvaW1hZ2VzL2JyYXZlLWxvZ28uc3ZnKV0oKVxuYDtcblxuZXhwb3J0IGNvbnN0IE5vQm9va21hcmtzVGV4dCA9IGBUaGlzIHByb2ZpbGUgaGFzIG5vIGJvb2ttYXJrcy5gO1xuXG5leHBvcnQgY29uc3QgVW5rbm93bkVycm9yVGV4dCA9IGBcbiMgXHVEODNEXHVERUE4RXJyb3I6IFNvbWV0aGluZyBoYXBwZW5lZCB3aGlsZSB0cnlpbmcgdG8gcnVuIHlvdXIgY29tbWFuZFxuICBcblshW0JyYXZlXShodHRwczovL2JyYXZlLmNvbS9zdGF0aWMtYXNzZXRzL2ltYWdlcy9icmF2ZS1sb2dvLnN2ZyldKClcbmA7XG5cbmV4cG9ydCBjb25zdCBERUZBVUxUX0VSUk9SX1RJVExFID0gXCJBbiBFcnJvciBPY2N1cnJlZFwiO1xuXG5leHBvcnQgY29uc3QgTk9UX0lOU1RBTExFRF9NRVNTQUdFID0gXCJCcmF2ZSBub3QgaW5zdGFsbGVkXCI7XG5leHBvcnQgY29uc3QgTk9fQk9PS01BUktTX01FU1NBR0UgPSBcIkJyYXZlIGhhcyBubyBib29rbWFya3NcIjtcbiIsICJpbXBvcnQgeyBEZXRhaWwsIHNob3dUb2FzdCwgVG9hc3QgfSBmcm9tIFwiQHJheWNhc3QvYXBpXCI7XG5pbXBvcnQgeyBERUZBVUxUX0VSUk9SX1RJVExFLCBVbmtub3duRXJyb3JUZXh0IH0gZnJvbSBcIi4uLy4uL2NvbnN0YW50c1wiO1xuXG5leHBvcnQgZnVuY3Rpb24gVW5rbm93bkVycm9yKCkge1xuICBzaG93VG9hc3QoVG9hc3QuU3R5bGUuRmFpbHVyZSwgREVGQVVMVF9FUlJPUl9USVRMRSwgXCJTb21ldGhpbmcgaGFwcGVuZWQgd2hpbGUgdHJ5aW5nIHRvIHJ1biB5b3VyIGNvbW1hbmRcIik7XG5cbiAgcmV0dXJuIDxEZXRhaWwgbWFya2Rvd249e1Vua25vd25FcnJvclRleHR9IC8+O1xufVxuIiwgImltcG9ydCB7IFJlYWN0RWxlbWVudCB9IGZyb20gXCJyZWFjdFwiO1xuaW1wb3J0IHsgQWN0aW9uLCBBY3Rpb25QYW5lbCwgY2xvc2VNYWluV2luZG93LCBnZXRQcmVmZXJlbmNlVmFsdWVzLCBJY29uIH0gZnJvbSBcIkByYXljYXN0L2FwaVwiO1xuaW1wb3J0IHsgY2xvc2VUYWIsIGV4ZWN1dGVKYXZhc2NyaXB0LCBvcGVuTmV3VGFiLCBzZXRBY3RpdmVUYWIsIG9wZW5BbGxCb29rbWFya3NJbkZvbGRlciB9IGZyb20gXCIuLi9hY3Rpb25zXCI7XG5pbXBvcnQgeyBTZXR0aW5nc1Byb2ZpbGVPcGVuQmVoYXZpb3VyLCBUYWIgfSBmcm9tIFwiLi4vaW50ZXJmYWNlc1wiO1xuaW1wb3J0IHsgdXNlQ2FjaGVkU3RhdGUsIHNob3dGYWlsdXJlVG9hc3QgfSBmcm9tIFwiQHJheWNhc3QvdXRpbHNcIjtcbmltcG9ydCB7IEJSQVZFX1BST0ZJTEVfS0VZLCBERUZBVUxUX0JSQVZFX1BST0ZJTEVfSUQgfSBmcm9tIFwiLi4vY29uc3RhbnRzXCI7XG5cbmV4cG9ydCBjbGFzcyBCcmF2ZUFjdGlvbnMge1xuICBwdWJsaWMgc3RhdGljIE5ld1RhYiA9IE5ld1RhYkFjdGlvbnM7XG4gIHB1YmxpYyBzdGF0aWMgVGFiTGlzdCA9IFRhYkxpc3RJdGVtQWN0aW9ucztcbiAgcHVibGljIHN0YXRpYyBUYWJIaXN0b3J5ID0gSGlzdG9yeUl0ZW1BY3Rpb25zO1xuICBwdWJsaWMgc3RhdGljIE9wZW5BbGxCb29rbWFya3NJbkZvbGRlciA9IE9wZW5BbGxCb29rbWFya3NJbkZvbGRlckFjdGlvbjtcbn1cblxuZnVuY3Rpb24gT3BlbkFsbEJvb2ttYXJrc0luRm9sZGVyQWN0aW9uKHByb3BzOiB7IHVybHM6IHN0cmluZ1tdOyBwcm9maWxlOiBzdHJpbmcgfSkge1xuICBjb25zdCB7IG9wZW5UYWJJblByb2ZpbGUgfSA9IGdldFByZWZlcmVuY2VWYWx1ZXM8UHJlZmVyZW5jZXM+KCk7XG4gIGNvbnN0IFtwcm9maWxlQ3VycmVudF0gPSB1c2VDYWNoZWRTdGF0ZShCUkFWRV9QUk9GSUxFX0tFWSwgREVGQVVMVF9CUkFWRV9QUk9GSUxFX0lEKTtcblxuICByZXR1cm4gKFxuICAgIDxBY3Rpb25QYW5lbCB0aXRsZT1cIk9wZW4gQWxsIEJvb2ttYXJrcyBJbiBGb2xkZXJcIj5cbiAgICAgIDxBY3Rpb25cbiAgICAgICAgdGl0bGU9XCJPcGVuIEFsbCBCb29rbWFya3MgaW4gRm9sZGVyXCJcbiAgICAgICAgb25BY3Rpb249eygpID0+XG4gICAgICAgICAgb3BlbkFsbEJvb2ttYXJrc0luRm9sZGVyKHtcbiAgICAgICAgICAgIHVybHM6IHByb3BzLnVybHMsXG4gICAgICAgICAgICBwcm9maWxlQ3VycmVudDogcHJvZmlsZUN1cnJlbnQsXG4gICAgICAgICAgICBvcGVuVGFiSW5Qcm9maWxlOiBvcGVuVGFiSW5Qcm9maWxlLFxuICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICAgIC8+XG4gICAgPC9BY3Rpb25QYW5lbD5cbiAgKTtcbn1cblxuZnVuY3Rpb24gTmV3VGFiQWN0aW9ucyh7IHF1ZXJ5LCBpbmNvZ25pdG8gfTogeyBxdWVyeT86IHN0cmluZzsgaW5jb2duaXRvPzogYm9vbGVhbiB9KTogUmVhY3RFbGVtZW50IHtcbiAgY29uc3QgeyBvcGVuVGFiSW5Qcm9maWxlIH0gPSBnZXRQcmVmZXJlbmNlVmFsdWVzPFByZWZlcmVuY2VzPigpO1xuICBjb25zdCBbcHJvZmlsZUN1cnJlbnRdID0gdXNlQ2FjaGVkU3RhdGUoQlJBVkVfUFJPRklMRV9LRVksIERFRkFVTFRfQlJBVkVfUFJPRklMRV9JRCk7XG5cbiAgcmV0dXJuIChcbiAgICA8QWN0aW9uUGFuZWwgdGl0bGU9XCJOZXcgVGFiXCI+XG4gICAgICA8QWN0aW9uXG4gICAgICAgIG9uQWN0aW9uPXsoKSA9PiBvcGVuTmV3VGFiKHsgcXVlcnksIHByb2ZpbGVDdXJyZW50LCBvcGVuVGFiSW5Qcm9maWxlLCBpbmNvZ25pdG8gfSl9XG4gICAgICAgIHRpdGxlPXtxdWVyeSA/IGBTZWFyY2ggXCIke3F1ZXJ5fVwiYCA6IFwiT3BlbiBOZXcgVGFiXCJ9XG4gICAgICAgIGljb249e0ljb24uR2xvYmV9XG4gICAgICAvPlxuICAgIDwvQWN0aW9uUGFuZWw+XG4gICk7XG59XG5cbmZ1bmN0aW9uIFRhYkxpc3RJdGVtQWN0aW9ucyh7IHRhYiB9OiB7IHRhYjogVGFiIH0pIHtcbiAgY29uc3QgeyBvcGVuVGFiSW5Qcm9maWxlIH0gPSBnZXRQcmVmZXJlbmNlVmFsdWVzPFByZWZlcmVuY2VzPigpO1xuICBjb25zdCBbcHJvZmlsZUN1cnJlbnRdID0gdXNlQ2FjaGVkU3RhdGUoQlJBVkVfUFJPRklMRV9LRVksIERFRkFVTFRfQlJBVkVfUFJPRklMRV9JRCk7XG5cbiAgcmV0dXJuIChcbiAgICA8QWN0aW9uUGFuZWwgdGl0bGU9e3RhYi50aXRsZX0+XG4gICAgICA8R29Ub1RhYiB0YWI9e3RhYn0gLz5cbiAgICAgIDxBY3Rpb25cbiAgICAgICAgdGl0bGU9XCJNb3ZlIHRvIE5ldyBXaW5kb3dcIlxuICAgICAgICBpY29uPXtJY29uLldpbmRvd31cbiAgICAgICAgb25BY3Rpb249e2FzeW5jICgpID0+IHtcbiAgICAgICAgICBhd2FpdCBjbG9zZVRhYih0YWIudGFiSW5kZXgpO1xuICAgICAgICAgIGF3YWl0IG9wZW5OZXdUYWIoeyB1cmw6IHRhYi51cmwsIHByb2ZpbGVDdXJyZW50LCBvcGVuVGFiSW5Qcm9maWxlLCBuZXdXaW5kb3c6IHRydWUgfSk7XG4gICAgICAgIH19XG4gICAgICAvPlxuICAgICAgPEFjdGlvblxuICAgICAgICB0aXRsZT1cIk1vdmUgdG8gSW5jb2duaXRvIFdpbmRvd1wiXG4gICAgICAgIGljb249e0ljb24uRXllRGlzYWJsZWR9XG4gICAgICAgIG9uQWN0aW9uPXthc3luYyAoKSA9PiB7XG4gICAgICAgICAgYXdhaXQgY2xvc2VUYWIodGFiLnRhYkluZGV4KTtcbiAgICAgICAgICBhd2FpdCBvcGVuTmV3VGFiKHsgdXJsOiB0YWIudXJsLCBwcm9maWxlQ3VycmVudCwgb3BlblRhYkluUHJvZmlsZSwgaW5jb2duaXRvOiB0cnVlIH0pO1xuICAgICAgICB9fVxuICAgICAgLz5cbiAgICAgIDxBY3Rpb24uQ29weVRvQ2xpcGJvYXJkIHRpdGxlPVwiQ29weSBVUkxcIiBjb250ZW50PXt0YWIudXJsfSAvPlxuICAgIDwvQWN0aW9uUGFuZWw+XG4gICk7XG59XG5cbmZ1bmN0aW9uIEhpc3RvcnlJdGVtQWN0aW9ucyh7XG4gIHRpdGxlLFxuICB1cmwsXG4gIHByb2ZpbGU6IHByb2ZpbGVPcmlnaW5hbCxcbn06IHtcbiAgdGl0bGU6IHN0cmluZztcbiAgdXJsOiBzdHJpbmc7XG4gIHByb2ZpbGU6IHN0cmluZztcbn0pOiBSZWFjdEVsZW1lbnQge1xuICBjb25zdCB7IG9wZW5UYWJJblByb2ZpbGUgfSA9IGdldFByZWZlcmVuY2VWYWx1ZXM8UHJlZmVyZW5jZXM+KCk7XG4gIGNvbnN0IFtwcm9maWxlQ3VycmVudF0gPSB1c2VDYWNoZWRTdGF0ZShCUkFWRV9QUk9GSUxFX0tFWSwgREVGQVVMVF9CUkFWRV9QUk9GSUxFX0lEKTtcblxuICBpZiAodXJsLnN0YXJ0c1dpdGgoXCJqYXZhc2NyaXB0OlwiKSkge1xuICAgIGNvbnN0IGNvZGUgPSB1cmwuc3Vic3RyaW5nKFwiamF2YXNjcmlwdDpcIi5sZW5ndGgpO1xuICAgIHJldHVybiAoXG4gICAgICA8QWN0aW9uUGFuZWwgdGl0bGU9e3RpdGxlfT5cbiAgICAgICAgPEFjdGlvbiBvbkFjdGlvbj17KCkgPT4gZXhlY3V0ZUphdmFzY3JpcHQoY29kZSl9IGljb249e0ljb24uUGxheX0gdGl0bGU9XCJSdW4gQm9va21hcmtsZXRcIiAvPlxuICAgICAgICA8QWN0aW9uLkNvcHlUb0NsaXBib2FyZCB0aXRsZT1cIkNvcHkgQ29kZVwiIGNvbnRlbnQ9e2NvZGV9IHNob3J0Y3V0PXt7IG1vZGlmaWVyczogW1wiY21kXCJdLCBrZXk6IFwiY1wiIH19IC8+XG4gICAgICA8L0FjdGlvblBhbmVsPlxuICAgICk7XG4gIH1cblxuICByZXR1cm4gKFxuICAgIDxBY3Rpb25QYW5lbCB0aXRsZT17dGl0bGV9PlxuICAgICAgPEFjdGlvblxuICAgICAgICBvbkFjdGlvbj17YXN5bmMgKCkgPT4gYXdhaXQgb3Blbk5ld1RhYih7IHVybCwgcHJvZmlsZU9yaWdpbmFsLCBwcm9maWxlQ3VycmVudCwgb3BlblRhYkluUHJvZmlsZSB9KX1cbiAgICAgICAgaWNvbj17SWNvbi5FeWV9XG4gICAgICAgIHRpdGxlPVwiT3BlblwiXG4gICAgICAvPlxuICAgICAgPEFjdGlvblxuICAgICAgICB0aXRsZT1cIk9wZW4gaW4gTmV3IFdpbmRvd1wiXG4gICAgICAgIGljb249e0ljb24uV2luZG93fVxuICAgICAgICBvbkFjdGlvbj17YXN5bmMgKCkgPT5cbiAgICAgICAgICBhd2FpdCBvcGVuTmV3VGFiKHsgdXJsLCBwcm9maWxlT3JpZ2luYWwsIHByb2ZpbGVDdXJyZW50LCBvcGVuVGFiSW5Qcm9maWxlLCBuZXdXaW5kb3c6IHRydWUgfSlcbiAgICAgICAgfVxuICAgICAgLz5cbiAgICAgIDxBY3Rpb25cbiAgICAgICAgdGl0bGU9XCJPcGVuIGluIEluY29nbml0byBXaW5kb3dcIlxuICAgICAgICBpY29uPXtJY29uLkV5ZURpc2FibGVkfVxuICAgICAgICBvbkFjdGlvbj17YXN5bmMgKCkgPT5cbiAgICAgICAgICBhd2FpdCBvcGVuTmV3VGFiKHsgdXJsLCBwcm9maWxlT3JpZ2luYWwsIHByb2ZpbGVDdXJyZW50LCBvcGVuVGFiSW5Qcm9maWxlLCBpbmNvZ25pdG86IHRydWUgfSlcbiAgICAgICAgfVxuICAgICAgLz5cbiAgICAgIDxBY3Rpb25QYW5lbC5TZWN0aW9uIHRpdGxlPXtcIk9wZW4gaW4gcHJvZmlsZVwifT5cbiAgICAgICAgPEFjdGlvblxuICAgICAgICAgIG9uQWN0aW9uPXsoKSA9PlxuICAgICAgICAgICAgb3Blbk5ld1RhYih7XG4gICAgICAgICAgICAgIHVybCxcbiAgICAgICAgICAgICAgcHJvZmlsZU9yaWdpbmFsLFxuICAgICAgICAgICAgICBwcm9maWxlQ3VycmVudCxcbiAgICAgICAgICAgICAgb3BlblRhYkluUHJvZmlsZTogU2V0dGluZ3NQcm9maWxlT3BlbkJlaGF2aW91ci5Qcm9maWxlQ3VycmVudCxcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgfVxuICAgICAgICAgIHRpdGxlPXtcIk9wZW4gaW4gQ3VycmVudCBQcm9maWxlXCJ9XG4gICAgICAgIC8+XG4gICAgICAgIDxBY3Rpb25cbiAgICAgICAgICBvbkFjdGlvbj17KCkgPT5cbiAgICAgICAgICAgIG9wZW5OZXdUYWIoe1xuICAgICAgICAgICAgICB1cmwsXG4gICAgICAgICAgICAgIHByb2ZpbGVPcmlnaW5hbCxcbiAgICAgICAgICAgICAgcHJvZmlsZUN1cnJlbnQsXG4gICAgICAgICAgICAgIG9wZW5UYWJJblByb2ZpbGU6IFNldHRpbmdzUHJvZmlsZU9wZW5CZWhhdmlvdXIuUHJvZmlsZU9yaWdpbmFsLFxuICAgICAgICAgICAgfSlcbiAgICAgICAgICB9XG4gICAgICAgICAgdGl0bGU9e1wiT3BlbiBpbiBPcmlnaW5hbCBQcm9maWxlXCJ9XG4gICAgICAgIC8+XG4gICAgICA8L0FjdGlvblBhbmVsLlNlY3Rpb24+XG4gICAgICA8QWN0aW9uLkNvcHlUb0NsaXBib2FyZCB0aXRsZT1cIkNvcHkgVVJMXCIgY29udGVudD17dXJsfSBzaG9ydGN1dD17eyBtb2RpZmllcnM6IFtcImNtZFwiXSwga2V5OiBcImNcIiB9fSAvPlxuICAgIDwvQWN0aW9uUGFuZWw+XG4gICk7XG59XG5cbmZ1bmN0aW9uIEdvVG9UYWIocHJvcHM6IHsgdGFiOiBUYWIgfSkge1xuICBhc3luYyBmdW5jdGlvbiBoYW5kbGVBY3Rpb24oKSB7XG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IHNldEFjdGl2ZVRhYihwcm9wcy50YWIpO1xuICAgICAgYXdhaXQgY2xvc2VNYWluV2luZG93KCk7XG4gICAgfSBjYXRjaCB7XG4gICAgICBhd2FpdCBzaG93RmFpbHVyZVRvYXN0KFwiVGFiIG5vIGxvbmdlciBleGlzdHNcIiwge1xuICAgICAgICBtZXNzYWdlOiBcIlRoZSB0YWIgbWF5IGhhdmUgYmVlbiBjbG9zZWQuIFRyeSBzZWFyY2hpbmcgYWdhaW4uXCIsXG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gPEFjdGlvblBhbmVsLkl0ZW0gdGl0bGU9XCJPcGVuIFRhYlwiIGljb249e3sgc291cmNlOiBJY29uLkV5ZSB9fSBvbkFjdGlvbj17aGFuZGxlQWN0aW9ufSAvPjtcbn1cbiIsICJpbXBvcnQgeyBydW5BcHBsZVNjcmlwdCwgc2hvd0ZhaWx1cmVUb2FzdCB9IGZyb20gXCJAcmF5Y2FzdC91dGlsc1wiO1xuaW1wb3J0IHsgY2xvc2VNYWluV2luZG93LCBnZXRQcmVmZXJlbmNlVmFsdWVzLCBwb3BUb1Jvb3QgfSBmcm9tIFwiQHJheWNhc3QvYXBpXCI7XG5pbXBvcnQgeyBTZXR0aW5nc1Byb2ZpbGVPcGVuQmVoYXZpb3VyLCBUYWIgfSBmcm9tIFwiLi4vaW50ZXJmYWNlc1wiO1xuaW1wb3J0IHsgTk9UX0lOU1RBTExFRF9NRVNTQUdFIH0gZnJvbSBcIi4uL2NvbnN0YW50c1wiO1xuaW1wb3J0IHsgZXhlYyB9IGZyb20gXCJjaGlsZF9wcm9jZXNzXCI7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRPcGVuVGFicyh1c2VPcmlnaW5hbEZhdmljb246IGJvb2xlYW4pOiBQcm9taXNlPFRhYltdPiB7XG4gIGNvbnN0IGZhdmljb25Gb3JtdWxhID0gdXNlT3JpZ2luYWxGYXZpY29uXG4gICAgPyBgZXhlY3V0ZSBvZiB0YWIgX3RhYl9pbmRleCBvZiB3aW5kb3cgX3dpbmRvd19pbmRleCBqYXZhc2NyaXB0IFx1MDBBQ1xuICAgICAgICAgICAgICAgICAgICBcImRvY3VtZW50LmhlYWQucXVlcnlTZWxlY3RvcignbGlua1tyZWx+PWljb25dJykuaHJlZjtcImBcbiAgICA6ICdcIlwiJztcblxuICBhd2FpdCBjaGVja0FwcEluc3RhbGxlZCgpO1xuXG4gIGNvbnN0IHsgYnJvd3Nlck9wdGlvbiB9ID0gZ2V0UHJlZmVyZW5jZVZhbHVlczxQcmVmZXJlbmNlcz4oKTtcblxuICBjb25zdCBvcGVuVGFicyA9IGF3YWl0IHJ1bkFwcGxlU2NyaXB0KGBcbiAgICAgIHNldCBfb3V0cHV0IHRvIFwiXCJcbiAgICAgIHRlbGwgYXBwbGljYXRpb24gXCIke2Jyb3dzZXJPcHRpb259XCJcbiAgICAgICAgc2V0IF93aW5kb3dfaW5kZXggdG8gMVxuICAgICAgICByZXBlYXQgd2l0aCB3IGluIHdpbmRvd3NcbiAgICAgICAgICBzZXQgX3RhYl9pbmRleCB0byAxXG4gICAgICAgICAgcmVwZWF0IHdpdGggdCBpbiB0YWJzIG9mIHdcbiAgICAgICAgICAgIHNldCBfdGl0bGUgdG8gZ2V0IHRpdGxlIG9mIHRcbiAgICAgICAgICAgIHNldCBfdXJsIHRvIGdldCBVUkwgb2YgdFxuICAgICAgICAgICAgc2V0IF9mYXZpY29uIHRvICR7ZmF2aWNvbkZvcm11bGF9XG4gICAgICAgICAgICBzZXQgX291dHB1dCB0byAoX291dHB1dCAmIF90aXRsZSAmIFwiJHtUYWIuVEFCX0NPTlRFTlRTX1NFUEFSQVRPUn1cIiAmIF91cmwgJiBcIiR7VGFiLlRBQl9DT05URU5UU19TRVBBUkFUT1J9XCIgJiBfZmF2aWNvbiAmIFwiJHtUYWIuVEFCX0NPTlRFTlRTX1NFUEFSQVRPUn1cIiAmIF93aW5kb3dfaW5kZXggJiBcIiR7VGFiLlRBQl9DT05URU5UU19TRVBBUkFUT1J9XCIgJiBfdGFiX2luZGV4ICYgXCJcXFxcblwiKVxuICAgICAgICAgICAgc2V0IF90YWJfaW5kZXggdG8gX3RhYl9pbmRleCArIDFcbiAgICAgICAgICBlbmQgcmVwZWF0XG4gICAgICAgICAgc2V0IF93aW5kb3dfaW5kZXggdG8gX3dpbmRvd19pbmRleCArIDFcbiAgICAgICAgICBpZiBfd2luZG93X2luZGV4ID4gY291bnQgd2luZG93cyB0aGVuIGV4aXQgcmVwZWF0XG4gICAgICAgIGVuZCByZXBlYXRcbiAgICAgIGVuZCB0ZWxsXG4gICAgICByZXR1cm4gX291dHB1dFxuICBgKTtcblxuICByZXR1cm4gb3BlblRhYnNcbiAgICAuc3BsaXQoXCJcXG5cIilcbiAgICAuZmlsdGVyKChsaW5lKSA9PiBsaW5lLmxlbmd0aCAhPT0gMClcbiAgICAubWFwKChsaW5lKSA9PiBUYWIucGFyc2UobGluZSkpO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gb3BlbkFsbEJvb2ttYXJrc0luRm9sZGVyKHtcbiAgdXJscyxcbiAgcHJvZmlsZUN1cnJlbnQsXG4gIG9wZW5UYWJJblByb2ZpbGUsXG59OiB7XG4gIHVybHM6IHN0cmluZ1tdO1xuICBwcm9maWxlQ3VycmVudDogc3RyaW5nO1xuICBvcGVuVGFiSW5Qcm9maWxlOiBQcmVmZXJlbmNlc1tcIm9wZW5UYWJJblByb2ZpbGVcIl07XG59KTogUHJvbWlzZTx2b2lkPiB7XG4gIHRyeSB7XG4gICAgY29uc3QgeyBicm93c2VyT3B0aW9uIH0gPSBnZXRQcmVmZXJlbmNlVmFsdWVzPFByZWZlcmVuY2VzPigpO1xuXG4gICAgY29uc3QgYnVpbGRBcmdzID0gKHByb2ZpbGU/OiBzdHJpbmcpOiBzdHJpbmdbXSA9PiB7XG4gICAgICBjb25zdCBhcmdzOiBzdHJpbmdbXSA9IFtdO1xuICAgICAgaWYgKHByb2ZpbGUpIHtcbiAgICAgICAgYXJncy5wdXNoKGAtLXByb2ZpbGUtZGlyZWN0b3J5PSR7cHJvZmlsZX1gKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBhcmdzO1xuICAgIH07XG5cbiAgICBsZXQgYXJnczogc3RyaW5nW10gPSBbXTtcbiAgICBzd2l0Y2ggKG9wZW5UYWJJblByb2ZpbGUpIHtcbiAgICAgIGNhc2UgU2V0dGluZ3NQcm9maWxlT3BlbkJlaGF2aW91ci5EZWZhdWx0OlxuICAgICAgICBhcmdzID0gYnVpbGRBcmdzKCk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBTZXR0aW5nc1Byb2ZpbGVPcGVuQmVoYXZpb3VyLlByb2ZpbGVDdXJyZW50OlxuICAgICAgICBhcmdzID0gYnVpbGRBcmdzKHByb2ZpbGVDdXJyZW50KTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIFNldHRpbmdzUHJvZmlsZU9wZW5CZWhhdmlvdXIuUHJvZmlsZU9yaWdpbmFsOlxuICAgICAgICAvLyBUaGlzIGlzIG5vdCBzdXBwb3J0ZWQgd2hlbiBvcGVuaW5nIG11bHRpcGxlIHVybHMsIHNvIHdlIGZhbGxiYWNrIHRvIHRoZSBjdXJyZW50IHByb2ZpbGVcbiAgICAgICAgYXJncyA9IGJ1aWxkQXJncyhwcm9maWxlQ3VycmVudCk7XG4gICAgICAgIGJyZWFrO1xuICAgIH1cblxuICAgIGNvbnN0IHVybHNTdHJpbmcgPSB1cmxzLm1hcCgodXJsKSA9PiBgXCIke3VybH1cImApLmpvaW4oXCIgXCIpO1xuICAgIGNvbnN0IGFyZ3NTdHJpbmcgPSBhcmdzLm1hcCgoYXJnKSA9PiBgXCIke2FyZ31cImApLmpvaW4oXCIgXCIpO1xuICAgIGNvbnN0IGNvbW1hbmQgPSBgb3BlbiAtbmEgXCIke2Jyb3dzZXJPcHRpb259XCIgLS1hcmdzICR7YXJnc1N0cmluZ30gJHt1cmxzU3RyaW5nfWA7XG5cbiAgICBhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICBleGVjKGNvbW1hbmQsIChlcnJvcikgPT4ge1xuICAgICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgICByZWplY3QoZXJyb3IpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGNsb3NlTWFpbldpbmRvdyh7IGNsZWFyUm9vdFNlYXJjaDogdHJ1ZSB9KTtcbiAgICAgICAgICByZXNvbHZlKHRydWUpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIGNvbnNvbGUuZXJyb3IoZSk7XG4gICAgYXdhaXQgc2hvd0ZhaWx1cmVUb2FzdChcIkNvdWxkIG5vdCBvcGVuIGFsbCBib29rbWFya3NcIiwge1xuICAgICAgbWVzc2FnZTogZSBpbnN0YW5jZW9mIEVycm9yID8gZS5tZXNzYWdlIDogU3RyaW5nKGUpLFxuICAgIH0pO1xuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBvcGVuTmV3VGFiKHtcbiAgdXJsLFxuICBxdWVyeSxcbiAgcHJvZmlsZUN1cnJlbnQsXG4gIHByb2ZpbGVPcmlnaW5hbCxcbiAgb3BlblRhYkluUHJvZmlsZSxcbiAgbmV3V2luZG93LFxuICBpbmNvZ25pdG8sXG59OiB7XG4gIHVybD86IHN0cmluZztcbiAgcXVlcnk/OiBzdHJpbmc7XG4gIHByb2ZpbGVDdXJyZW50OiBzdHJpbmc7XG4gIHByb2ZpbGVPcmlnaW5hbD86IHN0cmluZztcbiAgb3BlblRhYkluUHJvZmlsZTogUHJlZmVyZW5jZXNbXCJvcGVuVGFiSW5Qcm9maWxlXCJdO1xuICBuZXdXaW5kb3c/OiBib29sZWFuO1xuICBpbmNvZ25pdG8/OiBib29sZWFuO1xufSk6IFByb21pc2U8Ym9vbGVhbiB8IHN0cmluZz4ge1xuICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICBwb3BUb1Jvb3QoeyBjbGVhclNlYXJjaEJhcjogdHJ1ZSB9KTtcbiAgfSwgMzAwMCk7XG4gIGNvbnN0IGluc3RhbGxlZCA9IGF3YWl0IGNoZWNrQXBwSW5zdGFsbGVkKCk7XG4gIGlmIChpbnN0YWxsZWQpIHtcbiAgICBjbG9zZU1haW5XaW5kb3coeyBjbGVhclJvb3RTZWFyY2g6IHRydWUgfSk7XG4gIH1cblxuICBjb25zdCB7IGJyb3dzZXJPcHRpb24gfSA9IGdldFByZWZlcmVuY2VWYWx1ZXM8UHJlZmVyZW5jZXM+KCk7XG4gIGNvbnN0IHRhcmdldFVybCA9IHVybCA/IHVybCA6IHF1ZXJ5ID8gYGh0dHBzOi8vd3d3Lmdvb2dsZS5jb20vc2VhcmNoP3E9JHtlbmNvZGVVUklDb21wb25lbnQocXVlcnkpfWAgOiBcIlwiO1xuXG4gIC8vIEhlbHBlciB0byBydW4gc2hlbGwgY29tbWFuZFxuICBjb25zdCBydW5TaGVsbENvbW1hbmQgPSAoY29tbWFuZDogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuIHwgc3RyaW5nPiA9PiB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIGV4ZWMoY29tbWFuZCwgKGVycm9yKSA9PiB7XG4gICAgICAgIGlmIChlcnJvcikge1xuICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmVzb2x2ZSh0cnVlKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG4gIH07XG5cbiAgLy8gQnVpbGQgY29tbWFuZCBhcmd1bWVudHMgYmFzZWQgb24gb3B0aW9uc1xuICBjb25zdCBidWlsZEFyZ3MgPSAocHJvZmlsZT86IHN0cmluZyk6IHN0cmluZ1tdID0+IHtcbiAgICBjb25zdCBhcmdzOiBzdHJpbmdbXSA9IFtdO1xuICAgIGlmIChwcm9maWxlKSB7XG4gICAgICBhcmdzLnB1c2goYC0tcHJvZmlsZS1kaXJlY3Rvcnk9JHtwcm9maWxlfWApO1xuICAgIH1cbiAgICBpZiAobmV3V2luZG93KSB7XG4gICAgICBhcmdzLnB1c2goXCItLW5ldy13aW5kb3dcIik7XG4gICAgfVxuICAgIGlmIChpbmNvZ25pdG8pIHtcbiAgICAgIGFyZ3MucHVzaChcIi0taW5jb2duaXRvXCIpO1xuICAgIH1cbiAgICBpZiAodGFyZ2V0VXJsKSB7XG4gICAgICBhcmdzLnB1c2godGFyZ2V0VXJsKTtcbiAgICB9XG4gICAgcmV0dXJuIGFyZ3M7XG4gIH07XG5cbiAgbGV0IGFyZ3M6IHN0cmluZ1tdID0gW107XG5cbiAgc3dpdGNoIChvcGVuVGFiSW5Qcm9maWxlKSB7XG4gICAgY2FzZSBTZXR0aW5nc1Byb2ZpbGVPcGVuQmVoYXZpb3VyLkRlZmF1bHQ6XG4gICAgICBhcmdzID0gYnVpbGRBcmdzKCk7XG4gICAgICBicmVhaztcbiAgICBjYXNlIFNldHRpbmdzUHJvZmlsZU9wZW5CZWhhdmlvdXIuUHJvZmlsZUN1cnJlbnQ6XG4gICAgICBhcmdzID0gYnVpbGRBcmdzKHByb2ZpbGVDdXJyZW50KTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgU2V0dGluZ3NQcm9maWxlT3BlbkJlaGF2aW91ci5Qcm9maWxlT3JpZ2luYWw6XG4gICAgICBhcmdzID0gYnVpbGRBcmdzKHByb2ZpbGVPcmlnaW5hbCk7XG4gICAgICBicmVhaztcbiAgfVxuXG4gIGNvbnN0IGFyZ3NTdHJpbmcgPSBhcmdzLm1hcCgoYXJnKSA9PiBgXCIke2FyZ31cImApLmpvaW4oXCIgXCIpO1xuICBjb25zdCBjb21tYW5kID0gYG9wZW4gLW5hIFwiJHticm93c2VyT3B0aW9ufVwiIC0tYXJncyAke2FyZ3NTdHJpbmd9YDtcblxuICByZXR1cm4gcnVuU2hlbGxDb21tYW5kKGNvbW1hbmQpO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY2xvc2VUYWIodGFiSW5kZXg6IG51bWJlcik6IFByb21pc2U8dm9pZD4ge1xuICBjb25zdCB7IGJyb3dzZXJPcHRpb24gfSA9IGdldFByZWZlcmVuY2VWYWx1ZXM8UHJlZmVyZW5jZXM+KCk7XG4gIGF3YWl0IHJ1bkFwcGxlU2NyaXB0KGB0ZWxsIGFwcGxpY2F0aW9uIFwiJHticm93c2VyT3B0aW9ufX1cIlxuICAgIHRlbGwgd2luZG93IDFcbiAgICAgIGRlbGV0ZSB0YWIgJHt0YWJJbmRleH1cbiAgICBlbmQgdGVsbFxuICBlbmQgdGVsbGApO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2V0QWN0aXZlVGFiKHRhYjogVGFiKTogUHJvbWlzZTx2b2lkPiB7XG4gIGNvbnN0IHsgYnJvd3Nlck9wdGlvbiB9ID0gZ2V0UHJlZmVyZW5jZVZhbHVlczxQcmVmZXJlbmNlcz4oKTtcbiAgYXdhaXQgcnVuQXBwbGVTY3JpcHQoYFxuICAgIHRlbGwgYXBwbGljYXRpb24gXCIke2Jyb3dzZXJPcHRpb259XCJcbiAgICAgIGFjdGl2YXRlXG4gICAgICBzZXQgaW5kZXggb2Ygd2luZG93ICgke3RhYi53aW5kb3dzSW5kZXh9IGFzIG51bWJlcikgdG8gKCR7dGFiLndpbmRvd3NJbmRleH0gYXMgbnVtYmVyKVxuICAgICAgc2V0IGFjdGl2ZSB0YWIgaW5kZXggb2Ygd2luZG93ICgke3RhYi53aW5kb3dzSW5kZXh9IGFzIG51bWJlcikgdG8gKCR7dGFiLnRhYkluZGV4fSBhcyBudW1iZXIpXG4gICAgZW5kIHRlbGxcbiAgICByZXR1cm4gdHJ1ZVxuICBgKTtcbn1cblxuY29uc3QgY2hlY2tBcHBJbnN0YWxsZWQgPSBhc3luYyAoKTogUHJvbWlzZTxib29sZWFuPiA9PiB7XG4gIGNvbnN0IHsgYnJvd3Nlck9wdGlvbiB9ID0gZ2V0UHJlZmVyZW5jZVZhbHVlczxQcmVmZXJlbmNlcz4oKTtcblxuICBjb25zdCBhcHBJbnN0YWxsZWQgPSBhd2FpdCBydW5BcHBsZVNjcmlwdChgXG5zZXQgaXNJbnN0YWxsZWQgdG8gZmFsc2VcbnRyeVxuICAgIGRvIHNoZWxsIHNjcmlwdCBcIm9zYXNjcmlwdCAtZSAnZXhpc3RzIGFwcGxpY2F0aW9uIFxcXFxcIiR7YnJvd3Nlck9wdGlvbn1cXFxcXCInXCJcbiAgICBzZXQgaXNJbnN0YWxsZWQgdG8gdHJ1ZVxuZW5kIHRyeVxuXG5yZXR1cm4gaXNJbnN0YWxsZWRgKTtcbiAgaWYgKGFwcEluc3RhbGxlZCA9PT0gXCJmYWxzZVwiKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKE5PVF9JTlNUQUxMRURfTUVTU0FHRSk7XG4gIH1cbiAgcmV0dXJuIHRydWU7XG59O1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZXhlY3V0ZUphdmFzY3JpcHQoY29kZTogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gIGNvbnN0IHsgYnJvd3Nlck9wdGlvbiB9ID0gZ2V0UHJlZmVyZW5jZVZhbHVlczxQcmVmZXJlbmNlcz4oKTtcblxuICB0cnkge1xuICAgIGNvbnN0IGRlY29kZWRDb2RlID0gZGVjb2RlVVJJQ29tcG9uZW50KGNvZGUpO1xuXG4gICAgLy8gV2UgbWFudWFsbHkgZXNjYXBlIHRoZSBjaGFyYWN0ZXJzIHRoYXQgYnJlYWsgQXBwbGVTY3JpcHQgc3RyaW5ncy5cbiAgICAvLyBUaGlzIGlzIHNhZmVyIHRoYW4gSlNPTi5zdHJpbmdpZnkgYmVjYXVzZSB3ZSBjb250cm9sIHRoZSBleGFjdCBvdXRwdXQgZm9ybWF0LlxuICAgIGNvbnN0IGVzY2FwZWRDb2RlID0gZGVjb2RlZENvZGVcbiAgICAgIC5yZXBsYWNlKC9cXFxcL2csIFwiXFxcXFxcXFxcIikgLy8gRXNjYXBlIGJhY2tzbGFzaGVzIGZpcnN0IVxuICAgICAgLnJlcGxhY2UoL1wiL2csICdcXFxcXCInKSAvLyBFc2NhcGUgZG91YmxlIHF1b3Rlc1xuICAgICAgLnJlcGxhY2UoL1xcci9nLCBcIlxcXFxyXCIpIC8vIEVzY2FwZSBDYXJyaWFnZSBSZXR1cm5cbiAgICAgIC5yZXBsYWNlKC9cXG4vZywgXCJcXFxcblwiKSAvLyBFc2NhcGUgTmV3IExpbmVcbiAgICAgIC5yZXBsYWNlKC9cXHQvZywgXCJcXFxcdFwiKSAvLyBFc2NhcGUgVGFiXG4gICAgICAucmVwbGFjZSgvW1xcYl0vZywgXCJcXFxcYlwiKSAvLyBFc2NhcGUgQmFja3NwYWNlXG4gICAgICAucmVwbGFjZSgvXFxmL2csIFwiXFxcXGZcIik7IC8vIEVzY2FwZSBGb3JtIEZlZWRcblxuICAgIGNvbnN0IHNjcmlwdCA9IGBcbiAgICAgIHRlbGwgYXBwbGljYXRpb24gXCIke2Jyb3dzZXJPcHRpb259XCJcbiAgICAgICAgYWN0aXZhdGVcbiAgICAgICAgdGVsbCBhY3RpdmUgdGFiIG9mIGZyb250IHdpbmRvd1xuICAgICAgICAgIGV4ZWN1dGUgamF2YXNjcmlwdCBcIiR7ZXNjYXBlZENvZGV9XCJcbiAgICAgICAgZW5kIHRlbGxcbiAgICAgIGVuZCB0ZWxsXG4gICAgYDtcbiAgICBhd2FpdCBydW5BcHBsZVNjcmlwdChzY3JpcHQpO1xuICAgIGF3YWl0IGNsb3NlTWFpbldpbmRvdygpO1xuICB9IGNhdGNoIChlKSB7XG4gICAgY29uc29sZS5lcnJvcihlKTtcbiAgICBpZiAoZSBpbnN0YW5jZW9mIEVycm9yICYmIGUubWVzc2FnZS5pbmNsdWRlcyhcIkFsbG93IEphdmFTY3JpcHQgZnJvbSBBcHBsZSBFdmVudHNcIikpIHtcbiAgICAgIGF3YWl0IHNob3dGYWlsdXJlVG9hc3QoXCJFbmFibGUgJ1ZpZXcgPiBEZXZlbG9wZXIgPiBBbGxvdyBKYXZhU2NyaXB0IGZyb20gQXBwbGUgRXZlbnRzJyBpbiBCcmF2ZS5cIik7XG4gICAgfSBlbHNlIHtcbiAgICAgIGF3YWl0IHNob3dGYWlsdXJlVG9hc3QoXCJDb3VsZCBub3QgcnVuIGJvb2ttYXJrbGV0XCIsIHtcbiAgICAgICAgbWVzc2FnZTogZSBpbnN0YW5jZW9mIEVycm9yID8gZS5tZXNzYWdlIDogU3RyaW5nKGUpLFxuICAgICAgfSk7XG4gICAgfVxuICB9XG59XG4iLCAiaW1wb3J0IHsgcHJvbWlzZXMsIGV4aXN0c1N5bmMgfSBmcm9tIFwiZnNcIjtcbmltcG9ydCB7IEJvb2ttYXJrRGlyZWN0b3J5LCBSYXdCb29rbWFya3MsIFNlYXJjaFJlc3VsdCwgQm9va21hcmtGb2xkZXIgfSBmcm9tIFwiLi4vaW50ZXJmYWNlc1wiO1xuaW1wb3J0IHsgZ2V0Qm9va21hcmtzRmlsZVBhdGggfSBmcm9tIFwiLi4vdXRpbFwiO1xuaW1wb3J0IHsgUmVhY3ROb2RlLCB1c2VFZmZlY3QsIHVzZVN0YXRlIH0gZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgeyBOT1RfSU5TVEFMTEVEX01FU1NBR0UsIERFRkFVTFRfQlJBVkVfUFJPRklMRV9JRCwgQlJBVkVfUFJPRklMRV9LRVkgfSBmcm9tIFwiLi4vY29uc3RhbnRzXCI7XG5pbXBvcnQgeyBOb3RJbnN0YWxsZWRFcnJvciwgVW5rbm93bkVycm9yIH0gZnJvbSBcIi4uL2NvbXBvbmVudHNcIjtcbmltcG9ydCB7IHVzZUNhY2hlZFN0YXRlIH0gZnJvbSBcIkByYXljYXN0L3V0aWxzXCI7XG5cbmZ1bmN0aW9uIGV4dHJhY3RCb29rbWFya0ZvbGRlckZyb21Cb29rbWFya0RpcmVjdG9yeShib29rbWFya0RpcmVjdG9yeTogQm9va21hcmtEaXJlY3RvcnkpOiBCb29rbWFya0ZvbGRlcltdIHtcbiAgY29uc3QgYm9va21hcmtzOiBCb29rbWFya0ZvbGRlcltdID0gW107XG5cbiAgaWYgKGJvb2ttYXJrRGlyZWN0b3J5LnR5cGUgPT09IFwiZm9sZGVyXCIpIHtcbiAgICBjb25zdCB1cmxDb3VudCA9IGJvb2ttYXJrRGlyZWN0b3J5LmNoaWxkcmVuLmZpbHRlcigoY2hpbGQpID0+IGNoaWxkLnR5cGUgPT09IFwidXJsXCIpLmxlbmd0aDtcbiAgICBpZiAodXJsQ291bnQgPiAxKSB7XG4gICAgICBib29rbWFya3MucHVzaCh7XG4gICAgICAgIGlkOiBib29rbWFya0RpcmVjdG9yeS5pZCxcbiAgICAgICAgbmFtZTogYm9va21hcmtEaXJlY3RvcnkubmFtZSxcbiAgICAgICAgY2hpbGRyZW46IGJvb2ttYXJrRGlyZWN0b3J5LmNoaWxkcmVuLFxuICAgICAgfSk7XG4gICAgfVxuICAgIGJvb2ttYXJrRGlyZWN0b3J5LmNoaWxkcmVuLmZvckVhY2goKGNoaWxkKSA9PiB7XG4gICAgICBib29rbWFya3MucHVzaCguLi5leHRyYWN0Qm9va21hcmtGb2xkZXJGcm9tQm9va21hcmtEaXJlY3RvcnkoY2hpbGQpKTtcbiAgICB9KTtcbiAgfVxuICByZXR1cm4gYm9va21hcmtzO1xufVxuXG5jb25zdCBleHRyYWN0Qm9va21hcmtGb2xkZXJzID0gKHJhd0Jvb2ttYXJrczogUmF3Qm9va21hcmtzKTogQm9va21hcmtGb2xkZXJbXSA9PiB7XG4gIGNvbnN0IGJvb2ttYXJrczogQm9va21hcmtGb2xkZXJbXSA9IFtdO1xuICBPYmplY3Qua2V5cyhyYXdCb29rbWFya3Mucm9vdHMpLmZvckVhY2goKHJvb3RLZXkpID0+IHtcbiAgICBjb25zdCByb290TGV2ZWxCb29rbWFya0ZvbGRlcnMgPSByYXdCb29rbWFya3Mucm9vdHNbcm9vdEtleV07XG4gICAgY29uc3QgYm9va21hcmtFbnRyaWVzID0gZXh0cmFjdEJvb2ttYXJrRm9sZGVyRnJvbUJvb2ttYXJrRGlyZWN0b3J5KHJvb3RMZXZlbEJvb2ttYXJrRm9sZGVycyk7XG4gICAgYm9va21hcmtzLnB1c2goLi4uYm9va21hcmtFbnRyaWVzKTtcbiAgfSk7XG4gIHJldHVybiBib29rbWFya3M7XG59O1xuXG5jb25zdCBnZXRCb29rbWFya0ZvbGRlcnMgPSBhc3luYyAocHJvZmlsZT86IHN0cmluZyk6IFByb21pc2U8Qm9va21hcmtGb2xkZXJbXT4gPT4ge1xuICBjb25zdCBib29rbWFya3NGaWxlUGF0aCA9IGdldEJvb2ttYXJrc0ZpbGVQYXRoKHByb2ZpbGUpO1xuICBpZiAoIWV4aXN0c1N5bmMoYm9va21hcmtzRmlsZVBhdGgpKSB7XG4gICAgcmV0dXJuIFtdO1xuICB9XG5cbiAgY29uc3QgZmlsZUJ1ZmZlciA9IGF3YWl0IHByb21pc2VzLnJlYWRGaWxlKGJvb2ttYXJrc0ZpbGVQYXRoLCB7IGVuY29kaW5nOiBcInV0Zi04XCIgfSk7XG4gIHJldHVybiBleHRyYWN0Qm9va21hcmtGb2xkZXJzKEpTT04ucGFyc2UoZmlsZUJ1ZmZlcikpO1xufTtcblxuZXhwb3J0IGZ1bmN0aW9uIHVzZUJvb2ttYXJrRm9sZGVyU2VhcmNoKCk6IFNlYXJjaFJlc3VsdDxCb29rbWFya0ZvbGRlcj4ge1xuICBjb25zdCBbcHJvZmlsZV0gPSB1c2VDYWNoZWRTdGF0ZShCUkFWRV9QUk9GSUxFX0tFWSwgREVGQVVMVF9CUkFWRV9QUk9GSUxFX0lEKTtcbiAgY29uc3QgW2RhdGEsIHNldERhdGFdID0gdXNlU3RhdGU8Qm9va21hcmtGb2xkZXJbXT4oW10pO1xuICBjb25zdCBbaXNMb2FkaW5nLCBzZXRJc0xvYWRpbmddID0gdXNlU3RhdGU8Ym9vbGVhbj4odHJ1ZSk7XG4gIGNvbnN0IFtlcnJvclZpZXcsIHNldEVycm9yVmlld10gPSB1c2VTdGF0ZTxSZWFjdE5vZGU+KCk7XG5cbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBnZXRCb29rbWFya0ZvbGRlcnMocHJvZmlsZSlcbiAgICAgIC50aGVuKChib29rbWFya3MpID0+IHtcbiAgICAgICAgc2V0RGF0YShib29rbWFya3MpO1xuICAgICAgICBzZXRJc0xvYWRpbmcoZmFsc2UpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZSkgPT4ge1xuICAgICAgICBpZiAoZS5tZXNzYWdlID09PSBOT1RfSU5TVEFMTEVEX01FU1NBR0UpIHtcbiAgICAgICAgICBzZXRFcnJvclZpZXcoPE5vdEluc3RhbGxlZEVycm9yIC8+KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBzZXRFcnJvclZpZXcoPFVua25vd25FcnJvciAvPik7XG4gICAgICAgIH1cbiAgICAgICAgc2V0SXNMb2FkaW5nKGZhbHNlKTtcbiAgICAgIH0pO1xuICB9LCBbcHJvZmlsZV0pO1xuXG4gIHJldHVybiB7IGVycm9yVmlldywgaXNMb2FkaW5nLCBkYXRhLCBwcm9maWxlOiB7IG5hbWU6IFwiXCIsIGlkOiBwcm9maWxlIGFzIHN0cmluZyB9IH07XG59XG4iLCAiaW1wb3J0IHBhdGggZnJvbSBcInBhdGhcIjtcbmltcG9ydCB7XG4gIERFRkFVTFRfQlJBVkVfUFJPRklMRV9JRCxcbiAgZGVmYXVsdEJyYXZlUHJvZmlsZVBhdGgsXG4gIGRlZmF1bHRCcmF2ZUJldGFQcm9maWxlUGF0aCxcbiAgZGVmYXVsdEJyYXZlTmlnaHRseVByb2ZpbGVQYXRoLFxuICBkZWZhdWx0QnJhdmVTdGF0ZVBhdGgsXG59IGZyb20gXCIuLi9jb25zdGFudHNcIjtcbmltcG9ydCB7IGdldFByZWZlcmVuY2VWYWx1ZXMgfSBmcm9tIFwiQHJheWNhc3QvYXBpXCI7XG5cbmNvbnN0IHsgYnJvd3Nlck9wdGlvbiB9ID0gZ2V0UHJlZmVyZW5jZVZhbHVlczxQcmVmZXJlbmNlcz4oKTtcblxubGV0IHByZWZQcm9maWxlOiBzdHJpbmdbXTtcblxuc3dpdGNoIChicm93c2VyT3B0aW9uKSB7XG4gIGNhc2UgXCJCcmF2ZSBCcm93c2VyIEJldGFcIjpcbiAgICBwcmVmUHJvZmlsZSA9IGRlZmF1bHRCcmF2ZUJldGFQcm9maWxlUGF0aDtcbiAgICBicmVhaztcbiAgY2FzZSBcIkJyYXZlIEJyb3dzZXIgTmlnaHRseVwiOlxuICAgIHByZWZQcm9maWxlID0gZGVmYXVsdEJyYXZlTmlnaHRseVByb2ZpbGVQYXRoO1xuICAgIGJyZWFrO1xuICBkZWZhdWx0OlxuICAgIHByZWZQcm9maWxlID0gZGVmYXVsdEJyYXZlUHJvZmlsZVBhdGg7XG59XG5cbmNvbnN0IHVzZXJMaWJyYXJ5RGlyZWN0b3J5UGF0aCA9ICgpID0+IHtcbiAgaWYgKCFwcm9jZXNzLmVudi5IT01FKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiJEhPTUUgZW52aXJvbm1lbnQgdmFyaWFibGUgaXMgbm90IHNldC5cIik7XG4gIH1cblxuICByZXR1cm4gcGF0aC5qb2luKHByb2Nlc3MuZW52LkhPTUUsIFwiTGlicmFyeVwiKTtcbn07XG5cbmV4cG9ydCBjb25zdCBnZXRIaXN0b3J5RGJQYXRoID0gKHByb2ZpbGU/OiBzdHJpbmcpID0+XG4gIHBhdGguam9pbih1c2VyTGlicmFyeURpcmVjdG9yeVBhdGgoKSwgLi4ucHJlZlByb2ZpbGUsIHByb2ZpbGUgPz8gREVGQVVMVF9CUkFWRV9QUk9GSUxFX0lELCBcIkhpc3RvcnlcIik7XG5cbmV4cG9ydCBjb25zdCBnZXRMb2NhbFN0YXRlUGF0aCA9ICgpID0+IHBhdGguam9pbih1c2VyTGlicmFyeURpcmVjdG9yeVBhdGgoKSwgLi4uZGVmYXVsdEJyYXZlU3RhdGVQYXRoKTtcblxuZXhwb3J0IGNvbnN0IGdldEJvb2ttYXJrc0ZpbGVQYXRoID0gKHByb2ZpbGU/OiBzdHJpbmcpID0+XG4gIHBhdGguam9pbih1c2VyTGlicmFyeURpcmVjdG9yeVBhdGgoKSwgLi4ucHJlZlByb2ZpbGUsIHByb2ZpbGUgPz8gREVGQVVMVF9CUkFWRV9QUk9GSUxFX0lELCBcIkJvb2ttYXJrc1wiKTtcbiJdLAogICJtYXBw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QUM7QUFBQSxFQUNMLEdBQUcsQ0FBQyxPQUFPLENBQUM7QUFFWixTQUFPLEVBQUUsV0FBVyxXQUFXLE1BQU0sU0FBUyxFQUFFLE1BQU0sSUFBSSxJQUFJLFFBQWtCLEVBQUU7QUFDcEY7OztBNUN2RFUsSUFBQUMsc0JBQUE7QUFYSyxTQUFSLFVBQTJCO0FBQ2hDLFFBQU0sRUFBRSxXQUFXLFdBQVcsTUFBTSxRQUFRLElBQUksd0JBQXdCO0FBRXhFLE1BQUksV0FBVztBQUNiLFdBQU87QUFBQSxFQUNUO0FBRUEsU0FDRSw2Q0FBQyxvQkFBSyxXQUFzQixzQkFBcUIsaUNBQy9DLHVEQUFDLGlCQUFLLFNBQUwsRUFBYSxPQUFNLG9CQUNqQixnQkFBTSxJQUFJLENBQUMsTUFDViw2Q0FBQyxlQUFlLGdCQUFmLEVBQXlDLE9BQU8sR0FBRyxTQUFTLFFBQVEsTUFBakMsRUFBRSxFQUFtQyxDQUMxRSxHQUNILEdBQ0Y7QUFFSjsiLAogICJuYW1lcyI6IFsiaW1wb3J0X2FwaSIsICIkaGdVVzEkdXNlUmVmIiwgIiRoZ1VXMSRzaG93VG9hc3QiLCAiJGhnVVcxJFRvYXN0IiwgIiRoZ1VXMSRyZWFkRmlsZVN5bmMiLCAiJGhnVVcxJGpvaW4iLCAiJGhnVVcxJGVudmlyb25tZW50IiwgIiRoZ1VXMSRDbGlwYm9hcmQiLCAiJGhnVVcxJG9wZW4iLCAiJGhnVVcxJENhY2hlIiwgIiRoZ1VXMSR1c2VTeW5jRXh0ZXJuYWxTdG9yZSIsICIkaGdVVzEkdXNlTWVtbyIsICIkaGdVVzEkdXNlQ2FsbGJhY2siLCAiJGhnVVcxJG5vZGVzdHJlYW0iLCAiJGhnVVcxJGNvbnN0YW50cyIsICIkaGdVVzEkcHJvbWlzaWZ5IiwgInVybCIsICIkaGdVVzEkVVJMIiwgIiRoZ1VXMSRJY29uIiwgIiRoZ1VXMSRub2RlY2hpbGRfcHJvY2VzcyIsICJpbXBvcnRfYXBpIiwgImltcG9ydF9yZWFjdCIsICJpbXBvcnRfYXBpIiwgImltcG9ydF9qc3hfcnVudGltZSIsICJpbXBvcnRfYXBpIiwgImltcG9ydF9qc3hfcnVudGltZSIsICJpbXBvcnRfYXBpIiwgImltcG9ydF9hcGkiLCAiaW1wb3J0X2NoaWxkX3Byb2Nlc3MiLCAiYnJvd3Nlck9wdGlvbiIsICJhcmdzIiwgImNvbW1hbmQiLCAiaW1wb3J0X2pzeF9ydW50aW1lIiwgImltcG9ydF9qc3hfcnVudGltZSIsICJpbXBvcnRfcGF0aCIsICJpbXBvcnRfYXBpIiwgInBhdGgiLCAicGF0aCIsICJpbXBvcnRfcmVhY3QiLCAiaW1wb3J0X2pzeF9ydW50aW1lIiwgImltcG9ydF9qc3hfcnVudGltZSJdCn0K
